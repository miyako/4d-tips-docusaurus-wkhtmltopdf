<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="de"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Formula · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="The [Formula](#formula) and [Formula from string](#formula-from-string) commands allow you to create native [`4D.Function` objects](#about-4dfunction-objects) to execute any 4D expression or code expressed as text."name="description" /><meta content="de" name="docsearch:language" /><meta content="Formula · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="The [Formula](#formula) and [Formula from string](#formula-from-string) commands allow you to create native [`4D.Function` objects](#about-4dfunction-objects) to execute any 4D expression or code expressed as text."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#FunctionClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">Formula<a aria-hidden="true" class="anchor" id="FunctionClass.html"></a></h1></header><article><div><p><span>The <a href="#FunctionClass.html_formula">Formula</a> and<a href="#FunctionClass.html_formula-from-string">Formula fromstring</a> commands allow you to create native <a href="#FunctionClass.html_about-4dfunction-objects"><code>4D.Function</code>objects</a> to execute any 4D expression or code expressed astext.</span></p><h3><span><a aria-hidden="true" class="anchor" id="FunctionClass.html_formula-objects"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_formula-objects"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Formula Objects</span></h3><p><span>Formula objects can be encapsulated in objectproperties:</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=New object <span class="hljs-variable">$f</span>.message:=<span class="hljs-function">Formula</span>(<span class="hljs-function">ALERT</span>(<span class="hljs-string">"Hello world"</span>))</code></span></pre><p>This property is an "object function", i.e. a function which isbound to its parent object. To execute a function stored in anobject property, use the <strong>()</strong> operator after theproperty name, such as:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$f</span>.<span class="hljs-function">message</span>() <span class="hljs-comment">//displays "Hello world"</span></code></pre><p>Die Syntax mit Klammern wird auch unterstützt:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$f</span>[<span class="hljs-string">"message"</span>]() <span class="hljs-comment">//displays "Hello world"</span></code></pre><p>Note that, even if it does not have parameters (see below), anobject function to be executed must be called with ( ) parenthesis.Sonst wird nur die Objekteigenschaft aufgerufen und sie gibt eineneue Referenz zur Formel zurück (und führt sie nicht aus):</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$o</span>:=<span class="hljs-variable">$f</span>.message <span class="hljs-comment">//returns the formula object in $o </span></code></pre><p>You can also execute a function using the <a href="#FunctionClass.html_apply"><code>apply()</code></a> and <a href="#FunctionClass.html_call"><code>call()</code></a> functions:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$f</span>.message.<span class="hljs-function">apply</span>() <span class="hljs-comment">//displays "Hello world"</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_passing-parameters"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_passing-parameters"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Passing parameters</h4><p>You can pass parameters to your formulas using the <a href="#FunctionClass.html_sequential-parameters">sequential parametersyntax</a> based upon $1, $2...$n. Sie schreiben zum Beispiel:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: Object <span class="hljs-variable">$f</span>:=New object <span class="hljs-variable">$f</span>.message:=<span class="hljs-function">Formula</span>(<span class="hljs-function">ALERT</span>(<span class="hljs-string">"Hello "</span>+<span class="hljs-variable">$1</span>)) <span class="hljs-variable">$f</span>.<span class="hljs-function">message</span>(<span class="hljs-string">"John"</span>) <span class="hljs-comment">//displays "Hello John"</span></code></pre><p>Or using the <a href="#FunctionClass.html_call">.call()</a>function:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: Object <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-variable">$1</span>+<span class="hljs-string">" "</span>+<span class="hljs-variable">$2</span>) <span class="hljs-variable">$text</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-literal">Null</span>;<span class="hljs-string">"Hello"</span>;<span class="hljs-string">"World"</span>) <span class="hljs-comment">//returns "Hello World"</span> <span class="hljs-variable">$text</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-literal">Null</span>;<span class="hljs-string">"Welcome to"</span>;<span class="hljs-function">String</span>(<span class="hljs-function">Year of</span>(Current date))) <span class="hljs-comment">//returns "Welcome to 2019" (for example)</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_parameters-to-a-single-method"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_parameters-to-a-single-method"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Parameters to a single method</h4><p>For more convenience, when the formula is made of a singleproject method, parameters can be omitted in the formula objectinitialization. They can just be passed when the formula is called.Beispiel:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(myMethod)  <span class="hljs-comment">//Writing Formula(myMethod($1;$2)) is not necessary</span> <span class="hljs-variable">$text</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-literal">Null</span>;<span class="hljs-string">"Hello"</span>;<span class="hljs-string">"World"</span>) <span class="hljs-comment">//returns "Hello World"</span> <span class="hljs-variable">$text</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>() <span class="hljs-comment">//returns "How are you?"</span>  <span class="hljs-comment">//myMethod</span> #<span class="hljs-function">DECLARE </span>(<span class="hljs-variable">$param1 </span>: Text; <span class="hljs-variable">$param2 </span>: Text)-&gt;<span class="hljs-variable">$return </span>: Text<span class="hljs-keyword"> If</span>(Count parameters=<span class="hljs-number">2</span>)    <span class="hljs-variable">$return</span>:=<span class="hljs-variable">$param1</span>+<span class="hljs-string">" "</span>+<span class="hljs-variable">$param2</span><span class="hljs-keyword"> Else</span>    <span class="hljs-variable">$return</span>:=<span class="hljs-string">"How are you?"</span><span class="hljs-keyword"> End if</span></code></pre><p>Parameters are received within the method, in the order they arespecified in the call.</p><h3><a aria-hidden="true" class="anchor" id="FunctionClass.html_about-4dfunction-objects"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_about-4dfunction-objects"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>About 4D.Function objects</h3><p>A <code>4D.Function</code> object contains a piece of code thatcan be executed from an object, either using the <code>()</code>operator, or using the <a href="#FunctionClass.html_apply"><code>apply()</code></a> and <a href="#FunctionClass.html_call"><code>call()</code></a> functions. 4Dproposes three kinds of Function objects:</p><ul><li>native functions, i.e. built-in functions from various 4Dclasses such as <code>collection.sort()</code> or<code>file.copyTo()</code>.</li><li>user functions, created in user <a href="#classes.html">classes</a> using the <a href="#FunctionClass.html_function">Function keyword</a>.</li><li>formula functions, i.e. functions that can execute any 4Dformula.</li></ul><h3><a aria-hidden="true" class="anchor" id="FunctionClass.html_summary"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_summary"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Summary</h3><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#FunctionClass.html_apply"><strong>.apply</strong>() :any<br /><strong>.apply</strong>( <em>thisObj</em> : Object { ;<em>formulaParams</em> : Collection } ) : any</a><p>&nbsp;&nbsp;&nbsp;&nbsp;executes the <code>formula</code> objectto which it is applied and returns the resulting value</p></td></tr><tr><td><a href="#FunctionClass.html_call"><strong>.call</strong>() :any<br /><strong>.call</strong>( <em>thisObj</em> : Object { ;...<em>params</em> : any } ) : any</a><p>&nbsp;&nbsp;&nbsp;&nbsp;executes the <code>formula</code> objectto which it is applied and returns the resulting value</p></td></tr><tr><td><a href="#FunctionClass.html_source"><strong>.source</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;contains the source expression of the<code>formula</code> as text</p></td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="FunctionClass.html_formula"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_formula"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Formula</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R6</td><td>Renamed (New formula -&gt; Formula)</td></tr><tr><td>v17 R3</td><td>Added</td></tr></tbody></table></details><p><strong>Formula</strong> ( <em>formulaExp</em> : Expression ) :4D.Function</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>formulaExp</td><td>Ausdruck</td><td style="text-align:center">-&gt;</td><td>Formula to be returned as object</td></tr><tr><td>Ergebnis</td><td>4D.Function</td><td style="text-align:center">&lt;-</td><td>Native function encapsulating the formula</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_beschreibung"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_beschreibung"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>Formula</code> command creates a <code>4DFunction</code> object based upon the <em>formulaExp</em>expression. <em>formulaExp</em> can be as simple as a single valueor complex, such as a project method with parameters.</p><p>Having a formula as an object allows it to be passed as aparameter (calculated attribute) to commands or methods or to beexecuted from various components without needing to declare them as"shared by components and host database". When called, the formulaobject is evaluated within the context of the database or componentthat created it.</p><p>The returned formula can be called with:</p><ul><li><a href="#FunctionClass.html_call"><code>.call()</code></a> or<a href="#FunctionClass.html_apply"><code>.apply()</code></a>methods, or</li><li>object notation syntax (see <a href="#FunctionClass.html_formula-object">formula object</a>).</li></ul><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-number">1</span>+<span class="hljs-number">2</span>) <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"myFormula"</span>;<span class="hljs-variable">$f</span>)  <span class="hljs-comment">//three different ways to call the formula</span> <span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-variable">$o</span>) <span class="hljs-comment">//returns 3</span> <span class="hljs-variable">$f</span>.<span class="hljs-function">apply</span>(<span class="hljs-variable">$o</span>) <span class="hljs-comment">//returns 3</span> <span class="hljs-variable">$o</span>.<span class="hljs-function">myFormula</span>() <span class="hljs-comment">//returns 3</span></code></pre><p>You can pass <a href="#FunctionClass.html_passing-parameters">parameters</a> to the<code>Formula</code>, as seen below in <a href="#FunctionClass.html_example-4">example 4</a>.</p><p>You can specify the object on which the formula is executed, asseen in <a href="#FunctionClass.html_example-5">example 5</a>. Theproperties of the object can then be accessed via the<code>This</code> command.</p><p>If <em>formulaExp</em> uses local variables, their values arecopied and stored in the returned formula object when it iscreated. When executed, the formula uses these copied values ratherthan the current value of the local variables. Note that usingarrays as local variables is not supported.</p><p>The object created by <code>Formula</code> can be saved, forexample, in a database field or in a blob document.</p><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_beispiel-1"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_beispiel-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel 1</h4><p>A simple formula:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-number">1</span>+<span class="hljs-number">2</span>)<span class="hljs-keyword"> var</span> <span class="hljs-variable">$o </span>: Object <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"f"</span>;<span class="hljs-variable">$f</span>) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$o</span>.f() <span class="hljs-comment">// returns 3</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_beispiel-2"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_beispiel-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel 2</h4><p>A formula using local variables:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$value</span>:=<span class="hljs-number">10</span> <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"f"</span>;<span class="hljs-function">Formula</span>(<span class="hljs-variable">$value</span>)) <span class="hljs-variable">$value</span>:=<span class="hljs-number">20</span> <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$o</span>.f() <span class="hljs-comment">// returns 10</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_example-3"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_example-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Example 3</h4><p>A simple formula using parameters:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"f"</span>;<span class="hljs-function">Formula</span>(<span class="hljs-variable">$1</span>+<span class="hljs-variable">$2</span>)) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$o</span>.f(<span class="hljs-number">10</span>;<span class="hljs-number">20</span>) <span class="hljs-comment">//returns 30</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_example-4"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_example-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Example 4</h4><p>A formula using a project method with parameters:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"f"</span>;<span class="hljs-function">Formula</span>(myMethod)) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$o</span>.f(<span class="hljs-string">"param1"</span>;<span class="hljs-string">"param2"</span>) <span class="hljs-comment">// equivalent to $result:=myMethod("param1";"param2")</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_example-5"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_example-5"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Example 5</h4><p>Using <code>This</code>:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"fullName"</span>;<span class="hljs-function">Formula</span>(<span class="hljs-literal">This</span>.firstName+<span class="hljs-string">" "</span>+<span class="hljs-literal">This</span>.lastName)) <span class="hljs-variable">$o</span>.firstName:=<span class="hljs-string">"John"</span> <span class="hljs-variable">$o</span>.lastName:=<span class="hljs-string">"Smith"</span> <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$o</span>.<span class="hljs-function">fullName</span>() <span class="hljs-comment">//returns "John Smith"</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_example-6"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_example-6"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Example 6</h4><p>Calling a formula using object notation:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$feta</span>; <span class="hljs-variable">$robot </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$calc </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$robot</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Robot"</span>;<span class="hljs-string">"price"</span>;<span class="hljs-number">543</span>;<span class="hljs-string">"quantity"</span>;<span class="hljs-number">2</span>) <span class="hljs-variable">$feta</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Feta"</span>;<span class="hljs-string">"price"</span>;<span class="hljs-number">12.5</span>;<span class="hljs-string">"quantity"</span>;<span class="hljs-number">5</span>) <span class="hljs-variable">$calc</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-literal">This</span>.total:=<span class="hljs-literal">This</span>.price*<span class="hljs-literal">This</span>.quantity)  <span class="hljs-comment">//sets the formula to object properties</span> <span class="hljs-variable">$feta</span>.calc:=<span class="hljs-variable">$calc</span> <span class="hljs-variable">$robot</span>.calc:=<span class="hljs-variable">$calc</span>  <span class="hljs-comment">//call the formula</span> <span class="hljs-variable">$feta</span>.<span class="hljs-function">calc</span>() <span class="hljs-comment">// $feta={name:Feta,price:12.5,quantity:5,total:62.5,calc:"[object Formula]"}</span> <span class="hljs-variable">$robot</span>.<span class="hljs-function">calc</span>() <span class="hljs-comment">// $robot={name:Robot,price:543,quantity:2,total:1086,calc:"[object Formula]"}</span></code></pre><h2><a aria-hidden="true" class="anchor" id="FunctionClass.html_formula-from-string"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_formula-from-string"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Formula from string</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R6</td><td>Renamed New formula from string -&gt; Formula from string</td></tr><tr><td>v17 R3</td><td>Added</td></tr></tbody></table></details><p><strong>Formula from string</strong>( <em>formulaString</em> :Text ) : 4D.Function</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>formulaString</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Text formula to be returned as object</td></tr><tr><td>Ergebnis</td><td>4D.Function</td><td style="text-align:center">&lt;-</td><td>Native object encapsulating the formula</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_beschreibung-1"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_beschreibung-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>Formula from string</code> command creates a4D.Function object based upon the <em>formulaString</em>.<em>formulaString</em> can be as simple as a single value orcomplex, such as a project method with parameters.</p><p>This command is similar to <a href="#FunctionClass.html_formula"><code>Formula</code></a>, except thatit handles a text-based formula. In most cases, it is recommendedto use the <code>Formula</code> command. <code>Formula fromstring</code> should only be used when the original formula wasexpressed as text (e.g., stored externally in a JSON file). In thiscontext, using syntax with tokens is highly advised.</p><blockquote><p>Because local variable contents can not be accessed by name incompiled mode, they can not be used in <em>formulaString</em>. Anattempt to access a local variable with <code>Formula fromstring</code> will result in an error (-10737).</p></blockquote><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_beispiel"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_beispiel"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><p>The following code will create a dialog accepting a formula intext format:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$textFormula </span>: Text<span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$textFormula</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please type a formula"</span>)<span class="hljs-keyword"> If</span>(ok=<span class="hljs-number">1</span>)    <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula from string</span>(<span class="hljs-variable">$textFormula</span>)<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Result = "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>()))<span class="hljs-keyword"> End if</span></code></pre><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/API/formulaDialog.png" /></p><p>...and execute the formula:</p><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/API/formulaAlert.png" /></p><h2><a aria-hidden="true" class="anchor" id="FunctionClass.html_apply"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_apply"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.apply()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R3</td><td>Added</td></tr></tbody></table></details><p><strong>.apply</strong>() : any<br /><strong>.apply</strong>( <em>thisObj</em> : Object { ;<em>formulaParams</em> : Collection } ) : any</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>thisObj</td><td>Objekt</td><td style="text-align:center">-&gt;</td><td>Object to be returned by the This command in the formula</td></tr><tr><td>formulaParams</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection of values to be passed as $1...$n when<code>formula</code> is executed</td></tr><tr><td>Ergebnis</td><td>any</td><td style="text-align:center">&lt;-</td><td>Value from formula execution</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_beschreibung-2"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_beschreibung-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.apply()</code> function executes the<code>formula</code> object to which it is applied and returns theresulting value. The formula object can be created using the<code>Formula</code> or <code>Formula from string</code>commands.</p><p>In the <em>thisObj</em> parameter, you can pass a reference tothe object to be used as <code>This</code> within the formula.</p><p>You can also pass a collection to be used as $1...$n parametersin the formula using the optional <em>formulaParams</em>parameter.</p><p>Note that <code>.apply()</code> is similar to <a href="#FunctionClass.html_call"><code>.call()</code></a> except thatparameters are passed as a collection. This can be useful forpassing calculated results.</p><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_beispiel-1-1"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_beispiel-1-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel 1</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-variable">$1</span>+<span class="hljs-variable">$2</span>+<span class="hljs-variable">$3</span>) <span class="hljs-variable">$c</span>:=<span class="hljs-function">New collection</span>(<span class="hljs-number">10</span>;<span class="hljs-number">20</span>;<span class="hljs-number">30</span>) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">apply</span>(<span class="hljs-literal">Null</span>;<span class="hljs-variable">$c</span>) <span class="hljs-comment">// returns 60</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_beispiel-2-1"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_beispiel-2-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel 2</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$calc </span>: 4D.<span class="hljs-keyword">Function</span><span class="hljs-keyword"> var</span> <span class="hljs-variable">$feta</span>; <span class="hljs-variable">$robot </span>: Object <span class="hljs-variable">$robot</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Robot"</span>;<span class="hljs-string">"price"</span>;<span class="hljs-number">543</span>;<span class="hljs-string">"quantity"</span>;<span class="hljs-number">2</span>) <span class="hljs-variable">$feta</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Feta"</span>;<span class="hljs-string">"price"</span>;<span class="hljs-number">12.5</span>;<span class="hljs-string">"quantity"</span>;<span class="hljs-number">5</span>) <span class="hljs-variable">$calc</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-literal">This</span>.total:=<span class="hljs-literal">This</span>.price*<span class="hljs-literal">This</span>.quantity) <span class="hljs-variable">$calc</span>.<span class="hljs-function">apply</span>(<span class="hljs-variable">$feta</span>) <span class="hljs-comment">// $feta={name:Feta,price:12.5,quantity:5,total:62.5}</span> <span class="hljs-variable">$calc</span>.<span class="hljs-function">apply</span>(<span class="hljs-variable">$robot</span>) <span class="hljs-comment">// $robot={name:Robot,price:543,quantity:2,total:1086}</span></code></pre><h2><a aria-hidden="true" class="anchor" id="FunctionClass.html_call"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_call"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.call()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R3</td><td>Added</td></tr></tbody></table></details><p><strong>.call</strong>() : any<br /><strong>.call</strong>( <em>thisObj</em> : Object { ;...<em>params</em> : any } ) : any</p><table><thead><tr><th>Parameter</th><th>Typ</th><th></th><th>Beschreibung</th></tr></thead><tbody><tr><td>thisObj</td><td>Objekt</td><td>-&gt;</td><td>Object to be returned by the This command in the formula</td></tr><tr><td>params</td><td>any</td><td>-&gt;</td><td>Value(s) to be passed as $1...$n when formula is executed</td></tr><tr><td>Ergebnis</td><td>any</td><td>&lt;-</td><td>Value from formula execution</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_beschreibung-3"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_beschreibung-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.call()</code> function executes the<code>formula</code> object to which it is applied and returns theresulting value. The formula object can be created using the<code>Formula</code> or <code>Formula from string</code>commands.</p><p>In the <em>thisObj</em> parameter, you can pass a reference tothe object to be used as <code>This</code> within the formula.</p><p>You can also pass values to be used as <em>$1...$n</em>parameters in the formula using the optional <em>params</em>parameter(s).</p><p>Note that <code>.call()</code> is similar to <a href="#FunctionClass.html_apply"><code>.apply()</code></a> except thatparameters are passed directly.</p><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_beispiel-1-2"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_beispiel-1-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel 1</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-function">Uppercase</span>(<span class="hljs-variable">$1</span>)) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-literal">Null</span>;<span class="hljs-string">"hello"</span>) <span class="hljs-comment">// returns "HELLO"</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_beispiel-2-2"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_beispiel-2-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel 2</h4><pre><code class="hljs css language-4d"> <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"value"</span>;<span class="hljs-number">50</span>) <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-literal">This</span>.value*<span class="hljs-number">2</span>) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-variable">$o</span>) <span class="hljs-comment">// returns 100</span></code></pre><h2><a aria-hidden="true" class="anchor" id="FunctionClass.html_source"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_source"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.source</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R2</td><td>Added</td></tr></tbody></table></details><p><strong>.source</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_beschreibung-4"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_beschreibung-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.source</code> property contains the source expressionof the <code>formula</code> as text.</p><p>This property is <strong>read-only</strong>.</p><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_beispiel-3"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_beispiel-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$of </span>: 4D.<span class="hljs-keyword">Function</span><span class="hljs-keyword"> var</span> <span class="hljs-variable">$tf </span>: Text <span class="hljs-variable">$of</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-function">String</span>(Current time;HH MM AM PM)) <span class="hljs-variable">$tf</span>:=<span class="hljs-variable">$of</span>.source <span class="hljs-comment">//"String(Current time;HH MM AM PM)"</span></code></pre><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#FolderClass.html"><span class="arrow-prev">←</span><span>Folder</span></a><a class="docs-next button" href="#IMAPTransporterClass.html"><span>IMAPTransporter</span><span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#FunctionClass.html_formula">Formula</a></li><li><a href="#FunctionClass.html_formula-from-string">Formula fromstring</a></li><li><a href="#FunctionClass.html_apply">.apply()</a></li><li><a href="#FunctionClass.html_call">.call()</a></li><li><a href="#FunctionClass.html_source">.source</a></li></ul></nav></div></div></body></html>