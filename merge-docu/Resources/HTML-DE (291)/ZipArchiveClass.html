<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="de"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>ZIPArchive · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="A 4D ZIP archive is a `File` or `Folder` object containing one or more files or folders, which are compressed to be smaller than their original size. These archives are created with a &quot;.zip&quot; extension and can be used to save disk space or transfer files via mediums which may have size limitations (e.g., email or network)."name="description" /><meta content="de" name="docsearch:language" /><meta content="ZIPArchive · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="A 4D ZIP archive is a `File` or `Folder` object containing one or more files or folders, which are compressed to be smaller than their original size. These archives are created with a &quot;.zip&quot; extension and can be used to save disk space or transfer files via mediums which may have size limitations (e.g., email or network)."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#ZipArchiveClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">ZIPArchive<a aria-hidden="true" class="anchor" id="ZipArchiveClass.html"></a></h1></header><article><div><p><span>A 4D ZIP archive is a <code>File</code> or<code>Folder</code> object containing one or more files or folders,which are compressed to be smaller than their original size. Thesearchives are created with a ".zip" extension and can be used tosave disk space or transfer files via mediums which may have sizelimitations (e.g., email or network).</span></p><ul><li><span>You create a 4D ZIP archive with the <a href="#ZipArchiveClass.html_zip-create-archive">ZIP Create archive</a>command.</span></li><li><span>4D <a href="#ZipFileClass.html"><code>ZIPFile</code></a>and <a href="#ZipFolderClass.html"><code>ZIPFolder</code></a>instances are available through the <a href="#ZipArchiveClass.html_root"><code>root</code></a> property(<code>ZIPFolder</code>) of the object returned by <a href="#ZipArchiveClass.html_zip-read-archive">ZIP Read archive</a>command.</span></li></ul><h3><span><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_beispiel"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_beispiel"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</span></h3><p><span>To retrieve and view the contents of a ZIP fileobject:</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$path</span>; <span class="hljs-variable">$archive </span>: 4D.File<span class="hljs-keyword">var</span> <span class="hljs-variable">$zipFile </span>: 4D.ZipFile<span class="hljs-keyword">var</span> <span class="hljs-variable">$zipFolder </span>: 4D.ZipFolder<span class="hljs-keyword">var</span> <span class="hljs-variable">$txt </span>: Text<span class="hljs-variable">$path</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/Archive.zip"</span>)<span class="hljs-variable">$archive</span>:=<span class="hljs-function">ZIP Read archive</span>(<span class="hljs-variable">$path</span>)<span class="hljs-variable">$zipFolder</span>:=<span class="hljs-variable">$archive</span>.root <span class="hljs-comment">// store the zip main folder</span><span class="hljs-variable">$zipFile</span>:=<span class="hljs-variable">$zipFolder</span>.<span class="hljs-function">files</span>()[<span class="hljs-number">0</span>] <span class="hljs-comment">//read the first zipped file</span><span class="hljs-keyword">If</span>(<span class="hljs-variable">$zipFile</span>.extension=<span class="hljs-string">".txt"</span>)    <span class="hljs-variable">$txt</span>:=<span class="hljs-variable">$zipFile</span>.<span class="hljs-function">getText</span>()<span class="hljs-keyword">End if</span></code></span></pre><h3><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_summary"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_summary"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Summary</h3><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#ZipArchiveClass.html_root"><strong>.root</strong> :4D.ZipFolder</a><p>&nbsp;&nbsp;&nbsp;&nbsp;a virtual folder providing access to thecontents of the ZIP archive</p></td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_zip-create-archive"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_zip-create-archive"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>ZIP Create archive</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v19 R3</td><td>Added <code>ZIP Compression LZMA</code>, <code>ZIP Compressionxy</code>, <code>.level</code> property</td></tr><tr><td>v18</td><td>Added</td></tr></tbody></table></details><p><strong>ZIP Create archive</strong> ( <em>fileToZip</em> :4D.File ; <em>destinationFile</em> : 4D.File ) : Object<br /><strong>ZIP Create archive</strong> ( <em>folderToZip</em> :4D.Folder ; <em>destinationFile</em> : 4D.File { ; <em>options</em>: Integer }) : Object<br /><strong>ZIP Create archive</strong> ( <em>zipStructure</em> :Object ; <em>destinationFile</em> : 4D.File ) : Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>fileToZip</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>File or Folder object to compress</td></tr><tr><td>folderToZip</td><td>4D.Folder</td><td style="text-align:center">-&gt;</td><td>File or Folder object to compress</td></tr><tr><td>zipStructure</td><td>Objekt</td><td style="text-align:center">-&gt;</td><td>File or Folder object to compress</td></tr><tr><td>destinationFile</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>Destination file for the archive</td></tr><tr><td>options</td><td>Ganzzahl</td><td style="text-align:center">-&gt;</td><td><em>folderToZip</em> option: <code>ZIP Without enclosingfolder</code></td></tr><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td>Status object</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_beschreibung"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_beschreibung"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>ZIP Create archive</code> command creates a compressedZIP archive object and returns the status of the operation.</p><p>You can pass a 4D.File, a 4D.Folder, or a zip structure objectas first parameter:</p><ul><li><p><em>fileToZip</em>: You simply pass a <code>4D.File</code> tocompress.</p></li><li><p><em>folderToZip</em>: You pass a <code>4D.Folder</code> tocompress. In this case, the <em>options</em> parameter allows youto compress only the contents of the folder (i.e., exclude theenclosing folder). By default, <code>ZIP Create archive</code> willcompress the folder and its contents, so that the decompressingoperation will recreate a folder. If you want the decompressingoperation to restore only the contents of the folder, pass the<code>ZIP Without enclosing folder</code> constant in the<em>options</em> parameter.</p></li><li><p><em>zipStructure</em>: You pass an object describing the ZIParchive object. The following properties are available to definethe structure:</p></li></ul><table><thead><tr><th>Property</th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>compression</td><td>Ganzzahl</td><td><ul><li><code>ZIP Compression standard</code>: Deflate compression(default)</li><li><code>ZIP Compression LZMA</code>: LZMA compression</li><li><code>ZIP Compression XZ</code>: XZ compression</li><li><code>ZIP Compression none</code>: No compression</li></ul></td></tr><tr><td>level</td><td>Ganzzahl</td><td>Compression level. Possible values: 1 to 10. A lower value willproduce a larger file, while a higher value will produce a smallerfile. Compression level has however an impact on performance.Default values if omitted:<ul><li><code>ZIP Compression standard</code>: 6</li><li><code>ZIP Compression LZMA</code>: 4</li><li><code>ZIP Compression XZ</code>: 4</li></ul></td></tr><tr><td>encryption</td><td>Ganzzahl</td><td>The encryption to use if a password is set:<ul><li><code>ZIP Encryption AES128</code>: AES encryption using128-bit key.</li><li><code>ZIP Encryption AES192</code>: AES encryption using192-bit key.</li><li><code>ZIP Encryption AES256</code>: AES encryption using256-bit key (default if password is set).</li><li><code>ZIP Encryption none</code>: Data is not encrypted(default if no password is set)</li></ul></td></tr><tr><td>password</td><td>Text</td><td>A password to use if encryption is required.</td></tr><tr><td>files</td><td>Collection</td><td><ul><li>a collection of <code>4D.File</code> or <code>4D.Folder</code>objects or</li><li>a collection of objects with the following properties:</li><table><tr><td>Property</td><td>Typ</td><td>Beschreibung</td></tr><tr><td>source</td><td>4D.File or 4D.Folder</td><td>File or Folder</td></tr><tr><td>destination</td><td>Text</td><td>(optional) - Specify a relative filepath to change theorganization of the contents of the archive</td></tr><tr><td>option</td><td>number</td><td>(optional) - <code>ZIP Ignore invisible files</code> or 0 tocompress all of the file</td></tr></table></ul></td></tr><tr><td>callback</td><td>4D.Function</td><td>A callback formula that will receive the compression progress(0 - 100) in $1.</td></tr></tbody></table><p>In the <em>destinationFile</em> parameter, pass a<code>4D.File</code> object describing the ZIP archive to create(name, location, etc.). It is advised to use the ".zip" extensionif you want the ZIP archive to be processed automatically by anysoftware.</p><p>Once an archive is created, you can use the <a href="#ZipArchiveClass.html_zip-read-archive">ZIP Read archive</a>command to access it.</p><p><strong>Status object</strong></p><p>The returned status object contains the followingproperties:</p><table><thead><tr><th>Property</th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>statusText</td><td>Text</td><td>Error message (if any):<ul><li>Cannot open ZIP archive</li><li>Cannot create ZIP archive</li><li>Password is required for encryption</li></ul></td></tr><tr><td>status</td><td>Ganzzahl</td><td>Status code</td></tr><tr><td>success</td><td>Boolean</td><td>True if archive created successfully, else false</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_beispiel-1"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_beispiel-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel 1</h4><p>To compress a <code>4D.File</code>:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$file</span>; <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/file.zip"</span>) <span class="hljs-variable">$file</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/text.txt"</span>) <span class="hljs-variable">$status</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$file</span>;<span class="hljs-variable">$destination</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_beispiel-2"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_beispiel-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel 2</h4><p>To compress a <code>4D.Folder</code> without the folderitself:</p><pre><code class="hljs css language-4D"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$folder </span>: 4D.Folder<span class="hljs-keyword"> var</span> <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/Images.zip"</span>) <span class="hljs-variable">$folder</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"MyDocs/Images"</span>) <span class="hljs-variable">$status</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$folder</span>;<span class="hljs-variable">$destination</span>;ZIP Without enclosing folder)</code></pre><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_example-3"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_example-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Example 3</h4><p>To compress a ZIP archive structure with a password and progressbar:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$zip</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> progID : Integer <span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/Archive.zip"</span>) <span class="hljs-variable">$zip</span>:=New object <span class="hljs-variable">$zip</span>.files:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"MyDocs/Resources"</span>).<span class="hljs-function">folders</span>() <span class="hljs-variable">$zip</span>.password:=<span class="hljs-string">"password"</span> <span class="hljs-variable">$zip</span>.callback:=<span class="hljs-function">Formula</span>(<span class="hljs-function">myFormulaCompressingMethod</span>(<span class="hljs-variable">$1</span>)) progID:=Progress New <span class="hljs-comment">//we use the 4D Progress component</span> <span class="hljs-variable">$status</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$zip</span>;<span class="hljs-variable">$destination</span>)<span class="hljs-function"> Progress QUIT</span>(progID)</code></pre><p><code>myFormulaCompressingMethod</code>:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$1 </span>: Integer<span class="hljs-function"> Progress SET PROGRESS</span>(progID;<span class="hljs-function">Num</span>(<span class="hljs-variable">$1</span>/<span class="hljs-number">100</span>))</code></pre><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_example-4"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_example-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Example 4</h4><p>You want to pass a collection of folders and files to compressto the <em>zipStructure</em> object:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$zip</span>;<span class="hljs-variable">$err </span>: Object <span class="hljs-variable">$zip</span>:=New object <span class="hljs-variable">$zip</span>.files:=New collection <span class="hljs-variable">$zip</span>.files.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"source"</span>;<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"Tests/text.txt"</span>))) <span class="hljs-variable">$zip</span>.files.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"source"</span>;<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"Tests/text2.txt"</span>))) <span class="hljs-variable">$zip</span>.files.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"source"</span>;<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"Images/image.png"</span>))) <span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"file.zip"</span>) <span class="hljs-variable">$err</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$zip</span>;<span class="hljs-variable">$destination</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_example-5"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_example-5"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Example 5</h4><p>You want to use an alternative compression algorithm with a highcompression level:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword">var</span> <span class="hljs-variable">$zip</span>; <span class="hljs-variable">$err </span>: Object<span class="hljs-variable">$zip</span>:=New object<span class="hljs-variable">$zip</span>.files:=New collection<span class="hljs-variable">$zip</span>.files.<span class="hljs-function">push</span>(<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"images"</span>))<span class="hljs-variable">$zip</span>.compression:=ZIP Compression LZMA<span class="hljs-variable">$zip</span>.level:=<span class="hljs-number">7</span> <span class="hljs-comment">//default is 4</span><span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"images.zip"</span>)<span class="hljs-variable">$err</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$zip</span>; <span class="hljs-variable">$destination</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_zip-read-archive"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_zip-read-archive"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>ZIP Read archive</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18</td><td>Added</td></tr></tbody></table></details><p><strong>ZIP Read archive</strong> ( <em>zipFile</em> : 4D.File {; <em>password</em> : Text }) : 4D.ZipArchive</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>zipFile</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>Zip archive file</td></tr><tr><td>password</td><td>Text</td><td style="text-align:center">-&gt;</td><td>ZIP archive password if any</td></tr><tr><td>Ergebnis</td><td>4D.ZipArchive</td><td style="text-align:center">&lt;-</td><td>Archive object</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_beschreibung-1"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_beschreibung-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>ZIP Read archive</code> command retrieves the contentsof <em>zipFile</em> and returns it as a <code>4D.ZipArchive</code>object.</p><blockquote><p>This command does not uncompress the ZIP archive, it onlyprovides a view of its contents. To extract the contents of anarchive, you need to use methods such as <a href="#ZipArchiveClass.html_copyto">file.copyTo()</a> or <a href="#ZipArchiveClass.html_copyto">folder.copyTo()</a>.</p></blockquote><p>Pass a <code>4D.File</code> object referencing the compressedZIP archive in the <em>zipFile</em> parameter. The target archivefile will be opened until the <code>ZIP Read archive</code> hasfinished executing and all contents/references have beenextracted/released, then it will be closed automatically.</p><p>If the <em>zipFile</em> is password protected, you need to usethe optional <em>password</em> parameter to provide a password. Ifa password is required but not passed when trying to read thecontents of the archive, an error is generated.</p><p><strong>Archive object</strong></p><p>The returned <code>4D.ZipArchive</code> object contains a single<a href="#ZipArchiveClass.html_root"><code>root</code></a> propertywhose value is a <code>4D.ZipFolder</code> object. This folderdescribes the whole contents of the ZIP archive.</p><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_beispiel-3"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_beispiel-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><p>To retrieve and view the contents of a ZIP file object:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$archive </span>: 4D.ZipArchive<span class="hljs-keyword"> var</span> <span class="hljs-variable">$path </span>: 4D.File <span class="hljs-variable">$path</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/Archive.zip"</span>) <span class="hljs-variable">$archive</span>:=<span class="hljs-function">ZIP Read archive</span>(<span class="hljs-variable">$path</span>)</code></pre><p>To retrieve the list of the files and folders in thearchive:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$folders</span>:=<span class="hljs-variable">$archive</span>.root.<span class="hljs-function">folders</span>() <span class="hljs-variable">$files</span>:=<span class="hljs-variable">$archive</span>.root.<span class="hljs-function">files</span>()</code></pre><p>To read the contents of a file without extracting it from theroot folder:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> If</span>(<span class="hljs-variable">$files</span>[<span class="hljs-variable">$i</span>].extension=<span class="hljs-string">".txt"</span>)    <span class="hljs-variable">$txt</span>:=<span class="hljs-variable">$files</span>[<span class="hljs-variable">$i</span>].<span class="hljs-function">getText</span>()<span class="hljs-keyword"> Else</span>    <span class="hljs-variable">$blob</span>:=<span class="hljs-variable">$files</span>[<span class="hljs-variable">$i</span>].<span class="hljs-function">getContent</span>()<span class="hljs-keyword"> End if</span></code></pre><p>To extract from the root folder:</p><pre><code class="hljs css language-4d">  <span class="hljs-comment">//extract a file</span> <span class="hljs-variable">$folderResult</span>:=<span class="hljs-variable">$files</span>[<span class="hljs-variable">$i</span>].<span class="hljs-function">copyTo</span>(<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"MyDocs"</span>))  <span class="hljs-comment">//extract all files</span> <span class="hljs-variable">$folderResult</span>:=<span class="hljs-variable">$archive</span>.root.<span class="hljs-function">copyTo</span>(<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"MyDocs"</span>))</code></pre><h2><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_root"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_root"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.root</h2><p><strong>.root</strong> : 4D.ZipFolder</p><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_beschreibung-2"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_beschreibung-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.root</code> property contains a virtual folderproviding access to the contents of the ZIP archive.</p><p>The <code>root</code> folder and its contents can be manipulatedwith the <a href="#ZipFileClass.html">ZipFile</a> and <a href="#ZipFolderClass.html">ZipFolder</a> functions and properties.</p><p>This property is <strong>read-only</strong>.</p><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#WebServerClass.html"><span class="arrow-prev">←</span><span class="function-name-prevnext">WebServer</span></a><a class="docs-next button" href="#ZipFileClass.html"><span>ZIPFile</span><span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#ZipArchiveClass.html_zip-create-archive">ZIP Createarchive</a></li><li><a href="#ZipArchiveClass.html_zip-read-archive">ZIP Readarchive</a></li><li><a href="#ZipArchiveClass.html_root">.root</a></li></ul></nav></div></div></body></html>