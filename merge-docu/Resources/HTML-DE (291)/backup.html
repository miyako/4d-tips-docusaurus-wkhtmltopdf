<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="de"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Cópia de segurança · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="Uma cópia de segurança pode ser começada de três maneiras:" name="description" /><meta content="de" name="docsearch:language" /><meta content="Cópia de segurança · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="Uma cópia de segurança pode ser começada de três maneiras:"property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#backup.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">Cópia desegurança<a aria-hidden="true" class="anchor" id="backup.html"></a></h1></header><article><div><p><span>Uma cópia de segurança pode ser começada de trêsmaneiras:</span></p><ul><li><span>Manualmente, usando o comando <strong>Cópia desegurança...</strong> do menu 4D <strong>Arquivo</strong> ou obotão <strong>Backup</strong> de <a href="#backup.html">Centro deManutenção e Segurança</a>.</span></li><li><span>Automaticamente, usando o programador que pode serdefinido nas Propriedades,</span></li><li><span>Por programação, utilizando o comando<code>BACKUP</code>.</span></li></ul><blockquote><p><span>4D Server: é possível iniciar uma cópia de segurançamanualmente desde uma máquina remota mediante um método que chamaao comando <code>BACKUP</code>. O comando será executado, em todosos casos, no servidor.</span></p></blockquote><h2><span><a aria-hidden="true" class="anchor" id="backup.html_manual-backup"></a><a aria-hidden="true" class="hash-link" href="#backup.html_manual-backup"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Manual backup</span></h2><ol><li><span>Select the <strong>Backup...</strong> command in the 4D<strong>File</strong> menu.<br />The backup window appears: <img alt="" src="https://developer.4d.com/docs/Rx/assets/en/Backup/backup01.png" />You can see the location of the backup folder using the pop-up menunext to the "Backup destination" area. This location is set on the<strong>Backup/Configuration</strong> page of the DatabaseSettings.</span></li></ol><ul><li><span>You can also open the <a href="#overview.html">Maintenance and Security Center</a> of 4D anddisplay the <a href="#backup.html">Backup page</a>.</span></li></ul><p><span>The <strong>Database properties...</strong> button causesthe Backup/Configuration page of the Structure Settings to bedisplayed.</span></p><ol start="2"><li><span>Click <strong>Backup</strong> to start the backup usingcurrent parameters.</span></li></ol><h2><span><a aria-hidden="true" class="anchor" id="backup.html_scheduled-automatic-backup"></a><a aria-hidden="true"class="hash-link" href="#backup.html_scheduled-automatic-backup"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Scheduled automatic backup</span></h2><p><span>Scheduled backups are started automatically. They areconfigured in the <strong>Backup/Scheduler</strong> page of the<strong>Settings</strong>.</span></p><p><span>Backups are automatically performed at the times definedon this page without any type of user intervention. For moreinformation on using this dialog box, refer to <a href="#backup.html_scheduler">Scheduler in backupsettings</a>.</span></p><h2><span><a aria-hidden="true" class="anchor" id="backup.html_backup-command"></a><a aria-hidden="true" class="hash-link" href="#backup.html_backup-command"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>BACKUP command</span></h2><p><span>When the <code>BACKUP</code> 4D language command isexecuted from any method, the backup starts using the currentparameters as defined in the Settings. You can use the <code>OnBackup Startup</code> and <code>On Backup Shutdown</code> databasemethods for handling the backup process (see the <em>4D LanguageReference</em> manual).</span></p><h2><span><a aria-hidden="true" class="anchor" id="backup.html_managing-the-backup-processing"></a><a aria-hidden="true" class="hash-link" href="#backup.html_managing-the-backup-processing"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Managing the backup processing</span></h2><p><span>Once a backup is started, 4D displays a dialog box with athermometer indicating the progress of the backup:</span></p><p><span><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/Backup/backupProgress.png" /></span></p><p><span>This thermometer is also displayed on the <a href="#backup.html">Backup page of the MSC</a> if you have used thisdialog box.</span></p><p><span>The <strong>Stop</strong> button lets the user interruptthe backup at any time (refer to <a href="#backup.html_handling-backup-issues">Handling backup issues</a>below).</span></p><p><span>The status of the last backup (successful or failed) isstored in the Last Backup Information area of the <a href="#backup.html">Backup page in the MSC</a> or in the<strong>Maintenance page</strong> of 4D Server. It is also recordedin the database <strong>Backup journal.txt</strong>.</span></p><h3><span><a aria-hidden="true" class="anchor" id="backup.html_accessing-the-application-during-backup"></a><a aria-hidden="true"class="hash-link" href="#backup.html_accessing-the-application-during-backup"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Accessing the application during backup</span></h3><p><span>During a backup, access to the application is restrictedby 4D according to the context. 4D locks any processes related tothe types of files included in the backup: if only the projectfiles are being backed up, access to the structure is not possiblebut access to the data will be allowed.</span></p><p><span>Conversely, if only the data file is being backed up,access to the structure is still allowed. In this case, theapplication access possibilities are as follows:</span></p><ul><li><span>With the 4D single-user version, the application islocked for both read and write; all processes are frozen. Noactions can be performed.</span></li><li><span>With 4D Server, the application is only write locked;client machines can view data. If a client machine sends an add,remove or change request to the server, a window appears asking theuser to wait until the end of the backup. Once the application issaved, the window disappears and the action is performed. To cancelthe request in process and not wait for the end of the backup,simply click the <strong>Cancel operation</strong> button. However,if the action waiting to be executed comes from a method launchedprior to the backup, you should not cancel it because onlyoperations remaining to be performed are cancelled. Also, apartially executed method can cause logical inconsistencies in thedata. &gt; When the action waiting to be executed comes from amethod and the user clicks the <strong>Cancel operation</strong>button, 4D Server returns error -9976 (This command cannot beexecuted because the database backup is in progress).</span></li></ul><h3><span><a aria-hidden="true" class="anchor" id="backup.html_handling-backup-issues"></a><a aria-hidden="true"class="hash-link" href="#backup.html_handling-backup-issues"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Handling backup issues</span></h3><p><span>It may happen that a backup is not executed properly.There may be several causes of a failed backup: user interruption,attached file not found, destination disk problems, incompletetransaction, etc. 4D processes the incident according to thecause.</span></p><p><span>In all cases, keep in mind that the status of the lastbackup (successful or failed) is stored in the Last BackupInformation area of the <a href="#backup.html">Backup page in theMSC</a> or in the <strong>Maintenance page</strong> of 4D Server,as well as in the <strong>Backup journal.txt</strong>.</span></p><ul><li><span><strong>User interruption</strong>: The<strong>Stop</strong> button in the progress dialog box allowsusers to interrupt the backup at any time. In this case, thecopying of elements is stopped and the error 1406 is generated. Youcan intercept this error in the <code>On Backup Shutdown</code>database method.</span></li><li><span><strong>Attached file not found</strong>: When anattached file cannot be found, 4D performs a partial backup (backupof application files and accessible attached files) and returns anerror.</span></li><li><span><strong>Backup impossible</strong> (disk is full orwrite-protected, missing disk, disk failure, incompletetransaction, application not launched at time of scheduledautomatic backup, etc.): If this is a first-time error, 4D willthen make a second attempt to perform the backup. The wait betweenthe two attempts is defined on the <strong>Backup/Backup &amp;Restore</strong> page of the Settings. If the second attempt fails,a system alert dialog box is displayed and an error is generated.You can intercept this error in the <code>On Backup Shutdown</code>database method.</span></li></ul><h2><span><a aria-hidden="true" class="anchor" id="backup.html_backup-journal"></a><a aria-hidden="true" class="hash-link" href="#backup.html_backup-journal"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Backup Journal</span></h2><p><span>To make following up and verifying backups easier, thebackup module writes a summary of each operation performed in aspecial file, which is similar to an activity journal. Like anon-board manual, all database operations (backups, restores, logfile integrations) are logged in this file whether they werescheduled or performed manually. The date and time that theseoperations occurred are also noted in the journal.</span></p><p><span>The backup journal is named "Backup Journal[001].txt" andis placed in the "Logs" folder of the project. The backup journalcan be opened with any text editor.</span></p><h4><span><a aria-hidden="true" class="anchor" id="backup.html_management-of-backup-journal-size"></a><a aria-hidden="true" class="hash-link" href="#backup.html_management-of-backup-journal-size"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Management of backup journal size</span></h4><p><span>In certain backup strategies (for example, in the casewhere numerous attached files are being backed up), the backupjournal can quickly grow to a large size. Two mechanisms can beused to control this size:</span></p><ul><li><span><strong>Automatic backup</strong>: Before each backup,the application examines the size of the current backup journalfile. If it is greater than 10 MB, the current file is archived anda new file is created with the [xxx] number incremented, forexample "Backup Journal[002].txt”. Once file number 999 is reached,the numbering begins at 1 again and the existing files will bereplaced.</span></li><li><span><strong>Possibility of reducing the amount of informationrecorded</strong>: To do this, simply modify the value of the<code>VerboseMode</code> key in the <em>Backup.4DSettings</em> fileof the project. By default, this key is set to True. If you changethe value of this key to False, only the main information will bestored in the backup journal: date and time of start of operationand any errors encountered. The XML keys concerning backupconfiguration are described in the <em>4D XML Keys Backup</em>manual.</span></li></ul><h2><span><a aria-hidden="true" class="anchor" id="backup.html_backuphistoryjson"></a><a aria-hidden="true" class="hash-link" href="#backup.html_backuphistoryjson"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>backupHistory.json</span></h2><p><span>All information regarding the latest backup and restoreoperations are stored in the application's<strong>backupHistory.json</strong> file. It logs the path of eachsaved file (including attachments) as well as number, date, time,duration, and status of each operation. To limit the size of thefile, the number of logged operations is the same as the number ofavailable backups ("Keep only the last X backup files") defined inthe backup settings.</span></p><p><span>The <strong>backupHistory.json</strong> file is created inthe current backup destination folder. You can get the actual pathfor this file using the following statement:</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-variable">$backupHistory</span>:=<span class="hljs-function">Get 4D file</span>(Backup history file)</code></span></pre><blockquote><p><strong>WARNING</strong><br />Deleting or moving the <strong>backupHistory.json</strong> filewill cause the next backup number to be reset. The<strong>backupHistory.json</strong> file is formatted to be used bythe 4D application. If you are looking for a human-readable reporton backup operations, you might find the Backup journal moreaccurate.</p></blockquote></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#overview.html"><span class="arrow-prev">←</span><span>Überblick</span></a><a class="docs-next button" href="#settings.html"><span>Backup Settings</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#backup.html_manual-backup">Manual backup</a></li><li><a href="#backup.html_scheduled-automatic-backup">Scheduledautomatic backup</a></li><li><a href="#backup.html_backup-command">BACKUP command</a></li><li><a href="#backup.html_managing-the-backup-processing">Managingthe backup processing</a><ul class="toc-headings"><li><a href="#backup.html_accessing-the-application-during-backup">Accessingthe application during backup</a></li><li><a href="#backup.html_handling-backup-issues">Handling backupissues</a></li></ul></li><li><a href="#backup.html_backup-journal">Backup Journal</a></li><li><a href="#backup.html_backuphistoryjson">backupHistory.json</a></li></ul></nav></div></div></body></html>