<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="de"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>MailAttachment · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="Attachment objects allow referencing files within a [`Email`](/docs/Rx/de/API/EmailObjectClass.html) object. Attachment objects are created using the [`MAIL New attachment`](#mail-new-attachment) command."name="description" /><meta content="de" name="docsearch:language" /><meta content="MailAttachment · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="Attachment objects allow referencing files within a [`Email`](/docs/Rx/de/API/EmailObjectClass.html) object. Attachment objects are created using the [`MAIL New attachment`](#mail-new-attachment) command."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#MailAttachmentClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">MailAttachment<a aria-hidden="true" class="anchor" id="MailAttachmentClass.html"></a></h1></header><article><div><p><span>Attachment objects allow referencing files within a<a href="#EmailObjectClass.html"><code>Email</code></a> object.Attachment objects are created using the <a href="#MailAttachmentClass.html_mail-new-attachment"><code>MAIL Newattachment</code></a> command.</span></p><h3><span><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_attachment-object"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_attachment-object"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Attachment Object</span></h3><p><span>Attachment objects provide the following read-onlyproperties and functions:</span></p><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#MailAttachmentClass.html_cid"><strong>.cid</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; the ID of the attachment</p></td></tr><tr><td><a href="#MailAttachmentClass.html_disposition"><strong>.disposition</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the value of the<code>Content-Disposition</code> header</p></td></tr><tr><td><a href="#MailAttachmentClass.html_getcontent"><strong>.getContent()</strong>: 4D.Blob</a><p>&nbsp;&nbsp;&nbsp;&nbsp;returns the contents of the attachmentobject in a <code>4D.Blob</code> object</p></td></tr><tr><td><a href="#MailAttachmentClass.html_name"><strong>.name</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the name and extension of theattachment</p></td></tr><tr><td><a href="#MailAttachmentClass.html_path"><strong>.path</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the POSIX path of the attachment file,if it exists</p></td></tr><tr><td><a href="#MailAttachmentClass.html_platformpath"><strong>.platformPath</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the path of the attachment fileexpressed with the current platform syntax</p></td></tr><tr><td><a href="#MailAttachmentClass.html_type"><strong>.type</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the <code>content-type</code> of theattachment file</p></td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_mail-new-attachment"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_mail-new-attachment"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>MAIL New attachment</span></h2><details><summary><span>History</span></summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v19 R2</td><td>Accepts 4D.File, 4D.ZipFile, 4D.Blob</td></tr></tbody></table></details><p><span><strong>MAIL New attachment</strong>( <em>file</em> :4D.File { ; <em>name</em> : Text {; <em>cid</em> : Text{ ;<em>type</em> : Text { ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment<br /><strong>MAIL New attachment</strong>( <em>zipFile</em> : 4D.ZipFile{ ; <em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> :Text { ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment<br /><strong>MAIL New attachment</strong>( <em>blob</em> : 4D.Blob { ;<em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> : Text{ ; <em>disposition</em> :Text } } } } ) : 4D.MailAttachment<br /><strong>MAIL New attachment</strong>( <em>path</em> : Text { ;<em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> : Text{ ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment</span></p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>file</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>Attachment file</td></tr><tr><td>zipFile</td><td>4D.ZipFile</td><td style="text-align:center">-&gt;</td><td>Attachment Zipfile</td></tr><tr><td>blob</td><td>4D.Blob</td><td style="text-align:center">-&gt;</td><td>BLOB containing the attachment</td></tr><tr><td>path</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Path of the attachment file</td></tr><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Name + extension used by the mail client to designate theattachment</td></tr><tr><td>cid</td><td>Text</td><td style="text-align:center">-&gt;</td><td>ID of attachment (HTML messages only), or " " if no cid isrequired</td></tr><tr><td>type</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Value of the content-type header</td></tr><tr><td>disposition</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Value of the content-disposition header: "inline" or"attachment".</td></tr><tr><td>Ergebnis</td><td>4D.MailAttachment</td><td style="text-align:center">&lt;-</td><td>Attachment object</td></tr></tbody></table><h4><span><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_beschreibung"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_beschreibung"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</span></h4><p><span>The <code>MAIL New attachment</code> command allows you tocreate an attachment object that you can add to an <a href="#MailAttachmentClass.html_email-object">Emailobject</a>.</span></p><p><span>To define the attachment, you can use:</span></p><ul><li><span>a <em>file</em>, pass a <code>4D.File</code> objectcontaining the attachment file.</span></li><li><span>a <em>zipfile</em>, pass a <code>4D.ZipFile</code> objectcontaining the attachment file.</span></li><li><span>a <em>blob</em>, pass a <code>4D.Blob</code> objectcontaining the attachment itself.</span></li><li><span>a <em>path</em>, pass a <strong>text</strong> valuecontaining the path of the attachment file, expressed with thesystem syntax. You can pass a full path name or a simple file name(in which case 4D will search for the file in the same directory asthe project file).</span></li></ul><p><span>The optional <em>name</em> parameter lets you pass thename and extension to be used by the mail client to designate theattachment. If <em>name</em> is omitted and:</span></p><ul><li><span>you passed a file path, the name and extension of thefile is used,</span></li><li><span>you passed a BLOB, a random name without extension isautomatically generated.</span></li></ul><p><span>The optional <em>cid</em> parameter lets you pass aninternal ID for the attachment. This ID is the value of the<code>Content-Id</code> header, it will be used in HTML messagesonly. The cid associates the attachment with a reference defined inthe message body using an HTML tag such as <code>\&lt;imgsrc="cid:ID"&gt;</code>. This means that the contents of theattachment (e.g., a picture) should be displayed within the messageon the mail client. The final result may vary depending on the mailclient. You can pass an empty string in <em>cid</em> if you do notwant to use this parameter.</span></p><p><span>You can use the optional <em>type</em> parameter toexplicitly set the <code>content-type</code> of the attachmentfile. For example, you can pass a string defining a MIME type("video/mpeg"). This content-type value will be set for theattachment, regardless of its extension. For more information aboutMIME types, please refer to the <a href="https://en.wikipedia.org/wiki/MIME">MIME type page onWikipedia</a>.</span></p><p><span>By default, if the <em>type</em> parameter is omitted orcontains an empty string, the <code>content-type</code> of theattachment file is based on its extension. The following rules areapplied for the main MIME types:</span></p><table><thead><tr><th>Extension</th><th>Content Type</th></tr></thead><tbody><tr><td>jpg, jpeg</td><td>image/jpeg</td></tr><tr><td>png</td><td>image/png</td></tr><tr><td>gif</td><td>image/gif</td></tr><tr><td>pdf</td><td>application/pdf</td></tr><tr><td>doc</td><td>application/msword</td></tr><tr><td>xls</td><td>application/vnd.ms-excel</td></tr><tr><td>ppt</td><td>application/vnd.ms-powerpoint</td></tr><tr><td>zip</td><td>application/zip</td></tr><tr><td>gz</td><td>application/gzip</td></tr><tr><td>json</td><td>application/json</td></tr><tr><td>js</td><td>application/javascript</td></tr><tr><td>ps</td><td>application/postscript</td></tr><tr><td>xml</td><td>application/xml</td></tr><tr><td>htm, html</td><td>text/html</td></tr><tr><td>mp3</td><td>audio/mpeg</td></tr><tr><td><em>other</em></td><td>application/octet-stream</td></tr></tbody></table><p><span>The optional <em>disposition</em> parameter lets you passthe <code>content-disposition</code> header of the attachment. Youcan pass one of the following constants from the "Mail" constanttheme:</span></p><table><thead><tr><th>Constant</th><th>Wert</th><th>Kommentar</th></tr></thead><tbody><tr><td>mail disposition attachment</td><td>"attachment"</td><td>Set the Content-disposition header value to "attachment", whichmeans that the attachment file must be provided as a link in themessage.</td></tr><tr><td>mail disposition inline</td><td>"inline"</td><td>Set the Content-disposition header value to "inline", whichmeans that the attachment must be rendered within the messagecontents, at the "cid" location. The rendering depends on the mailclient.</td></tr></tbody></table><p><span>By default, if the <em>disposition</em> parameter isomitted:</span></p><ul><li><span>if the <em>cid</em> parameter is used, the<code>Content-disposition</code> header is set to"inline",</span></li><li><span>if the <em>cid</em> parameter is not passed or empty, the<code>Content-disposition</code> header is set to"attachment".</span></li></ul><h4><span><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_beispiel-1"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_beispiel-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel 1</span></h4><p><span>You want to send an email with a user-selected file as anattachment and an image embedded in the HTML body:</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-variable">$doc</span>:=<span class="hljs-function">Select document</span>(<span class="hljs-string">""</span>;<span class="hljs-string">"*"</span>;<span class="hljs-string">"Please select a file to attach"</span>;<span class="hljs-number">0</span>)<span class="hljs-keyword">If</span> (OK=<span class="hljs-number">1</span>) <span class="hljs-comment">//If a document was selected</span><span class="hljs-function">C_OBJECT</span>(<span class="hljs-variable">$email</span>;<span class="hljs-variable">$server</span>;<span class="hljs-variable">$transporter</span>)<span class="hljs-variable">$server</span>:=New object<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"smtp.mail.com"</span><span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"test_user@mail.com"</span><span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"p@ssw@rd"</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">SMTP New transporter</span>(<span class="hljs-variable">$server</span>)<span class="hljs-variable">$email</span>:=New object<span class="hljs-variable">$email</span>.from:=<span class="hljs-string">"test_user@mail.com"</span><span class="hljs-variable">$email</span>.to:=<span class="hljs-string">"test_user@mail.com"</span><span class="hljs-variable">$email</span>.subject:=<span class="hljs-string">"This is a test message with attachments"</span><span class="hljs-comment">//add a link to download file</span><span class="hljs-variable">$email</span>.attachments:=<span class="hljs-function">New collection</span>(<span class="hljs-function">MAIL New attachment</span>(Document))<span class="hljs-comment">//insert an inline picture (use a cid)</span><span class="hljs-variable">$email</span>.attachments[<span class="hljs-number">1</span>]:=<span class="hljs-function">MAIL New attachment</span>(<span class="hljs-string">"c:\\Pictures\\4D.jpg"</span>;<span class="hljs-string">""</span>;<span class="hljs-string">"4D"</span>)<span class="hljs-variable">$email</span>.htmlBody:=<span class="hljs-string">"&lt;html&gt;"</span>+\<span class="hljs-string">"&lt;body&gt;Hello World!"</span>+\<span class="hljs-string">"&lt;img src='cid:4D' &gt;"</span>+\<span class="hljs-string">"&lt;/body&gt;"</span>+\<span class="hljs-string">"&lt;/head&gt;"</span>+\<span class="hljs-string">"&lt;/html&gt;"</span><span class="hljs-variable">$transporter</span>.<span class="hljs-function">send</span>(<span class="hljs-variable">$email</span>) <span class="hljs-comment">//send mail</span><span class="hljs-keyword">End if</span></code></span></pre><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_beispiel-2"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_beispiel-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel 2</h4><p>You want to send an email with a 4D Write Pro area as anattachment:</p><pre><code class="hljs css language-4d"><span class="hljs-function">C_BLOB</span>(<span class="hljs-variable">$blob</span>)<span class="hljs-function">WP EXPORT VARIABLE</span>(WPArea;<span class="hljs-variable">$blob</span>;wk docx)<span class="hljs-function">C_OBJECT</span>(<span class="hljs-variable">$email</span>;<span class="hljs-variable">$server</span>;<span class="hljs-variable">$transporter</span>)<span class="hljs-variable">$server</span>:=New object<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"smtp.mail.com"</span><span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"user@mail.com"</span><span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"p@ssw@rd"</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">SMTP New transporter</span>(<span class="hljs-variable">$server</span>)<span class="hljs-variable">$email</span>:=New object<span class="hljs-variable">$email</span>.from:=<span class="hljs-string">"user@mail.com"</span><span class="hljs-variable">$email</span>.to:=<span class="hljs-string">"customer@mail.com"</span><span class="hljs-variable">$email</span>.subject:=<span class="hljs-string">"New annual report"</span><span class="hljs-variable">$email</span>.textBody:=<span class="hljs-string">"Please find enclosed our latest annual report."</span><span class="hljs-variable">$email</span>.attachments:=<span class="hljs-function">New collection</span>(<span class="hljs-function">MAIL New attachment</span>(<span class="hljs-variable">$blob</span>;<span class="hljs-string">"Annual report.docx"</span>))<span class="hljs-variable">$transporter</span>.<span class="hljs-function">send</span>(<span class="hljs-variable">$email</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_4dmailattachmentnew"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_4dmailattachmentnew"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4D.MailAttachment.new()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v19 R2</td><td>Accepts 4D.File, 4D.ZipFile, 4D.Blob</td></tr></tbody></table></details><p><strong>4D.MailAttachment.new</strong>( <em>file</em> : 4D.File{ ; <em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> :Text { ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment<br /><strong>4D.MailAttachment.new</strong>( <em>zipFile</em> :4D.ZipFile { ; <em>name</em> : Text {; <em>cid</em> : Text{ ;<em>type</em> : Text { ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment<br /><strong>4D.MailAttachment.new</strong>( <em>blob</em> : 4D.Blob { ;<em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> : Text{ ; <em>disposition</em> :Text } } } } ) : 4D.MailAttachment<br /><strong>4D.MailAttachment.new</strong>( <em>path</em> : Text { ;<em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> : Text{ ; <em>disposition</em> :Text } } } } ) : 4D.MailAttachment</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>file</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>Attachment file</td></tr><tr><td>zipFile</td><td>4D.ZipFile</td><td style="text-align:center">-&gt;</td><td>Attachment Zipfile</td></tr><tr><td>blob</td><td>4D.Blob</td><td style="text-align:center">-&gt;</td><td>BLOB containing the attachment</td></tr><tr><td>path</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Path of the attachment file</td></tr><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Name + extension used by the mail client to designate theattachment</td></tr><tr><td>cid</td><td>Text</td><td style="text-align:center">-&gt;</td><td>ID of attachment (HTML messages only), or " " if no cid isrequired</td></tr><tr><td>type</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Value of the content-type header</td></tr><tr><td>disposition</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Value of the content-disposition header: "inline" or"attachment".</td></tr><tr><td>Ergebnis</td><td>4D.MailAttachment</td><td style="text-align:center">&lt;-</td><td>Attachment object</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_beschreibung-1"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_beschreibung-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>4D.MailAttachment.new()</code> function creates andreturns a new object of the <code>4D.MailAttachment</code> type. Itis identical to the <a href="#MailAttachmentClass.html_mail-new-attachment"><code>MAIL Newattachment</code></a> command (shortcut).</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_cid"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_cid"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.cid</h2><p><strong>.cid</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_beschreibung-2"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_beschreibung-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.cid</code> property contains the ID of theattachment. This property is used in HTML messages only. If thisproperty is missing, the file is handled as a simple attachment(link).</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_disposition"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_disposition"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.disposition</h2><p><strong>.disposition</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_beschreibung-3"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_beschreibung-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.disposition</code> property contains the value of the<code>Content-Disposition</code> header. Two values areavailable:</p><ul><li>"inline": the attachment is rendered within the messagecontents, at the "cid" location. The rendering depends on the mailclient.</li><li>"attachment": the attachment is provided as a link in themessage.</li></ul><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_getcontent"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_getcontent"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getContent()</h2><p><strong>.getContent()</strong> : 4D.Blob</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>Ergebnis</td><td>4D.Blob</td><td style="text-align:center">&lt;-</td><td>Content of the attachment</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_beschreibung-4"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_beschreibung-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.getContent()</code> function returns the contents ofthe attachment object in a <code>4D.Blob</code> object. You can usethis method with attachment objects received by the <a href="#MailAttachmentClass.html_mail-convert-from-mime"><code>MAILConvert from MIME</code></a> command.</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_name"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_name"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.name</h2><p><strong>.name</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_beschreibung-5"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_beschreibung-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.name</code> property contains the name and extensionof the attachment. By default, it is the name of the file, unlessanother name was specified in the <a href="#MailAttachmentClass.html_mail-new-attachment"><code>MAIL Newattachment</code></a> command.</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_path"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_path"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.path</h2><p><strong>.path</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_beschreibung-6"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_beschreibung-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.path</code> property contains the POSIX path of theattachment file, if it exists.</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_platformpath"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_platformpath"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.platformPath</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v19</td><td>Added</td></tr></tbody></table></details><p><strong>.platformPath</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_beschreibung-7"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_beschreibung-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.platformPath</code> property returns the path of theattachment file expressed with the current platform syntax.</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_type"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_type"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.type</h2><p><strong>.type</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_beschreibung-8"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_beschreibung-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.type</code> property contains the<code>content-type</code> of the attachment file. If this type isnot explicitly passed to the <a href="#MailAttachmentClass.html_mail-new-attachment"><code>MAIL Newattachment</code></a> command, the <code>content-type</code> isbased on its file extension.</p><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#IMAPTransporterClass.html"><span class="arrow-prev">←</span><span>IMAPTransporter</span></a><a class="docs-next button" href="#POP3TransporterClass.html"><span>POP3Transporter</span><span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#MailAttachmentClass.html_mail-new-attachment">MAILNew attachment</a></li><li><a href="#MailAttachmentClass.html_4dmailattachmentnew">4D.MailAttachment.new()</a></li><li><a href="#MailAttachmentClass.html_cid">.cid</a></li><li><a href="#MailAttachmentClass.html_disposition">.disposition</a></li><li><a href="#MailAttachmentClass.html_getcontent">.getContent()</a></li><li><a href="#MailAttachmentClass.html_name">.name</a></li><li><a href="#MailAttachmentClass.html_path">.path</a></li><li><a href="#MailAttachmentClass.html_platformpath">.platformPath</a></li><li><a href="#MailAttachmentClass.html_type">.type</a></li></ul></nav></div></div></body></html>