<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="de"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Calling ORDA class functions · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="You can call [data model class functions](/docs/Rx/de/ORDA/ordaClasses.html) defined for the ORDA Data Model through your REST requests, so that you can benefit from the exposed API of the targeted 4D application."name="description" /><meta content="de" name="docsearch:language" /><meta content="Calling ORDA class functions · 4D Documentation"property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="You can call [data model class functions](/docs/Rx/de/ORDA/ordaClasses.html) defined for the ORDA Data Model through your REST requests, so that you can benefit from the exposed API of the targeted 4D application."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#ClassFunctions.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">Calling ORDA classfunctions<a aria-hidden="true" class="anchor" id="classFunctions.html"></a></h1></header><article><div><p><span>You can call <a href="#ordaClasses.html">data model classfunctions</a> defined for the ORDA Data Model through your RESTrequests, so that you can benefit from the exposed API of thetargeted 4D application.</span></p><p><span>Functions are simply called in POST requests on theappropriate ORDA interface, without (). For example, if you havedefined a <code>getCity()</code> function in the City dataclassclass, you could call it using the following request:</span></p><p><span><code>/rest/City/getCity</code></span></p><p><span>with data in the body of the POST request:<code>["Aguada"]</code></span></p><p><span>In 4D language, this call is equivalent to, :</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-variable">$city</span>:=ds.City.<span class="hljs-function">getCity</span>(<span class="hljs-string">"Aguada"</span>)</code></span></pre><blockquote><p>Only functions with the <code>exposed</code> keyword can bedirectly called from REST requests. See <a href="#classFunctions.html_exposed-vs-non-exposed-functions">Exposed vsnon-exposed functions</a> section.</p></blockquote><h2><a aria-hidden="true" class="anchor" id="classFunctions.html_function-calls"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_function-calls"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Function calls</h2><p>Functions must always be called using REST <strong>POST</strong>requests (a GET request will receive an error).</p><p>Functions are called on the corresponding object on the serverdatastore.</p><table><thead><tr><th>Class function</th><th>Syntax</th></tr></thead><tbody><tr><td><a href="#classFunctions.html_datastore-class">datastoreclass</a></td><td><code>/rest/$catalog/DataStoreClassFunction</code></td></tr><tr><td><a href="#classFunctions.html_dataclass-class">dataclassclass</a></td><td><code>/rest/{dataClass}/DataClassClassFunction</code></td></tr><tr><td><a href="#classFunctions.html_entityselection-class">entitySelectionclass</a></td><td><code>/rest/{dataClass}/EntitySelectionClassFunction</code></td></tr><tr><td></td><td><code>/rest/{dataClass}/EntitySelectionClassFunction/$entityset/entitySetNumber</code></td></tr><tr><td></td><td><code>/rest/{dataClass}/EntitySelectionClassFunction/$filter</code></td></tr><tr><td></td><td><code>/rest/{dataClass}/EntitySelectionClassFunction/$orderby</code></td></tr><tr><td><a href="#classFunctions.html_entity-class">entityclass</a></td><td><code>/rest/{dataClass}(key)/EntityClassFunction/</code></td></tr></tbody></table><blockquote><p><code>/rest/{dataClass}/Function</code> can be used to calleither a dataclass or an entity selection function(<code>/rest/{dataClass}</code> returns all entities of theDataClass as an entity selection).<br />The function is searched in the entity selection class first. Ifnot found, it is searched in the dataclass. In other words, if afunction with the same name is defined in both the DataClass classand the EntitySelection class, the dataclass class function willnever be executed.</p></blockquote><blockquote><p>All 4D code called from REST requests <strong>must bethread-safe</strong> if the project runs in compiled mode, becausethe REST Server always uses preemptive processes in this case (the<a href="#classFunctions.html_enabling-the-preemptive-mode-for-the-web-server"><em>Use preemptive process</em> setting value</a> is ignored by theREST Server).</p></blockquote><h2><a aria-hidden="true" class="anchor" id="classFunctions.html_parameter"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_parameter"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Parameter</h2><p>You can send parameters to functions defined in ORDA userclasses. On the server side, they will be received in the classfunctions in regular $1, $2, etc. parameters.</p><p>Es gelten folgende Regeln:</p><ul><li>Parameters must be passed in the <strong>body of the POSTrequest</strong></li><li>Parameters must be enclosed within a collection (JSONformat)</li><li>All scalar data types supported in JSON collections can bepassed as parameters.</li><li>Entity and entity selection can be passed as parameters. TheJSON object must contain specific attributes used by the RESTserver to assign data to the corresponding ORDA objects:__DATACLASS, __ENTITY, __ENTITIES, __DATASET.</li></ul><p>See <a href="#classFunctions.html_request-receiving-an-entity-as-parameter">thisexample</a> and <a href="#classFunctions.html_request-receiving-an-entity-selection-as-parameter">this example</a>.</p><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_scalar-value-parameter"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_scalar-value-parameter"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Scalar value parameter</h3><p>Parameter(s) must simply be enclosed in a collection defined inthe body. For example, with a dataclass function<code>getCities()</code> receiving text parameters:<code>/rest/City/getCities</code></p><p><strong>Parameters in body:</strong> ["Aguada","Paris"]</p><p>All JSON data types are supported in parameters, including JSONpointers. Dates can be passed as strings in ISO 8601 date format(e.g. "2020-08-22T22:00:000Z").</p><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_entity-parameter"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_entity-parameter"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Entity parameter</h3><p>Entities passed in parameters are referenced on the serverthrough their key (<em>i.e.</em> __KEY property). If the keyparameter is omitted in a request, a new entity is loaded in memorythe server. You can also pass values for any attributes of theentity. These values will automatically be used for the entityhandled on the server.</p><blockquote><p>If the request sends modified attribute values for an existingentity on the server, the called ORDA data model function will beautomatically executed on the server with modified values. Thisfeature allows you, for example, to check the result of anoperation on an entity, after applying all business rules, from theclient application. You can then decide to save or not the entityon the server.</p></blockquote><table><thead><tr><th>Properties</th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>Attributes of the entity</td><td>mixed</td><td>Optional - Values to modify</td></tr><tr><td>__DATACLASS</td><td>String</td><td>Mandatory - Indicates the Dataclass of the entity</td></tr><tr><td>__ENTITY</td><td>Boolean</td><td>Mandatory - True to indicate to the server that the parameteris an entity</td></tr><tr><td>__KEY</td><td>mixed (same type as the primary key)</td><td>Optional - Primary key of the entity</td></tr></tbody></table><ul><li>If __KEY is not provided, a new entity is created on the serverwith the given attributes.</li><li>If __KEY is provided, the entity corresponding to __KEY isloaded on the server with the given attributes</li></ul><p>See examples for <a href="#classFunctions.html_creating-an-entity">creating</a> or <a href="#classFunctions.html_updating-an-entity">updating</a>entities.</p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_related-entity-parameter"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_related-entity-parameter"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Related entity parameter</h4><p>Same properties as for an <a href="#classFunctions.html_entity-parameter">entity parameter</a>. Inaddition, the related entity must exist and is referenced by __KEYcontaining its primary key.</p><p>See examples for <a href="#classFunctions.html_creating-an-entity-with-a-related-entity">creating</a>or <a href="#classFunctions.html_updating-an-entity-with-a-related-entity">updating</a>entities with related entities.</p><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_entity-selection-parameter"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_entity-selection-parameter"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Entity selection parameter</h3><p>The entity selection must have been defined beforehand using<a href="#classFunctions.html_methodentityset">$method=entityset</a>.</p><blockquote><p>If the request sends a modified entity selection to the server,the called ORDA data model function will be automatically executedon the server with the modified entity selection.</p></blockquote><table><thead><tr><th>Properties</th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>Attributes of the entity</td><td>mixed</td><td>Optional - Values to modify</td></tr><tr><td>__DATASET</td><td>String</td><td>Mandatory - entitySetID (UUID) of the entity selection</td></tr><tr><td>__ENTITIES</td><td>Boolean</td><td>Mandatory - True to indicate to the server that the parameteris an entity selection</td></tr></tbody></table><p>See example for <a href="#classFunctions.html_receiving-an-entity-selection-as-parameter">receivingan entity selection</a>.</p><h2><a aria-hidden="true" class="anchor" id="classFunctions.html_request-examples"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_request-examples"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Request examples</h2><p>This database is exposed as a remote datastore on localhost(port 8111):</p><p><img alt="alt-text" src="https://developer.4d.com/docs/Rx/assets/en/REST/ordastructure.png" /></p><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_using-a-datastore-class-function"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_using-a-datastore-class-function"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Using a datastore class function</h3><p>The US_Cities <code>DataStore</code> class provides an API:</p><pre><code class="hljs">// DataStore <span class="hljs-class"><span class="hljs-keyword">class</span></span><span class="hljs-class"><span class="hljs-keyword">Class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">DataStoreImplementation</span></span>exposed <span class="hljs-function"><span class="hljs-keyword">Function</span> <span class="hljs-title">getName</span>(</span>)    <span class="hljs-number">$0</span>:=<span class="hljs-string">"US cities and zip codes manager"</span> </code></pre><p>You can then run this request:</p><p><strong>POST</strong><code>127.0.0.1:8111/rest/$catalog/getName</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_ergebnis"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_ergebnis"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><pre><code class="hljs">{<span class="hljs-attr">"result"</span>: <span class="hljs-string">"US cities and zip codes manager"</span> }</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_using-a-dataclass-class-function"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_using-a-dataclass-class-function"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Using a dataclass class function</h3><p>The Dataclass class <code>City</code> provides an API thatreturns a city entity from a name passed in parameter:</p><pre><code class="hljs"><span class="hljs-comment">// City class</span><span class="hljs-keyword">Class extends</span> DataClass<span class="hljs-function">exposed Function getCity</span>()<span class="hljs-keyword">    var</span> <span class="hljs-variable">$0 </span>: cs.CityEntity<span class="hljs-keyword">    var</span> <span class="hljs-variable">$1</span>,<span class="hljs-variable">$nameParam </span>: text    <span class="hljs-variable">$nameParam</span>:=<span class="hljs-variable">$1</span>    <span class="hljs-variable">$0</span>:=<span class="hljs-literal">This</span>.<span class="hljs-function">query</span>(<span class="hljs-string">"name = :1"</span>;<span class="hljs-variable">$nameParam</span>).<span class="hljs-function">first</span>()</code></pre><p>You can then run this request:</p><p><strong>POST</strong><code>127.0.0.1:8111/rest/City/getCity</code></p><p>Body of the request: ["Aguada"]</p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_ergebnis-1"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_ergebnis-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><p>The result is an entity:</p><pre><code class="hljs">{    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"City"</span>,    <span class="hljs-attr">"__DATACLASS"</span>: <span class="hljs-string">"City"</span>,    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"1"</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"2020-03-09T08:03:19.923Z"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Aguada"</span>,    <span class="hljs-attr">"countyFIPS"</span>: <span class="hljs-number">72003</span>,    <span class="hljs-attr">"county"</span>: {        <span class="hljs-attr">"__deferred"</span>: {            <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"/rest/County(72003)"</span>,            <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"72003"</span>         }    },    <span class="hljs-attr">"zips"</span>: {        <span class="hljs-attr">"__deferred"</span>: {            <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"/rest/City(1)/zips?$expand=zips"</span>         }    }}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_using-an-entity-class-function"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_using-an-entity-class-function"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Using an entity class function</h3><p>The Entity class <code>CityEntity</code> provides an API:</p><pre><code class="hljs">// CityEntity <span class="hljs-class"><span class="hljs-keyword">class</span></span><span class="hljs-class"><span class="hljs-keyword">Class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Entity</span></span>exposed <span class="hljs-function"><span class="hljs-keyword">Function</span> <span class="hljs-title">getPopulation</span>(</span>)    <span class="hljs-number">$0</span>:=This.zips.sum(<span class="hljs-string">"population"</span>)</code></pre><p>You can then run this request:</p><p><strong>POST</strong><code>127.0.0.1:8111/rest/City(2)/getPopulation</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_ergebnis-2"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_ergebnis-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: <span class="hljs-number">48814</span>}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_using-an-entityselection-class-function"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_using-an-entityselection-class-function"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Using an entitySelection class function</h3><p>The EntitySelection class <code>CitySelection</code> provides anAPI:</p><pre><code class="hljs">// CitySelection <span class="hljs-class"><span class="hljs-keyword">class</span></span><span class="hljs-class"><span class="hljs-keyword">Class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EntitySelection</span></span>exposed <span class="hljs-function"><span class="hljs-keyword">Function</span> <span class="hljs-title">getPopulation</span>(</span>)    <span class="hljs-number">$0</span>:=This.zips.sum(<span class="hljs-string">"population"</span>)</code></pre><p>You can then run this request:</p><p><strong>POST</strong><code>127.0.0.1:8111/rest/City/getPopulation/?$filter="ID&lt;3"</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_ergebnis-3"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_ergebnis-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: <span class="hljs-number">87256</span>}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_using-an-entityselection-class-function-and-an-entityset"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_using-an-entityselection-class-function-and-an-entityset"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Using an entitySelection class function and anentitySet</h3><p>The <code>StudentsSelection</code> class has a<code>getAgeAverage</code> function:</p><pre><code class="hljs"><span class="hljs-comment">// StudentsSelection Class</span><span class="hljs-keyword">Class extends</span> EntitySelectionexposed<span class="hljs-keyword"> Function</span> getAgeAverage<span class="hljs-function">    C_LONGINT</span>(<span class="hljs-variable">$sum</span>;<span class="hljs-variable">$0</span>)<span class="hljs-function">    C_OBJECT</span>(<span class="hljs-variable">$s</span>)    <span class="hljs-variable">$sum</span>:=<span class="hljs-number">0</span><span class="hljs-keyword">    For each</span> (<span class="hljs-variable">$s</span>;<span class="hljs-literal">This</span>)        <span class="hljs-variable">$sum</span>:=<span class="hljs-variable">$sum</span>+<span class="hljs-variable">$s</span>.<span class="hljs-function">age</span>()<span class="hljs-keyword">    End for each</span>     <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$sum</span>/<span class="hljs-literal">This</span>.length</code></pre><p>Once you have created an entityset, you can run thisrequest:</p><p><strong>POST</strong><code>127.0.0.1:8044/rest/Students/getAgeAverage/$entityset/17E83633FFB54ECDBF947E5C620BB532</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_ergebnis-4"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_ergebnis-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: <span class="hljs-number">34</span>}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_using-an-entityselection-class-function-and-an-orderby"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_using-an-entityselection-class-function-and-an-orderby"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Using an entitySelection class function and anorderBy</h3><p>The <code>StudentsSelection</code> class has a<code>getLastSummary</code> function:</p><pre><code class="hljs"><span class="hljs-comment">// StudentsSelection Class</span><span class="hljs-keyword">Class extends</span> EntitySelectionexposed<span class="hljs-keyword"> Function</span> getLastSummary<span class="hljs-function">    C_TEXT</span>(<span class="hljs-variable">$0</span>)<span class="hljs-function">    C_OBJECT</span>(<span class="hljs-variable">$last</span>)    <span class="hljs-variable">$last</span>:=<span class="hljs-literal">This</span>.<span class="hljs-function">last</span>()    <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$last</span>.firstname+<span class="hljs-string">" - "</span>+<span class="hljs-variable">$last</span>.lastname+<span class="hljs-string">" is ... "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$last</span>.<span class="hljs-function">age</span>())</code></pre><p>You can then run this request:</p><p><strong>POST</strong><code>127.0.0.1:8044/rest/Students/getLastSummary/$entityset/?$filter="lastname=b@"&amp;$orderby="lastname"</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_ergebnis-5"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_ergebnis-5"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: <span class="hljs-string">"Wilbert - Bull is ... 21"</span> }</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_using-an-entity-to-be-created-on-the-server"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_using-an-entity-to-be-created-on-the-server"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Using an entity to be created on the server</h3><p>The Dataclass class <code>Students</code> has the function<code>pushData()</code> receiving an entity containing data fromthe client. The <code>checkData()</code> method runs some controls.If they are OK, the entity is saved and returned.</p><pre><code class="hljs"><span class="hljs-comment">// Students Class</span><span class="hljs-keyword">Class extends</span> DataClassexposed<span class="hljs-keyword"> Function</span> pushData<span class="hljs-keyword">    var</span> <span class="hljs-variable">$1</span>, <span class="hljs-variable">$entity</span>, <span class="hljs-variable">$status</span>, <span class="hljs-variable">$0 </span>: Object    <span class="hljs-variable">$entity</span>:=<span class="hljs-variable">$1</span>    <span class="hljs-variable">$status</span>:=<span class="hljs-function">checkData</span>(<span class="hljs-variable">$entity</span>) <span class="hljs-comment">// $status is an object with a success boolean property</span>    <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$status</span><span class="hljs-keyword">    If</span> (<span class="hljs-variable">$status</span>.success)        <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$entity</span>.<span class="hljs-function">save</span>()<span class="hljs-keyword">       If</span> (<span class="hljs-variable">$status</span>.success)           <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$entity</span><span class="hljs-keyword">      End if</span><span class="hljs-keyword">     End if</span></code></pre><p>You run this request:</p><p><strong>POST</strong><code>http://127.0.0.1:8044/rest/Students/pushData</code></p><p>Body of the request:</p><pre><code class="hljs">[{<span class="hljs-attr">"__DATACLASS"</span>:<span class="hljs-string">"Students"</span>,<span class="hljs-attr">"__ENTITY"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"firstname"</span>:<span class="hljs-string">"Ann"</span>,<span class="hljs-attr">"lastname"</span>:<span class="hljs-string">"Brown"</span> }]</code></pre><p>Since no <code>__KEY</code> is given, a new Students entity isloaded on the server <strong>with the attributes received from theclient</strong>. Because the <code>pushData()</code> function runsa <code>save()</code> action, the new entity is created.</p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_ergebnis-6"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_ergebnis-6"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><pre><code class="hljs">{    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__DATACLASS"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"55"</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"2020-06-16T10:54:41.805Z"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">55</span>,    <span class="hljs-attr">"firstname"</span>: <span class="hljs-string">"Ann"</span>,    <span class="hljs-attr">"lastname"</span>: <span class="hljs-string">"BROWN"</span>,    <span class="hljs-attr">"schoolID"</span>: <span class="hljs-literal">null</span>,    <span class="hljs-attr">"school"</span>: <span class="hljs-literal">null</span>}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_using-an-entity-to-be-updated-on-the-server"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_using-an-entity-to-be-updated-on-the-server"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Using an entity to be updated on the server</h3><p>Same as above but with a __KEY attribute</p><p>You run this request:</p><p><strong>POST:</strong><code>http://127.0.0.1:8044/rest/Students/pushData</code></p><p>Body of the request:</p><pre><code class="hljs">[{<span class="hljs-attr">"__DATACLASS"</span>:<span class="hljs-string">"Students"</span>,<span class="hljs-attr">"__ENTITY"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"lastname"</span>:<span class="hljs-string">"Brownie"</span>,<span class="hljs-attr">"__KEY"</span>:<span class="hljs-number">55</span>}]</code></pre><p>Since <code>__KEY</code> is given, the Students entity withprimary key 55 is loaded <strong>with the lastname value receivedfrom the client</strong>. Because the function runs a<code>save()</code> action, the entity is updated.</p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_ergebnis-7"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_ergebnis-7"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><pre><code class="hljs">{    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__DATACLASS"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"55"</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"2020-06-16T11:10:21.679Z"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">3</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">55</span>,    <span class="hljs-attr">"firstname"</span>: <span class="hljs-string">"Ann"</span>,    <span class="hljs-attr">"lastname"</span>: <span class="hljs-string">"BROWNIE"</span>,    <span class="hljs-attr">"schoolID"</span>: <span class="hljs-literal">null</span>,    <span class="hljs-attr">"school"</span>: <span class="hljs-literal">null</span> }</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_creating-an-entity-with-a-related-entity"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_creating-an-entity-with-a-related-entity"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Creating an entity with a related entity</h3><p>In this example, we create a new Students entity with theSchools entity having primary key 2.</p><p>You run this request:</p><p><strong>POST:</strong><code>http://127.0.0.1:8044/rest/Students/pushData</code></p><p>Body of the request:</p><pre><code class="hljs">[{<span class="hljs-attr">"__DATACLASS"</span>:<span class="hljs-string">"Students"</span>,<span class="hljs-attr">"__ENTITY"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"firstname"</span>:<span class="hljs-string">"John"</span>,<span class="hljs-attr">"lastname"</span>:<span class="hljs-string">"Smith"</span>,<span class="hljs-attr">"school"</span>:{<span class="hljs-attr">"__KEY"</span>:<span class="hljs-number">2</span>}}]</code></pre><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_ergebnis-8"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_ergebnis-8"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><pre><code class="hljs">{    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__DATACLASS"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"56"</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"2020-06-16T11:16:47.601Z"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">56</span>,    <span class="hljs-attr">"firstname"</span>: <span class="hljs-string">"John"</span>,    <span class="hljs-attr">"lastname"</span>: <span class="hljs-string">"SMITH"</span>,    <span class="hljs-attr">"schoolID"</span>: <span class="hljs-number">2</span>,       <span class="hljs-attr">"school"</span>: {        <span class="hljs-attr">"__deferred"</span>: {            <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"/rest/Schools(2)"</span>,            <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"2"</span>         }    }}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_updating-an-entity-with-a-related-entity"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_updating-an-entity-with-a-related-entity"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Updating an entity with a related entity</h3><p>In this example, we associate an existing school to a Studentsentity. The <code>StudentsEntity</code> class has an API:</p><pre><code class="hljs"><span class="hljs-comment">// StudentsEntity class</span><span class="hljs-keyword">Class extends</span> Entity<span class="hljs-function">exposed Function putToSchool</span>()<span class="hljs-keyword">    var</span> <span class="hljs-variable">$1</span>, <span class="hljs-variable">$school </span>, <span class="hljs-variable">$0</span>, <span class="hljs-variable">$status </span>: Object        <span class="hljs-comment">//$1 is a Schools entity</span>    <span class="hljs-variable">$school</span>:=<span class="hljs-variable">$1</span>        <span class="hljs-comment">//Associate the related entity school to the current Students entity</span>    <span class="hljs-literal">This</span>.school:=<span class="hljs-variable">$school</span>    <span class="hljs-variable">$status</span>:=<span class="hljs-literal">This</span>.<span class="hljs-function">save</span>()    <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$status</span></code></pre><p>You run this request, called on a Students entity :<strong>POST</strong><code>http://127.0.0.1:8044/rest/Students(1)/putToSchool</code>Body of the request:</p><pre><code class="hljs">[{<span class="hljs-attr">"__DATACLASS"</span>:<span class="hljs-string">"Schools"</span>,<span class="hljs-attr">"__ENTITY"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"__KEY"</span>:<span class="hljs-number">2</span>}]</code></pre><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_ergebnis-9"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_ergebnis-9"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: {        <span class="hljs-attr">"success"</span>: <span class="hljs-literal">true</span>    }}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_receiving-an-entity-selection-as-parameter"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_receiving-an-entity-selection-as-parameter"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Receiving an entity selection as parameter</h3><p>In the <code>Students</code> Dataclass class, the<code>setFinalExam()</code> function updates a received entityselection ($1). It actually updates the <em>finalExam</em>attribute with the received value ($2). It returns the primary keysof the updated entities.</p><pre><code class="hljs"><span class="hljs-comment">// Students class</span><span class="hljs-keyword">Class extends</span> DataClass<span class="hljs-function">exposed Function setFinalExam</span>()<span class="hljs-keyword">    var</span> <span class="hljs-variable">$1</span>, <span class="hljs-variable">$es</span>, <span class="hljs-variable">$student</span>, <span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">    var</span> <span class="hljs-variable">$2</span>, <span class="hljs-variable">$examResult </span>: Text<span class="hljs-keyword">    var</span> <span class="hljs-variable">$keys</span>, <span class="hljs-variable">$0 </span>: Collection      <span class="hljs-comment">//Entity selection</span>    <span class="hljs-variable">$es</span>:=<span class="hljs-variable">$1</span>    <span class="hljs-variable">$examResult</span>:=<span class="hljs-variable">$2</span>    <span class="hljs-variable">$keys</span>:=<span class="hljs-function">New collection</span>()      <span class="hljs-comment">//Loop on the entity selection</span><span class="hljs-keyword">    For each</span> (<span class="hljs-variable">$student</span>;<span class="hljs-variable">$es</span>)        <span class="hljs-variable">$student</span>.finalExam:=<span class="hljs-variable">$examResult</span>        <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$student</span>.<span class="hljs-function">save</span>()<span class="hljs-keyword">        If</span> (<span class="hljs-variable">$status</span>.success)            <span class="hljs-variable">$keys</span>.<span class="hljs-function">push</span>(<span class="hljs-variable">$student</span>.ID)<span class="hljs-keyword">        End if</span><span class="hljs-keyword">     End for each</span>     <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$keys</span></code></pre><p>An entity set is first created with this request:</p><p><code>http://127.0.0.1:8044/rest/Students/?$filter="ID&lt;3"&amp;$method=entityset</code></p><p>Then you can run this request:</p><p><strong>POST</strong><code>http://127.0.0.1:8044/rest/Students/setFinalExam</code></p><p>Body of the request:</p><pre><code class="hljs">[{<span class="hljs-attr">"__ENTITIES"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"__DATASET"</span>:<span class="hljs-string">"9B9C053A111E4A288E9C1E48965FE671"</span> },<span class="hljs-string">"Passed"</span> ]</code></pre><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_ergebnis-10"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_ergebnis-10"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><p>The entities with primary keys 1 and 2 have been updated.</p><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: [        <span class="hljs-number">1</span>,        <span class="hljs-number">2</span>    ]}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_using-an-entity-selection-updated-on-the-client"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_using-an-entity-selection-updated-on-the-client"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Using an entity selection updated on the client</h3><p>Using the <code>getAgeAverage()</code> function <a href="#classFunctions.html_using-an-entityselection-class-function-and-an-entityset">defined above</a>.</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$remoteDS</span>, <span class="hljs-variable">$newStudent</span>, <span class="hljs-variable">$students </span>: Object<span class="hljs-keyword">var</span> <span class="hljs-variable">$ageAverage </span>: Integer<span class="hljs-variable">$remoteDS</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"hostname"</span>;<span class="hljs-string">"127.0.0.1:8044"</span>);<span class="hljs-string">"students"</span>)<span class="hljs-comment">// $newStudent is a student entity to procees</span><span class="hljs-variable">$newStudent</span>:=...<span class="hljs-variable">$students</span>:=<span class="hljs-variable">$remoteDS</span>.Students.<span class="hljs-function">query</span>(<span class="hljs-string">"school.name = :1"</span>;<span class="hljs-string">"Math school"</span>)<span class="hljs-comment">// We add an entity to the $students entity selection on the client</span><span class="hljs-variable">$students</span>.<span class="hljs-function">add</span>(<span class="hljs-variable">$newStudent</span>) <span class="hljs-comment">// We call a function on the StudentsSelection class returning the age average of the students in the entity selection</span><span class="hljs-comment">// The function is executed on the server on the updated $students entity selection which included the student added from the client</span><span class="hljs-variable">$ageAverage</span>:=<span class="hljs-variable">$students</span>.<span class="hljs-function">getAgeAverage</span>()</code></pre></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#manData.html"><span class="arrow-prev">←</span><span>Manipulating Data</span></a><a class="docs-next button" href="#REST_requests.html"><span>About REST Requests</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#classFunctions.html_function-calls">Functioncalls</a></li><li><a href="#classFunctions.html_parameter">Parameter</a><ul class="toc-headings"><li><a href="#classFunctions.html_scalar-value-parameter">Scalarvalue parameter</a></li><li><a href="#classFunctions.html_entity-parameter">Entityparameter</a></li><li><a href="#classFunctions.html_entity-selection-parameter">Entity selectionparameter</a></li></ul></li><li><a href="#classFunctions.html_request-examples">Requestexamples</a><ul class="toc-headings"><li><a href="#classFunctions.html_using-a-datastore-class-function">Using adatastore class function</a></li><li><a href="#classFunctions.html_using-a-dataclass-class-function">Using adataclass class function</a></li><li><a href="#classFunctions.html_using-an-entity-class-function">Using anentity class function</a></li><li><a href="#classFunctions.html_using-an-entityselection-class-function">Usingan entitySelection class function</a></li><li><a href="#classFunctions.html_using-an-entityselection-class-function-and-an-entityset">Using an entitySelection class function and an entitySet</a></li><li><a href="#classFunctions.html_using-an-entityselection-class-function-and-an-orderby">Using an entitySelection class function and an orderBy</a></li><li><a href="#classFunctions.html_using-an-entity-to-be-created-on-the-server">Usingan entity to be created on the server</a></li><li><a href="#classFunctions.html_using-an-entity-to-be-updated-on-the-server">Usingan entity to be updated on the server</a></li><li><a href="#classFunctions.html_creating-an-entity-with-a-related-entity">Creatingan entity with a related entity</a></li><li><a href="#classFunctions.html_updating-an-entity-with-a-related-entity">Updatingan entity with a related entity</a></li><li><a href="#classFunctions.html_receiving-an-entity-selection-as-parameter">Receivingan entity selection as parameter</a></li><li><a href="#classFunctions.html_using-an-entity-selection-updated-on-the-client">Using an entity selection updated on the client</a></li></ul></li></ul></nav></div></div></body></html>