<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="de"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>IMAPTransporter · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="The `IMAPTransporter` class allows you to retrieve messages from a IMAP email server."name="description" /><meta content="de" name="docsearch:language" /><meta content="IMAPTransporter · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="The `IMAPTransporter` class allows you to retrieve messages from a IMAP email server."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#IMAPTransporterClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">IMAPTransporter<a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html"></a></h1></header><article><div><p><span>The <code>IMAPTransporter</code> class allows you toretrieve messages from a IMAP email server.</span></p><h3><span><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_imap-transporter-object"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_imap-transporter-object"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>IMAP Transporter object</span></h3><p><span>IMAP Transporter objects are instantiated with the<a href="#IMAPTransporterClass.html_imap-new-transporter">IMAP Newtransporter</a> command. They provide the following properties andfunctions:</span></p><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#IMAPTransporterClass.html_acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong>: Boolean</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>True</strong> if 4D is allowedto establish an unencrypted connection</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_addflags"><strong>.addFlags</strong>(<em>msgIDs</em> : Collection ; <em>keywords</em> : Object ) :Object<br /><strong>.addFlags</strong>( <em>msgIDs</em> : Text ;<em>keywords</em> : Object ) : Object<br /><strong>.addFlags</strong>( <em>msgIDs</em> : Longint ;<em>keywords</em> : Object ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;adds flags to the <code>msgIDs</code>for the specified <code>keywords</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_append"><strong>.append</strong>(<em>mailObj</em> : Object ; <em>destinationBox</em> : Text ;<em>options</em> : Object ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;appends a <code>mailObj</code> to the<code>destinationBox</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_authenticationmode"><strong>.authenticationMode</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the authentication mode used to open thesession on the mail server</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_checkconnection"><strong>.checkConnection()</strong>: Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp; checks the connection using informationstored in the transporter object</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_checkconnectiondelay"><strong>.checkConnectionDelay</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the maximum time (in seconds) allowedprior to checking the connection to the server</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_connectiontimeout"><strong>.connectionTimeOut</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the maximum wait time (in seconds)allowed to establish a connection to the server</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_copy"><strong>.copy</strong>(<em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) :Object<br /><strong>.copy</strong>( <em>allMsgs</em> : Integer ;<em>destinationBox</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;copies the messages defined by<em>msgsIDs</em> or <em>allMsgs</em> to the <em>destinationBox</em>on the IMAP server</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_createbox"><strong>.createBox</strong>(<em>name</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;creates a mailbox with the given<code>name</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_delete"><strong>.delete</strong>(<em>msgsIDs</em> : Collection ) : Object<br /><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;sets the "deleted" flag for the messagesdefined in <code>msgsIDs</code> or <code>allMsgs</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_deletebox"><strong>.deleteBox</strong>(<em>name</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;permanently removes the mailbox with thegiven <code>name</code> from the IMAP server</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_expunge"><strong>.expunge()</strong> :Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;removes all messages with the "deleted"flag from the IMAP mail server.</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getboxinfo"><strong>.getBoxInfo</strong>({ <em>name</em> : Text }) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;returns a <code>boxInfo</code> objectcorresponding to the current maibox, or the mailbox<em>name</em></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getboxlist"><strong>.getBoxList</strong>({ <em>parameters</em> : Object } ) : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;returns a collection of mailboxesdescribing all of the available mailboxes</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getdelimiter"><strong>.getDelimiter()</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;returns the character used to delimitlevels of hierarchy in the mailbox name</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getmail"><strong>.getMail</strong>(<em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) :Object<br /><strong>.getMail</strong>( <em>msgID</em>: Text { ;<em>options</em> : Object } ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;returns the <code>Email</code> objectcorresponding to the <em>msgNumber</em> or <em>msgID</em> in themailbox designated by the <code>IMAP_transporter</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getmails"><strong>.getMails</strong>(<em>ids</em> : Collection { ; <em>options</em> : Object } ) :Object<br /><strong>.getMails</strong>( <em>startMsg</em> : Integer ;<em>endMsg</em> : Integer { ; <em>options</em> : Object } ) :Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;returns an object containing acollection of <code>Email</code> objects</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getmimeasblob"><strong>.getMIMEAsBlob</strong>(<em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ): Blob<br /><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ;<em>updateSeen</em> : Boolean } ) : Blob</a><p>&nbsp;&nbsp;&nbsp;&nbsp;returns a BLOB containing the MIMEcontents for the message corresponding to the <em>msgNumber</em> or<em>msgID</em> in the mailbox designated by the<code>IMAP_transporter</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_host"><strong>.host</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the name or the IP address of the hostserver</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_logfile"><strong>.logFile</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the path of the extended log filedefined (if any) for the mail connection</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_move"><strong>.move</strong>(<em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) :Object<br /><strong>.move</strong>( <em>allMsgs</em> : Integer ;<em>destinationBox</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;moves the messages defined by<em>msgsIDs</em> or <em>allMsgs</em> to the <em>destinationBox</em>on the IMAP server</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_numtoid"><strong>.numToID</strong>(<em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) :Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;converts the sequence numbers to IMAPunique IDs for the messages in the sequential range designated by<em>startMsg</em> and <em>endMsg</em></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_removeflags"><strong>.removeFlags</strong>(<em>msgIDs</em> : Collection ; <em>keywords</em> : Object ) :Object<br /><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ;<em>keywords</em> : Object ) : Object<br /><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ;<em>keywords</em> : Object ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;removes flags from the<code>msgIDs</code> for the specified <code>keywords</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_renamebox"><strong>.renameBox</strong>(<em>currentName</em> : Text ; <em>newName</em> : Text ) :Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;changes the name of a mailbox on theIMAP server</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_port"><strong>.port</strong> :Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp; the port number used for mailtransactions</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_searchmails"><strong>.searchMails</strong>(<em>searchCriteria</em> : Text ) : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;searches for messages that match thegiven <em>searchCriteria</em> in the current mailbox</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_selectbox"><strong>.selectBox</strong>(<em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;selects the <em>name</em> mailbox as thecurrent mailbox</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_subscribe"><strong>.subscribe</strong>(<em>name</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;allows adding or removing of thespecified mailbox to/from the IMAP server’s set of “subscribed”mailboxes</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_unsubscribe"><strong>.unsubscribe</strong>(<em>name</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;removes a mailbox from a set ofsubscribed mailboxes</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_user"><strong>.user</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; the user name used for authenticationon the mail server</p></td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_imap-new-transporter"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_imap-new-transporter"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>IMAP New transporter</span></h2><details><summary><span>History</span></summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R4</td><td>Added</td></tr></tbody></table></details><p><span><strong>IMAP New transporter</strong>( <em>server</em> :Object ) : 4D.IMAPTransporter</span></p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>server</td><td>Objekt</td><td style="text-align:center">-&gt;</td><td>Mail server information</td></tr><tr><td>Ergebnis</td><td>4D.IMAPTransporter</td><td style="text-align:center">&lt;-</td><td><a href="#IMAPTransporterClass.html_imap-transporter-object">IMAPtransporter object</a></td></tr></tbody></table><h4><span><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beschreibung"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</span></h4><p><span>The <code>IMAP New transporter</code> command configures anew IMAP connection according to the <em>server</em> parameter andreturns a new <em>transporter</em> object. The returned transporterobject will then usually be used to receive emails.</span></p><p><span>In the <em>server</em> parameter, pass an objectcontaining the following properties:</span></p><table><thead><tr><th><em>server</em></th><th>Default value (if omitted)</th></tr></thead><tbody><tr><td><a href="#IMAPTransporterClass.html_acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong>: Boolean</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>True</strong> if 4D is allowedto establish an unencrypted connection</p></td><td>Falsch</td></tr><tr><td>.<strong>accessTokenOAuth2</strong>: Text<br />.<strong>accessTokenOAuth2</strong>: Object<p>Text string or token object representing OAuth2 authorizationcredentials. Used only with OAUTH2 <code>authenticationMode</code>.If <code>accessTokenOAuth2</code> is used but<code>authenticationMode</code> is omitted, the OAuth 2 protocol isused (if allowed by the server). Not returned in <em><a href="#IMAPTransporterClass.html_imap-transporter-object">IMAPtransporter</a></em> object.</p></td><td>none</td></tr><tr><td><a href="#IMAPTransporterClass.html_authenticationmode"><strong>.authenticationMode</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the authentication mode used to open thesession on the mail server</p></td><td>the most secure authentication mode supported by the server isused</td></tr><tr><td><a href="#IMAPTransporterClass.html_checkconnectiondelay"><strong>.checkConnectionDelay</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the maximum time (in seconds) allowedprior to checking the connection to the server</p></td><td>300</td></tr><tr><td><a href="#IMAPTransporterClass.html_connectiontimeout"><strong>.connectionTimeOut</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the maximum wait time (in seconds)allowed to establish a connection to the server</p></td><td>30</td></tr><tr><td><a href="#IMAPTransporterClass.html_host"><strong>.host</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the name or the IP address of the hostserver</p></td><td><em>mandatory</em></td></tr><tr><td><a href="#IMAPTransporterClass.html_logfile"><strong>.logFile</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the path of the extended log filedefined (if any) for the mail connection</p></td><td>none</td></tr><tr><td>.<strong>password</strong> : Text<p>User password for authentication on the server. Not returned in<em><a href="#IMAPTransporterClass.html_imap-transporter-object">IMAPtransporter</a></em> object.</p></td><td>none</td></tr><tr><td><a href="#IMAPTransporterClass.html_port"><strong>.port</strong> :Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp; the port number used for mailtransactions</p></td><td>993</td></tr><tr><td><a href="#IMAPTransporterClass.html_user"><strong>.user</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; the user name used for authenticationon the mail server</p></td><td>none</td></tr></tbody></table><blockquote><p><span><strong>Warning</strong>: Make sure the defined timeout islower than the server timeout, otherwise the client timeout will beuseless.</span></p></blockquote><h4><span><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ergebnis"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ergebnis"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</span></h4><p><span>The function returns an <a href="#IMAPTransporterClass.html_imap-transporter-object"><strong>IMAPtransporter object</strong></a>. All returned properties are<strong>read-only</strong>.</span></p><blockquote><p><span>The IMAP connection is automatically closed when thetransporter object is destroyed.</span></p></blockquote><h4><span><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</span></h4><pre><span><code class="hljs css language-4d"><span class="hljs-variable">$server</span>:=New object<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span><span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span><span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span><span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span><span class="hljs-variable">$server</span>.logFile:=<span class="hljs-string">"LogTest.txt"</span> <span class="hljs-comment">//log to save in the Logs folder</span><span class="hljs-keyword">var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">checkConnection</span>()<span class="hljs-keyword">If</span>(<span class="hljs-function">Not</span>(<span class="hljs-variable">$status</span>.success))<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"An error occurred: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">End if</span></code></span></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_4dimaptransporternew"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_4dimaptransporternew"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4D.IMAPTransporter.new()</h2><p><strong>4D.IMAPTransporter.new</strong>( <em>server</em> :Object ) : 4D.IMAPTransporter</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>server</td><td>Objekt</td><td style="text-align:center">-&gt;</td><td>Mail server information</td></tr><tr><td>Ergebnis</td><td>4D.IMAPTransporter</td><td style="text-align:center">&lt;-</td><td><a href="#IMAPTransporterClass.html_imap-transporter-object">IMAPtransporter object</a></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-1"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>4D.IMAPTransporter.new()</code> function creates andreturns a new object of the <code>4D.IMAPTransporter</code> type.It is identical to the <a href="#IMAPTransporterClass.html_imap-new-transporter"><code>IMAP Newtransporter</code></a> command (shortcut).</p><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_acceptunsecureconnection"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_acceptunsecureconnection"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.acceptUnsecureConnection</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.acceptUnsecureConnection</strong> : Boolean</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-2"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.acceptUnsecureConnection</code> property contains<strong>True</strong> if 4D is allowed to establish an unencryptedconnection when encrypted connection is not possible.</p><p>It contains <strong>False</strong> if unencrypted connectionsare unallowed, in which case an error in returned when encryptedconnection is not possible.</p><p>Available secured ports are:</p><ul><li><p>SMTP</p><ul><li>465: SMTPS</li><li>587 or 25: SMTP with STARTTLS upgrade if supported by theserver.</li></ul></li><li><p>IMAP</p><ul><li>143: IMAP non-encrypted port</li><li>993: IMAP with STARTTLS upgrade if supported by the server</li></ul></li><li><p>POP3</p><ul><li>110: POP3 non-encrypted port</li><li>995: POP3 with STARTTLS upgrade if supported by theserver.</li></ul></li></ul><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_addflags"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_addflags"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.addFlags()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R6</td><td>Added</td></tr></tbody></table></details><p><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ;<em>keywords</em> : Object ) : Object<br /><strong>.addFlags</strong>( <em>msgIDs</em> : Text ;<em>keywords</em> : Object ) : Object<br /><strong>.addFlags</strong>( <em>msgIDs</em> : Longint ;<em>keywords</em> : Object ) : Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>msgIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection of strings: Message unique IDs (text)<br />Text: Unique ID of a message<br />Longint (IMAP all): All messages in the selected mailbox</td></tr><tr><td>keywords</td><td>Objekt</td><td style="text-align:center">-&gt;</td><td>Keyword flags to add</td></tr><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td>Status of the addFlags operation</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-3"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.addFlags()</code> function adds flags to the<code>msgIDs</code> for the specified <code>keywords</code>.</p><p>In the <code>msgIDs</code> parameter, you can pass either:</p><ul><li><p>a <em>collection</em> containing the unique IDs of specificmessages or</p></li><li><p>the unique ID (<em>text</em>) of a single message or</p></li><li><p>the following constant (<em>longint</em>) for all messages inthe selected mailbox:</p><table><thead><tr><th>Constant</th><th>Wert</th><th>Kommentar</th></tr></thead><tbody><tr><td>IMAP all</td><td>1</td><td>Select all messages in the selected mailbox</td></tr></tbody></table></li></ul><p>The <code>keywords</code> parameter lets you pass an object withkeyword values for specific flags to add to <code>msgIDs</code>.You can pass any of the following keywords:</p><table><thead><tr><th>Parameter</th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>$draft</td><td>Boolean</td><td>True to add the "draft" flag to the message</td></tr><tr><td>$seen</td><td>Boolean</td><td>True to add the "seen" flag to the message</td></tr><tr><td>$flagged</td><td>Boolean</td><td>True to add the "flagged" flag to the message</td></tr><tr><td>$answered</td><td>Boolean</td><td>True to add the "answered" flag to the message</td></tr><tr><td>$deleted</td><td>Boolean</td><td>True to add the "deleted" flag to the message</td></tr></tbody></table><blockquote><ul><li>False values are ignored.</li><li>The interpretation of keyword flags may vary per mailclient.</li></ul></blockquote><p><strong>Returned object</strong></p><p>The function returns an object describing the IMAP status:</p><table><thead><tr><th>Property</th><th></th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>True if the operation is successful, False otherwise</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Status message returned by the IMAP server, or last errorreturned in the 4D error stack</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>4D error stack (not returned if a IMAP server response isreceived)</td></tr><tr><td></td><td>[].errcode</td><td>Zahl</td><td>4D error code</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description of the 4D error</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature of the internal component which returned theerror</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-1"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span><span class="hljs-comment">// Create transporter</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-comment">// Select mailbox</span><span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-comment">// Mark all messages from INBOX as read/seen</span><span class="hljs-variable">$flags</span>:=New object<span class="hljs-variable">$flags</span>[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">addFlags</span>(IMAP all;<span class="hljs-variable">$flags</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_append"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_append"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.append()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R6</td><td>Added</td></tr></tbody></table></details><p><strong>.append</strong>( <em>mailObj</em> : Object ;<em>destinationBox</em> : Text ; <em>options</em> : Object ) :Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>mailObj</td><td>Objekt</td><td style="text-align:center">-&gt;</td><td>Email object</td></tr><tr><td>destinationBox</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Mailbox to receive Email object</td></tr><tr><td>options</td><td>Objekt</td><td style="text-align:center">-&gt;</td><td>Object containing charset info</td></tr><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td>Status of the append operation</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-4"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.append()</code> function appends a<code>mailObj</code> to the <code>destinationBox</code>.</p><p>In the <code>mailObj</code> parameter, pass an Email object. Inthe <code>mailObj</code> parameter, pass an Email object. The<code>.append()</code> function supports keyword tags in the Emailobject's <code>keywords</code> attribute.</p><p>The optional <code>destinationBox</code> parameter lets you passthe name of a mailbox where the <code>mailObj</code> will beappended. If omitted, the current mailbox is used.</p><p>In the optional <code>options</code> parameter, you can pass anobject to define the charset and encoding for specific parts of theemail. Available properties:</p><table><thead><tr><th>Property</th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>headerCharset</td><td>Text</td><td>Charset and encoding used for the following parts of the email:subject, attachment filenames, and email name attribute(s).Possible values: See possible charsets table below</td></tr><tr><td>bodyCharset</td><td>Text</td><td>Charset and encoding used for the html and text body contentsof the email. Possible values: See possible charsets tablebelow</td></tr></tbody></table><p>Possible charsets:</p><table><thead><tr><th>Constant</th><th>Wert</th><th>Kommentar</th></tr></thead><tbody><tr><td>mail mode ISO2022JP</td><td>US-ASCII_ISO-2022-JP_UTF8_QP</td><td><ul><li>headerCharset: US-ASCII if possible, Japanese (ISO-2022-JP)&amp; Quoted-printable if possible, otherwise UTF-8 &amp;Quoted-printable</li><li>bodyCharset: US-ASCII if possible, Japanese (ISO-2022-JP) &amp;7-bit if possible, otherwise UTF-8 &amp; Quoted-printable</li></ul></td></tr><tr><td>mail mode ISO88591</td><td>ISO-8859-1</td><td><ul><li>headerCharset: ISO-8859-1 &amp; Quoted-printable</li><li>bodyCharset: ISO-8859-1 &amp; 8-bit</li></ul></td></tr><tr><td>mail mode UTF8</td><td>US-ASCII_UTF8_QP</td><td>headerCharset &amp; bodyCharset: US-ASCII if possible,otherwise UTF-8 &amp; Quoted-printable (<strong>defaultvalue</strong>)</td></tr><tr><td>mail mode UTF8 in base64</td><td>US-ASCII_UTF8_B64</td><td>headerCharset &amp; bodyCharset: US-ASCII if possible,otherwise UTF-8 &amp; base64</td></tr></tbody></table><p><strong>Returned object</strong></p><p>The function returns an object describing the IMAP status:</p><table><thead><tr><th>Property</th><th></th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>True if the operation is successful, False otherwise</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Status message returned by the IMAP server, or last errorreturned in the 4D error stack</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>4D error stack (not returned if a IMAP server response isreceived)</td></tr><tr><td></td><td>[].errcode</td><td>Zahl</td><td>4D error code</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description of the 4D error</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature of the internal component which returned theerror</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-2"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><p>To save an email in the Drafts mailbox:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$settings</span>; <span class="hljs-variable">$status</span>; <span class="hljs-variable">$msg</span>; <span class="hljs-variable">$imap</span>: Object<span class="hljs-variable">$settings</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"host"</span>; <span class="hljs-string">"domain.com"</span>; <span class="hljs-string">"user"</span>; <span class="hljs-string">"xxxx"</span>; <span class="hljs-string">"password"</span>; <span class="hljs-string">"xxxx"</span>; <span class="hljs-string">"port"</span>; <span class="hljs-number">993</span>)<span class="hljs-variable">$imap</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$settings</span>)<span class="hljs-variable">$msg</span>:=New object<span class="hljs-variable">$msg</span>.from:=<span class="hljs-string">"xxxx@domain.com"</span><span class="hljs-variable">$msg</span>.subject:=<span class="hljs-string">"Lorem Ipsum"</span><span class="hljs-variable">$msg</span>.textBody:=<span class="hljs-string">"Lorem ipsum dolor sit amet, consectetur adipiscing elit."</span><span class="hljs-variable">$msg</span>.keywords:=New object<span class="hljs-variable">$msg</span>.keywords[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span><span class="hljs-comment">//flag the message as read</span><span class="hljs-variable">$msg</span>.keywords[<span class="hljs-string">"$draft"</span>]:=<span class="hljs-literal">True</span><span class="hljs-comment">//flag the message as a draft</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$imap</span>.<span class="hljs-function">append</span>(<span class="hljs-variable">$msg</span>; <span class="hljs-string">"Drafts"</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_authenticationmode"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_authenticationmode"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.authenticationMode</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.authenticationMode</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-5"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.authenticationMode</code> property contains theauthentication mode used to open the session on the mailserver.</p><p>By default, the most secured mode supported by the server isused.</p><p>Possible values are:</p><table><thead><tr><th>Wert</th><th>Konstanten</th><th>Kommentar</th></tr></thead><tbody><tr><td>CRAM-MD5</td><td><code>IMAP authentication CRAM MD5</code></td><td>Authentication using CRAM-MD5 protocol</td></tr><tr><td>LOGIN</td><td><code>IMAP authentication login</code></td><td>Authentication using LOGIN protocol</td></tr><tr><td>OAUTH2</td><td><code>IMAP authentication OAUTH2</code></td><td>Authentication using OAuth2 protocol</td></tr><tr><td>PLAIN</td><td><code>IMAP authentication plain</code></td><td>Authentication using PLAIN protocol</td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_checkconnection"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_checkconnection"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.checkConnection()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.checkConnection()</strong> : Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td>Status of the transporter object connection</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-6"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.checkConnection()</code> function checks theconnection using information stored in the transporter object,recreates the connection if necessary, and returns the status. Thisfunction allows you to verify that the values provided by the userare valid and consistent.</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_returned-object"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_returned-object"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Returned object</h4><p>The function sends a request to the mail server and returns anobject describing the mail status. This object can contain thefollowing properties:</p><table><thead><tr><th>Property</th><th></th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>True if the check is successful, False otherwise</td></tr><tr><td>status</td><td></td><td>number</td><td>(SMTP only) Status code returned by the mail server (0 in caseof an issue unrelated to the mail processing)</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Status message returned by the mail server, or last errorreturned in the 4D error stack</td></tr><tr><td>errors</td><td></td><td>collection</td><td>4D error stack (not returned if a mail server response isreceived)</td></tr><tr><td></td><td>[ ].errCode</td><td>number</td><td>4D error code</td></tr><tr><td></td><td>[ ].message</td><td>Text</td><td>Description of the 4D error</td></tr><tr><td></td><td>[ ].componentSignature</td><td>Text</td><td>Signature of the internal component which returned theerror</td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_checkconnectiondelay"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_checkconnectiondelay"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.checkConnectionDelay</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.checkConnectionDelay</strong> : Integer</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-7"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.checkConnectionDelay</code> property contains themaximum time (in seconds) allowed prior to checking the connectionto the server. If this time is exceeded between two method calls,the connection to the server will be checked. By default, if theproperty has not been set in the <em>server</em> object, the valueis 300.</p><blockquote><p><strong>Warning</strong>: Make sure the defined timeout is lowerthan the server timeout, otherwise the client timeout will beuseless.</p></blockquote><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_connectiontimeout"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_connectiontimeout"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.connectionTimeOut</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R5</td><td>Added</td></tr></tbody></table></details><p><strong>.connectionTimeOut</strong> : Integer</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-8"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.connectionTimeOut</code> property contains themaximum wait time (in seconds) allowed to establish a connection tothe server. By default, if the property has not been set in theserver object (used to create the transporter object with<code>SMTP New transporter</code>, <code>POP3 Newtransporter</code>, or <code>IMAP New transporter</code>), thevalue is 30.</p><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_copy"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_copy"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.copy()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R5</td><td>Added</td></tr></tbody></table></details><p><strong>.copy</strong>( <em>msgsIDs</em> : Collection ;<em>destinationBox</em> : Text ) : Object<br /><strong>.copy</strong>( <em>allMsgs</em> : Integer ;<em>destinationBox</em> : Text ) : Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection of message unique IDs (strings)</td></tr><tr><td>allMsgs</td><td>Ganzzahl</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code>: All messages in the selectedmailbox</td></tr><tr><td>destinationBox</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Mailbox to receive copied messages</td></tr><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td>Status of the copy operation</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-9"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.copy()</code> function copies the messages defined by<em>msgsIDs</em> or <em>allMsgs</em> to the <em>destinationBox</em>on the IMAP server.</p><p>You can pass:</p><ul><li>in the <em>msgsIDs</em> parameter, a collection containing theunique IDs of the specific messages to copy, or</li><li>in the <em>allMsgs</em> parameter, the <code>IMAP all</code>constant (integer) to copy all messages in the selectedmailbox.</li></ul><p>The <em>destinationBox</em> parameter allows you to pass a textvalue with the name of the mailbox where the copies of messageswill be placed.</p><p><strong>Returned object</strong></p><p>The function returns an object describing the IMAP status:</p><table><thead><tr><th>Property</th><th></th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>True if the operation is successful, False otherwise</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Status message returned by the IMAP server, or last errorreturned in the 4D error stack</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>4D error stack (not returned if a IMAP server response isreceived)</td></tr><tr><td></td><td>[].errcode</td><td>Zahl</td><td>4D error code</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description of the 4D error</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature of the internal component which returned theerror</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-1-1"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-1-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel 1</h4><p>To copy a selection of messages:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//select mailbox</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)  <span class="hljs-comment">//get collection of message unique IDs</span> <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"4D new feature:\""</span>)  <span class="hljs-comment">// copy found messages to the "documents" mailbox</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">copy</span>(<span class="hljs-variable">$mailIds</span>;<span class="hljs-string">"documents"</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-2-1"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-2-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel 2</h4><p>To copy all messages in the current mailbox:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//select mailbox</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)  <span class="hljs-comment">// copy all messages to the "documents" mailbox</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">copy</span>(IMAP all;<span class="hljs-string">"documents"</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_createbox"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_createbox"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.createBox()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v19</td><td>Added</td></tr></tbody></table></details><p><strong>.createBox</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Name of the new mailbox</td></tr><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td>Status of the mailbox creation operation</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-10"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-10"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.createBox()</code> function creates a mailbox withthe given <code>name</code>. If the IMAP server’s hierarchyseparator character appears elsewhere in the mailbox name, the IMAPserver will create any parent names needed to create the givenmailbox.</p><p>In other words, an attempt to create "Projects/IMAP/Doc" on aserver in which "/" is the hierarchy separator character willcreate:</p><ul><li>Only the "Doc" mailbox if "Projects" &amp; "IMAP" alreadyexist.</li><li>"IMAP" &amp; "Doc" mailboxes if only “Projects” alreadyexists.</li><li>"Projects" &amp; “IMAP” &amp; "Doc" mailboxes, if they do notalready exist.</li></ul><p>In the <code>name</code> parameter, pass the name of the newmailbox.</p><p><strong>Returned object</strong></p><p>The function returns an object describing the IMAP status:</p><table><thead><tr><th>Property</th><th></th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>True if the operation is successful, False otherwise</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Status message returned by the IMAP server, or last errorreturned in the 4D error stack</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>4D error stack (not returned if a IMAP server response isreceived)</td></tr><tr><td></td><td>[].errcode</td><td>Zahl</td><td>4D error code</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description of the 4D error</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature of the internal component which returned theerror</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-3"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><p>To create a new “Invoices” mailbox:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw </span>: text<span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">If</span>(OK=<span class="hljs-number">1</span>)<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">createBox</span>(<span class="hljs-string">"Invoices"</span>)<span class="hljs-keyword">If</span> (<span class="hljs-variable">$status</span>.success)<span class="hljs-function">ALERT</span>(<span class="hljs-string">"Mailbox creation successful!"</span>)<span class="hljs-keyword">Else</span><span class="hljs-function">ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">End if</span><span class="hljs-keyword">End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_delete"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_delete"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.delete()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R5</td><td>Added</td></tr></tbody></table></details><p><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) :Object<br /><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection of message unique IDs (strings)</td></tr><tr><td>allMsgs</td><td>Ganzzahl</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code>: All messages in the selectedmailbox</td></tr><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td>Status of the delete operation</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-11"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-11"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.delete()</code> function sets the "deleted" flag forthe messages defined in <code>msgsIDs</code> or<code>allMsgs</code>.</p><p>You can pass:</p><ul><li>in the <code>msgsIDs</code> parameter, a collection containingthe unique IDs of the specific messages to delete, or</li><li>in the <code>allMsgs</code> parameter, the <code>IMAPall</code> constant (integer) to delete all messages in theselected mailbox.</li></ul><p>Executing this function does not actually remove messages.Messages with the "delete" flag can still be found by the <a href="#IMAPTransporterClass.html_searchmails">.searchMails()</a>function. Flagged messages are deleted from the IMAP server withthe <a href="#IMAPTransporterClass.html_expunge"><code>.expunge()</code></a>function or by selecting another mailbox or when the <a href="#IMAPTransporterClass.html_imap-transporter-object">transporterobject</a> (created with <a href="#IMAPTransporterClass.html_imap-new-transporter">IMAP Newtransporter</a>) is destroyed.</p><p><strong>Returned object</strong></p><p>The function returns an object describing the IMAP status:</p><table><thead><tr><th>Property</th><th></th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>True if the operation is successful, False otherwise</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Status message returned by the IMAP server, or last errorreturned in the 4D error stack</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>4D error stack (not returned if a IMAP server response isreceived)</td></tr><tr><td></td><td>[].errcode</td><td>Zahl</td><td>4D error code</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description of the 4D error</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature of the internal component which returned theerror</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-1-2"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-1-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel 1</h4><p>To delete a selection of messages:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//select mailbox</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)  <span class="hljs-comment">//get collection of message unique IDs</span> <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"Reports\""</span>)  <span class="hljs-comment">// Delete selected messages</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$mailIds</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-2-2"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-2-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel 2</h4><p>To delete all messages in the current mailbox:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//select mailbox</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Junk Email"</span>)  <span class="hljs-comment">// delete all messages in the current mailbox</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(IMAP all)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_deletebox"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_deletebox"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.deleteBox()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v19</td><td>Added</td></tr></tbody></table></details><p><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Name of the mailbox to delete</td></tr></tbody></table><p>|Result|Object|&lt;-|Status of the mailbox deletionoperation|</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-12"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-12"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.deleteBox()</code> function permanently removes themailbox with the given <code>name</code> from the IMAP server.Attempting to delete an INBOX or a mailbox that does not exist willgenerate an error.</p><p>In the <code>name</code> parameter, pass the name of the mailboxto delete.</p><blockquote><ul><li>The function cannot delete a mailbox that has child mailboxesif the parent mailbox has the "\Noselect" attribute.</li><li>All messages in the deleted mailbox will also be deleted.</li><li>The ability to delete a mailbox depends on the mailserver.</li></ul></blockquote><p><strong>Returned object</strong></p><p>The function returns an object describing the IMAP status:</p><table><thead><tr><th>Property</th><th></th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>True if the operation is successful, False otherwise</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Status message returned by the IMAP server, or last errorreturned in the 4D error stack</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>4D error stack (not returned if a IMAP server response isreceived)</td></tr><tr><td></td><td>[].errcode</td><td>Zahl</td><td>4D error code</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description of the 4D error</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature of the internal component which returned theerror</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-4"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><p>To delete the "Nova Orion Industries" child mailbox from the"Bills" mailbox hierarchy:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-comment">// delete mailbox</span><span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Nova Orion Industries"</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">deleteBox</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">If</span> (<span class="hljs-variable">$status</span>.success)<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Mailbox deletion successful!"</span>)<span class="hljs-keyword">    Else</span><span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">    End if</span><span class="hljs-keyword">End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_expunge"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_expunge"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.expunge()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R6</td><td>Added</td></tr></tbody></table></details><p><strong>.expunge()</strong> : Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td>Status of the expunge operation</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-13"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-13"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.expunge()</code> function removes all messages withthe "deleted" flag from the IMAP mail server. The "deleted" flagcan be set with the <a href="#IMAPTransporterClass.html_delete"><code>.delete()</code></a> or<a href="#IMAPTransporterClass.html_addflags"><code>.addFlags()</code></a>methods.</p><p><strong>Returned object</strong></p><p>The function returns an object describing the IMAP status:</p><table><thead><tr><th>Property</th><th></th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>True if the operation is successful, False otherwise</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Status message returned by the IMAP server, or last errorreturned in the 4D error stack</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>4D error stack (not returned if a IMAP server response isreceived)</td></tr><tr><td></td><td>[].errcode</td><td>Zahl</td><td>4D error code</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description of the 4D error</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature of the internal component which returned theerror</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-5"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">var</span> <span class="hljs-variable">$ids </span>: Collection<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span><span class="hljs-comment">// Create transporter</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-comment">// Select mailbox</span><span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-comment">// Find and delete all seen messages in INBOX</span><span class="hljs-variable">$ids</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"SEEN"</span>)<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$ids</span>)<span class="hljs-comment">// Purge all messages flagged as deleted</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">expunge</span>()</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getboxinfo"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getboxinfo"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getBoxInfo()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R5</td><td><em>name</em> is optional</td></tr></tbody></table><p>|v18 R4|Added|</p></details><p><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) :Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Name of the mailbox</td></tr><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td>boxInfo object</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-14"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-14"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.getBoxInfo()</code> function returns a<code>boxInfo</code> object corresponding to the current maibox, orthe mailbox <em>name</em>. This function returns the sameinformation as <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>without changing the current mailbox.</p><p>In the optional <em>name</em> parameter, pass the name of themailbox to access. The name represents an unambiguous left-to-righthierarchy with levels separated by a specific delimiter character.The delimiter can be found with the <a href="#IMAPTransporterClass.html_getdelimiter"><code>.getDelimiter()</code></a>function.</p><p>If the mailbox <em>name</em> is not selectable or does notexist, the function generates an error and returns<strong>null</strong>.</p><p><strong>Returned object</strong></p><p>The <code>boxInfo</code> object returned contains the followingproperties:</p><table><thead><tr><th>Property</th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td>Name of the mailbox</td></tr><tr><td>mailCount</td><td>number</td><td>Number of messages in the mailbox</td></tr><tr><td>mailRecent</td><td>number</td><td>Number of messages with the "recent" flag (indicating newmessages)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-6"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>) <span class="hljs-variable">$info</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxInfo</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-function"> ALERT</span>(<span class="hljs-string">"INBOX contains "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$info</span>.mailRecent)+<span class="hljs-string">" recent emails."</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getboxlist"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getboxlist"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getBoxList()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R4</td><td>Added</td></tr><tr><td>v19</td><td>Add <code>isSubscribed</code> parameter</td></tr></tbody></table></details><p><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ): Collection</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>parameters</td><td>Objekt</td><td style="text-align:center">-&gt;</td><td>Parameter object</td></tr><tr><td>Ergebnis</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Collection of mailbox objects</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-15"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-15"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.getBoxList()</code> function returns a collection ofmailboxes describing all of the available mailboxes. This functionallows you to locally manage the list of messages located on theIMAP mail server.</p><p>In the optional <code>parameters</code> parameter, pass anobject containing values to filter the returned mailboxes. You canpass:</p><table><thead><tr><th>Property</th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>isSubscribed</td><td>Boolean</td><td><ul><li><strong>True</strong> to return only subscribed mailboxes</li><li><strong>False</strong> to return all available mailboxes</li></ul></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ergebnis-1"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ergebnis-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><p>Each object of the returned collection contains the followingproperties:</p><table><thead><tr><th>Property</th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>[].name</td><td>Text</td><td>Name of the mailbox</td></tr><tr><td>[].selectable</td><td>Boolean</td><td>Indicates whether or not the access rights allow the mailbox tobe selected:<ul><li>true - the mailbox can be selected</li><li>false - the mailbox can not be selected</li></ul></td></tr><tr><td>[].inferior</td><td>Boolean</td><td>Indicates whether or not the access rights allow creating alower hierachy in the mailbox:<ul><li>true - a lower level can be created</li><li>false - a lower level can not be created</li></ul></td></tr><tr><td>[].interesting</td><td>Boolean</td><td>Indicates if the mailbox has been marked "interesting" by theserver:<ul><li>true - The mailbox has been marked "interesting" by the server.For example, it may contain new messages.</li><li>false - The mailbox has not been marked "interesting" by theserver.</li></ul></td></tr></tbody></table><p>If the account does not contain any mailboxes, an emptycollection is returned.</p><blockquote><ul><li>If there is no open connection, <code>.getBoxList()</code> willopen a connection.</li><li>If the connection has not been used since the designatedconnection delay (see <code>IMAP New transporter</code>), the<code>.checkConnection( )</code> function is automaticallycalled.</li></ul></blockquote><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-7"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>) <span class="hljs-variable">$boxList</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxList</span>()<span class="hljs-keyword"> For each</span>(<span class="hljs-variable">$box</span>;<span class="hljs-variable">$boxList</span>)<span class="hljs-keyword">    If</span>(<span class="hljs-variable">$box</span>.interesting)       <span class="hljs-variable">$split</span>:=<span class="hljs-function">Split string</span>(<span class="hljs-variable">$box</span>.name;<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>())<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"New emails are available in the box: "</span>+<span class="hljs-variable">$split</span>[<span class="hljs-variable">$split</span>.length<span class="hljs-number">-1</span>])<span class="hljs-keyword">    End if</span><span class="hljs-keyword"> End for each</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getdelimiter"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getdelimiter"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getDelimiter()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.getDelimiter()</strong> : Text</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>Ergebnis</td><td>Text</td><td style="text-align:center">&lt;-</td><td>Hierarchy delimiter character</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-16"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-16"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.getDelimiter()</code> function returns the characterused to delimit levels of hierarchy in the mailbox name.</p><p>The delimiter is a character which can be used to:</p><ul><li>create lower level (inferior) mailboxes</li><li>search higher or lower within the mailbox hierarchy</li></ul><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ergebnis-2"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ergebnis-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><p>Mailbox name delimiter character.</p><blockquote><ul><li>If there is no open connection, <code>.getDelimiter()</code>will open a connection.</li><li>If the connection has not been used since the <a href="#IMAPTransporterClass.html_checkconnectiondelay">designatedconnection delay</a>, the <a href="#IMAPTransporterClass.html_checkconnection"><code>.checkConnection()</code></a>function is automatically called.</li></ul></blockquote><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-8"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>) <span class="hljs-variable">$boxList</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxList</span>()<span class="hljs-keyword"> For each</span>(<span class="hljs-variable">$box</span>;<span class="hljs-variable">$boxList</span>)<span class="hljs-keyword">    If</span>(<span class="hljs-variable">$box</span>.interesting)       <span class="hljs-variable">$split</span>:=<span class="hljs-function">Split string</span>(<span class="hljs-variable">$box</span>.name;<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>())<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"New emails are available in the box: "</span>+<span class="hljs-variable">$split</span>[<span class="hljs-variable">$split</span>.length<span class="hljs-number">-1</span>])<span class="hljs-keyword">    End if</span><span class="hljs-keyword"> End for each</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getmail"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getmail"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getMail()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ;<em>options</em> : Object } ) : Object<br /><strong>.getMail</strong>( <em>msgID</em>: Text { ;<em>options</em> : Object } ) : Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>msgNumber</td><td>Ganzzahl</td><td style="text-align:center">-&gt;</td><td>Sequence number of the message</td></tr><tr><td>msgID</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Unique ID of the message</td></tr><tr><td>options</td><td>Objekt</td><td style="text-align:center">-&gt;</td><td>Message handling instructions</td></tr><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td><a href="#IMAPTransporterClass.html_email-object">Emailobject</a></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-17"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-17"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.getMail()</code> function returns the<code>Email</code> object corresponding to the <em>msgNumber</em>or <em>msgID</em> in the mailbox designated by the<code>IMAP_transporter</code>. This function allows you to locallyhandle the email contents.</p><p>In the first parameter, you can pass either:</p><ul><li><em>msgNumber</em>, an <em>integer</em> value indicating thesequence number of the message to retrieve or</li><li><em>msgID</em>, a <em>text</em> value indicating the unique IDof the message to retrieve.</li></ul><p>The optional <em>options</em> parameter allows you pass anobject defining additional instructions for handling the message.The following properties are available:</p><table><thead><tr><th>Property</th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>updateSeen</td><td>Boolean</td><td>If True, the message is marked as "seen" in the mailbox. IfFalse, the message is not marked as "seen". Default value:True</td></tr><tr><td>withBody</td><td>Boolean</td><td>Pass True to return the body of the message. If False, only themessage header is returned. Default value: True</td></tr></tbody></table><blockquote><ul><li>The function generates an error and returns<strong>Null</strong> if <em>msgID</em> designates a non-existingmessage,</li><li>If no mailbox is selected with the <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>function, an error is generated,</li><li>If there is no open connection, <code>.getMail()</code> willopen a connection the last mailbox specified with <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>`.</li></ul></blockquote><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ergebnis-3"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ergebnis-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><p><code>.getMail()</code> returns an <a href="#IMAPTransporterClass.html_email-object"><code>Email</code>object</a> with the following specific IMAP properties:<em>id</em>, <em>receivedAt</em>, and <em>size</em>.</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-9"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><p>You want to get the message with ID = 1:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$info</span>; <span class="hljs-variable">$mail</span>; <span class="hljs-variable">$boxInfo </span>: Variant<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>  <span class="hljs-comment">//create transporter</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//select mailbox</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)  <span class="hljs-comment">//get Email object with ID 1</span> <span class="hljs-variable">$mail</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMail</span>(<span class="hljs-number">1</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getmails"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getmails"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getMails()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R5</td><td>Added</td></tr></tbody></table></details><p><strong>.getMails</strong>( <em>ids</em> : Collection { ;<em>options</em> : Object } ) : Object<br /><strong>.getMails</strong>( <em>startMsg</em> : Integer ;<em>endMsg</em> : Integer { ; <em>options</em> : Object } ) :Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>ids</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection of message ID</td></tr><tr><td>startMsg</td><td>Ganzzahl</td><td style="text-align:center">-&gt;</td><td>Sequence number of the first message</td></tr><tr><td>endMsg</td><td>Ganzzahl</td><td style="text-align:center">-&gt;</td><td>Sequence number of the last message</td></tr><tr><td>options</td><td>Objekt</td><td style="text-align:center">-&gt;</td><td>Message handling instructions</td></tr><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td>Object containing:<br /><ul><li>a collection of <a href="#IMAPTransporterClass.html_email-object">Email objects</a>and</li><li>a collection of IDs or numbers for missing messages, ifany</li></ul></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-18"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-18"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.getMails()</code> function returns an objectcontaining a collection of <code>Email</code> objects.</p><p><strong>First Syntax:</strong></p><p><strong><em>.getMails( ids { ; options } ) -&gt;result</em></strong></p><p>The first syntax allows you to retrieve messages based on theirIDs.</p><p>In the <em>ids</em> parameter, pass a collection of IDs for themessages to return. You can get the IDs with <a href="#IMAPTransporterClass.html_getmail"><code>.getMail()</code></a>.</p><p>The optional <em>options</em> parameter allows you to define theparts of the messages to be returned. See the<strong>Options</strong> table below for a description of theavailable properties.</p><p><strong>Second syntax:</strong></p><p><strong><em>.getMails( startMsg ; endMsg { ; options } ) -&gt;result</em></strong></p><p>The second syntax allows you to retrieve messages based on asequential range. The values passed represent the position of themessages in the mailbox.</p><p>In the <em>startMsg</em> parameter, pass an <em>integer</em>value corresponding to the number of the first message in asequential range. If you pass a negative number (<em>startMsg</em>&lt;= 0), the first message of the mailbox will be used as thebeginning of the sequence.</p><p>In the <em>endMsg</em> parameter, pass an <em>integer</em> valuecorresponding to the number of the last message to be included in asequential range. If you pass a negative number (<em>endMsg</em>&lt;= 0), the last message of the mailbox will be used as the endof the sequence.</p><p>The optional <em>options</em> parameter allows you to define theparts of the messages to be returned.</p><p><strong>Options</strong></p><table><thead><tr><th>Property</th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>updateSeen</td><td>Boolean</td><td>If True, the specified messages are marked as "seen" in themailbox. If False, the messages are not marked as "seen". Defaultvalue: True</td></tr><tr><td>withBody</td><td>Boolean</td><td>Pass True to return the body of the specified messages. IfFalse, only the message headers are returned. Default value:True</td></tr></tbody></table><blockquote><ul><li>If no mailbox is selected with the <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>command, an error is generated.</li><li>If there is no open connection, <code>.getMails()</code> willopen a connection the last mailbox specified with <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>.</li></ul></blockquote><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ergebnis-4"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ergebnis-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><p><code>.getMails()</code> returns an object containing thefollowing collections:</p><table><thead><tr><th>Property</th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>list</td><td>Collection</td><td>Collection of <a href="#IMAPTransporterClass.html_email-object"><code>Email</code>objects</a>. If no Email objects are found, an empty collection isreturned.</td></tr><tr><td>notFound</td><td>Collection</td><td>Collection of:<br /><ul><li>first syntax - previously passed message IDs that do notexist</li><li>second syntax - sequence numbers of messages between startMsgand endMsg that do not exist</li></ul>An empty collection is returned if all messages are found.</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-10"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-10"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><p>You want to retrieve the 20 most recent emails without changingtheir "seen" status:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>,<span class="hljs-variable">$boxInfo</span>,<span class="hljs-variable">$result </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>  <span class="hljs-comment">//create transporter</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//select mailbox</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-keyword">  If</span>(<span class="hljs-variable">$boxInfo</span>.mailCount&gt;<span class="hljs-number">0</span>)        <span class="hljs-comment">// retrieve the headers of the last 20 messages without marking them as read</span>    <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMails</span>(<span class="hljs-variable">$boxInfo</span>.mailCount<span class="hljs-number">-20</span>;<span class="hljs-variable">$boxInfo</span>.mailCount;\<span class="hljs-function">        New object</span>(<span class="hljs-string">"withBody"</span>;<span class="hljs-literal">False</span>;<span class="hljs-string">"updateSeen"</span>;<span class="hljs-literal">False</span>))<span class="hljs-keyword">    For each</span>(<span class="hljs-variable">$mail</span>;<span class="hljs-variable">$result</span>.list)        <span class="hljs-comment">// ...</span><span class="hljs-keyword">    End for each</span><span class="hljs-keyword"> End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getmimeasblob"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getmimeasblob"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getMIMEAsBlob()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer {; <em>updateSeen</em> : Boolean } ) : Blob<br /><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ;<em>updateSeen</em> : Boolean } ) : Blob</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>msgNumber</td><td>Ganzzahl</td><td style="text-align:center">-&gt;</td><td>Sequence number of the message</td></tr><tr><td>msgID</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Unique ID of the message</td></tr><tr><td>updateSeen</td><td>Boolean</td><td style="text-align:center">-&gt;</td><td>If True, the message is marked "seen" in the mailbox. If Falsethe message is left untouched.</td></tr><tr><td>Ergebnis</td><td>BLOB</td><td style="text-align:center">&lt;-</td><td>Blob of the MIME string returned from the mail server</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-19"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-19"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.getMIMEAsBlob()</code> function returns a BLOBcontaining the MIME contents for the message corresponding to the<em>msgNumber</em> or <em>msgID</em> in the mailbox designated bythe <code>IMAP_transporter</code>.</p><p>In the first parameter, you can pass either:</p><ul><li><em>msgNumber</em>, an <em>integer</em> value indicating thesequence number of the message to retrieve or</li><li><em>msgID</em>, a <em>text</em> value indicating the unique IDof the message to retrieve.</li></ul><p>The optional <em>updateSeen</em> parameter allows you to specifyif the message is marked as "seen" in the mailbox. You canpass:</p><ul><li><strong>True</strong> - to mark the message as "seen"(indicating the message has been read)</li><li><strong>False</strong> - to leave the message's "seen" statusuntouched &gt; * The function returns an empty BLOB if<em>msgNumber</em> or msgID* designates a non-existing message,&gt; * If no mailbox is selected with the <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>command, an error is generated, &gt; * If there is no openconnection, <code>.getMIMEAsBlob()</code> will open a connectionthe last mailbox specified with <code>.selectBox()</code>.</li></ul><blockquote><ul><li>The function returns an empty BLOB if <em>msgNumber</em> ormsgID* designates a non-existing message,</li><li>If no mailbox is selected with the <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>command, an error is generated,</li><li>If there is no open connection, <code>.getMIMEAsBlob()</code>will open a connection the last mailbox specified with<code>.selectBox()</code>.</li></ul></blockquote><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ergebnis-5"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ergebnis-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><p><code>.getMIMEAsBlob()</code> returns a <code>BLOB</code> whichcan be archived in a database or converted to an <a href="#IMAPTransporterClass.html_email-object"><code>Email</code>object</a> with the <code>MAIL Convert from MIME</code>command.</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-11"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-11"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$boxInfo </span>: Variant<span class="hljs-keyword"> var</span> <span class="hljs-variable">$blob </span>: Blob<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>  <span class="hljs-comment">//create transporter</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//select mailbox</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)  <span class="hljs-comment">//get BLOB</span> <span class="hljs-variable">$blob</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMIMEAsBlob</span>(<span class="hljs-number">1</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_host"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_host"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.host</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R5</td><td>Added</td></tr></tbody></table></details><p><strong>.host</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-20"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-20"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.host</code> property contains the name or the IPaddress of the host server. Used for mail transactions (SMTP, POP3,IMAP).</p><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_logfile"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_logfile"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.logFile</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R5</td><td>Added</td></tr></tbody></table></details><p><strong>.logFile</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-21"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-21"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.logFile</code> property contains the path of theextended log file defined (if any) for the mail connection. It canbe relative (to the current Logs folder) or absolute.</p><p>Unlike regular log files (enabled via the <code>SET DATABASEPARAMETER</code> command), extended log files store MIME contentsof all sent mails and do not have any size limit. For moreinformation about extended log files, refer to:</p><ul><li><strong>SMTP connections</strong> - <a href="#IMAPTransporterClass.html_4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DSMTPLog.txt</a></li><li><strong>POP3 connections</strong> - <a href="#IMAPTransporterClass.html_4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DPOP3Log.txt</a></li><li><strong>IMAP connections</strong> - <a href="#IMAPTransporterClass.html_4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DIMAPLog.txt</a></li></ul><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_move"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_move"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.move()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R5</td><td>Added</td></tr></tbody></table></details><p><strong>.move</strong>( <em>msgsIDs</em> : Collection ;<em>destinationBox</em> : Text ) : Object<br /><strong>.move</strong>( <em>allMsgs</em> : Integer ;<em>destinationBox</em> : Text ) : Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection of message unique IDs (strings)</td></tr><tr><td>allMsgs</td><td>Ganzzahl</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code>: All messages in the selectedmailbox</td></tr><tr><td>destinationBox</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Mailbox to receive moved messages</td></tr><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td>Status of the move operation</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-22"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-22"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.move()</code> function moves the messages defined by<em>msgsIDs</em> or <em>allMsgs</em> to the <em>destinationBox</em>on the IMAP server.</p><p>You can pass:</p><ul><li>in the <em>msgsIDs</em> parameter, a collection containing theunique IDs of the specific messages to move, or</li><li>in the <em>allMsgs</em> parameter, the <code>IMAP all</code>constant (integer) to move all messages in the selectedmailbox.</li></ul><p>The <em>destinationBox</em> parameter allows you to pass a textvalue with the name of the mailbox where the messages will bemoved.</p><blockquote><p>This function is only supported by IMAP servers compliant withRFC <a href="https://tools.ietf.org/html/rfc8474">8474</a>.</p></blockquote><p><strong>Returned object</strong></p><p>The function returns an object describing the IMAP status:</p><table><thead><tr><th>Property</th><th></th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>True if the operation is successful, False otherwise</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Status message returned by the IMAP server, or last errorreturned in the 4D error stack</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>4D error stack (not returned if a IMAP server response isreceived)</td></tr><tr><td></td><td>[].errcode</td><td>Zahl</td><td>4D error code</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description of the 4D error</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature of the internal component which returned theerror</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-1-3"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-1-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel 1</h4><p>To move a selection of messages:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//select mailbox</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)  <span class="hljs-comment">//get collection of message unique IDs</span> <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"4D new feature:\""</span>)  <span class="hljs-comment">// Move found messages from the current mailbox to the "documents" mailbox</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">move</span>(<span class="hljs-variable">$mailIds</span>;<span class="hljs-string">"documents"</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-2-3"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-2-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel 2</h4><p>To move all messages in the current mailbox:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//select mailbox</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)  <span class="hljs-comment">// move all messages in the current mailbox to the "documents" mailbox</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">move</span>(IMAP all;<span class="hljs-string">"documents"</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_numtoid"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_numtoid"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.numToID()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R5</td><td>Added</td></tr></tbody></table></details><p><strong>.numToID</strong>( <em>startMsg</em> : Integer ;<em>endMsg</em> : Integer ) : Collection</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>startMsg</td><td>Ganzzahl</td><td style="text-align:center">-&gt;</td><td>Sequence number of the first message</td></tr><tr><td>endMsg</td><td>Ganzzahl</td><td style="text-align:center">-&gt;</td><td>Sequence number of the last message</td></tr><tr><td>Ergebnis</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Collection of unique IDs</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-23"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-23"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.numToID()</code> function converts the sequencenumbers to IMAP unique IDs for the messages in the sequential rangedesignated by <em>startMsg</em> and <em>endMsg</em> in thecurrently selected mailbox.</p><p>In the <em>startMsg</em> parameter, pass an integer valuecorresponding to the number of the first message in a sequentialrange. If you pass a negative number (<em>startMsg</em> &lt;= 0),the first message of the mailbox will be used as the beginning ofthe sequence.</p><p>In the <em>endMsg</em> parameter, pass an integer valuecorresponding to the number of the last message to be included in asequential range. If you pass a negative number (<em>endMsg</em>&lt;= 0), the last message of the mailbox will be used as the endof the sequence.</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ergebnis-6"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ergebnis-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ergebnis</h4><p>The function returns a collection of strings (unique IDs).</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-12"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-12"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter<span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$mailIds </span>: Collection <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//select mailbox</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)  <span class="hljs-comment">//get IDs for 5 last messages received</span> <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">numToID</span>((<span class="hljs-variable">$boxInfo</span>.mailCount<span class="hljs-number">-5</span>);<span class="hljs-variable">$boxInfo</span>.mailCount)  <span class="hljs-comment">//delete the messages from the current mailbox</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$mailIds</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_removeflags"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_removeflags"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.removeFlags()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R6</td><td>Added</td></tr></tbody></table></details><p><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ;<em>keywords</em> : Object ) : Object<br /><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ;<em>keywords</em> : Object ) : Object<br /><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ;<em>keywords</em> : Object ) : Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>msgIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection of strings: Message unique IDs (text)<br />Text: Unique ID of a message<br />Longint (IMAP all): All messages in the selected mailbox</td></tr><tr><td>keywords</td><td>Objekt</td><td style="text-align:center">-&gt;</td><td>Keyword flags to remove</td></tr><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td>Status of the removeFlags operation</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-24"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-24"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.removeFlags()</code> function removes flags from the<code>msgIDs</code> for the specified <code>keywords</code>.</p><p>In the <code>msgIDs</code> parameter, you can pass either:</p><ul><li><p>a <em>collection</em> containing the unique IDs of specificmessages or</p></li><li><p>the unique ID (<em>text</em>) of a single message or</p></li><li><p>the following constant (<em>longint</em>) for all messages inthe selected mailbox:</p><table><thead><tr><th>Constant</th><th>Wert</th><th>Kommentar</th></tr></thead><tbody><tr><td>IMAP all</td><td>1</td><td>Select all messages in the selected mailbox</td></tr></tbody></table></li></ul><p>The <code>keywords</code> parameter lets you pass an object withkeyword values for specific flags to remove from<code>msgIDs</code>. You can pass any of the followingkeywords:</p><table><thead><tr><th>Parameter</th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>$draft</td><td>Boolean</td><td>True to remove the "draft" flag from the message</td></tr><tr><td>$seen</td><td>Boolean</td><td>True to remove the "seen" flag from the message</td></tr><tr><td>$flagged</td><td>Boolean</td><td>True to remove the "flagged" flag from the message</td></tr><tr><td>$answered</td><td>Boolean</td><td>True to remove the "answered" flag from the message</td></tr><tr><td>$deleted</td><td>Boolean</td><td>True to remove the "deleted" flag from the message</td></tr></tbody></table><p>Note that False values are ignored.</p><p><strong>Returned object</strong></p><p>The function returns an object describing the IMAP status:</p><table><thead><tr><th>Property</th><th></th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>True if the operation is successful, False otherwise</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Status message returned by the IMAP server, or last errorreturned in the 4D error stack</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>4D error stack (not returned if a IMAP server response isreceived)</td></tr><tr><td></td><td>[].errcode</td><td>Zahl</td><td>4D error code</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description of the 4D error</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature of the internal component which returned theerror</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-13"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-13"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span><span class="hljs-comment">// Create transporter</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-comment">// Select mailbox</span><span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-comment">// Mark all messages from INBOX as unseen</span><span class="hljs-variable">$flags</span>:=New object<span class="hljs-variable">$flags</span>[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">removeFlags</span>(IMAP all;<span class="hljs-variable">$flags</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_renamebox"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_renamebox"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.renameBox()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v19</td><td>Added</td></tr></tbody></table></details><p><strong>.renameBox</strong>( <em>currentName</em> : Text ;<em>newName</em> : Text ) : Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>currentName</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Name of the current mailbox</td></tr><tr><td>newName</td><td>Text</td><td style="text-align:center">-&gt;</td><td>New mailbox name</td></tr><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td>Status of the renaming operation</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-25"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-25"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.renameBox()</code> function changes the name of amailbox on the IMAP server. Attempting to rename a mailbox from amailbox name that does not exist or to a mailbox name that alreadyexists will generate an error.</p><p>In the <code>currentName</code> parameter, pass the name of themailbox to be renamed.</p><p>Pass the new name for the mailbox in the <code>newName</code>parameter.</p><p><strong>Returned object</strong></p><p>The function returns an object describing the IMAP status:</p><table><thead><tr><th>Property</th><th></th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>True if the operation is successful, False otherwise</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Status message returned by the IMAP server, or last errorreturned in the 4D error stack</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>4D error stack (not returned if a IMAP server response isreceived)</td></tr><tr><td></td><td>[].errcode</td><td>Zahl</td><td>4D error code</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description of the 4D error</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature of the internal component which returned theerror</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-14"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-14"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><p>To to rename your “Invoices” mailbox to “Bills”:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw </span>: text<span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-comment">// rename mailbox</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">renameBox</span>(<span class="hljs-string">"Invoices"</span>; <span class="hljs-string">"Bills"</span>)<span class="hljs-keyword">If</span> (<span class="hljs-variable">$status</span>.success)<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox renaming successful!"</span>)<span class="hljs-keyword">   Else</span><span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End if</span><span class="hljs-keyword">End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_port"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_port"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.port</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.port</strong> : Integer</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-26"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-26"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.port</code> property contains the port number usedfor mail transactions. By default, if the <em>port</em> propertyhas not been set in the <em>server</em> object (used to create thetransporter object with <code>SMTP New transporter</code>,<code>POP3 New transporter</code>, <code>IMAP Newtransporter</code>), the port used is:</p><ul><li><strong>SMTP</strong> - 587</li><li><strong>POP3</strong> - 995</li><li><strong>IMAP</strong> - 993</li></ul><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_searchmails"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_searchmails"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.searchMails()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R5</td><td>Added</td></tr></tbody></table></details><p><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ): Collection</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>searchCriteria</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Search criteria</td></tr><tr><td>Ergebnis</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Collection of message numbers</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-27"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-27"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><blockquote><p>This function is based upon the specification for the <a href="https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol">IMAPprotocol</a>.</p></blockquote><p>The <code>.searchMails()</code> function searches for messagesthat match the given <em>searchCriteria</em> in the currentmailbox. <em>searchCriteria</em> consists of one or more searchkeys.</p><p><em>searchCriteria</em> is a text parameter listing one or moresearch keys (see <a href="#IMAPTransporterClass.html_authorized-search-keys">Authorizedsearch-keys</a> below) associated or not with values to look for. Asearch key may be a single or multiple items. Beispiel:</p><pre><code class="hljs"><span class="hljs-attr">SearchKey1</span> = FLAGGED<span class="hljs-attr">SearchKey2</span> = NOT FLAGGED<span class="hljs-attr">SearchKey3</span> = FLAGGED DRAFT</code></pre><blockquote><p>Matching is usually not case-sensitive</p></blockquote><ul><li>If the <em>searchCriteria</em> is a null string, the searchwill be equivalent to a “select all”.</li><li>If the <em>searchCriteria</em> includes multiple search keys,the result is the intersection (AND function) of all the messagesthat match those keys.</li></ul><pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = FLAGGED FROM <span class="hljs-string">"SMITH"</span></code></pre><p>... returns all messages with \Flagged flag set AND sent bySmith.</p><ul><li>You can use the <strong>OR</strong> or <strong>NOT</strong>operators as follows:</li></ul><pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = OR SEEN FLAGGED</code></pre><p>... returns all messages with \Seen flag set OR \Flagged flagset</p><pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = NOT SEEN</code></pre><p>... returns all messages with \Seen flag not set.</p><pre><code class="hljs">searchCriteria = <span class="hljs-keyword">HEADER</span> CONTENT<span class="hljs-params">-TYPE</span> <span class="hljs-string">"MIXED"</span> <span class="hljs-literal">NOT</span> <span class="hljs-keyword">HEADER</span> CONTENT<span class="hljs-params">-TYPE</span> <span class="hljs-string">"TEXT"</span><span class="hljs-params">...</span></code></pre><p>... returns message whose content-type header contains “Mixed”and does not contain “Text”.</p><pre><code class="hljs">searchCriteria = <span class="hljs-keyword">HEADER</span> CONTENT-<span class="hljs-keyword">TYPE</span> "E" <span class="hljs-keyword">NOT</span> SUBJECT "o" <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">HEADER</span> CONTENT-<span class="hljs-keyword">TYPE</span> "MIXED"</code></pre><p>... returns message whose content-type header contains “ e ” andwhose Subject header does not contain “ o ” and whose content-typeheader is not “ Mixed ”.</p><p>As concerns the last two examples, notice that the result of thesearch is different when you remove the parentheses of the firstsearch key list.</p><ul><li>The <em>searchCriteria</em> may include the optional [CHARSET]specification. This consists of the "CHARSET" word followed by aregistered [CHARSET] (US ASCII, ISO-8859). It indicates the charsetof the <em>searchCriteria</em> string. Therefore, you must convertthe <em>searchCriteria</em> string into the specified charset ifyou use the [CHARSET] specification (see the <code>CONVERT FROMTEXT</code> or <code>Convert to text</code> commands). By default,4D encodes in Quotable Printable the searchCriteria string if itcontains extended characters.</li></ul><pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = CHARSET <span class="hljs-string">"ISO-8859"</span> BODY <span class="hljs-string">"Help"</span></code></pre><p>... means the search criteria uses the charset iso-8859 and theserver will have to convert the search criteria before searching,if necessary.</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_search-value-types"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_search-value-types"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Search value types</h4><p>Search-keys may request the value to search for:</p><ul><li><p><strong>Search-keys with a date value</strong>: the date is astring that must be formatted as follows:<em>date-day+"-"+date-month+"-"+date-year</em> where date-dayindicates the number of the day of the month (max. 2 characters),date-month indicates the name of the month(Jan/Feb/Mar/Apr/May/Jun/Jul/Aug/Sep/Oct/Dec) and date-yearindicates the year (4 characters). Example: <code>searchCriteria =SENTBEFORE 1-Feb-2020</code> (a date does not usually need to bequoted since it does not contain any special characters)</p></li><li><p><strong>Search-keys with a string value</strong>: the string maycontain any character and must be quoted. If the string does notcontain any special characters, like the space character forinstance, it does not need to be quoted. Quoting such strings willensure that your string value will be correctly interpreted.Example: <code>searchCriteria = FROM "SMITH"</code> For all searchkeys that use strings, a message matches the key if the string is asubstring of the field. Matching is not case-sensitive.</p></li><li><p><strong>Search-keys with a field-name value</strong>: thefield-name is the name of a header field. Example:<code>searchCriteria = HEADER CONTENT-TYPE "MIXED"</code></p></li><li><p><strong>Search-keys with a flag value</strong>: the flag mayaccept one or several keywords (including standard flags),separated by spaces. Example: <code>searchCriteria = KEYWORD\Flagged \Draft</code></p></li><li><p><strong>Search-keys with a message set value</strong>:Identifies a set of messages. For message sequence numbers, theseare consecutive numbers from 1 to the total number of messages inthe mailbox. A comma delimits individual numbers; a colon delimitsbetween two numbers inclusive. Examples: <code>2,4:7,9,12:*</code>is <code>2,4,5,6,7,9,12,13,14,15</code> for a mailbox with 15messages. <code>searchCriteria = 1:5 ANSWERED</code> search inmessage selection from message sequence number 1 to 5 for messageswhich have the \Answered flag set. <code>searchCriteria= 2,4ANSWERED</code> search in the message selection (message numbers 2and 4) for messages which have the \Answered flag set.</p></li></ul><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_authorized-search-keys"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_authorized-search-keys"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Authorized search-keys</h4><p><strong>ALL</strong>: All messages in the mailbox.<br /><strong>ANSWERED</strong>: Messages with the \Answered flagset.<br /><strong>UNANSWERED</strong>: Messages that do not have the\Answered flag set.<br /><strong>DELETED</strong>: Messages with the \Deleted flagset.<br /><strong>UNDELETED</strong>: Messages that do not have the \Deletedflag set.<br /><strong>DRAFT</strong>: Messages with the \Draft flag set.<br /><strong>UNDRAFT</strong>: Messages that do not have the \Draft flagset.<br /><strong>FLAGGED</strong>: Messages with the \Flagged flagset.<br /><strong>UNFLAGGED</strong>: Messages that do not have the \Flaggedflag set.<br /><strong>RECENT</strong>: Messages that have the \Recent flagset.<br /><strong>OLD</strong>: Messages that do not have the \Recent flagset.<br /><strong>SEEN</strong>: Messages that have the \Seen flag set.<br /><strong>UNSEEN</strong>: Messages that do not have the \Seen flagset.<br /><strong>NEW</strong>: Messages that have the \Recent flag set butnot the \Seen flag. This is functionally equivalent to “(RECENTUNSEEN)”.<br />***KEYWORD ***flag******: Messages with the specified keywordset.<br />***UNKEYWORD ***flag******: Messages that do not have the specifiedkeyword set.<br />***BEFORE ***date******: Messages whose internal date is earlierthan the specified date.<br />***ON ***date******: Messages whose internal date is within thespecified date.<br />***SINCE ***date******: Messages whose internal date is within orlater than the specified date.<br />***SENTBEFORE ***date******: Messages whose Date header is earlierthan the specified date.<br />***SENTON ***date******: Messages whose Date header is within thespecified date.<br />***SENTSINCE ***date******: Messages whose Date header is within orlater than the specified date.<br />***TO ***string******: Messages that contain the specified stringin the TO header.<br />***FROM ***string******: Messages that contain the specified stringin the FROM header.<br />***CC ***string******: Messages that contain the specified stringin the CC header.<br />***BCC ***string******: Messages that contain the specified stringin the BCC header.<br />***SUBJECT ***string******: Messages that contain the specifiedstring in the Subject header.<br />***BODY ***string******: Messages that contain the specified stringin the message body.<br />***TEXT ***string******: Messages that contain the specified stringin the header or in the message body.<br />***HEADER <em>field-name</em> ***string******: Messages that have aheader with the specified field-name and that contain the specifiedstring in the field-body.<br />***UID ***message-UID******: Messages with unique identifierscorresponding to the specified unique identifier set.<br />***LARGER ***n******: Messages with a size larger than thespecified number of bytes.<br />***SMALLER ***n******: Messages with a size smaller than thespecified number of bytes.<br />***NOT ***search-key******: Messages that do not match thespecified search key.<br />***OR <em>search-key1</em> ***search-key2******: Messages thatmatch either search key.</p><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_selectbox"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_selectbox"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.selectBox()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.selectBox</strong>( <em>name</em> : Text { ;<em>state</em> : Integer } ) : Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Name of the mailbox</td></tr><tr><td>state</td><td>Ganzzahl</td><td style="text-align:center">-&gt;</td><td>Mailbox access status</td></tr><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td>boxInfo object</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-28"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-28"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.selectBox()</code> function selects the <em>name</em>mailbox as the current mailbox. This function allows you toretrieve information about the mailbox.</p><blockquote><p>To get the information from a mailbox without changing thecurrent mailbox, use <a href="#IMAPTransporterClass.html_getboxinfo"><code>.getBoxInfo()</code></a>.</p></blockquote><p>In the <em>name</em> parameter, pass the name of the mailbox toaccess. The name represents an unambiguous left-to-right hierarchywith levels separated by a specific delimiter character. Thedelimiter can be found with the <a href="#IMAPTransporterClass.html_getdelimiter"><code>.getDelimiter()</code></a>function.</p><p>The optional <em>state</em> parameter defines the type of accessto the mailbox. The possible values are:</p><table><thead><tr><th>Constant</th><th>Wert</th><th>Kommentar</th></tr></thead><tbody><tr><td>IMAP read only state</td><td>1</td><td>The selected mailbox is accessed with read only privileges.Messages with a "recent" flag (indicating new messages) remainunchanged.</td></tr><tr><td>IMAP read write state</td><td>0</td><td>The selected mailbox is accessed with read and writeprivileges. Messages are considered "seen" and lose the "recent"flag (indicating new messages). (Default value)</td></tr></tbody></table><blockquote><ul><li>The function generates an error and returns<strong>Null</strong> if <em>name</em> designates a non-existingmailbox.</li><li>If there is no open connection, <code>.selectBox()</code> willopen a connection.</li><li>If the connection has not been used since the designatedconnection delay (see <code>IMAP New transporter</code>), the<a href="#IMAPTransporterClass.html_checkconnection"><code>.checkConnection()</code></a>function is automatically called.</li></ul></blockquote><p><strong>Returned object</strong></p><p>The <code>boxInfo</code> object returned contains the followingproperties:</p><table><thead><tr><th>Property</th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td>Name of the mailbox</td></tr><tr><td>mailCount</td><td>number</td><td>Number of messages in the mailbox</td></tr><tr><td>mailRecent</td><td>number</td><td>Number of messages with the "recent" flag</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-15"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-15"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>; <span class="hljs-variable">$boxinfo </span>: Object <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>) <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_subscribe"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_subscribe"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.subscribe()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v19</td><td>Added</td></tr></tbody></table></details><p><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Name of the mailbox</td></tr><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td>Status of the subscribe operation</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-29"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-29"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.subscribe()</code> function allows adding or removingof the specified mailbox to/from the IMAP server’s set of“subscribed” mailboxes. As such, you can choose to narrow down alarge list of available mailboxes by subscribing to those youusually want to see.</p><p>In the <code>name</code> parameter, pass the name of the mailboxto add (subscribe) to your "subscribed" mailboxes.</p><p><strong>Returned object</strong></p><p>The function returns an object describing the IMAP status:</p><table><thead><tr><th>Property</th><th></th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>True if the operation is successful, False otherwise</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Status message returned by the IMAP server, or last errorreturned in the 4D error stack</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>4D error stack (not returned if a IMAP server response isreceived)</td></tr><tr><td></td><td>[].errcode</td><td>Zahl</td><td>4D error code</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description of the 4D error</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature of the internal component which returned theerror</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-16"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-16"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><p>To subscribe to the "Atlas Corp” mailbox in the "Bills"hierarchy:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Atlas Corp"</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">subscribe</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">If</span> (<span class="hljs-variable">$status</span>.success)<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox subscription successful!"</span>)<span class="hljs-keyword">   Else</span><span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">   End if</span><span class="hljs-keyword">End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_unsubscribe"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_unsubscribe"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.unsubscribe()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v19</td><td>Added</td></tr></tbody></table></details><p><strong>.unsubscribe</strong>( <em>name</em> : Text ) :Object</p><table><thead><tr><th>Parameter</th><th>Typ</th><th style="text-align:center"></th><th>Beschreibung</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Name of the mailbox</td></tr><tr><td>Ergebnis</td><td>Objekt</td><td style="text-align:center">&lt;-</td><td>Status of the unsubscribe operation</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-30"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-30"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.unsubscribe()</code> function removes a mailbox froma set of subscribed mailboxes. This allows you reduce the number ofmailboxes you usually see.</p><p>In the <code>name</code> parameter, pass the name of the mailboxto remove (unsubscribe) from your active mailboxes.</p><p><strong>Returned object</strong></p><p>The function returns an object describing the IMAP status:</p><table><thead><tr><th>Property</th><th></th><th>Typ</th><th>Beschreibung</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>True if the operation is successful, False otherwise</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Status message returned by the IMAP server, or last errorreturned in the 4D error stack</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>4D error stack (not returned if a IMAP server response isreceived)</td></tr><tr><td></td><td>[].errcode</td><td>Zahl</td><td>4D error code</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description of the 4D error</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature of the internal component which returned theerror</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beispiel-17"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_beispiel-17"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beispiel</h4><p>To unsubscribe from the "Atlas Corp” mailbox in the "Bills"hierarchy:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Atlas Corp"</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">unsubscribe</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">If</span> (<span class="hljs-variable">$status</span>.success)<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox unsubscription successful!"</span>)<span class="hljs-keyword">   Else</span><span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">   End if</span><span class="hljs-keyword">End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_user"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_user"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.user</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.user</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_beschreibung-31"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_beschreibung-31"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Beschreibung</h4><p>The <code>.user</code> property contains the user name used forauthentication on the mail server.</p><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#FunctionClass.html"><span class="arrow-prev">←</span><span>Formula</span></a><a class="docs-next button" href="#MailAttachmentClass.html"><span class="function-name-prevnext">MailAttachment</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#IMAPTransporterClass.html_imap-new-transporter">IMAPNew transporter</a></li><li><a href="#IMAPTransporterClass.html_4dimaptransporternew">4D.IMAPTransporter.new()</a></li><li><a href="#IMAPTransporterClass.html_acceptunsecureconnection">.acceptUnsecureConnection</a></li><li><a href="#IMAPTransporterClass.html_addflags">.addFlags()</a></li><li><a href="#IMAPTransporterClass.html_append">.append()</a></li><li><a href="#IMAPTransporterClass.html_authenticationmode">.authenticationMode</a></li><li><a href="#IMAPTransporterClass.html_checkconnection">.checkConnection()</a></li><li><a href="#IMAPTransporterClass.html_checkconnectiondelay">.checkConnectionDelay</a></li><li><a href="#IMAPTransporterClass.html_connectiontimeout">.connectionTimeOut</a></li><li><a href="#IMAPTransporterClass.html_copy">.copy()</a></li><li><a href="#IMAPTransporterClass.html_createbox">.createBox()</a></li><li><a href="#IMAPTransporterClass.html_delete">.delete()</a></li><li><a href="#IMAPTransporterClass.html_deletebox">.deleteBox()</a></li><li><a href="#IMAPTransporterClass.html_expunge">.expunge()</a></li><li><a href="#IMAPTransporterClass.html_getboxinfo">.getBoxInfo()</a></li><li><a href="#IMAPTransporterClass.html_getboxlist">.getBoxList()</a></li><li><a href="#IMAPTransporterClass.html_getdelimiter">.getDelimiter()</a></li><li><a href="#IMAPTransporterClass.html_getmail">.getMail()</a></li><li><a href="#IMAPTransporterClass.html_getmails">.getMails()</a></li><li><a href="#IMAPTransporterClass.html_getmimeasblob">.getMIMEAsBlob()</a></li><li><a href="#IMAPTransporterClass.html_host">.host</a></li><li><a href="#IMAPTransporterClass.html_logfile">.logFile</a></li><li><a href="#IMAPTransporterClass.html_move">.move()</a></li><li><a href="#IMAPTransporterClass.html_numtoid">.numToID()</a></li><li><a href="#IMAPTransporterClass.html_removeflags">.removeFlags()</a></li><li><a href="#IMAPTransporterClass.html_renamebox">.renameBox()</a></li><li><a href="#IMAPTransporterClass.html_port">.port</a></li><li><a href="#IMAPTransporterClass.html_searchmails">.searchMails()</a></li><li><a href="#IMAPTransporterClass.html_selectbox">.selectBox()</a></li><li><a href="#IMAPTransporterClass.html_subscribe">.subscribe()</a></li><li><a href="#IMAPTransporterClass.html_unsubscribe">.unsubscribe()</a></li><li><a href="#IMAPTransporterClass.html_user">.user</a></li></ul></nav></div></div></body></html>