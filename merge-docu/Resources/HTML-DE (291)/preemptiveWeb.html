<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="de"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Using preemptive web processes · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="The 4D Web Server allows you to take full advantage of multi-core computers by using preemptive web processes in your applications. You can configure your web-related code, including 4D tags, web database methods or ORDA REST class functions to run simultaneously on as many cores as possible."name="description" /><meta content="de" name="docsearch:language" /><meta content="Using preemptive web processes · 4D Documentation"property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="The 4D Web Server allows you to take full advantage of multi-core computers by using preemptive web processes in your applications. You can configure your web-related code, including 4D tags, web database methods or ORDA REST class functions to run simultaneously on as many cores as possible."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#preemptiveWeb.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">Using preemptive webprocesses<a aria-hidden="true" class="anchor" id="preemptiveWeb.html"></a></h1></header><article><div><p><span>The 4D Web Server allows you to take full advantage ofmulti-core computers by using preemptive web processes in yourapplications. You can configure your web-related code, including 4Dtags, web database methods or ORDA REST class functions to runsimultaneously on as many cores as possible.</span></p><p><span>For in-depth information on preemptive process in 4D,please refer to the <em>Preemptive 4D processes</em> section in the<a href="https://doc.4d.com"><em>4D LanguageReference</em></a>.</span></p><h2><span><a aria-hidden="true" class="anchor" id="preemptiveWeb.html_availability-of-preemptive-mode-for-web-processes"></a><a aria-hidden="true" class="hash-link" href="#preemptiveWeb.html_availability-of-preemptive-mode-for-web-processes"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Availability of preemptive mode for webprocesses</span></h2><p><span>The following table indicates whether the preemptive modeis used or is available, depending on the executioncontext:</span></p><table><thead><tr><th>4D Server</th><th>Interpreted (<a href="#debugging-remote.html">debuggerattached</a>)</th><th>Interpreted (debugger detached)</th><th>Kompiliert</th></tr></thead><tbody><tr><td>REST Server</td><td>cooperative</td><td>preemptive</td><td>preemptive</td></tr><tr><td>Web Server</td><td>cooperative</td><td><em>web setting</em></td><td><em>web setting</em></td></tr><tr><td>Web Services Server</td><td>cooperative</td><td><em>web setting</em></td><td><em>web setting</em></td></tr></tbody></table><table><thead><tr><th>4D remote/single-user</th><th>Interpretiert</th><th>Kompiliert</th></tr></thead><tbody><tr><td>REST Server</td><td>cooperative</td><td>preemptive</td></tr><tr><td>Web Server</td><td>cooperative</td><td><em>web setting</em></td></tr><tr><td>Web Services Server</td><td>cooperative</td><td><em>web setting</em></td></tr></tbody></table><ul><li><span>REST Server: handles <a href="#classFunctions.html">ORDAdata model class functions</a></span></li><li><span>Web Server: handles <a href="#templates.html">webtemplates</a>, <a href="#httpRequests.html">4DACTION and databasemethods</a></span></li><li><span>Web Service Server: handles SOAP requests</span></li><li><span><strong><em>web setting</em></strong> means that thepreemptive mode depends on a setting value:</span><ul><li><span>when <a href="#preemptiveWeb.html_enabling-sessions"><strong>Scalablesessions</strong></a> option is selected, the <a href="#preemptiveWeb.html_preemptive-mode">preemptive mode isautomatically used</a> for web processes.</span></li><li><span>otherwise, the <a href="#preemptiveWeb.html_use-preemptive-processes"><strong>Usepreemptive processes</strong></a> option is taken intoaccount.</span></li><li><span>regarding Web service processes (server or client),preemptive mode is supported at method level. You just have toselect "Can be run in preemptive processes" property for publishedSOAP server methods (see <a href="https://doc.4d.com/4Dv19/4D/19/Publishing-a-Web-Service-with-4D.300-5416868.en.html">Publishing a Web Service with 4D</a>) or proxy client methods (see<a href="https://doc.4d.com/4Dv19/4D/19/Subscribing-to-a-Web-Service-in-4D.300-5416870.en.html">Subscribing to a Web Service in 4D</a>) and make sure they areconfirmed thread-safe by the compiler.</span></li></ul></li></ul><h2><span><a aria-hidden="true" class="anchor" id="preemptiveWeb.html_writing-thread-safe-web-server-code"></a><a aria-hidden="true"class="hash-link" href="#preemptiveWeb.html_writing-thread-safe-web-server-code"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Writing thread-safe web server code</span></h2><p><span>All 4D code executed by the web server must be thread-safeif you want your web processes to be run in preemptive mode. Whenthe <a href="#preemptiveWeb.html_availability-of-preemptive-mode-for-web-processes">preemptive mode is enabled</a>, the following parts of theapplication will be automatically evaluated by the 4Dcompiler:</span></p><ul><li><p><span>All web-related database methods:</span></p><ul><li><span><a href="#preemptiveWeb.html_on-web-authentication"><code>On WebAuthentication</code></a></span></li><li><span><a href="#preemptiveWeb.html_on-web-connection"><code>OnWeb Connection</code></a></span></li><li><span><a href="#preemptiveWeb.html_using-the-on-rest-authentication-database-method"><code>On REST Authentication</code></a></span></li><li><span><a href="#on-mobile-app-authentication"><code>On MobileApp Authentication</code></a> and <a href="#on-mobile-app-action"><code>On Mobile AppAction</code></a></span></li></ul></li><li><p><span>The <code>compiler_web</code> project method (regardlessof its actual "Execution mode" property);</span></p></li><li><p><span>Basically any code processed by the <a href="https://doc.4d.com/4dv19R/help/command/en/page816.html"><code>PROCESS4D TAGS</code></a> command in the web context, for example through.shtml pages</span></p></li><li><p><span>Any project method with the "Available through 4D tags andURLS (<code>4DACTION</code>, etc.)" attribute</span></p></li><li><p><span>Triggers for tables with "Expose as REST resource"attribute</span></p></li><li><p><span><a href="#classFunctions.html">ORDA data model classfunctions</a> called via REST</span></p></li></ul><p><span>For each of these methods and code parts, the compilerwill check if the thread-safety rules are respected, and willreturn errors in case of issues. For more information aboutthread-safety rules, please refer to the <em>Writing a thread-safemethod</em> paragraph in the <em>Processes</em> chapter of the<a href="https://doc.4d.com">4D Language Reference</a>manual.</span></p><h2><span><a aria-hidden="true" class="anchor" id="preemptiveWeb.html_thread-safety-of-4d-web-code"></a><a aria-hidden="true"class="hash-link" href="#preemptiveWeb.html_thread-safety-of-4d-web-code"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Thread-safety of 4D web code</span></h2><p><span>Most of the web-related 4D commands and functions,database methods and URLs are thread-safe and can be used inpreemptive mode.</span></p><h3><span><a aria-hidden="true" class="anchor" id="preemptiveWeb.html_4d-commands-and-database-methods"></a><a aria-hidden="true"class="hash-link" href="#preemptiveWeb.html_4d-commands-and-database-methods"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4D commands and database methods</span></h3><p><span>All 4D web-related commands are thread-safe,<em>i.e.</em>:</span></p><ul><li><span>all commands from the <em>Web Server</em>theme,</span></li><li><span>all commands from the <em>HTTP Client</em>theme.</span></li></ul><p><span>The web-related database methods are thread-safe and canbe used in preemptive mode (see above): <code>On WebAuthentication</code>, <code>On Web Connection</code>, <code>OnREST Authentication</code>...).</span></p><p><span>Of course, the code executed by these methods must also bethread-safe.</span></p><h3><span><a aria-hidden="true" class="anchor" id="preemptiveWeb.html_web-server-urls"></a><a aria-hidden="true"class="hash-link" href="#preemptiveWeb.html_web-server-urls"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Web Server URLs</span></h3><p><span>The following 4D Web Server URLs are thread-safe and canbe used in preemptive mode:</span></p><ul><li><span><em>4daction/</em> (the called project method must alsobe thread-safe)</span></li><li><span><em>4dcgi/</em> (the called database methods must also bethread-safe)</span></li><li><span><em>4dwebtest/</em></span></li><li><span><em>4dblank/</em></span></li><li><span><em>4dstats/</em></span></li><li><span><em>4dhtmlstats/</em></span></li><li><span><em>4dcacheclear/</em></span></li><li><span><em>rest/</em></span></li><li><span><em>4dimgfield/</em> (generated by <code>PROCESS 4DTAGS</code> for web request on picture fields)</span></li><li><span><em>4dimg/</em> (generated by <code>PROCESS 4DTAGS</code> for web request on picture variables)</span></li></ul><h3><span><a aria-hidden="true" class="anchor" id="preemptiveWeb.html_preemptive-web-process-icon"></a><a aria-hidden="true"class="hash-link" href="#preemptiveWeb.html_preemptive-web-process-icon"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Preemptive web process icon</span></h3><p><span>Both the Runtime Explorer and the 4D Server administrationwindow display a specific icon for preemptive webprocesses:</span></p><table><thead><tr><th>Process type</th><th>Icon</th></tr></thead><tbody><tr><td>Preemptive web method</td><td><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/WebServer/processIcon.png" /></td></tr></tbody></table></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#sessions.html"><span class="arrow-prev">←</span> <span>Usersessions</span></a><a class="docs-next button" href="#gettingStarted.html"><span>Getting Started</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#preemptiveWeb.html_availability-of-preemptive-mode-for-web-processes">Availability of preemptive mode for web processes</a></li><li><a href="#preemptiveWeb.html_writing-thread-safe-web-server-code">Writingthread-safe web server code</a></li><li><a href="#preemptiveWeb.html_thread-safety-of-4d-web-code">Thread-safety of4D web code</a><ul class="toc-headings"><li><a href="#preemptiveWeb.html_4d-commands-and-database-methods">4D commandsand database methods</a></li><li><a href="#preemptiveWeb.html_web-server-urls">Web ServerURLs</a></li><li><a href="#preemptiveWeb.html_preemptive-web-process-icon">Preemptive webprocess icon</a></li></ul></li></ul></nav></div></div></body></html>