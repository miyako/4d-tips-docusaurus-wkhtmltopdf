<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="fr"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Appeler des fonctions de classe ORDA · 4DDocumentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="Vous pouvez appeler les [fonctions de classe de modèles de données](/docs/Rx/fr/ORDA/ordaClasses.html) définies pour le modèle de données ORDA via vos requêtes REST, afin de bénéficier de l'API de l'application 4D ciblée."name="description" /><meta content="fr" name="docsearch:language" /><meta content="Appeler des fonctions de classe ORDA · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="Vous pouvez appeler les [fonctions de classe de modèles de données](/docs/Rx/fr/ORDA/ordaClasses.html) définies pour le modèle de données ORDA via vos requêtes REST, afin de bénéficier de l'API de l'application 4D ciblée."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#ClassFunctions.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">Appeler des fonctionsde classe ORDA<a aria-hidden="true" class="anchor" id="classFunctions.html"></a></h1></header><article><div><p><span>Vous pouvez appeler les <a href="#ordaClasses.html">fonctions de classe de modèles de données</a>définies pour le modèle de données ORDA via vos requêtes REST, afinde bénéficier de l'API de l'application 4D ciblée.</span></p><p><span>Les fonctions sont simplement appelées dans les requêtesPOST sur l'interface ORDA appropriée, sans (). Par exemple, si vousavez défini une fonction <code>getCity()</code> dans la dataclassCity, vous pouvez l'appeler à l'aide de la requête suivante:</span></p><p><span><code>/rest/City/getCity</code></span></p><p><span>avec des données contenues dans le corps de la requêtePOST : <code>["Paris"]</code></span></p><p><span>Dans le langage 4D, cet appel équivaut à :</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-variable">$city</span>:=ds.City.<span class="hljs-function">getCity</span>(<span class="hljs-string">"Aguada"</span>)</code></span></pre><blockquote><p>Seules les fonctions contenant le mot-clé <code>exposed</code>peuvent être directement appelées à partir de requêtes REST. See<a href="#classFunctions.html_exposed-vs-non-exposed-functions">Exposed vsnon-exposed functions</a> section.</p></blockquote><h2><a aria-hidden="true" class="anchor" id="classFunctions.html_appeler-des-fonctions"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_appeler-des-fonctions"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Appeler des fonctions</h2><p>Les fonctions doivent toujours être appelées à l'aide desrequêtes <strong>POST</strong> (une requête GET recevra uneerreur).</p><p>Les fonctions sont appelées sur l'objet correspondant audatastore du serveur.</p><table><thead><tr><th>Fonction de classe</th><th>Syntaxe</th></tr></thead><tbody><tr><td><a href="#classFunctions.html_datastore-class">datastoreclass</a></td><td><code>/rest/$catalog/DataStoreClassFunction</code></td></tr><tr><td><a href="#classFunctions.html_dataclass-class">dataclassclass</a></td><td><code>/rest/{dataClass}/DataClassClassFunction</code></td></tr><tr><td><a href="#classFunctions.html_entityselection-class">entitySelectionclass</a></td><td><code>/rest/{dataClass}/EntitySelectionClassFunction</code></td></tr><tr><td></td><td><code>/rest/{dataClass}/EntitySelectionClassFunction/$entityset/entitySetNumber</code></td></tr><tr><td></td><td><code>/rest/{dataClass}/EntitySelectionClassFunction/$filter</code></td></tr><tr><td></td><td><code>/rest/{dataClass}/EntitySelectionClassFunction/$orderby</code></td></tr><tr><td><a href="#classFunctions.html_entity-class">entityclass</a></td><td><code>/rest/{dataClass}(key)/EntityClassFunction/</code></td></tr></tbody></table><blockquote><p><code>/rest/{dataClass}/Function</code> peut être utilisé pourappeler une fonction de dataclass ou de sélection d'entité(<code>/rest/{dataClass}</code> retourne toutes les entités de laDataClass en tant que sélection d'entité).<br />La fonction est d'abord recherchée dans la classe de sélectiond'entité. Si elle n'est pas trouvée, elle est recherchée dans ladataclass. En d'autres termes, si une fonction portant le même nomest définie à la fois dans la classe DataClass et la classeEntitySelection, la fonction de classe de dataclass ne sera jamaisexécutée.</p></blockquote><blockquote><p>All 4D code called from REST requests <strong>must bethread-safe</strong> if the project runs in compiled mode, becausethe REST Server always uses preemptive processes in this case (the<a href="#classFunctions.html_enabling-the-preemptive-mode-for-the-web-server"><em>Use preemptive process</em> setting value</a> is ignored by theREST Server).</p></blockquote><h2><a aria-hidden="true" class="anchor" id="classFunctions.html_param%C3%A8tres"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_param%25C3%25A8tres"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Paramètres</h2><p>Vous pouvez envoyer des paramètres aux fonctions définies dansles classes utilisateurs ORDA. Côté serveur, ils seront reçus dansles fonctions de classe dans les paramètres normaux $1, $2,etc.</p><p>Les règles suivantes s'appliquent :</p><ul><li>Les paramètres doivent être passés dans le <strong>corps de larequête POST</strong></li><li>Les paramètres doivent être inclus dans une collection (formatJSON)</li><li>Tous les types de données scalaires pris en charge dans lescollections JSON peuvent être passés en tant que paramètres.</li><li>La sélection d'entité et l'entité peuvent être passées en tantque paramètres. L'objet JSON doit contenir des attributsspécifiques utilisés par le serveur REST pour affecter des donnéesaux objets ORDA correspondants : __DATACLASS, __ENTITY, __ENTITIES,__DATASET.</li></ul><p>Voir <a href="#classFunctions.html_request-receiving-an-entity-as-parameter">cetexemple</a> et <a href="#classFunctions.html_request-receiving-an-entity-selection-as-parameter">cet exemple</a>.</p><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_param%C3%A8tre-de-valeur-scalaire"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_param%25C3%25A8tre-de-valeur-scalaire"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Paramètre de valeur scalaire</h3><p>Le(s) paramètre(s) doivent simplement être incluse dans unecollection définie dans le corps. Par exemple, avec une fonction dedataclass <code>getCities()</code> qui reçoit des paramètres detype texte : <code>/rest/City/getCities</code></p><p><strong>Parmaètres dans le corps :</strong>["Aguada","Paris"]</p><p>Tous les types de données JSON sont pris en charge dans lesparamètres, y compris les pointeurs JSON. Les dates peuvent êtrepassées sous forme de chaînes au format de date ISO 8601 (parexemple, "2020-08-22T22:00:000Z").</p><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_param%C3%A8tre-dentit%C3%A9"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_param%25C3%25A8tre-dentit%25C3%25A9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Paramètre d'entité</h3><p>Les entités passées en paramètres sont référencées sur leserveur via leur clé (c'est-à-dire la propriété __KEY). Si leparamètre clé est omis dans une requête, une nouvelle entité estchargée en mémoire du serveur. Vous pouvez également transmettredes valeurs pour tous les attributs de l'entité. Ces valeurs serontautomatiquement utilisées pour l'entité traitée sur le serveur.</p><blockquote><p>Si la requête envoie des valeurs d'attribut modifiées pour uneentité existante sur le serveur, la fonction de modèle de donnéesORDA appelée sera automatiquement exécutée sur le serveur avec desvaleurs modifiées. Cette fonctionnalité vous permet, par exemple,de vérifier le résultat d'une opération sur une entité, après avoirappliqué toutes les règles métier, depuis l'application cliente.Vous pouvez alors décider de sauvegarder ou non l'entité sur leserveur.</p></blockquote><table><thead><tr><th>Propriétés</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>Attributs de l'entité</td><td>mixte</td><td>Optionnelle - Valeurs à modifier</td></tr><tr><td>__DATACLASS</td><td>Chaine</td><td>Obligatoire - Indique la Dataclass de l'entité</td></tr><tr><td>__ENTITY</td><td>Booléen</td><td>Obligatoire - Vrai pour indiquer au serveur que le paramètreest une entité</td></tr><tr><td>__KEY</td><td>mixte (type identique à celui de la clé primaire)</td><td>Optionnel - clé primaire de l'entité</td></tr></tbody></table><ul><li>Si __KEY n'est pas fourni, une nouvelle entité est créée sur leserveur avec les attributs donnés.</li><li>Si __KEY est fourni, l'entité correspondant à _KEY est chargéesur le serveur avec les attributs donnés</li></ul><p>Voir les exemple de <a href="#classFunctions.html_creating-an-entity">création</a> ou de<a href="#classFunctions.html_updating-an-entity">mise à jour</a>des entités.</p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_param%C3%A8tre-dentit%C3%A9-associ%C3%A9"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_param%25C3%25A8tre-dentit%25C3%25A9-associ%25C3%25A9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Paramètre d'entité associé</h4><p>Mêmes propriétés que pour un <a href="#classFunctions.html_entity-parameter">paramètre d'entité</a>. Deplus, l'entité associée doit exister et est référencée par __KEY,qui contient sa clé primaire.</p><p>Reportez-vous aux exemples de <a href="#classFunctions.html_creating-an-entity-with-a-related-entity">création</a>ou de <a href="#classFunctions.html_updating-an-entity-with-a-related-entity">miseà jour</a> des entités avec des entités associées.</p><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_param%C3%A8tre-de-s%C3%A9lection-dentit%C3%A9"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_param%25C3%25A8tre-de-s%25C3%25A9lection-dentit%25C3%25A9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Paramètre de sélection d'entité</h3><p>La sélection d'entité doit avoir été définie au préalable àl'aide de <a href="#classFunctions.html_methodentityset">$method=entityset</a>.</p><blockquote><p>Si la requête envoie une sélection d'entité modifiée au serveur,la fonction de modèle de données ORDA appelée sera automatiquementexécutée sur le serveur avec la sélection d'entité modifiée.</p></blockquote><table><thead><tr><th>Propriétés</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>Attributs de l'entité</td><td>mixte</td><td>Optionnelle - Valeurs à modifier</td></tr><tr><td>__DATASET</td><td>Chaine</td><td>Obligatoire - entitySetID (UUID) de la sélection d'entité</td></tr><tr><td>__ENTITIES</td><td>Booléen</td><td>Obligatoire - Vrai pour indiquer au serveur que le paramètreest une sélection d'entité</td></tr></tbody></table><p>Reportez-vous aux exemples de <a href="#classFunctions.html_receiving-an-entity-selection-as-parameter">réceptiond'une sélection d'entité</a>.</p><h2><a aria-hidden="true" class="anchor" id="classFunctions.html_exemples-de-requ%C3%AAtes"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_exemples-de-requ%25C3%25AAtes"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemples de requêtes</h2><p>Cette base de données est exposée comme un datastore distant surlocalhost (port 8111) :</p><p><img alt="alt-text" src="https://developer.4d.com/docs/Rx/assets/en/REST/ordastructure.png" /></p><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utiliser-une-fonction-de-classe-de-datastore"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_utiliser-une-fonction-de-classe-de-datastore"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utiliser une fonction de classe de datastore</h3><p>La classe de <code>DataStore</code> US_Cities fournit une API:</p><pre><code class="hljs">// DataStore <span class="hljs-class"><span class="hljs-keyword">class</span></span><span class="hljs-class"><span class="hljs-keyword">Class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">DataStoreImplementation</span></span>exposed <span class="hljs-function"><span class="hljs-keyword">Function</span> <span class="hljs-title">getName</span>(</span>)    <span class="hljs-number">$0</span>:=<span class="hljs-string">"US cities and zip codes manager"</span> </code></pre><p>Vous pouvez lancer cette requête :</p><p><strong>POST</strong><code>127.0.0.1:8111/rest/$catalog/getName</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_r%C3%A9sultat"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_r%25C3%25A9sultat"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><pre><code class="hljs">{<span class="hljs-attr">"result"</span>: <span class="hljs-string">"US cities and zip codes manager"</span> }</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utiliser-une-fonction-de-classe-de-dataclass"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_utiliser-une-fonction-de-classe-de-dataclass"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utiliser une fonction de classe de dataclass</h3><p>La classe de Dataclass <code>City</code> fournit une API quiretourne une entité de ville à partir du nom passé en paramètre:</p><pre><code class="hljs"><span class="hljs-comment">// City class</span><span class="hljs-keyword">Class extends</span> DataClass<span class="hljs-function">exposed Function getCity</span>()<span class="hljs-keyword">    var</span> <span class="hljs-variable">$0 </span>: cs.CityEntity<span class="hljs-keyword">    var</span> <span class="hljs-variable">$1</span>,<span class="hljs-variable">$nameParam </span>: text    <span class="hljs-variable">$nameParam</span>:=<span class="hljs-variable">$1</span>    <span class="hljs-variable">$0</span>:=<span class="hljs-literal">This</span>.<span class="hljs-function">query</span>(<span class="hljs-string">"name = :1"</span>;<span class="hljs-variable">$nameParam</span>).<span class="hljs-function">first</span>()</code></pre><p>Vous pouvez lancer cette requête :</p><p><strong>POST</strong><code>127.0.0.1:8111/rest/City/getCity</code></p><p>Requête : ["Paris"]</p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_r%C3%A9sultat-1"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_r%25C3%25A9sultat-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><p>Le résultat est une entité :</p><pre><code class="hljs">{    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"City"</span>,    <span class="hljs-attr">"__DATACLASS"</span>: <span class="hljs-string">"City"</span>,    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"1"</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"2020-03-09T08:03:19.923Z"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Paris"</span>,    <span class="hljs-attr">"countyFIPS"</span>: <span class="hljs-number">72003</span>,    <span class="hljs-attr">"county"</span>: {        <span class="hljs-attr">"__deferred"</span>: {            <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"/rest/County(72003)"</span>,            <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"72003"</span>         }    },    <span class="hljs-attr">"zips"</span>: {        <span class="hljs-attr">"__deferred"</span>: {            <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"/rest/City(1)/zips?$expand=zips"</span>         }    }}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utiliser-une-fonction-de-classe-dune-entit%C3%A9"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_utiliser-une-fonction-de-classe-dune-entit%25C3%25A9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utiliser une fonction de classe d'une entité</h3><p>La classe d'entité <code>CityEntity</code> fournit une API :</p><pre><code class="hljs">// CityEntity <span class="hljs-class"><span class="hljs-keyword">class</span></span><span class="hljs-class"><span class="hljs-keyword">Class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Entity</span></span>exposed <span class="hljs-function"><span class="hljs-keyword">Function</span> <span class="hljs-title">getPopulation</span>(</span>)    <span class="hljs-number">$0</span>:=This.zips.sum(<span class="hljs-string">"population"</span>)</code></pre><p>Vous pouvez lancer cette requête :</p><p><strong>POST</strong><code>127.0.0.1:8111/rest/City(2)/getPopulation</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_r%C3%A9sultat-2"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_r%25C3%25A9sultat-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: <span class="hljs-number">48814</span>}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utiliser-une-fonction-de-classe-dune-s%C3%A9lection-dentit%C3%A9"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_utiliser-une-fonction-de-classe-dune-s%25C3%25A9lection-dentit%25C3%25A9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utiliser une fonction de classe d'une sélectiond'entité</h3><p>La classe de sélection d'entité <code>CityEntity</code> fournitune API :</p><pre><code class="hljs">// CitySelection <span class="hljs-class"><span class="hljs-keyword">class</span></span><span class="hljs-class"><span class="hljs-keyword">Class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EntitySelection</span></span>exposed <span class="hljs-function"><span class="hljs-keyword">Function</span> <span class="hljs-title">getPopulation</span>(</span>)    <span class="hljs-number">$0</span>:=This.zips.sum(<span class="hljs-string">"population"</span>)</code></pre><p>Vous pouvez lancer cette requête :</p><p><strong>POST</strong><code>127.0.0.1:8111/rest/City/getPopulation/?$filter="ID&lt;3"</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_r%C3%A9sultat-3"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_r%25C3%25A9sultat-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: <span class="hljs-number">87256</span>}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utiliser-une-fonction-de-classe-de-s%C3%A9lection-dentit%C3%A9-et-un-ensemble-dentit%C3%A9"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_utiliser-une-fonction-de-classe-de-s%25C3%25A9lection-dentit%25C3%25A9-et-un-ensemble-dentit%25C3%25A9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utiliser une fonction de classe de sélection d'entité etun ensemble d'entité</h3><p>La classe <code>StudentsSelection</code> a une fonction<code>getAgeAverage</code> :</p><pre><code class="hljs"><span class="hljs-comment">// StudentsSelection Class</span><span class="hljs-keyword">Class extends</span> EntitySelectionexposed<span class="hljs-keyword"> Function</span> getAgeAverage<span class="hljs-function">    C_LONGINT</span>(<span class="hljs-variable">$sum</span>;<span class="hljs-variable">$0</span>)<span class="hljs-function">    C_OBJECT</span>(<span class="hljs-variable">$s</span>)    <span class="hljs-variable">$sum</span>:=<span class="hljs-number">0</span><span class="hljs-keyword">    For each</span> (<span class="hljs-variable">$s</span>;<span class="hljs-literal">This</span>)        <span class="hljs-variable">$sum</span>:=<span class="hljs-variable">$sum</span>+<span class="hljs-variable">$s</span>.<span class="hljs-function">age</span>()<span class="hljs-keyword">    End for each</span>     <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$sum</span>/<span class="hljs-literal">This</span>.length</code></pre><p>Une fois que vous avez créé un ensemble d'entité, vous pouvezlancer cette requête :</p><p><strong>POST</strong><code>127.0.0.1:8044/rest/Students/getAgeAverage/$entityset/17E83633FFB54ECDBF947E5C620BB532</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_r%C3%A9sultat-4"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_r%25C3%25A9sultat-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: <span class="hljs-number">34</span>}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utiliser-une-fonction-de-classe-de-s%C3%A9lection-dentit%C3%A9-et-un-orderby"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_utiliser-une-fonction-de-classe-de-s%25C3%25A9lection-dentit%25C3%25A9-et-un-orderby"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utiliser une fonction de classe de sélection d'entité etun "orderBy"</h3><p>La classe <code>StudentsSelection</code> a une fonction<code>getLastSummary</code> :</p><pre><code class="hljs"><span class="hljs-comment">// StudentsSelection Class</span><span class="hljs-keyword">Class extends</span> EntitySelectionexposed<span class="hljs-keyword"> Function</span> getLastSummary<span class="hljs-function">    C_TEXT</span>(<span class="hljs-variable">$0</span>)<span class="hljs-function">    C_OBJECT</span>(<span class="hljs-variable">$last</span>)    <span class="hljs-variable">$last</span>:=<span class="hljs-literal">This</span>.<span class="hljs-function">last</span>()    <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$last</span>.firstname+<span class="hljs-string">" - "</span>+<span class="hljs-variable">$last</span>.lastname+<span class="hljs-string">" is ... "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$last</span>.<span class="hljs-function">age</span>())</code></pre><p>Vous pouvez lancer cette requête :</p><p><strong>POST</strong><code>127.0.0.1:8044/rest/Students/getLastSummary/$entityset/?$filter="lastname=b@"&amp;$orderby="lastname"</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_r%C3%A9sultat-5"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_r%25C3%25A9sultat-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: <span class="hljs-string">"Wilbert - Bull is ... 21"</span> }</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utiliser-une-entit%C3%A9-%C3%A0-cr%C3%A9er-sur-le-serveur"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_utiliser-une-entit%25C3%25A9-%25C3%25A0-cr%25C3%25A9er-sur-le-serveur"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utiliser une entité à créer sur le serveur</h3><p>La classe de Dataclass <code>Students</code> possède la fonction<code>pushData()</code> qui reçoit une entité contenant les donnéesdu client. La méthode <code>checkData()</code> effectue quelquescontrôles. Si elles sont valides, l'entité est sauvegardée etretournée.</p><pre><code class="hljs"><span class="hljs-comment">// Students Class</span><span class="hljs-keyword">Class extends</span> DataClassexposed<span class="hljs-keyword"> Function</span> pushData<span class="hljs-keyword">    var</span> <span class="hljs-variable">$1</span>, <span class="hljs-variable">$entity</span>, <span class="hljs-variable">$status</span>, <span class="hljs-variable">$0 </span>: Object    <span class="hljs-variable">$entity</span>:=<span class="hljs-variable">$1</span>    <span class="hljs-variable">$status</span>:=<span class="hljs-function">checkData</span>(<span class="hljs-variable">$entity</span>) <span class="hljs-comment">// $status est un objet avec une propriété booléenne "success"</span>    <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$status</span><span class="hljs-keyword">    If</span> (<span class="hljs-variable">$status</span>.success)        <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$entity</span>.<span class="hljs-function">save</span>()<span class="hljs-keyword">       If</span> (<span class="hljs-variable">$status</span>.success)           <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$entity</span><span class="hljs-keyword">      End if</span><span class="hljs-keyword">     End if</span></code></pre><p>Lancez cette requête :</p><p><strong>POST</strong><code>http://127.0.0.1:8044/rest/Students/pushData</code></p><p>Corps de la requête :</p><pre><code class="hljs">[{<span class="hljs-attr">"__DATACLASS"</span>:<span class="hljs-string">"Students"</span>,<span class="hljs-attr">"__ENTITY"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"firstname"</span>:<span class="hljs-string">"Ann"</span>,<span class="hljs-attr">"lastname"</span>:<span class="hljs-string">"Brown"</span> }]</code></pre><p>Si aucune <code>__KEY</code> n'est donnée, une nouvelle entitéStudents est chargée sur le serveur <strong>avec les attributs duclient</strong>. Parce que la fonction <code>pushData()</code>exécute une action <code>save()</code>, la nouvelle entité estcréée.</p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_r%C3%A9sultat-6"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_r%25C3%25A9sultat-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><pre><code class="hljs">{    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__DATACLASS"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"55"</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"2020-06-16T10:54:41.805Z"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">55</span>,    <span class="hljs-attr">"firstname"</span>: <span class="hljs-string">"Ann"</span>,    <span class="hljs-attr">"lastname"</span>: <span class="hljs-string">"BROWN"</span>,    <span class="hljs-attr">"schoolID"</span>: <span class="hljs-literal">null</span>,    <span class="hljs-attr">"school"</span>: <span class="hljs-literal">null</span>}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utiliser-une-entit%C3%A9-%C3%A0-mettre-%C3%A0-jour-sur-le-serveur"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_utiliser-une-entit%25C3%25A9-%25C3%25A0-mettre-%25C3%25A0-jour-sur-le-serveur"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utiliser une entité à mettre à jour sur le serveur</h3><p>Description semblable à la précédente, avec l'attribut _KEY</p><p>Lancez cette requête :</p><p><strong>POST:</strong><code>http://127.0.0.1:8044/rest/Students/pushData</code></p><p>Corps de la requête :</p><pre><code class="hljs">[{<span class="hljs-attr">"__DATACLASS"</span>:<span class="hljs-string">"Students"</span>,<span class="hljs-attr">"__ENTITY"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"lastname"</span>:<span class="hljs-string">"Brownie"</span>,<span class="hljs-attr">"__KEY"</span>:<span class="hljs-number">55</span>}]</code></pre><p>Si aucune <code>__KEY</code> n'est donnée, l'entité Students estchargée avec la clé primaire 55 <strong>avec la valeur lastnamereçue par le client</strong>. Parce que la fonction exécute uneaction <code>save()</code>, la nouvelle entité est mise à jour.</p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_r%C3%A9sultat-7"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_r%25C3%25A9sultat-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><pre><code class="hljs">{    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__DATACLASS"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"55"</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"2020-06-16T11:10:21.679Z"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">3</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">55</span>,    <span class="hljs-attr">"firstname"</span>: <span class="hljs-string">"Ann"</span>,    <span class="hljs-attr">"lastname"</span>: <span class="hljs-string">"BROWNIE"</span>,    <span class="hljs-attr">"schoolID"</span>: <span class="hljs-literal">null</span>,    <span class="hljs-attr">"school"</span>: <span class="hljs-literal">null</span> }</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_cr%C3%A9er-une-entit%C3%A9-avec-une-entit%C3%A9-li%C3%A9e"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_cr%25C3%25A9er-une-entit%25C3%25A9-avec-une-entit%25C3%25A9-li%25C3%25A9e"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Créer une entité avec une entité liée</h3><p>Dans cet exemple, nous créons une nouvelle entité Students avecl'entité Schools ayant la clé primaire 2.</p><p>Lancez cette requête :</p><p><strong>POST:</strong><code>http://127.0.0.1:8044/rest/Students/pushData</code></p><p>Corps de la requête :</p><pre><code class="hljs">[{<span class="hljs-attr">"__DATACLASS"</span>:<span class="hljs-string">"Students"</span>,<span class="hljs-attr">"__ENTITY"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"firstname"</span>:<span class="hljs-string">"John"</span>,<span class="hljs-attr">"lastname"</span>:<span class="hljs-string">"Smith"</span>,<span class="hljs-attr">"school"</span>:{<span class="hljs-attr">"__KEY"</span>:<span class="hljs-number">2</span>}}]</code></pre><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_r%C3%A9sultat-8"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_r%25C3%25A9sultat-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><pre><code class="hljs">{    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__DATACLASS"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"56"</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"2020-06-16T11:16:47.601Z"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">56</span>,    <span class="hljs-attr">"firstname"</span>: <span class="hljs-string">"John"</span>,    <span class="hljs-attr">"lastname"</span>: <span class="hljs-string">"SMITH"</span>,    <span class="hljs-attr">"schoolID"</span>: <span class="hljs-number">2</span>,       <span class="hljs-attr">"school"</span>: {        <span class="hljs-attr">"__deferred"</span>: {            <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"/rest/Schools(2)"</span>,            <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"2"</span>         }    }}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_mettre-%C3%A0-jour-une-entit%C3%A9-avec-une-entit%C3%A9-li%C3%A9e"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_mettre-%25C3%25A0-jour-une-entit%25C3%25A9-avec-une-entit%25C3%25A9-li%25C3%25A9e"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Mettre à jour une entité avec une entité liée</h3><p>Dans cet exemple, nous associons une école existante à l'entitéStudents. La classe <code>StudentsEntity</code> possède une API:</p><pre><code class="hljs"><span class="hljs-comment">// StudentsEntity class</span><span class="hljs-keyword">Class extends</span> Entity<span class="hljs-function">exposed Function putToSchool</span>()<span class="hljs-keyword">    var</span> <span class="hljs-variable">$1</span>, <span class="hljs-variable">$school </span>, <span class="hljs-variable">$0</span>, <span class="hljs-variable">$status </span>: Object        <span class="hljs-comment">//$1 is a Schools entity</span>    <span class="hljs-variable">$school</span>:=<span class="hljs-variable">$1</span>        <span class="hljs-comment">//Associe l'entité reliée "school" à l'entité courante "Students"</span>    <span class="hljs-literal">This</span>.school:=<span class="hljs-variable">$school</span>    <span class="hljs-variable">$status</span>:=<span class="hljs-literal">This</span>.<span class="hljs-function">save</span>()    <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$status</span></code></pre><p>You run this request, called on a Students entity :<strong>POST</strong><code>http://127.0.0.1:8044/rest/Students(1)/putToSchool</code>Body of the request:</p><pre><code class="hljs">[{<span class="hljs-attr">"__DATACLASS"</span>:<span class="hljs-string">"Schools"</span>,<span class="hljs-attr">"__ENTITY"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"__KEY"</span>:<span class="hljs-number">2</span>}]</code></pre><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_r%C3%A9sultat-9"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_r%25C3%25A9sultat-9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: {        <span class="hljs-attr">"success"</span>: <span class="hljs-literal">true</span>    }}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_recevoir-une-s%C3%A9lection-dentit%C3%A9-comme-param%C3%A8tre"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_recevoir-une-s%25C3%25A9lection-dentit%25C3%25A9-comme-param%25C3%25A8tre"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Recevoir une sélection d'entité comme paramètre</h3><p>Dans la classe de Dataclass <code>Students</code>, la fonction<code>setFinalExam()</code> met à jour une sélection d'entité reçue($1). Elle met à jour l'attribut <em>finalExam</em> avec la valeurreçue ($2). Elle retourne les clés primaires des entités mises àjour.</p><pre><code class="hljs"><span class="hljs-comment">// Students class</span><span class="hljs-keyword">Class extends</span> DataClass<span class="hljs-function">exposed Function setFinalExam</span>()<span class="hljs-keyword">    var</span> <span class="hljs-variable">$1</span>, <span class="hljs-variable">$es</span>, <span class="hljs-variable">$student</span>, <span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">    var</span> <span class="hljs-variable">$2</span>, <span class="hljs-variable">$examResult </span>: Text<span class="hljs-keyword">    var</span> <span class="hljs-variable">$keys</span>, <span class="hljs-variable">$0 </span>: Collection      <span class="hljs-comment">//Entity selection</span>    <span class="hljs-variable">$es</span>:=<span class="hljs-variable">$1</span>    <span class="hljs-variable">$examResult</span>:=<span class="hljs-variable">$2</span>    <span class="hljs-variable">$keys</span>:=<span class="hljs-function">New collection</span>()      <span class="hljs-comment">//Boucle sur la sélection d'entité</span><span class="hljs-keyword">    For each</span> (<span class="hljs-variable">$student</span>;<span class="hljs-variable">$es</span>)        <span class="hljs-variable">$student</span>.finalExam:=<span class="hljs-variable">$examResult</span>        <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$student</span>.<span class="hljs-function">save</span>()<span class="hljs-keyword">        If</span> (<span class="hljs-variable">$status</span>.success)            <span class="hljs-variable">$keys</span>.<span class="hljs-function">push</span>(<span class="hljs-variable">$student</span>.ID)<span class="hljs-keyword">        End if</span><span class="hljs-keyword">     End for each</span>     <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$keys</span></code></pre><p>Un ensemble d'entité est d'abord créé avec cette requête :</p><p><code>http://127.0.0.1:8044/rest/Students/?$filter="ID&lt;3"&amp;$method=entityset</code></p><p>Vous pouvez ensuite exécuter cette requête :</p><p><strong>POST</strong><code>http://127.0.0.1:8044/rest/Students/setFinalExam</code></p><p>Corps de la requête :</p><pre><code class="hljs">[{<span class="hljs-attr">"__ENTITIES"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"__DATASET"</span>:<span class="hljs-string">"9B9C053A111E4A288E9C1E48965FE671"</span> },<span class="hljs-string">"Passed"</span> ]</code></pre><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_r%C3%A9sultat-10"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_r%25C3%25A9sultat-10"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><p>Les entités ayant les clés primaires sont 1 et 2 ont été mises àjour.</p><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: [        <span class="hljs-number">1</span>,        <span class="hljs-number">2</span>    ]}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utiliser-une-s%C3%A9lection-dentit%C3%A9-mise-%C3%A0-jour-sur-le-client"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_utiliser-une-s%25C3%25A9lection-dentit%25C3%25A9-mise-%25C3%25A0-jour-sur-le-client"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utiliser une sélection d'entité mise à jour sur leclient</h3><p>A l'aide de la fonction <code>getAgeAverage()</code> <a href="#classFunctions.html_using-an-entityselection-class-function-and-an-entityset">définie ci-dessus</a>.</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$remoteDS</span>, <span class="hljs-variable">$newStudent</span>, <span class="hljs-variable">$students </span>: Object<span class="hljs-keyword">var</span> <span class="hljs-variable">$ageAverage </span>: Integer<span class="hljs-variable">$remoteDS</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"hostname"</span>;<span class="hljs-string">"127.0.0.1:8044"</span>);<span class="hljs-string">"students"</span>)<span class="hljs-comment">// $newStudent est une entité "student" à traiter</span><span class="hljs-variable">$newStudent</span>:=...<span class="hljs-variable">$students</span>:=<span class="hljs-variable">$remoteDS</span>.Students.<span class="hljs-function">query</span>(<span class="hljs-string">"school.name = :1"</span>;<span class="hljs-string">"Math school"</span>)<span class="hljs-comment">// Nous avons ajouté une entité à la sélection d'entité $students sur le client</span><span class="hljs-variable">$students</span>.<span class="hljs-function">add</span>(<span class="hljs-variable">$newStudent</span>) <span class="hljs-comment">// Nous appelons une fonction sur la classe StudentsSelection qui retourne l'âge moyen des étudiants de la sélection d'entité</span><span class="hljs-comment">// La fonction est utilisée sur le serveur sur la sélection d'entité $students mise à jour, qui inclut l'étudiant ajouté par le client</span><span class="hljs-variable">$ageAverage</span>:=<span class="hljs-variable">$students</span>.<span class="hljs-function">getAgeAverage</span>()</code></pre></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#manData.html"><span class="arrow-prev">←</span><span>Manipulation des données</span></a><a class="docs-next button" href="#REST_requests.html"><span>A propos desrequêtes REST</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#classFunctions.html_appeler-des-fonctions">Appelerdes fonctions</a></li><li><a href="#classFunctions.html_param%25C3%25A8tres">Paramètres</a><ul class="toc-headings"><li><a href="#classFunctions.html_param%25C3%25A8tre-de-valeur-scalaire">Paramètrede valeur scalaire</a></li><li><a href="#classFunctions.html_param%25C3%25A8tre-dentit%25C3%25A9">Paramètred'entité</a></li><li><a href="#classFunctions.html_param%25C3%25A8tre-de-s%25C3%25A9lection-dentit%25C3%25A9">Paramètre de sélection d'entité</a></li></ul></li><li><a href="#classFunctions.html_exemples-de-requ%25C3%25AAtes">Exemples derequêtes</a><ul class="toc-headings"><li><a href="#classFunctions.html_utiliser-une-fonction-de-classe-de-datastore">Utiliser une fonction de classe de datastore</a></li><li><a href="#classFunctions.html_utiliser-une-fonction-de-classe-de-dataclass">Utiliser une fonction de classe de dataclass</a></li><li><a href="#classFunctions.html_utiliser-une-fonction-de-classe-dune-entit%25C3%25A9">Utiliser une fonction de classe d'une entité</a></li><li><a href="#classFunctions.html_utiliser-une-fonction-de-classe-dune-s%25C3%25A9lection-dentit%25C3%25A9">Utiliser une fonction de classe d'une sélection d'entité</a></li><li><a href="#classFunctions.html_utiliser-une-fonction-de-classe-de-s%25C3%25A9lection-dentit%25C3%25A9-et-un-ensemble-dentit%25C3%25A9">Utiliser une fonction de classe de sélection d'entité et unensemble d'entité</a></li><li><a href="#classFunctions.html_utiliser-une-fonction-de-classe-de-s%25C3%25A9lection-dentit%25C3%25A9-et-un-orderby">Utiliser une fonction de classe de sélection d'entité et un"orderBy"</a></li><li><a href="#classFunctions.html_utiliser-une-entit%25C3%25A9-%25C3%25A0-cr%25C3%25A9er-sur-le-serveur">Utiliser une entité à créer sur le serveur</a></li><li><a href="#classFunctions.html_utiliser-une-entit%25C3%25A9-%25C3%25A0-mettre-%25C3%25A0-jour-sur-le-serveur">Utiliser une entité à mettre à jour sur le serveur</a></li><li><a href="#classFunctions.html_cr%25C3%25A9er-une-entit%25C3%25A9-avec-une-entit%25C3%25A9-li%25C3%25A9e">Créer une entité avec une entité liée</a></li><li><a href="#classFunctions.html_mettre-%25C3%25A0-jour-une-entit%25C3%25A9-avec-une-entit%25C3%25A9-li%25C3%25A9e">Mettre à jour une entité avec une entité liée</a></li><li><a href="#classFunctions.html_recevoir-une-s%25C3%25A9lection-dentit%25C3%25A9-comme-param%25C3%25A8tre">Recevoir une sélection d'entité comme paramètre</a></li><li><a href="#classFunctions.html_utiliser-une-s%25C3%25A9lection-dentit%25C3%25A9-mise-%25C3%25A0-jour-sur-le-client">Utiliser une sélection d'entité mise à jour sur le client</a></li></ul></li></ul></nav></div></div></body></html>