<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="fr"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>MailAttachment · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="Les objets pièces jointes permettent de référencer des fichiers dans un objet [`Email`](/docs/Rx/fr/API/EmailObjectClass.html). Les objets Attachment (pièce jointe) sont créés à l'aide de la commande [`MAIL New attachment`](#mail-new-attachment)."name="description" /><meta content="fr" name="docsearch:language" /><meta content="MailAttachment · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="Les objets pièces jointes permettent de référencer des fichiers dans un objet [`Email`](/docs/Rx/fr/API/EmailObjectClass.html). Les objets Attachment (pièce jointe) sont créés à l'aide de la commande [`MAIL New attachment`](#mail-new-attachment)."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#MailAttachmentClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">MailAttachment<a aria-hidden="true" class="anchor" id="MailAttachmentClass.html"></a></h1></header><article><div><p><span>Les objets pièces jointes permettent de référencer desfichiers dans un objet <a href="#EmailObjectClass.html"><code>Email</code></a>. Les objetsAttachment (pièce jointe) sont créés à l'aide de la commande<a href="#MailAttachmentClass.html_mail-new-attachment"><code>MAILNew attachment</code></a>.</span></p><h3><span><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_objet-attachment"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_objet-attachment"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Objet Attachment</span></h3><p><span>Les objets Attachment fournissent les propriétés etfonctions suivantes en lecture seule :</span></p><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#MailAttachmentClass.html_cid"><strong>.cid</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; l'ID de la pièce jointe</p></td></tr><tr><td><a href="#MailAttachmentClass.html_disposition"><strong>.disposition</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;la valeur de l'en-tête<code>Content-Disposition</code></p></td></tr><tr><td><a href="#MailAttachmentClass.html_getcontent"><strong>.getContent()</strong>: 4D.Blob</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne le contenu de l'objet piècejointe dans un objet <code>4D.Blob</code></p></td></tr><tr><td><a href="#MailAttachmentClass.html_name"><strong>.name</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;le nom et l'extension de la piècejointe</p></td></tr><tr><td><a href="#MailAttachmentClass.html_path"><strong>.path</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;le chemin POSIX complet de la piècejointe, si elle existe</p></td></tr><tr><td><a href="#MailAttachmentClass.html_platformpath"><strong>.platformPath</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;le chemin complet de la pièce jointeexprimé avec la syntaxe de la plate-forme courante</p></td></tr><tr><td><a href="#MailAttachmentClass.html_type"><strong>.type</strong>: Texte</a><p>&nbsp;&nbsp;&nbsp;&nbsp;le <code>content-type</code> du fichierjoint</p></td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_mail-new-attachment"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_mail-new-attachment"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>MAIL New attachment</span></h2><details><summary><span>Historique</span></summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19 R2</td><td>Accepte 4D.File, 4D.ZipFile, 4D.Blob</td></tr></tbody></table></details><p><span><strong>MAIL New attachment</strong>( <em>file</em> :4D.File { ; <em>name</em> : Text {; <em>cid</em> : Text{ ;<em>type</em> : Text { ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment<br /><strong>MAIL New attachment</strong>( <em>zipFile</em> : 4D.ZipFile{ ; <em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> :Text { ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment<br /><strong>MAIL New attachment</strong>( <em>blob</em> : 4D.Blob { ;<em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> : Text{ ; <em>disposition</em> :Text } } } } ) : 4D.MailAttachment<br /><strong>MAIL New attachment</strong>( <em>path</em> : Text { ;<em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> : Text{ ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment</span></p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>file</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>Fichier joint</td></tr><tr><td>zipFile</td><td>4D.ZipFile</td><td style="text-align:center">-&gt;</td><td>Fichier Zip joint</td></tr><tr><td>blob</td><td>4D.Blob</td><td style="text-align:center">-&gt;</td><td>Blob contenant la pièce jointe</td></tr><tr><td>path</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Chemin de la pièce jointe</td></tr><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Nom + extension utilisés par le client de messagerie pourdésigner la pièce jointe</td></tr><tr><td>cid</td><td>Text</td><td style="text-align:center">-&gt;</td><td>ID de la pièce jointe (messages HTML uniquement) ou " " siaucun cid n'est requis</td></tr><tr><td>type</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Valeur de l'en-tête content-type</td></tr><tr><td>disposition</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Valeur de l'en-tête content-disposition : "inline" ou"attachment"</td></tr><tr><td>Résultat</td><td>4D.MailAttachment</td><td style="text-align:center">&lt;-</td><td>Objet pièce jointe</td></tr></tbody></table><h4><span><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_description"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_description"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span>La commande <code>MAIL New attachment</code> vous permetde créer un objet pièce jointe que vous pouvez associer à un objet<a href="#MailAttachmentClass.html_email-object">Email</a>.</span></p><p><span>Pour définir l'objet attachment, vous pouvez utiliser:</span></p><ul><li><span>un <em>file</em>, en passant un objet<code>4D.File</code> contenant le fichier joint.</span></li><li><span>un <em>zipfile</em>, en passant un objet<code>4D.ZipFile</code> contenant le fichier joint.</span></li><li><span>un <em>blob</em>, en passant un objet<code>4D.Blob</code> contenant la pièce jointeelle-même.</span></li><li><span>un <em>path</em>, en passant une valeur de type<strong>text</strong> contenant le chemin d'accès du fichier joint,exprimé avec la syntaxe du système. Vous pouvez passer un nom dechemin complet ou un simple nom de fichier (auquel cas 4Drecherchera le fichier dans le même répertoire que le fichier duprojet).</span></li></ul><p><span>Le paramètre facultatif <em>name</em> vous permet depasser le nom et l'extension à utiliser par le client de messageriepour désigner la pièce jointe. Si le paramètre <em>name</em> estomis et que :</span></p><ul><li><span>vous avez passé un chemin d'accès au fichier, le nom etl'extension du fichier sont utilisés,</span></li><li><span>vous avez passé un BLOB, un nom aléatoire sans extensionest automatiquement généré.</span></li></ul><p><span>Le paramètre facultatif <em>cid</em> vous permet de passerun ID interne pour la pièce jointe. Cet ID est la valeur del'en-tête <code>Content-Id</code> et sera utilisé dans les messagesHTML uniquement. Le cid associe la pièce jointe à une référencedéfinie dans le corps du message à l'aide d'une balise HTML telleque <code>\&lt;img src="cid:ID"&gt;</code>. Cela signifie que lecontenu de la pièce jointe (par exemple, une image) doit êtreaffiché dans le message sur le client de messagerie. Le résultatfinal peut varier en fonction du client de messagerie. Vous pouvezpasser une chaîne vide dans <em>cid</em> si vous ne souhaitez pasutiliser ce paramètre.</span></p><p><span>Vous pouvez utiliser le paramètre optionnel <em>type</em>pour définir explicitement le <code>content-type</code> du fichierjoint. Par exemple, vous pouvez passer une chaîne définissant untype MIME ("video/mpeg"). Cette valeur de content-type sera définiepour la pièce jointe, quelle que soit son extension. Pour plusd'informations sur les types MIME, veuillez vous référer à <a href="https://en.wikipedia.org/wiki/MIME">la page type MIME surWikipedia</a>.</span></p><p><span>Par défaut, si le paramètre <em>type</em> est omis oucontient une chaîne vide, le <code>content-type</code> du fichierjoint est basé sur son extension. Les règles suivantes sontappliquées pour les principaux types MIME :</span></p><table><thead><tr><th>Extension</th><th>Content Type</th></tr></thead><tbody><tr><td>jpg, jpeg</td><td>image/jpeg</td></tr><tr><td>png</td><td>image/png</td></tr><tr><td>gif</td><td>image/gif</td></tr><tr><td>pdf</td><td>application/pdf</td></tr><tr><td>doc</td><td>application/msword</td></tr><tr><td>xls</td><td>application/vnd.ms-excel</td></tr><tr><td>ppt</td><td>application/vnd.ms-powerpoint</td></tr><tr><td>zip</td><td>application/zip</td></tr><tr><td>gz</td><td>application/gzip</td></tr><tr><td>json</td><td>application/json</td></tr><tr><td>js</td><td>application/javascript</td></tr><tr><td>ps</td><td>application/postscript</td></tr><tr><td>xml</td><td>application/xml</td></tr><tr><td>htm, html</td><td>text/html</td></tr><tr><td>mp3</td><td>audio/mpeg</td></tr><tr><td><em>other</em></td><td>application/octet-stream</td></tr></tbody></table><p><span>Le paramètre facultatif <em>disposition</em> vous permetde passer l'en-tête <code>content-disposition</code> de la piècejointe. Vous pouvez passer l'une des constantes suivantes du thèmede constantes "Mail" :</span></p><table><thead><tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr></thead><tbody><tr><td>mail disposition attachment</td><td>"attachment"</td><td>Définissez la valeur de l'en-tête Content-disposition sur"attachment", ce qui signifie que le fichier joint doit être fournisous forme de lien dans le message.</td></tr><tr><td>mail disposition inline</td><td>"inline"</td><td>Définissez la valeur de l'en-tête Content-disposition sur"inline", ce qui signifie que la pièce jointe doit être rendue dansle contenu du message, à l'emplacement du "cid". Le rendu dépend duclient de messagerie.</td></tr></tbody></table><p><span>Par défaut, si le paramètre <em>disposition</em> est omis:</span></p><ul><li><span>si le paramètre <em>cid</em> est utilisé, l'en-tête<code>Content-disposition</code> est défini sur"inline",</span></li><li><span>si le paramètre <em>cid</em> n'est pas passé ou est vide,l'en-tête <code>Content-disposition</code> est fixé à"attachment".</span></li></ul><h4><span><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_exemple-1"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_exemple-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 1</span></h4><p><span>Vous souhaitez envoyer un e-mail avec un fichiersélectionné par l'utilisateur comme pièce jointe et une imageintégrée dans le corps HTML :</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-variable">$doc</span>:=<span class="hljs-function">Select document</span>(<span class="hljs-string">""</span>;<span class="hljs-string">"*"</span>;<span class="hljs-string">"Please select a file to attach"</span>;<span class="hljs-number">0</span>)<span class="hljs-keyword">If</span> (OK=<span class="hljs-number">1</span>) <span class="hljs-comment">//If a document was selected</span><span class="hljs-function">C_OBJECT</span>(<span class="hljs-variable">$email</span>;<span class="hljs-variable">$server</span>;<span class="hljs-variable">$transporter</span>)<span class="hljs-variable">$server</span>:=New object<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"smtp.mail.com"</span><span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"test_user@mail.com"</span><span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"p@ssw@rd"</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">SMTP New transporter</span>(<span class="hljs-variable">$server</span>)<span class="hljs-variable">$email</span>:=New object<span class="hljs-variable">$email</span>.from:=<span class="hljs-string">"test_user@mail.com"</span><span class="hljs-variable">$email</span>.to:=<span class="hljs-string">"test_user@mail.com"</span><span class="hljs-variable">$email</span>.subject:=<span class="hljs-string">"This is a test message with attachments"</span><span class="hljs-comment">//add a link to download file</span><span class="hljs-variable">$email</span>.attachments:=<span class="hljs-function">New collection</span>(<span class="hljs-function">MAIL New attachment</span>(Document))<span class="hljs-comment">//insert an inline picture (use a cid)</span><span class="hljs-variable">$email</span>.attachments[<span class="hljs-number">1</span>]:=<span class="hljs-function">MAIL New attachment</span>(<span class="hljs-string">"c:\\Pictures\\4D.jpg"</span>;<span class="hljs-string">""</span>;<span class="hljs-string">"4D"</span>)<span class="hljs-variable">$email</span>.htmlBody:=<span class="hljs-string">"&lt;html&gt;"</span>+\<span class="hljs-string">"&lt;body&gt;Hello World!"</span>+\<span class="hljs-string">"&lt;img src='cid:4D' &gt;"</span>+\<span class="hljs-string">"&lt;/body&gt;"</span>+\<span class="hljs-string">"&lt;/head&gt;"</span>+\<span class="hljs-string">"&lt;/html&gt;"</span><span class="hljs-variable">$transporter</span>.<span class="hljs-function">send</span>(<span class="hljs-variable">$email</span>) <span class="hljs-comment">//envoyer e-mail</span><span class="hljs-keyword">End if</span></code></span></pre><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_exemple-2"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_exemple-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 2</h4><p>Vous voulez envoyer un e-mail avec une zone 4D Write Pro enpièce jointe :</p><pre><code class="hljs css language-4d"><span class="hljs-function">C_BLOB</span>(<span class="hljs-variable">$blob</span>)<span class="hljs-function">WP EXPORT VARIABLE</span>(WPArea;<span class="hljs-variable">$blob</span>;wk docx)<span class="hljs-function">C_OBJECT</span>(<span class="hljs-variable">$email</span>;<span class="hljs-variable">$server</span>;<span class="hljs-variable">$transporter</span>)<span class="hljs-variable">$server</span>:=New object<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"smtp.mail.com"</span><span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"user@mail.com"</span><span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"p@ssw@rd"</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">SMTP New transporter</span>(<span class="hljs-variable">$server</span>)<span class="hljs-variable">$email</span>:=New object<span class="hljs-variable">$email</span>.from:=<span class="hljs-string">"user@mail.com"</span><span class="hljs-variable">$email</span>.to:=<span class="hljs-string">"customer@mail.com"</span><span class="hljs-variable">$email</span>.subject:=<span class="hljs-string">"New annual report"</span><span class="hljs-variable">$email</span>.textBody:=<span class="hljs-string">"Please find enclosed our latest annual report."</span><span class="hljs-variable">$email</span>.attachments:=<span class="hljs-function">New collection</span>(<span class="hljs-function">MAIL New attachment</span>(<span class="hljs-variable">$blob</span>;<span class="hljs-string">"Annual report.docx"</span>))<span class="hljs-variable">$transporter</span>.<span class="hljs-function">send</span>(<span class="hljs-variable">$email</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_4dmailattachmentnew"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_4dmailattachmentnew"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4D.MailAttachment.new()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19 R2</td><td>Accepte 4D.File, 4D.ZipFile, 4D.Blob</td></tr></tbody></table></details><p><strong>4D.MailAttachment.new</strong>( <em>file</em> : 4D.File{ ; <em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> :Text { ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment<br /><strong>4D.MailAttachment.new</strong>( <em>zipFile</em> :4D.ZipFile { ; <em>name</em> : Text {; <em>cid</em> : Text{ ;<em>type</em> : Text { ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment<br /><strong>4D.MailAttachment.new</strong>( <em>blob</em> : 4D.Blob { ;<em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> : Text{ ; <em>disposition</em> :Text } } } } ) : 4D.MailAttachment<br /><strong>4D.MailAttachment.new</strong>( <em>path</em> : Text { ;<em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> : Text{ ; <em>disposition</em> :Text } } } } ) : 4D.MailAttachment</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>file</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>Fichier joint</td></tr><tr><td>zipFile</td><td>4D.ZipFile</td><td style="text-align:center">-&gt;</td><td>Fichier Zip joint</td></tr><tr><td>blob</td><td>4D.Blob</td><td style="text-align:center">-&gt;</td><td>Blob contenant la pièce jointe</td></tr><tr><td>path</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Chemin de la pièce jointe</td></tr><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Nom + extension utilisés par le client de messagerie pourdésigner la pièce jointe</td></tr><tr><td>cid</td><td>Text</td><td style="text-align:center">-&gt;</td><td>ID de la pièce jointe (messages HTML uniquement) ou " " siaucun cid n'est requis</td></tr><tr><td>type</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Valeur de l'en-tête content-type</td></tr><tr><td>disposition</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Valeur de l'en-tête content-disposition : "inline" ou"attachment"</td></tr><tr><td>Résultat</td><td>4D.MailAttachment</td><td style="text-align:center">&lt;-</td><td>Objet pièce jointe</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_description-1"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_description-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>4D.MailAttachment.new()</code> crée etretourne un nouvel objet de type <code>4D.MailAttachment</code>.Elle est identique à la commande <a href="#MailAttachmentClass.html_mail-new-attachment"><code>MAIL Newattachment</code></a> (raccourci).</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_cid"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_cid"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.cid</h2><p><strong>.cid</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_description-2"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_description-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.cid</code> contient l'ID de la pièce jointe.Cette propriété est utilisée uniquement dans les messages HTML. Sicette propriété est manquante, le fichier est géré comme une simplepièce jointe (lien).</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_disposition"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_disposition"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.disposition</h2><p><strong>.disposition</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_description-3"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_description-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.disposition</code> contient la valeur del'en-tête <code>Content-Disposition</code>. Deux valeurs sontdisponibles :</p><ul><li>"inline" : la pièce jointe est rendue dans le contenu dumessage, à l'emplacement "cid". Le rendu dépend du client demessagerie.</li><li>"attachment" : la pièce jointe est fournie sous forme de liendans le message.</li></ul><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_getcontent"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_getcontent"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getContent()</h2><p><strong>.getContent()</strong> : 4D.Blob</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>4D.Blob</td><td style="text-align:center">&lt;-</td><td>Contenu de la pièce jointe</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_description-4"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_description-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.getContent()</code> retourne le contenu del'objet pièce jointe dans un objet <code>4D.Blob</code>. Vouspouvez utiliser cette fonction avec les objets pièce jointe reçuspar la commande <a href="#MailAttachmentClass.html_mail-convert-from-mime"><code>MAILConvert from MIME</code></a>.</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_name"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_name"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.name</h2><p><strong>.name</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_description-5"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_description-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.name</code> contient le nom et l'extensionde la pièce jointe. Par défaut, c'est le nom du fichier, sauf si unautre nom a été indiqué dans la commande <a href="#MailAttachmentClass.html_mail-new-attachment"><code>MAIL Newattachment</code></a>.</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_path"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_path"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.path</h2><p><strong>.path</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_description-6"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_description-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.path</code> contient le chemin POSIX completde la pièce jointe, si elle existe.</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_platformpath"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_platformpath"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.platformPath</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19</td><td>Ajout</td></tr></tbody></table></details><p><strong>.platformPath</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_description-7"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_description-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.platformPath</code> contient le chemincomplet de la pièce jointe exprimé avec la syntaxe de laplate-forme courante.</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_type"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_type"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.type</h2><p><strong>.type</strong> : Texte</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_description-8"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_description-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.type</code> contient le<code>content-type</code> du fichier joint. Si ce type n'est pasexplicitement passé à la commande <a href="#MailAttachmentClass.html_mail-new-attachment"><code>MAIL Newattachment</code></a>, le <code>content-type</code> est fondé surson extension de fichier.</p><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#IMAPTransporterClass.html"><span class="arrow-prev">←</span><span>IMAPTransporter</span></a><a class="docs-next button" href="#POP3TransporterClass.html"><span>POP3Transporter</span><span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#MailAttachmentClass.html_mail-new-attachment">MAILNew attachment</a></li><li><a href="#MailAttachmentClass.html_4dmailattachmentnew">4D.MailAttachment.new()</a></li><li><a href="#MailAttachmentClass.html_cid">.cid</a></li><li><a href="#MailAttachmentClass.html_disposition">.disposition</a></li><li><a href="#MailAttachmentClass.html_getcontent">.getContent()</a></li><li><a href="#MailAttachmentClass.html_name">.name</a></li><li><a href="#MailAttachmentClass.html_path">.path</a></li><li><a href="#MailAttachmentClass.html_platformpath">.platformPath</a></li><li><a href="#MailAttachmentClass.html_type">.type</a></li></ul></nav></div></div></body></html>