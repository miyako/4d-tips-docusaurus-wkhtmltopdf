<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="fr"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Entity · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="Une [entity](/docs/Rx/fr/ORDA/dsmapping.html#entity) est une instance d'une [Dataclass](/docs/Rx/fr/ORDA/dsmapping.html#dataclass), tel un enregistrement de la table correspondant à la dataclass contenue dans son datastore associé. Elle contient les mêmes attributs que la dataclass ainsi que les valeurs des données et des propriétés et fonctions spécifiques."name="description" /><meta content="fr" name="docsearch:language" /><meta content="Entity · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="Une [entity](/docs/Rx/fr/ORDA/dsmapping.html#entity) est une instance d'une [Dataclass](/docs/Rx/fr/ORDA/dsmapping.html#dataclass), tel un enregistrement de la table correspondant à la dataclass contenue dans son datastore associé. Elle contient les mêmes attributs que la dataclass ainsi que les valeurs des données et des propriétés et fonctions spécifiques."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#EntityClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">Entity<a aria-hidden="true" class="anchor" id="EntityClass.html"></a></h1></header><article><div><p><span>Une <a href="#EntityClass.html_entity">entity</a> est uneinstance d'une <a href="#EntityClass.html_dataclass">Dataclass</a>,tel un enregistrement de la table correspondant à la dataclasscontenue dans son datastore associé. Elle contient les mêmesattributs que la dataclass ainsi que les valeurs des données et despropriétés et fonctions spécifiques.</span></p><h3><span><a aria-hidden="true" class="anchor" id="EntityClass.html_sommaire"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_sommaire"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Sommaire</span></h3><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#EntityClass.html_attributename"><strong><em>.attributeName</em></strong>: any</a><p>&nbsp;&nbsp;&nbsp;&nbsp;stocke la valeur de l'attribut pourl'entité</p></td></tr><tr><td><a href="#EntityClass.html_clone"><strong>.clone()</strong> :4D.Entity</a><p>&nbsp;&nbsp;&nbsp;&nbsp;crée en mémoire une nouvelle entitéréférençant le même enregistrement que l'entité d’origine</p></td></tr><tr><td><a href="#EntityClass.html_diff"><strong>.diff</strong>(<em>entityToCompare</em> : 4D.Entity { ;<em>attributesToCompare</em> : Collection } ) : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;compare le contenu de deux entités etretourne leurs différences</p></td></tr><tr><td><a href="#EntityClass.html_drop"><strong>.drop</strong>({<em>mode</em> : Integer} ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;supprime les données de l'entité de latable associée à la dataclass</p></td></tr><tr><td><a href="#EntityClass.html_first"><strong>.first()</strong>:4D.Entity</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne une référence vers l'entité enpremière position dans l'entity selection à laquelle appartientl'entité</p></td></tr><tr><td><a href="#EntityClass.html_fromobject"><strong>.fromObject</strong>(<em>filler</em> : Object )</a><p>&nbsp;&nbsp;&nbsp;&nbsp;remplit les attributs de l'entité avecle contenu de <em>filler</em></p></td></tr><tr><td><a href="#EntityClass.html_getdataclass"><strong>.getDataClass()</strong> :4D.DataClass</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne la dataclass de l'entité</p></td></tr><tr><td><a href="#EntityClass.html_getkey"><strong>.getKey</strong>( {<em>mode</em> : Integer } ) : Text<br /><strong>.getKey</strong>( { <em>mode</em> : Integer } ) :Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne la valeur de la clé primaire del'entité</p></td></tr><tr><td><a href="#EntityClass.html_getremotecontextattributes"><strong>.getRemoteContextAttributes()</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne des informations relatives aucontexte d'optimisation utilisé par l'entity</p></td></tr><tr><td><a href="#EntityClass.html_getselection"><strong>.getSelection()</strong>:4D.EntitySelection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne l'entity selection à laquelleappartient l'entité</p></td></tr><tr><td><a href="#EntityClass.html_getstamp"><strong>.getStamp()</strong> :Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp; retourne la valeur courante du stamp del'entité</p></td></tr><tr><td><a href="#EntityClass.html_indexof"><strong>.indexOf</strong>({ <em>entitySelection</em> : 4D.EntitySelection } ) : Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne la position de l'entité dansune entity selection</p></td></tr><tr><td><a href="#EntityClass.html_isnew"><strong>.isNew()</strong> :Boolean</a><p>&nbsp;&nbsp;&nbsp;&nbsp; renvoie Vrai si l'entité à laquelleelle est appliquée vient d'être créée et n'a pas encore étéenregistrée dans le datastore</p></td></tr><tr><td><a href="#EntityClass.html_last"><strong>.last()</strong> :4D.Entity</a><p>&nbsp;&nbsp;&nbsp;&nbsp;renvoie une référence vers l'entité endernière position dans l'entity selection à laquelle l'entitéappartient</p></td></tr><tr><td><a href="#EntityClass.html_lock"><strong>.lock</strong>( {<em>mode</em> : Integer } ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;pose un verrou pessimiste surl'enregistrement référencé par l'entité</p></td></tr><tr><td><a href="#EntityClass.html_next"><strong>.next()</strong> :4D.Entity</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne une référence sur l'entitésuivante dans l'entity selection à laquelle appartient l'entité</p></td></tr><tr><td><a href="#EntityClass.html_previous"><strong>.previous()</strong> :4D.Entity</a><p>&nbsp;&nbsp;&nbsp;&nbsp; retourne une référence sur l'entitéprécédente dans l'entity selection à laquelle appartientl'entité</p></td></tr><tr><td><a href="#EntityClass.html_reload"><strong>.reload()</strong> :Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;recharge en mémoire le contenu del'entité</p></td></tr><tr><td><a href="#EntityClass.html_save"><strong>.save</strong>( {<em>mode</em> : Integer } ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;sauvegarde les modifications effectuéessur l'entité</p></td></tr><tr><td><a href="#EntityClass.html_toobject"><strong>.toObject</strong>() :Object<br /><strong>.toObject</strong>( <em>filterString</em> : Text { ;<em>options</em> : Integer} ) : Object<br /><strong>.toObject</strong>( <em>filterCol</em> : Collection { ;<em>options</em> : Integer } ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne un objet construit à partir del'entité</p></td></tr><tr><td><a href="#EntityClass.html_touched"><strong>.touched()</strong>: Boolean</a><p>&nbsp;&nbsp;&nbsp;&nbsp;indique si un attribut de l'entité a étémodifié ou non depuis que l'entité a été chargée en mémoire ousauvegardée</p></td></tr><tr><td><a href="#EntityClass.html_touchedattributes"><strong>.touchedAttributes()</strong>: Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne les noms des attributs qui ontété modifiés depuis que l'entité a été chargée en mémoire</p></td></tr><tr><td><a href="#EntityClass.html_unlock"><strong>.unlock()</strong> :Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;supprime le verrou pessimiste posé surl'enregistrement correspondant à l'entité</p></td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="EntityClass.html_attributename"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_attributename"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.<em>attributeName</em></span></h2><details><summary><span>Historique</span></summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><span><strong><em>.attributeName</em></strong> : any</span></p><h4><span><a aria-hidden="true" class="anchor" id="EntityClass.html_description"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span>Tout attribut de dataclass est disponible en tant quepropriété des entités de la dataclass, et qui stocke la valeur del'attribut pour l'entité.</span></p><blockquote><p><span>Les attributs de dataclass peuvent également être obtenusen utilisant la syntaxe alternative avec [ ].</span></p></blockquote><p><span>Le type de valeur de l'attribut dépend du type (<a href="#EntityClass.html_kind">kind</a>) d'attribut (relation oustockage) :</span></p><ul><li><span>Si le type de <em>attributeName</em> est<strong>storage</strong> : <code>.attributeName</code> retourne unevaleur du même type que <em>attributeName</em>.</span></li><li><span>Si le type de <em>attributeName</em> est<strong>relatedEntity</strong> : <code>.attributeName</code>retourne une entité reliée. Les valeurs de l'entité liée sontdirectement disponibles par le biais des propriétés en cascade, parexemple "myEntity.employer.employees[0].lastname".</span></li><li><span>Si le type de <em>attributName</em> est<strong>relatedEntities</strong> : <code>.attributeName</code>retourne une nouvelle entity selection d'entités liées. Lesdoublons sont supprimés (une entity selection non ordonnée estretournée).</span></li></ul><h4><span><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</span></h4><pre><span><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$myEntity </span>: cs.EmployeeEntity<span class="hljs-variable">$myEntity</span>:=ds.Employee.<span class="hljs-function">new</span>() <span class="hljs-comment">//Créer une nouvelle entity</span><span class="hljs-variable">$myEntity</span>.name:=<span class="hljs-string">"Dupont"</span> <span class="hljs-comment">//assigner 'Dupont' à l'attribut 'name'</span><span class="hljs-variable">$myEntity</span>.firstname:=<span class="hljs-string">"John"</span> <span class="hljs-comment">//assigner 'John' à l'attribut 'firstname' </span><span class="hljs-variable">$myEntity</span>.<span class="hljs-function">save</span>() <span class="hljs-comment">//sauvegarder l'entity</span></code></span></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_clone"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_clone"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.clone()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.clone()</strong> : 4D.Entity</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>4D.Entity</td><td style="text-align:center">&lt;-</td><td>Nouvelle entité référençant l'enregistrement</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.clone()</code> crée en mémoire une nouvelleentité référençant le même enregistrement que l'entité d’origine.Cette fonction vous permet de mettre à jour des entitésséparément.</p><blockquote><p>A noter que toute modification apportée aux entités n'eststockée dans l'enregistrement référencé qu'au moment où la fonction<a href="#EntityClass.html_save"><code>.save( )</code></a> estexécutée.</p></blockquote><p>Cette fonction ne peut être utilisée qu'avec des entités déjàenregistrées dans la base de données. Elle ne peut pas être appeléesur une entité nouvellement créée (pour laquelle <a href="#EntityClass.html_isnew"><code>.isNew()</code></a> retourne<strong>True</strong>).</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$emp</span>; <span class="hljs-variable">$empCloned </span>: cs.EmployeeEntity <span class="hljs-variable">$emp</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">672</span>) <span class="hljs-variable">$empCloned</span>:=<span class="hljs-variable">$emp</span>.<span class="hljs-function">clone</span>() <span class="hljs-variable">$emp</span>.lastName:=<span class="hljs-string">"Smith"</span> <span class="hljs-comment">//Les mises à jour effectuées sur $emp ne le sont pas sur $empCloned</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_diff"></a><a aria-hidden="true" class="hash-link"href="#EntityClass.html_diff"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.diff()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.diff</strong>( <em>entityToCompare</em> : 4D.Entity { ;<em>attributesToCompare</em> : Collection } ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>entityToCompare</td><td>4D.Entity</td><td style="text-align:center">-&gt;</td><td>Entité à comparer à l'entité d'origine</td></tr><tr><td>attributesToCompare</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Noms des attributs à comparer</td></tr><tr><td>Résultat</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Différences entre les entités</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-2"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.diff()</code> compare le contenu de deuxentités et retourne leurs différences.</p><p>Dans le paramètre <em>entityToCompare</em>, passez l'entité àcomparer à l'entité d'origine.</p><p>Dans le paramètre <em>attributesToCompare</em>, vous pouvezdésigner les attributs spécifiques à comparer. Si le paramètre estpassé, la comparaison est effectuée uniquement sur les attributsspécifiés. S'il est omis, toutes les différences entre les entitéssont retournées.</p><p>Les différences sont retournées sous forme de collectiond'objets dont les propriétés sont :</p><table><thead><tr><th>Nom de propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>attributeName</td><td>String</td><td>Nom de l'attribut</td></tr><tr><td>value</td><td>Dépend du type d'attribut</td><td>Valeur de l'attribut dans l'entité d'origine</td></tr><tr><td>otherValue</td><td>Dépend du type d'attribut</td><td>Valeur de l'attribut dans <em>entityToCompare</em></td></tr></tbody></table><p>Seuls les attributs dont les valeurs diffèrent sont inclus dansla collection. Si aucune différence n'est trouvée,<code>.diff()</code> retourne une collection vide.</p><p>La fonction s'applique aux attributs dont le <a href="#EntityClass.html_kind">kind</a> est <strong>storage</strong> ou<strong>relatedEntity</strong>. Dans le cas où une entité liée aété mise à jour (c'est-à-dire la clé étrangère), le nom de l'entitéliée et de sa clé primaire sont retournés comme propriétés<em>attributeName</em> (<em>value</em> et <em>otherValue</em> sontvides pour l'entité liée).</p><p>Si l'une des entités comparées vaut <strong>Null</strong>, uneerreur est retournée.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-1-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-1-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 1</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$diff1</span>; <span class="hljs-variable">$diff2 </span>: Collection employee:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"ID=1001"</span>).<span class="hljs-function">first</span>() <span class="hljs-variable">$clone</span>:=employee.<span class="hljs-function">clone</span>() employee.firstName:=<span class="hljs-string">"MARIE"</span> employee.lastName:=<span class="hljs-string">"SOPHIE"</span> employee.salary:=<span class="hljs-number">500</span> <span class="hljs-variable">$diff1</span>:=<span class="hljs-variable">$clone</span>.<span class="hljs-function">diff</span>(employee) <span class="hljs-comment">// Toutes les différences sont retournées</span> <span class="hljs-variable">$diff2</span>:=<span class="hljs-variable">$clone</span>.<span class="hljs-function">diff</span>(employee;New collection<span class="hljs-string">"firstName"</span>;<span class="hljs-string">"lastName"</span>))  <span class="hljs-comment">// Seules les différences relevées sur firstName et lastName sont retournées</span></code></pre><p>$diff1:</p><pre><code class="hljs css language-4d">[    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"firstName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Natasha"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"MARIE"</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"lastName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Locke"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"SOPHIE"</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"salary"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-number">66600</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-number">500</span>    }]<span class="hljs-variable">$diff2</span>:[    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"firstName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Natasha"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"MARIE"</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"lastName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Locke"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"SOPHIE"</span>    }]</code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-2"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 2</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> vCompareResult1; vCompareResult2; vCompareResult3; <span class="hljs-variable">$attributesToInspect </span>: Collection vCompareResult1:=New collection vCompareResult2:=New collection vCompareResult3:=New collection <span class="hljs-variable">$attributesToInspect</span>:=New collection <span class="hljs-variable">$e1</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">636</span>) <span class="hljs-variable">$e2</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">636</span>) <span class="hljs-variable">$e1</span>.firstName:=<span class="hljs-variable">$e1</span>.firstName+<span class="hljs-string">" update"</span> <span class="hljs-variable">$e1</span>.lastName:=<span class="hljs-variable">$e1</span>.lastName+<span class="hljs-string">" update"</span> <span class="hljs-variable">$c</span>:=ds.Company.<span class="hljs-function">get</span>(<span class="hljs-number">117</span>) <span class="hljs-variable">$e1</span>.employer:=<span class="hljs-variable">$c</span> <span class="hljs-variable">$e2</span>.salary:=<span class="hljs-number">100</span> <span class="hljs-variable">$attributesToInspect</span>.<span class="hljs-function">push</span>(<span class="hljs-string">"firstName"</span>) <span class="hljs-variable">$attributesToInspect</span>.<span class="hljs-function">push</span>(<span class="hljs-string">"lastName"</span>) vCompareResult1:=<span class="hljs-variable">$e1</span>.<span class="hljs-function">diff</span>(<span class="hljs-variable">$e2</span>) vCompareResult2:=<span class="hljs-variable">$e1</span>.<span class="hljs-function">diff</span>(<span class="hljs-variable">$e2</span>;<span class="hljs-variable">$attributesToInspect</span>) vCompareResult3:=<span class="hljs-variable">$e1</span>.<span class="hljs-function">diff</span>(<span class="hljs-variable">$e2</span>;<span class="hljs-variable">$e1</span>.<span class="hljs-function">touchedAttributes</span>())</code></pre><p>vCompareResult1 (toutes les différences sont retournées) :</p><pre><code class="hljs css language-4d">[    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"firstName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Karla update"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"Karla"</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"lastName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Marrero update"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"Marrero"</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"salary"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-number">33500</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-number">100</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"employerID"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-number">117</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-number">118</span>    },  {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"employer"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"[object Entity]"</span>,<span class="hljs-comment">// Entity 117 de Company</span>        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"[object Entity]"</span><span class="hljs-comment">// Entity 118 de Company</span>    }]</code></pre><p>vCompareResult2 (seules les différences sur $attributesToInspectsont retournées)</p><pre><code class="hljs css language-4d">[    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"firstName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Karla update"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"Karla"</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"lastName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Marrero update"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"Marrero"</span>    }]</code></pre><p>vCompareResult3 (seules les différences sur les attributstouchés de $e1 sont retournés)</p><pre><code class="hljs css language-4d">[    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"firstName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Karla update"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"Karla"</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"lastName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Marrero update"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"Marrero"</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"employerID"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-number">117</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-number">118</span>    },     {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"employer"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"[object Entity]"</span>,<span class="hljs-comment">// Entity 117 de Company</span>        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"[object Entity]"</span><span class="hljs-comment">// Entity 118 de Company</span>    }]</code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_drop"></a><a aria-hidden="true" class="hash-link"href="#EntityClass.html_drop"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.drop()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.drop</strong>( {<em>mode</em> : Integer} ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>mode</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>dk force drop if stamp changed</code> : Force lasuppression même si le marqueur interne a changé</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Résultat de l'opération de suppression</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-3"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.drop()</code> supprime les données del'entité de la table associée à la dataclass. A noter que l'entitéreste en mémoire.</p><p>Dans une application multiprocess ou multi-utilisateurs, lafonction <code>.drop()</code> est exécutée en mode <a href="#EntityClass.html_verrouillage-d-une-entite">"verrouillageoptimiste"</a> dans lequel un marqueur de verrouillage interne estautomatiquement incrémenté à chaque sauvegarde del'enregistrement.</p><p>Par défaut, lorsque le paramètre <em>mode</em> est omis, laméthode retourne une erreur (cf. ci-dessous) si l'entité a étémodifiée (i.e. le marqueur interne a changé) entre-temps par unautre process ou utilisateur.</p><p>Sinon, vous pouvez passer l'option <code>dk force drop if stampchanged</code> dans le paramètre <em>mode</em> : dans ce cas,l'entité est supprimée même si la valeur du marqueur interne estdifférente (si la clé primaire est identique).</p><p><strong>Résultat</strong></p><p>L'objet retourné par <code>.drop( )</code> contient lespropriétés suivantes :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>boolean</td><td>vrai si l'action de suppression a été effectuée avec succès,sinon Faux.</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible uniquement en cas d'erreur:</em></strong></td></tr><tr><td>status(*)</td><td></td><td>number</td><td>Code d'erreur, voir ci-dessous</td></tr><tr><td>statusText(*)</td><td></td><td>text</td><td>Description de l'erreur, voir ci-dessous</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible uniquement en cas d'erreur deverrouillage pessimiste :</em></strong></td></tr><tr><td>LockKindText</td><td></td><td>text</td><td>"Locked by record"</td></tr><tr><td>lockInfo</td><td></td><td>object</td><td>Information sur l'origine du verrouillage</td></tr><tr><td></td><td>task_id</td><td>number</td><td>Id du process</td></tr><tr><td></td><td>user_name</td><td>text</td><td>Nom d'utilisateur de la session sur la machine</td></tr><tr><td></td><td>user4d_alias</td><td>text</td><td>Alias utilisateur si défini avec <code>SET USER ALIAS</code>,sinon le nom d'utilisateur dans le répertoire de la base 4D</td></tr><tr><td></td><td>host_name</td><td>text</td><td>Nom de la machine</td></tr><tr><td></td><td>task_name</td><td>text</td><td>Nom du process</td></tr><tr><td></td><td>client_version</td><td>text</td><td></td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible uniquement en cas d'erreur critique (cléprimaire dupliquée, disque plein..) :</em></strong></td></tr><tr><td>errors</td><td></td><td>collection of objects</td><td></td></tr><tr><td></td><td>message</td><td>text</td><td>Message d'erreur</td></tr><tr><td></td><td>component signature</td><td>text</td><td>signature du composant interne (e.g. "dmbg" pour le composantde base de données)</td></tr><tr><td></td><td>errCode</td><td>number</td><td>Code d'erreur</td></tr></tbody></table><p>(*) Les valeurs suivantes peuvent être retournées dans lespropriétés <em>status</em> et <em>statusText</em> de l'objet<em>Résultat</em> en cas d'erreur :</p><table><thead><tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr></thead><tbody><tr><td><code>dk status entity does not exist anymore</code></td><td>5</td><td>L'entité n'existe plus dans les données. Cette erreur peut seproduire dans les cas suivants :<br /><ul><li>l'entité a été supprimée (le stamp est modifié et l'espacemémoire est libéré)</li><li>l'entité a été supprimée et remplacée par une autre avec uneclé primaire différente (le stamp est modifié et une nouvelleentité occupe l'espace mémoire). Avec drop( ), cette erreur peutêtre retournée lorsque l'option dk force drop if stamp changed estutilisée. Avec lock( ), cette erreur peut être retournée lorsquel'option dk reload if stamp changed est utilisée</li><p><strong>statusText associé</strong> : "Entity does not existanymore"</p></ul></td></tr><tr><td><code>dk status locked</code></td><td>3</td><td>L'entité est verrouillée par un verrou pessimiste.<br /><strong>statusText associé</strong> : "Already locked"</td></tr><tr><td><code>dk status serious error</code></td><td>4</td><td>Une erreur critique peut être une erreur de bas niveau de labase de données (ex. clé dupliquée), une erreur matérielle,etc.<br /><strong>statusText associé</strong> : "Other error"</td></tr><tr><td><code>dk status stamp has changed</code></td><td>2</td><td>La valeur du marqueur interne (stamp) de l'entité ne correspondpas à celle de l'entité stockée dans les données (verrouillageoptimiste).<br /><ul><li>avec <code>.save( )</code> : erreur uniquement si l'option<code>dk auto merge</code> n'est pas utilisée</li><li>avec <code>.drop( )</code> : erreur uniquement si l'option<code>dk force drop if stamp changed</code> n'est pas utilisée</li><li>avec <code>.lock( )</code> : erreur uniquement si l'option<code>dk reload if stamp changed</code> n'est pas utilisée</li><li><strong>statusText associé</strong> : "Stamp has changed"</li></ul></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-1-2"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-1-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 1</h4><p>Exemple sans option <code>dk force drop if stamp changed</code>:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName=:1"</span>;<span class="hljs-string">"Smith"</span>) <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>.<span class="hljs-function">first</span>() <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">drop</span>()<span class="hljs-keyword"> Case of</span>    :(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"You have dropped "</span>+<span class="hljs-variable">$employee</span>.firstName+<span class="hljs-string">" "</span>+<span class="hljs-variable">$employee</span>.lastName) <span class="hljs-comment">//L'entité supprimée reste en mémoire</span>    :(<span class="hljs-variable">$status</span>.status=dk status stamp has changed)<span class="hljs-function">       ALERT</span>(<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End case</span></code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-2-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-2-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 2</h4><p>Même exemple avec l'option <code>dk force drop if stampchanged</code> :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName=:1"</span>;<span class="hljs-string">"Smith"</span>) <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>.<span class="hljs-function">first</span>() <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">drop</span>(dk force drop if stamp changed)<span class="hljs-keyword"> Case of</span>    :(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"You have dropped "</span>+<span class="hljs-variable">$employee</span>.firstName+<span class="hljs-string">" "</span>+<span class="hljs-variable">$employee</span>.lastName) <span class="hljs-comment">//L'entité supprimée reste en mémoire</span>    :(<span class="hljs-variable">$status</span>.status=dk status entity does not exist anymore)<span class="hljs-function">       ALERT</span>(<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End case</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_first"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_first"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.first()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.first()</strong>: 4D.Entity</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>4D.Entity</td><td style="text-align:center">&lt;-</td><td>Référence à la première entité de l'entity selection (Null sinon trouvée)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-4"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.first()</code> retourne une référence versl'entité en première position dans l'entity selection à laquelleappartient l'entité.</p><p>Si l'entité n'appartient à aucune entity selection (i.e.<a href="#EntityClass.html_getselection">.getSelection( )</a>retourne Null), la fonction renvoie une valeur Null.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-3"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee</span>; <span class="hljs-variable">$firstEmployee </span>: cs.EmployeeEntity <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName = :1"</span>;<span class="hljs-string">"H@"</span>) <span class="hljs-comment">//Cette entity selection contient 3 entités</span> <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>[<span class="hljs-number">2</span>] <span class="hljs-variable">$firstEmployee</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">first</span>() <span class="hljs-comment">//$firstEmployee est la première entité de l'entity selection $employees</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_fromobject"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_fromobject"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.fromObject()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.fromObject</strong>( <em>filler</em> : Object )</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>filler</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Objet avec lequel remplir l'entité</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-5"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-5"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.fromObject()</code> remplit les attributs del'entité avec le contenu de <em>filler</em>.</p><blockquote><p>Cette fonction modifie l'entity d'origine.</p></blockquote><p>La correspondance entre l'objet et l'entité est établie à partirdes noms de propriétés/d'attributs :</p><ul><li>Si une propriété de l'objet n'existe pas dans la dataclass,elle est ignorée.</li><li>Les types de données doivent être équivalents. S'il existe unedifférence de type entre l'objet et la dataclass, 4D essaie deconvertir les données lorsque cela est possible (voir <a href="#EntityClass.html_converting-data-types"><code>Conversion destypes de données</code></a>), sinon l'attribut demeure intact.</li><li>La clé primaire peut être donnée telle quelle ou avec unepropriété "__KEY" (remplie avec la valeur de la clé primaire). Sielle n'existe pas déjà dans la dataclass, l'entité est créée avecla valeur donnée lorsque <a href="#EntityClass.html_save">.save()</a> est appelé. Si la clé primairen'est pas fournie, l'entité est créée et la valeur de la cléprimaire est affectée en fonction des règles de la base de données.L'auto-incrémentation n'est calculée que si la clé primaire estnulle.</li></ul><p><em>filler</em> peut contenir une related entity dans lesconditions suivantes :</p><ul><li><em>filler</em> contient lui-même la clé étrangère, ou</li><li><em>filler</em> contient une propriété de type objet qui a lemême nom que l'entité relative, contenant une seule propriéténommée "__KEY".</li><li>si l'entité relative n'existe pas, elle est ignorée.</li></ul><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-4"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><p>Avec l'objet $o suivant :</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Mary"</span>,    <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Smith"</span>,    <span class="hljs-string">"salary"</span>: <span class="hljs-number">36500</span>,    <span class="hljs-string">"birthDate"</span>: <span class="hljs-string">"1958-10-27T00:00:00.000Z"</span>,    <span class="hljs-string">"woman"</span>: true,    <span class="hljs-string">"managerID"</span>: <span class="hljs-number">411</span>,<span class="hljs-comment">// relatedEntity fournie avec clé primaire</span>    <span class="hljs-string">"employerID"</span>: <span class="hljs-number">20</span> <span class="hljs-comment">// relatedEntity fournie avec clé primaire</span>}</code></pre><p>Le code suivant créera une entité avec les entités relativesmanager et employer.</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$o </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$entity </span>: cs.EmpEntity <span class="hljs-variable">$entity</span>:=ds.Emp.<span class="hljs-function">new</span>() <span class="hljs-variable">$entity</span>.<span class="hljs-function">fromObject</span>(<span class="hljs-variable">$o</span>) <span class="hljs-variable">$entity</span>.<span class="hljs-function">save</span>()</code></pre><p>Vous pouvez également utiliser une entité relative fournie sousforme d'objet :</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Marie"</span>,    <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Lechat"</span>,    <span class="hljs-string">"salary"</span>: <span class="hljs-number">68400</span>,    <span class="hljs-string">"birthDate"</span>: <span class="hljs-string">"1971-09-03T00:00:00.000Z"</span>,    <span class="hljs-string">"woman"</span>: false,    <span class="hljs-string">"employer"</span>: {<span class="hljs-comment">// relatedEntity fournie sous forme d'objet</span>        <span class="hljs-string">"__KEY"</span>: <span class="hljs-string">"21"</span>    },    <span class="hljs-string">"manager"</span>: {<span class="hljs-comment">// relatedEntity fournie sous forme d'objet</span>        <span class="hljs-string">"__KEY"</span>: <span class="hljs-string">"411"</span>    }}</code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_getdataclass"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_getdataclass"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getDataClass()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R5</td><td>Ajout</td></tr></tbody></table></details><p><strong>.getDataClass()</strong> : 4D.DataClass</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>4D.DataClass</td><td style="text-align:center">&lt;-</td><td>Dataclass à laquelle appartient l'entité</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-6"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-6"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.getDataClass()</code> retourne la dataclassde l'entité. Cette fonction est utile pour l'écriture du codegénérique.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-5"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-5"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><p>Le code générique suivant duplique toute entité :</p><pre><code class="hljs css language-4d">  <span class="hljs-comment">//méthode duplicate_entity </span>  <span class="hljs-comment">//duplicate_entity($entity) </span> #<span class="hljs-function">DECLARE</span>(<span class="hljs-variable">$entity </span>: 4D.Entity)<span class="hljs-keyword">   var</span> <span class="hljs-variable">$entityNew </span>: 4D.Entity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$entityNew</span>:=<span class="hljs-variable">$entity</span>.<span class="hljs-function">getDataClass</span>().<span class="hljs-function">new</span>() <span class="hljs-comment">//crée une nouvelle entité dans la dataclass parente</span> <span class="hljs-variable">$entityNew</span>.<span class="hljs-function">fromObject</span>(<span class="hljs-variable">$entity</span>.<span class="hljs-function">toObject</span>()) <span class="hljs-comment">//lire tous les attributs</span> <span class="hljs-variable">$entityNew</span>[<span class="hljs-variable">$entity</span>.<span class="hljs-function">getDataClass</span>().<span class="hljs-function">getInfo</span>().primaryKey]:=<span class="hljs-literal">Null</span> <span class="hljs-comment">//réinitialise la clé primaire</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$entityNew</span>.<span class="hljs-function">save</span>() <span class="hljs-comment">//sauvegarde l'entité dupliquée</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_getkey"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_getkey"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getKey()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.getKey</strong>( { <em>mode</em> : Integer } ) :Text<br /><strong>.getKey</strong>( { <em>mode</em> : Integer } ) :Integer</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>mode</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>dk key as string</code>: retourner la clé primaire entexte, quel que soit son type d'origine</td></tr><tr><td>Résultat</td><td>Text</td><td style="text-align:center">&lt;-</td><td>Valeur de la clé primaire texte de l'entité</td></tr><tr><td>Résultat</td><td>Integer</td><td style="text-align:center">&lt;-</td><td>Valeur de la clé primaire numérique de l'entité</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-7"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-7"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.getKey()</code> retourne la valeur de la cléprimaire de l'entité.</p><p>Les clés primaires peuvent être des nombres (integer) ou destextes. Vous pouvez "forcer" la méthode à retourner la valeur declé primaire sous forme de chaîne, quel que soit son typed'origine, en passant l'option <code>dk key as string</code> dansle paramètre <em>mode</em>.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-6"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-6"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName=:1"</span>;<span class="hljs-string">"Smith"</span>) <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>[<span class="hljs-number">0</span>]<span class="hljs-function"> ALERT</span>(<span class="hljs-string">"The primary key is "</span>+<span class="hljs-variable">$employee</span>.<span class="hljs-function">getKey</span>(dk key as string))</code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_getremotecontextattributes"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_getremotecontextattributes"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getRemoteContextAttributes()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19R5</td><td>Ajout</td></tr></tbody></table></details><p><strong>.getRemoteContextAttributes()</strong> : Text</p><table><thead><tr><th>Paramètres</th><th>Type</th><th></th><th>Description</th></tr></thead><tbody><tr><td>result</td><td>Text</td><td>&lt;-</td><td>Attirbuts de contexte associés à l'entity, séparés par unevirgule</td></tr></tbody></table><blockquote><p><strong>Mode avancé :</strong> Cette fonction est destinée auxdéveloppeurs qui souhaitent personnaliser les fonctionnalités pardéfaut de ORDA dans le cadre de configurations spécifiques. Dans laplupart des cas, vous n'aurez pas besoin de l'utiliser.</p></blockquote><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-8"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-8"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.getRemoteContextAttributes()</code> retournedes informations relatives au contexte d'optimisation utilisé parl'entity .</p><p>S'il n'existe pas de <a href="#EntityClass.html_clientserver-optimization">contexted'optimisation</a> pour l'entity, la fonction retourne un textevide.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-7"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-7"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$ds </span>: 4D.DataStoreImplementation<span class="hljs-keyword">var</span> <span class="hljs-variable">$address </span>: cs.AddressEntity<span class="hljs-keyword">var</span> <span class="hljs-variable">$p </span>: cs.PersonsEntity<span class="hljs-keyword">var</span> <span class="hljs-variable">$contextA </span>: Object<span class="hljs-keyword">var</span> <span class="hljs-variable">$info </span>: Text<span class="hljs-keyword">var</span> <span class="hljs-variable">$text </span>: Text<span class="hljs-variable">$ds</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"hostname"</span>; <span class="hljs-string">"www.myserver.com"</span>); <span class="hljs-string">"myDS"</span>)<span class="hljs-variable">$contextA</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"context"</span>; <span class="hljs-string">"contextA"</span>)<span class="hljs-variable">$address</span>:=<span class="hljs-variable">$ds</span>.Address.<span class="hljs-function">get</span>(<span class="hljs-number">1</span>; <span class="hljs-variable">$contextA</span>)<span class="hljs-variable">$text</span>:=<span class="hljs-string">""</span><span class="hljs-keyword"> For each</span> (<span class="hljs-variable">$p</span>; <span class="hljs-variable">$address</span>.persons)    <span class="hljs-variable">$text</span>:=<span class="hljs-variable">$p</span>.firstname+<span class="hljs-string">" "</span>+<span class="hljs-variable">$p</span>.lastname<span class="hljs-keyword">End for each</span> <span class="hljs-variable">$info</span>:=<span class="hljs-variable">$address</span>.<span class="hljs-function">getRemoteContextAttributes</span>()<span class="hljs-comment">//$info = "persons,persons.lastname,persons.firstname"</span></code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_voir-aussi"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_voir-aussi"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Voir aussi</h4><p><a href="#EntityClass.html_getRemoteContextAttributes">EntitySelection.getRemoteContextAttributes()</a><br /><a href="#EntityClass.html_clearallremotecontexts">.clearAllRemoteContexts()</a><br /><a href="#EntityClass.html_getremotecontextinfo">.getRemoteContextInfo()</a><br /><a href="#EntityClass.html_getallremotecontexts">.getAllRemoteContexts()</a><br /><a href="#EntityClass.html_setremotecontextinfo">.setRemoteContextInfo()</a></p><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_getselection"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_getselection"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getSelection()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.getSelection()</strong>: 4D.EntitySelection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>4D.EntitySelection</td><td style="text-align:center">&lt;-</td><td>Entity selection à laquelle appartient l'entité (Null si nontrouvée)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-9"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-9"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.getSelection()</code> retourne l'entityselection à laquelle appartient l'entité.</p><p>Si l'entité n'appartient pas à une entity selection, la fonctionrenvoie Null.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-8"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-8"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$emp </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees</span>; <span class="hljs-variable">$employees2 </span>: cs.EmployeeSelection <span class="hljs-variable">$emp</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">672</span>) <span class="hljs-comment">// Cette entité n'appartient à aucune entity selection</span> <span class="hljs-variable">$employees</span>:=<span class="hljs-variable">$emp</span>.<span class="hljs-function">getSelection</span>() <span class="hljs-comment">// $employees contient Null</span> <span class="hljs-variable">$employees2</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName=:1"</span>;<span class="hljs-string">"Smith"</span>) <span class="hljs-comment">//Cette entity selection contient 6 entités</span> <span class="hljs-variable">$emp</span>:=<span class="hljs-variable">$employees2</span>[<span class="hljs-number">0</span>]  <span class="hljs-comment">// Cette entité appartient à une entity selection</span><span class="hljs-function"> ALERT</span>(<span class="hljs-string">"L'entity selection contient "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$emp</span>.<span class="hljs-function">getSelection</span>().length)+<span class="hljs-string">" entités"</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_getstamp"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_getstamp"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getStamp()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.getStamp()</strong> : Integer</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Integer</td><td style="text-align:center">&lt;-</td><td>Valeur du "stamp" de l'entité (0 si l'entité vient d'êtrecréée)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-10"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-10"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.getStamp()</code> retourne la valeur courantedu stamp de l'entité.</p><p>Le stamp (marqueur interne) d'une entité est automatiquementincrémenté par 4D à chaque fois qu'une entité est enregistrée surdisque. Il permet de gérer les accès et modificationsconcurrent(e)s sur les mêmes entités (cf. <a href="#EntityClass.html_verrouillage-d-une-entite"><strong>Entitylocking</strong></a>).</p><blockquote><p>Pour une nouvelle entité (jamais enregistrée), la fonctionretourne 0. Pour savoir si une entité vient d'être créée, il estcependant recommandé d'utiliser <a href="#EntityClass.html_isnew">.isNew()</a>.</p></blockquote><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-9"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-9"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$entity </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$stamp </span>: Integer <span class="hljs-variable">$entity</span>:=ds.Employee.<span class="hljs-function">new</span>() <span class="hljs-variable">$entity</span>.lastname:=<span class="hljs-string">"Smith"</span> <span class="hljs-variable">$entity</span>.<span class="hljs-function">save</span>() <span class="hljs-variable">$stamp</span>:=<span class="hljs-variable">$entity</span>.<span class="hljs-function">getStamp</span>() <span class="hljs-comment">//$stamp=1</span> <span class="hljs-variable">$entity</span>.lastname:=<span class="hljs-string">"Wesson"</span> <span class="hljs-variable">$entity</span>.<span class="hljs-function">save</span>() <span class="hljs-variable">$stamp</span>:=<span class="hljs-variable">$entity</span>.<span class="hljs-function">getStamp</span>() <span class="hljs-comment">//$stamp=2</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_indexof"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_indexof"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.indexOf()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.indexOf</strong>( { <em>entitySelection</em> :4D.EntitySelection } ) : Integer</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>entitySelection</td><td>4D.EntitySelection</td><td style="text-align:center">-&gt;</td><td>Entity selection dans laquelle obtenir la position del'entité</td></tr><tr><td>Résultat</td><td>Integer</td><td style="text-align:center">&lt;-</td><td>Position de l'entité dans l'entity selection</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-11"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-11"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.indexOf()</code> retourne la position del'entité dans une entity selection.</p><p>Par défaut, si le paramètre <em>entitySelection</em> est omis,la fonction retourne la position de l'entité dans sa propre entityselection (si elle existe). Sinon, elle renvoie la position del'entité dans l'<em>entitySelection</em> spécifiée.</p><p>La valeur résultante est comprise entre 0 et la longueur del'entity selection -1.</p><ul><li>Si l'entité n'a pas d'entity selection ou n'appartient pas à<em>entitySelection</em>, la fonction retourne -1.</li><li>Si <em>entitySelection</em> est Null ou n'appartient pas à lamême dataclass que l'entité, une erreur est générée.</li></ul><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-10"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-10"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName = :1"</span>;<span class="hljs-string">"H@"</span>) <span class="hljs-comment">//Cette entity selection contient 3 entités</span> <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>[<span class="hljs-number">1</span>] <span class="hljs-comment">//Cette entité appartient à l'entity selection</span><span class="hljs-function"> ALERT</span>(<span class="hljs-string">"La position de cette entité dans son entity selection est "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$employee</span>.<span class="hljs-function">indexOf</span>())) <span class="hljs-comment">//1</span> <span class="hljs-variable">$employee</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">725</span>) <span class="hljs-comment">//Cette entité n'appartient pas à l'entity selection</span><span class="hljs-function"> ALERT</span>(<span class="hljs-string">"La position de cette entité est "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$employee</span>.<span class="hljs-function">indexOf</span>())) <span class="hljs-comment">// -1</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_isnew"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_isnew"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.isNew()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.isNew()</strong> : Boolean</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Booléen</td><td style="text-align:center">&lt;-</td><td>Vrai si l'entité vient juste d'être créée et n'a pas encore étéenregistrée. Sinon, Faux.</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-12"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-12"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction<code>.isNew()</code> renvoie Vrai si l'entité àlaquelle elle est appliquée vient d'être créée et n'a pas encoreété enregistrée dans le datastore. Sinon, elle renvoie Faux.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-11"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-11"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$emp </span>: cs.EmployeeEntity <span class="hljs-variable">$emp</span>:=ds.Employee.<span class="hljs-function">new</span>()<span class="hljs-keyword"> If</span>(<span class="hljs-variable">$emp</span>.<span class="hljs-function">isNew</span>())<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Ceci est une nouvelle entité"</span>)<span class="hljs-keyword"> End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_last"></a><a aria-hidden="true" class="hash-link"href="#EntityClass.html_last"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.last()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.last()</strong> : 4D.Entity</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>4D.Entity</td><td style="text-align:center">&lt;-</td><td>Référence à la dernière entité de l'entity selection (Null sinon trouvée)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-13"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-13"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.last()</code> renvoie une référence versl'entité en dernière position dans l'entity selection à laquellel'entité appartient.</p><p>Si l'entité n'appartient à aucune entity selection (i.e.<a href="#EntityClass.html_getselection">.getSelection( )</a>retourne Null), la fonction renvoie une valeur Null.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-12"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-12"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee</span>; <span class="hljs-variable">$lastEmployee </span>: cs.EmployeeEntity <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName = :1"</span>;<span class="hljs-string">"H@"</span>) <span class="hljs-comment">//Cette entity selection contient 3 entités $employee:=$employees[0]</span> <span class="hljs-variable">$lastEmployee</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">last</span>() <span class="hljs-comment">//$lastEmployee est la dernière entité de l'entity selection $employees</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_lock"></a><a aria-hidden="true" class="hash-link"href="#EntityClass.html_lock"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.lock()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.lock</strong>( { <em>mode</em> : Integer } ) :Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>mode</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>dk reload if stamp changed</code> : Recharger avant deverrouiller si le marqueur interne a changé</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Résultat de l'opération lock</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-14"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-14"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.lock()</code> pose un verrou pessimiste surl'enregistrement référencé par l'entité. Le <a href="#EntityClass.html_verrouillage-d-une-entite">verrou est posé</a>pour l'enregistrement et toutes les références de l'entité dans leprocess courant.</p><p>Pour les autres process, cet enregistrement apparaîtraverrouillé (la propriété <code>result.success</code> contiendraFaux s'ils tentent de verrouiller la même entité à l'aide de cettefonction). Seules les fonctions exécutées dans la session àl'origine du verrouillage auront la possibilité de modifier et desauvegarder les attributs de l'entité. L'entité peut être chargéeen lecture seulement dans les autres sessions, mais elles nepourront ni saisir ni sauvegarder des valeurs.</p><p>Un enregistrement verrouillé peut être déverrouillé :</p><ul><li>lorsque la fonction <a href="#EntityClass.html_unlock"><code>unlock()</code></a> est appeléesur une entité correspondante dans le même process</li><li>automatiquement, lorsqu'elle n'est plus référencée par aucuneentité en mémoire. Par exemple, si le verrou n'est posé que sur uneréférence locale d'une entité, celle-ci est déverrouillée à la finde la fonction. Tant qu'il existe des références à l'entité enmémoire, l'enregistrement reste verrouillé.</li></ul><blockquote><p>Pour plus d'informations, veuillez consulter la section <a href="#EntityClass.html_verrouillage-d-une-entite">Verrouillage d'uneentité</a>.</p></blockquote><p>Par défaut, lorsque le paramètre <em>mode</em> est omis, laméthode retourne une erreur (cf. ci-dessous) si l'entité a étémodifiée (i.e. le marqueur interne a changé) entre-temps par unautre process ou utilisateur.</p><p>Sinon, vous pouvez passer l'option <code>dk reload if stampchanged</code> dans le paramètre <em>mode</em> : dans ce cas,aucune erreur n'est générée et l'entité est simplement rechargée sile stamp a changé (si l'entité existe toujours et si la cléprimaire est toujours la même).</p><p><strong>Résultat</strong></p><p>L'objet retourné par <code>.lock( )</code> contient lespropriétés suivantes :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>boolean</td><td>vrai si l'action de verrouillage a été effectuée avec succès(ou si l'entité est déjà verrouillée dans le process courant),sinon faux.</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible uniquement si l'option <code>dk reloadif stamp changed</code> est utilisée :</em></strong></td></tr><tr><td><strong>wasReloaded</strong></td><td></td><td>boolean</td><td>vrai si l'entité a été correctement rechargée, sinon faux.</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible uniquement en cas d'erreur:</em></strong></td></tr><tr><td>status(*)</td><td></td><td>number</td><td>Code d'erreur, voir ci-dessous</td></tr><tr><td>statusText(*)</td><td></td><td>text</td><td>Description de l'erreur, voir ci-dessous</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible uniquement en cas d'erreur deverrouillage pessimiste :</em></strong></td></tr><tr><td>lockKindText</td><td></td><td>text</td><td>"Locked by record" si verrouillage par un process 4D, "Lockedby session" si verrouillage par une session REST</td></tr><tr><td>lockInfo</td><td></td><td>object</td><td>Information sur l'origine du verrouillage. Les propriétésretournées dépendent de l'origine du verrouillage (process 4D ousession REST).</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible uniquement pour un verrouillage parprocess 4D:</em></strong></td></tr><tr><td></td><td>task_id</td><td>number</td><td>ID du process</td></tr><tr><td></td><td>user_name</td><td>text</td><td>Nom d'utilisateur de la session sur la machine</td></tr><tr><td></td><td>user4d_alias</td><td>Texte</td><td>Nom ou alias de l'utilisateur 4D</td></tr><tr><td></td><td>user4d_id</td><td>number</td><td>Identifiant utilisateur dans le répertoire de la base 4D</td></tr><tr><td></td><td>host_name</td><td>text</td><td>Nom de la machine</td></tr><tr><td></td><td>task_name</td><td>text</td><td>Nom du process</td></tr><tr><td></td><td>client_version</td><td>Texte</td><td>Version du client</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible uniquement pour un verrouillage parsession REST :</em></strong></td></tr><tr><td></td><td>host</td><td>text</td><td>URL ayant verrouillé l'entité (ex : "<a href="http://www.myserver.com">www.myserver.com</a>")</td></tr><tr><td></td><td>IPAddr</td><td>text</td><td>Adresse IP d'origine du verrouillage (ex. 127.0.0.1")</td></tr><tr><td></td><td>userAgent</td><td>Texte</td><td>userAgent de l'origine du verouillage (ex : "Mozilla/5.0(Macintosh; Intel Mac OS X 10_15_3) AppleWebKit/537.36 (KHTML, likeGecko) Chrome/96.0.4664.110 Safari/537.36")</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible uniquement en cas d'erreurcritique</em></strong> (clé primaire dupliquée, disque plein...):</td></tr><tr><td>errors</td><td></td><td>collection d'objets</td><td></td></tr><tr><td></td><td>message</td><td>Texte</td><td>Message d'erreur</td></tr><tr><td></td><td>component signature</td><td>Texte</td><td>signature du composant interne (e.g. "dmbg" pour le composantde base de données)</td></tr><tr><td></td><td>errCode</td><td>number</td><td>Code d'erreur</td></tr></tbody></table><p>(*) Les valeurs suivantes peuvent être retournées dans lespropriétés <em>status</em> et <em>statusText</em> de l'objet<em>Résultat</em> en cas d'erreur :</p><table><thead><tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr></thead><tbody><tr><td><code>dk status entity does not exist anymore</code></td><td>5</td><td>L'entité n'existe plus dans les données. Cette erreur peut seproduire dans les cas suivants :<ul><li>l'entité a été supprimée (le stamp est modifié et l'espacemémoire est libéré)</li><li>l'entité a été supprimée et remplacée par une autre avec uneclé primaire différente (le stamp est modifié et une nouvelleentité occupe l'espace mémoire). Avec <code>.drop( )</code>, cetteerreur peut être retournée lorsque l'option dk force drop if stampchanged est utilisée. Avec <code>.lock( )</code>, cette erreur peutêtre retournée lorsque l'option dk reload if stamp changed estutilisée.</li><br /><strong>statusText associé</strong>: "Entity does not existanymore"</ul></td></tr><tr><td><code>dk status locked</code></td><td>3</td><td>L'entité est verrouillée par un verrou pessimiste.<p><strong>statusText associé</strong> : "Already locked"</p></td></tr><tr><td><code>dk status serious error</code></td><td>4</td><td>Une erreur critique peut être une erreur de bas niveau de labase de données (ex. clé dupliquée), une erreur matérielle, etc.<p><strong>statusText associé</strong> : "Other error"</p></td></tr><tr><td><code>dk status stamp has changed</code></td><td>2</td><td>La valeur du marqueur interne (stamp) de l'entité ne correspondpas à celle de l'entité stockée dans les données (verrouillageoptimiste).<ul><li>avec <code>.save( )</code> : erreur uniquement si l'option<code>dk auto merge</code> n'est pas utilisée</li><li>avec <code>.drop( )</code> : erreur uniquement si l'option<code>dk force drop if stamp changed</code> n'est pas utilisée</li><li>avec <code>.lock( )</code> : erreur uniquement si l'option<code>dk reload if stamp changed</code> n'est pas utilisée</li><br /><strong>statusText associé</strong>: "Stamp has changed"</ul></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-1-3"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-1-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 1</h4><p>Exemple avec erreur :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$employee</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">716</span>) <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">lock</span>()<span class="hljs-keyword"> Case of</span>    :(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"You have locked "</span>+<span class="hljs-variable">$employee</span>.firstName+<span class="hljs-string">" "</span>+<span class="hljs-variable">$employee</span>.lastName)    :(<span class="hljs-variable">$status</span>.status=dk status stamp has changed)<span class="hljs-function">       ALERT</span>(<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End case</span></code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-2-2"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-2-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 2</h4><p>Exemple avec option <code>dk reload if stamp changed</code>:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$employee</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">717</span>) <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">lock</span>(dk reload if stamp changed)<span class="hljs-keyword"> Case of</span>    :(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"You have locked "</span>+<span class="hljs-variable">$employee</span>.firstName+<span class="hljs-string">" "</span>+<span class="hljs-variable">$employee</span>.lastName)    :(<span class="hljs-variable">$status</span>.status=dk status entity does not exist anymore)<span class="hljs-function">       ALERT</span>(<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End case</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_next"></a><a aria-hidden="true" class="hash-link"href="#EntityClass.html_next"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.next()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.next()</strong> : 4D.Entity</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>4D.Entity</td><td style="text-align:center">&lt;-</td><td>Référence à l'entité suivante dans l'entity selection (Null sinon trouvée)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-15"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-15"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.next()</code> retourne une référence surl'entité suivante dans l'entity selection à laquelle appartientl'entité.</p><p>Si l'entité n'appartient à aucune entity selection existante(i.e. <a href="#EntityClass.html_getselection">.getSelection()</a>retourne Null), la fonction renvoie une valeur Null.</p><p>S'il n'y a pas d'entité suivante valide dans l'entity selection(i.e. vous êtes sur la dernière entité de la sélection), lafonction retourne Null. Si l'entité suivante a été supprimée, lafonction renvoie l'entité valide suivante (et finalement Null).</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-13"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-13"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee</span>; <span class="hljs-variable">$nextEmployee </span>: cs.EmployeeEntity <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName = :1"</span>;<span class="hljs-string">"H@"</span>) <span class="hljs-comment">//Cette entity selection contient 3 entités</span> <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>[<span class="hljs-number">0</span>] <span class="hljs-variable">$nextEmployee</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">next</span>() <span class="hljs-comment">//$nextEmployee est la deuxième entité de l'entity selection $employees</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_previous"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_previous"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.previous()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.previous()</strong> : 4D.Entity</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>4D.Entity</td><td style="text-align:center">&lt;-</td><td>Référence à l'entité précédente dans l'entity selection (Nullsi non trouvée)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-16"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-16"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.previous()</code> retourne une référence surl'entité précédente dans l'entity selection à laquelle appartientl'entité.</p><p>Si l'entité n'appartient à aucune entity selection existante(i.e. <a href="#EntityClass.html_getselection">.getSelection()</a>retourne Null), la fonction renvoie une valeur Null.</p><p>Si l'entité n'appartient à aucune entity selection (i.e.<a href="#EntityClass.html_getselection">.getSelection( )</a>retourne Null), la fonction renvoie une valeur Null.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-14"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-14"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee</span>; <span class="hljs-variable">$previousEmployee </span>: cs.EmployeeEntity <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName = :1"</span>;<span class="hljs-string">"H@"</span>) <span class="hljs-comment">//Cette entity selection contient 3 entités</span> <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>[<span class="hljs-number">1</span>] <span class="hljs-variable">$previousEmployee</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">previous</span>() <span class="hljs-comment">//$previousEmployee est la première entité de l'entity selection $employees</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_reload-"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_reload-"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.reload( )</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.reload()</strong> : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Objet statut</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-17"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-17"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.reload()</code> recharge en mémoire lecontenu de l'entitéà partir des informations stockées dans la tableassociée à la dataclass dans le datastore. Le rechargement esteffectué uniquement si l'entité existe toujours avec la même cléprimaire.</p><p><strong>Résultat</strong></p><p>L'objet retourné par <code>.reload( )</code> contient lespropriétés suivantes :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td>boolean</td><td>Vrai si le rechargement a été effectué avec succès, sinon Faux.<p><strong><em>Disponible uniquement en cas d'erreur</em></strong>:</p></td></tr><tr><td>status(*)</td><td>number</td><td>Code d'erreur, voir ci-dessous</td></tr><tr><td>statusText(*)</td><td>text</td><td>Description de l'erreur, voir ci-dessous</td></tr></tbody></table><p>(*) Les valeurs suivantes peuvent être retournées dans lespropriétés <em>status</em> et <em>statusText</em> de l'objet<em>Résultat</em> en cas d'erreur :</p><table><thead><tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr></thead><tbody><tr><td><code>dk status entity does not exist anymore</code></td><td>5</td><td>L'entité n'existe plus dans les données. Cette erreur peut seproduire dans les cas suivants :<br /><ul><li>l'entité a été supprimée (le stamp est modifié et l'espacemémoire est libéré)</li><li>l'entité a été supprimée et remplacée par une autre avec uneclé primaire différente (le stamp est modifié et une nouvelleentité occupe l'espace mémoire). Avec <code>.drop( )</code>, cetteerreur peut être retournée lorsque l'option <code>dk force drop ifstamp changed</code> est utilisée. Avec <code>.lock( )</code>,cette erreur peut être retournée lorsque l'option dk reload ifstamp changed est utilisée.</li><br /><strong><em>statusText associé</em></strong>: "Entity does notexist anymore"</ul></td></tr><tr><td><code>dk status serious error</code></td><td>4</td><td>Une erreur critique peut être une erreur de bas niveau de labase de données (ex. clé dupliquée), une erreur matérielle,etc.<br /><strong><em>statusText associé</em></strong> : "Other error"</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-15"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-15"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$result </span>: Object <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName=:1"</span>;<span class="hljs-string">"Hollis"</span>) <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>[<span class="hljs-number">0</span>] <span class="hljs-variable">$employee</span>.firstName:=<span class="hljs-string">"Mary"</span> <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">reload</span>()<span class="hljs-keyword"> Case of</span>    :(<span class="hljs-variable">$result</span>.success)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"Rechargement effectué"</span>)    :(<span class="hljs-variable">$result</span>.status=dk status entity does not exist anymore)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"L'entité a été supprimée"</span>)<span class="hljs-keyword"> End case</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_save"></a><a aria-hidden="true" class="hash-link"href="#EntityClass.html_save"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.save()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.save</strong>( { <em>mode</em> : Integer } ) :Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>mode</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>dk auto merge</code> : Active le mode "automaticmerge"</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Résultat de la sauvegarde</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-18"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-18"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.save()</code> sauvegarde les modificationseffectuées sur l'entité dans la table de sa dataclass. Vous devezappeler cette fonction après toute création ou modificationd'entité si vous souhaitez sauvegarder les changements.</p><p>La sauvegarde est effectuée si et seulement si au moins unattribut de l'entité a été "touché" (cf. les fonctions <a href="#EntityClass.html_touched"><code>.touched()</code></a> et <a href="#EntityClass.html_touchedattributes"><code>.touchedAttributes()</code></a>).Sinon, la fonction ne fait rien (le trigger n'est pas appelé).</p><p>Dans une application multi-utilisateur ou multi-process, lafonction <code>.save()</code> est exécutée avec le mécanisme du<a href="#EntityClass.html_entity-locking">"verrouillageoptimiste"</a>, dans lequel un compteur interne (stamp) estautomatiquement incrémenté à chaque sauvegarde del'enregistrement.</p><p>Par défaut, si le paramètre <em>mode</em> est omis, la fonctionretournera systématiquement une erreur (voir ci-dessous) lorsque lamême entité a été modifiée entre-temps par un autre process ouutilisateur, quel(s) que soi(en)t l(es) attribut(s) modifié(s).</p><p>Sinon, vous pouvez passer l'option <code>dk auto merge</code>dans le paramètre <em>mode</em> afin d'activer le mode "automaticmerge". Dans ce mode, une modification simultanée effectuée par unautre process/utilisateur sur la même entité mais sur un attributdifférent ne génère pas d'erreur. Les données effectivementstockées dans l'enregistrement résultent alors de la combinaison(le "merge") des modifications non-concurrentes (si desmodifications ont été effectuées sur le même attribut, lasauvegarde échoue et une erreur est retournée, même en mode"automatic merge").</p><blockquote><p>Le mode de fusion automatique n'est pas disponible pour lesattributs de type Image, Objet et Texte lorsqu'ils sont stockés endehors de l'enregistrement. Des modifications simultanées de cesattributs entraîneront une erreur "<code>dk status stamp haschanged</code>".</p></blockquote><p><strong>Résultat</strong></p><p>L'objet retourné par <code>.save()</code> contient lespropriétés suivantes :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>boolean</td><td>Vrai si la sauvegarde a été effectuée avec succès, sinonfaux.</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible uniquement si l'option <code>dk automerge</code> a été utilisée</em></strong> :</td></tr><tr><td>autoMerged</td><td></td><td>boolean</td><td>Vrai si un "auto merge" a été effectué, sinon faux.</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible uniquement en cas d'erreur</em></strong>:</td></tr><tr><td>status</td><td></td><td>number</td><td>Code d'erreur, <a href="#EntityClass.html_status-and-statustext">voir ci-dessous</a></td></tr><tr><td>statusText</td><td></td><td>text</td><td>Description de l'erreur, <a href="#EntityClass.html_status-and-statustext">voir ci-dessous</a></td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible uniquement en cas d'erreur enverrouillage pessimiste</em></strong> :</td></tr><tr><td>lockKindText</td><td></td><td>text</td><td>"Locked by record"</td></tr><tr><td>lockInfo</td><td></td><td>object</td><td>Information sur l'origine du verrouillage</td></tr><tr><td></td><td>task_id</td><td>number</td><td>Id du process</td></tr><tr><td></td><td>user_name</td><td>text</td><td>Nom d'utilisateur de la session sur la machine</td></tr><tr><td></td><td>user4d_alias</td><td>text</td><td>Alias utilisateur si défini avec <code>SET USER ALIAS</code>,sinon le nom d'utilisateur dans le répertoire de la base 4D</td></tr><tr><td></td><td>host_name</td><td>text</td><td>Nom de la machine</td></tr><tr><td></td><td>task_name</td><td>text</td><td>Nom du process</td></tr><tr><td></td><td>client_version</td><td>text</td><td></td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible uniquement en cas d'erreurcritique</em></strong> (clé primaire dupliquée, disque plein...):</td></tr><tr><td>errors</td><td></td><td>collection of objects</td><td></td></tr><tr><td></td><td>message</td><td>text</td><td>Message d'erreur</td></tr><tr><td></td><td>componentSignature</td><td>text</td><td>Signature du composant interne (e.g. "dmbg" pour le composantde base de données)</td></tr><tr><td></td><td>errCode</td><td>number</td><td>Code d'erreur</td></tr></tbody></table><h5><a aria-hidden="true" class="anchor" id="EntityClass.html_status-et-statustext"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_status-et-statustext"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>status et statusText</h5><p>Les valeurs suivantes peuvent être retournées dans lespropriétés <code>status</code> et <code>statusText</code> del'objet Résultat en cas d'erreur :</p><table><thead><tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr></thead><tbody><tr><td><code>dk status automerge failed</code></td><td>6</td><td>(Uniquement si l'option <code>dk auto merge</code> estutilisée) Echec du mécanisme de merge automatique lors de lasauvegarde de l'entité.<p><strong>statusText associé</strong> : "Auto merge failed"</p></td></tr><tr><td><code>dk status entity does not exist anymore</code></td><td>5</td><td>L'entité n'existe plus dans les données. Cette erreur peut seproduire dans les cas suivants :<br /><ul><li>l'entité a été supprimée (le stamp est modifié et l'espacemémoire est libéré)</li><li>l'entité a été supprimée et remplacée par une autre avec uneclé primaire différente (le stamp est modifié et une nouvelleentité occupe l'espace mémoire). Avec <code>.drop( )</code>, cetteerreur peut être retournée lorsque l'option <code>dk force drop ifstamp changed</code> est utilisée. Avec <code>.lock( )</code>,cette erreur peut être retournée lorsque l'option dk reload ifstamp changed est utilisée.</li><br /><strong>statusText associé</strong>: "Entity does not existanymore"</ul></td></tr><tr><td><code>dk status locked</code></td><td>3</td><td>L'entité est verrouillée par un verrou pessimiste.<p><strong>statusText associé</strong> : "Already locked"</p></td></tr><tr><td><code>dk status serious error</code></td><td>4</td><td>Une erreur critique peut être une erreur de bas niveau de labase de données (ex. clé dupliquée), une erreur matérielle, etc.<p><strong>statusText associé</strong> : "Other error"</p></td></tr><tr><td><code>dk status stamp has changed</code></td><td>2</td><td>La valeur du marqueur interne (stamp) de l'entité ne correspondpas à celle de l'entité stockée dans les données (verrouillageoptimiste).<br /><ul><li>avec <code>.save( )</code> : erreur uniquement si l'option<code>dk auto merge</code> n'est pas utilisée</li><li>avec <code>.drop( )</code> : erreur uniquement si l'option<code>dk force drop if stamp changed</code> n'est pas utilisée</li><li>avec <code>.lock( )</code> : erreur uniquement si l'option<code>dk reload if stamp changed</code> n'est pas utilisée</li><br /><strong>statusText associé</strong>: "Stamp has changed"</ul></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-1-4"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-1-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 1</h4><p>Création d'une entité :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity <span class="hljs-variable">$employee</span>:=ds.Employee.<span class="hljs-function">new</span>() <span class="hljs-variable">$employee</span>.firstName:=<span class="hljs-string">"Mary"</span> <span class="hljs-variable">$employee</span>.lastName:=<span class="hljs-string">"Smith"</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">save</span>()<span class="hljs-keyword"> If</span>(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Employé créé"</span>)<span class="hljs-keyword"> End if</span></code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-2-3"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-2-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 2</h4><p>Mise à jour d'une entité sans option <code>dk auto merge</code>:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName=:1"</span>;<span class="hljs-string">"Smith"</span>) <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>.<span class="hljs-function">first</span>() <span class="hljs-variable">$employee</span>.lastName:=<span class="hljs-string">"Mac Arthur"</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">save</span>()<span class="hljs-keyword"> Case of</span>    :(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"Employé mis à jour"</span>)    :(<span class="hljs-variable">$status</span>.status=dk status stamp has changed)<span class="hljs-function">       ALERT</span>(<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End case</span></code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-3-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-3-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 3</h4><p>Mise à jour d'une entité avec option <code>dk auto merge</code>:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName=:1"</span>;<span class="hljs-string">"Smith"</span>) <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>.<span class="hljs-function">first</span>() <span class="hljs-variable">$employee</span>.lastName:=<span class="hljs-string">"Mac Arthur"</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">save</span>(dk auto merge)<span class="hljs-keyword"> Case of</span>    :(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"Employé mis à jour"</span>)    :(<span class="hljs-variable">$status</span>.status=dk status automerge failed)<span class="hljs-function">       ALERT</span>(<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End case</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_toobject"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_toobject"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.toObject()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.toObject</strong>() : Object<br /><strong>.toObject</strong>( <em>filterString</em> : Text { ;<em>options</em> : Integer} ) : Object<br /><strong>.toObject</strong>( <em>filterCol</em> : Collection { ;<em>options</em> : Integer } ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>filterString</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Attribut(s) à extraire (chaînes séparées par des virgules)</td></tr><tr><td>filterCol</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection d'attribut(s) à extraire</td></tr><tr><td>options</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>dk with primary key</code> : ajouter la propriété _KEY;<br /><code>dk with stamp</code> : ajouter la propriété _STAMP</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Objet généré à partir de l'entité</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-19"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-19"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.toObject()</code> retourne un objet construità partir de l'entité. Les noms des propriétés de l'objetcorrespondent aux noms des attributs de l'entité.</p><p>Si aucun filtre n'est passé ou si le paramètre<em>filterString</em> contient une chaîne vide ou "*", l'objetretourné contiendra :</p><ul><li>tous les attributs storage de l'entité</li><li>attributs dont le <a href="#EntityClass.html_kind">kind</a> est<code>relatedEntity</code> : vous obtenez une propriété avec lemême nom que l'entité liée (nom du lien N vers 1). L'attribut estextrait sous forme simple.</li><li>attributs dont le <a href="#EntityClass.html_kind">kind</a> est<code>relatedEntities</code> : non retournés.</li></ul><p>Dans le premier paramètre, indiquez le ou les attribut(s) àextraire. Vous pouvez passer :</p><ul><li><em>filterString</em> : une chaîne avec les chemins despropriétés séparés par des virgules : "propertyPath1,propertyPath2, ...", ou</li><li><em>filterCol</em> : une collection de chaînes contenant deschemins de propriétés : ["propertyPath1","propertyPath2";...]</li></ul><p>Si un filtre contient des attributs dont le <a href="#EntityClass.html_kind">kind</a> est relatedEntity :</p><ul><li>propertyPath = "relatedEntity" -&gt; l'attribut est extraitsous forme simple : un objet avec la propriété __KEY (cléprimaire).</li><li>propertyPath = "relatedEntity.*" -&gt; toutes les propriétéssont extraites</li><li>propertyPath = "relatedEntity.propertyName1;relatedEntity.propertyName2; ..." -&gt; seules ces propriétés sontextraites</li></ul><p>Si un filtre contient de attributs dont le <a href="#EntityClass.html_kind">kind</a> est relatedEntities :</p><ul><li>propertyPath = "relatedEntities.*" -&gt; toutes les propriétéssont extraites</li><li>propertyPath = "relatedEntities.propertyName1;relatedEntities.propertyName2; ..." -&gt; seules ces propriétéssont extraites</li></ul><p>Dans le paramètre <em>options</em>, vous pouvez passer lessélecteurs <code>dk with primary key</code> et/ou <code>dk withstamp</code> afin d'ajouter les clés primaires et/ou les stampsdans les objets extraits.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-1-5"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-1-5"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 1</h4><p>La structure suivante sera utilisée pour les exemples de cettesection :</p><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/API/dataclassAttribute4.png" /></p><p>Sans paramètre filtre :</p><pre><code class="hljs css language-4d">employeeObject:=employeeSelected.<span class="hljs-function">toObject</span>()</code></pre><p>Retourne :</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"ID"</span>: <span class="hljs-number">413</span>,    <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Greg"</span>,    <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Wahl"</span>,    <span class="hljs-string">"salary"</span>: <span class="hljs-number">0</span>,    <span class="hljs-string">"birthDate"</span>: <span class="hljs-string">"1963-02-01T00:00:00.000Z"</span>,    <span class="hljs-string">"woman"</span>: false,    <span class="hljs-string">"managerID"</span>: <span class="hljs-number">412</span>,    <span class="hljs-string">"employerID"</span>: <span class="hljs-number">20</span>,    <span class="hljs-string">"photo"</span>: <span class="hljs-string">"[object Picture]"</span>,    <span class="hljs-string">"extra"</span>: null,    <span class="hljs-string">"employer"</span>: { <span class="hljs-comment">// relatedEntity sous forme simple</span>        <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">20</span>    },    <span class="hljs-string">"manager"</span>: {        <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">412</span>    }}</code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-2-4"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-2-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 2</h4><p>Extraction de la clé primaire et du stamp :</p><pre><code class="hljs css language-4d">employeeObject:=employeeSelected.<span class="hljs-function">toObject</span>(<span class="hljs-string">""</span>;dk with primary key+dk with stamp)</code></pre><p>Retourne :</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">413</span>,   <span class="hljs-string">"__STAMP"</span>: <span class="hljs-number">1</span>,    <span class="hljs-string">"ID"</span>: <span class="hljs-number">413</span>,    <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Greg"</span>,    <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Wahl"</span>,    <span class="hljs-string">"salary"</span>: <span class="hljs-number">0</span>,    <span class="hljs-string">"birthDate"</span>: <span class="hljs-string">"1963-02-01T00:00:00.000Z"</span>,    <span class="hljs-string">"woman"</span>: false,    <span class="hljs-string">"managerID"</span>: <span class="hljs-number">412</span>,    <span class="hljs-string">"employerID"</span>: <span class="hljs-number">20</span>,    <span class="hljs-string">"photo"</span>: <span class="hljs-string">"[object Picture]"</span>,    <span class="hljs-string">"extra"</span>: null,    <span class="hljs-string">"employer"</span>: {        <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">20</span>    },    <span class="hljs-string">"manager"</span>: {        <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">412</span>    }}</code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-3-2"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-3-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 3</h4><p>Extraction complète des attributs des<code>relatedEntities</code> :</p><pre><code class="hljs css language-4d">employeeObject:=employeeSelected.<span class="hljs-function">toObject</span>(<span class="hljs-string">"directReports.*"</span>)</code></pre><pre><code class="hljs css language-4d">{    <span class="hljs-string">"directReports"</span>: [        {            <span class="hljs-string">"ID"</span>: <span class="hljs-number">418</span>,            <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Lorena"</span>,            <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Boothe"</span>,            <span class="hljs-string">"salary"</span>: <span class="hljs-number">44800</span>,            <span class="hljs-string">"birthDate"</span>: <span class="hljs-string">"1970-10-02T00:00:00.000Z"</span>,            <span class="hljs-string">"woman"</span>: true,            <span class="hljs-string">"managerID"</span>: <span class="hljs-number">413</span>,            <span class="hljs-string">"employerID"</span>: <span class="hljs-number">20</span>,            <span class="hljs-string">"photo"</span>: <span class="hljs-string">"[object Picture]"</span>,            <span class="hljs-string">"extra"</span>: null,            <span class="hljs-string">"employer"</span>: {                <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">20</span>            },            <span class="hljs-string">"manager"</span>: {                <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">413</span>            }        },        {            <span class="hljs-string">"ID"</span>: <span class="hljs-number">419</span>,            <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Drew"</span>,            <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Caudill"</span>,            <span class="hljs-string">"salary"</span>: <span class="hljs-number">41000</span>,            <span class="hljs-string">"birthDate"</span>: <span class="hljs-string">"2030-01-12T00:00:00.000Z"</span>,            <span class="hljs-string">"woman"</span>: false,            <span class="hljs-string">"managerID"</span>: <span class="hljs-number">413</span>,            <span class="hljs-string">"employerID"</span>: <span class="hljs-number">20</span>,            <span class="hljs-string">"photo"</span>: <span class="hljs-string">"[object Picture]"</span>,            <span class="hljs-string">"extra"</span>: null,            <span class="hljs-string">"employer"</span>: {                <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">20</span>            },            <span class="hljs-string">"manager"</span>: {                <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">413</span>            }        },        {            <span class="hljs-string">"ID"</span>: <span class="hljs-number">420</span>,            <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Nathan"</span>,            <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Gomes"</span>,            <span class="hljs-string">"salary"</span>: <span class="hljs-number">46300</span>,            <span class="hljs-string">"birthDate"</span>: <span class="hljs-string">"2010-05-29T00:00:00.000Z"</span>,            <span class="hljs-string">"woman"</span>: false,            <span class="hljs-string">"managerID"</span>: <span class="hljs-number">413</span>,            <span class="hljs-string">"employerID"</span>: <span class="hljs-number">20</span>,            <span class="hljs-string">"photo"</span>: <span class="hljs-string">"[object Picture]"</span>,            <span class="hljs-string">"extra"</span>: null,            <span class="hljs-string">"employer"</span>: {                <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">20</span>            },            <span class="hljs-string">"manager"</span>: {                <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">413</span>            }        }    ]}</code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-4-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-4-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 4</h4><p>Extraction de quelques attributs des<code>relatedEntities</code> :</p><pre><code class="hljs css language-4d"> employeeObject:=employeeSelected.<span class="hljs-function">toObject</span>(<span class="hljs-string">"firstName, directReports.lastName"</span>)</code></pre><p>Retourne :</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Greg"</span>,    <span class="hljs-string">"directReports"</span>: [        {            <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Boothe"</span>        },        {            <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Caudill"</span>        },        {            <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Gomes"</span>        }    ]}</code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-5-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-5-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 5</h4><p>Extraction d'une <code>relatedEntity</code> sous forme simple:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$coll</span>:=<span class="hljs-function">New collection</span>(<span class="hljs-string">"firstName"</span>;<span class="hljs-string">"employer"</span>) employeeObject:=employeeSelected.<span class="hljs-function">toObject</span>(<span class="hljs-variable">$coll</span>)</code></pre><p>Retourne :</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Greg"</span>,    <span class="hljs-string">"employer"</span>: {        <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">20</span>    }}</code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-6-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-6-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 6</h4><p>Extraction de tous les attributs d'une<code>relatedEntity</code> :</p><pre><code class="hljs css language-4d"> employeeObject:=employeeSelected.<span class="hljs-function">toObject</span>(<span class="hljs-string">"employer.*"</span>)</code></pre><p>Retourne :</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"employer"</span>: {        <span class="hljs-string">"ID"</span>: <span class="hljs-number">20</span>,        <span class="hljs-string">"name"</span>: <span class="hljs-string">"India Astral Secretary"</span>,        <span class="hljs-string">"creationDate"</span>: <span class="hljs-string">"1984-08-25T00:00:00.000Z"</span>,        <span class="hljs-string">"revenues"</span>: <span class="hljs-number">12000000</span>,        <span class="hljs-string">"extra"</span>: null    }}</code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-7-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-7-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 7</h4><p>Extraction de quelques attributs d'une<code>relatedEntity</code> :</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$col</span>:=New collection <span class="hljs-variable">$col</span>.<span class="hljs-function">push</span>(<span class="hljs-string">"employer.name"</span>) <span class="hljs-variable">$col</span>.<span class="hljs-function">push</span>(<span class="hljs-string">"employer.revenues"</span>) employeeObject:=employeeSelected.<span class="hljs-function">toObject</span>(<span class="hljs-variable">$col</span>)</code></pre><p>Retourne :</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"employer"</span>: {        <span class="hljs-string">"name"</span>: <span class="hljs-string">"India Astral Secretary"</span>,        <span class="hljs-string">"revenues"</span>: <span class="hljs-number">12000000</span>    }}</code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_touched-"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_touched-"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.touched( )</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.touched()</strong> : Boolean</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Booléen</td><td style="text-align:center">&lt;-</td><td>Vrai si au moins un attribut de l'entité a été modifié et nonencore sauvegardé, sinon Faux</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-20"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-20"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.touched()</code> indique si un attribut del'entité a été modifié ou non depuis que l'entité a été chargée enmémoire ou sauvegardée.</p><p>Si un attribut a été modifié ou calculé, la fonction retourneVrai, sinon elle retourne Faux. Vous pouvez utiliser cette fonctionpour savoir s'il est nécessaire de sauvegarder l'entité.</p><p>Cette fonction retourne Faux pour une entité qui vient d'êtrecréée (avec <a href="#EntityClass.html_new"><code>.new()</code></a>). A noter cependant que si vous utilisez une fonctionpour calculer un attribut de l'entité, la fonction<code>.touched()</code> retournera Vrai. Par exemple, si vousappelez <a href="#EntityClass.html_getkey"><code>.getKey()</code></a> pour calculerla clé primaire, <code>.touched()</code> retourne alors Vrai.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-16"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-16"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><p>Cet exemple vérifie s'il est nécessaire de sauvegarder l'entité:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$emp </span>: cs.EmployeeEntity <span class="hljs-variable">$emp</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">672</span>) <span class="hljs-variable">$emp</span>.firstName:=<span class="hljs-variable">$emp</span>.firstName <span class="hljs-comment">//Même réassigné avec sa propre valeur, l'attribut est considéré "touched"</span><span class="hljs-keyword"> If</span>(<span class="hljs-variable">$emp</span>.<span class="hljs-function">touched</span>()) <span class="hljs-comment">//si au moins l'un des attributs a été modifié</span>    <span class="hljs-variable">$emp</span>.<span class="hljs-function">save</span>()<span class="hljs-keyword"> End if</span> <span class="hljs-comment">// sinon, inutile de sauvegarder l'entité</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_touchedattributes-"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_touchedattributes-"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.touchedAttributes( )</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.touchedAttributes()</strong> : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Noms des attributs touchés ou collection vide</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-21"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-21"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.touchedAttributes()</code> retourne les nomsdes attributs qui ont été modifiés depuis que l'entité a étéchargée en mémoire.</p><p>Cette fonction est applicable aux attributs dont le <a href="#EntityClass.html_kind">kind</a> est <code>storage</code> ou<code>relatedEntity</code>.</p><p>Dans le cas d'un attribut relationnel ayant été "touché" (i.e.,la clé étrangère), le nom de l'entité liée et celui de sa cléprimaire sont retournés.</p><p>Si aucun attribut de l'entité n'a été touché, la fonctionretourne une collection vide.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-1-6"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-1-6"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 1</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$touchedAttributes </span>: Collection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$emp </span>: cs.EmployeeEntity <span class="hljs-variable">$touchedAttributes</span>:=New collection <span class="hljs-variable">$emp</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">725</span>) <span class="hljs-variable">$emp</span>.firstName:=<span class="hljs-variable">$emp</span>.firstName <span class="hljs-comment">//Même modifié avec la même valeur, l'attribut est considéré comme touché</span> <span class="hljs-variable">$emp</span>.lastName:=<span class="hljs-string">"Martin"</span> <span class="hljs-variable">$touchedAttributes</span>:=<span class="hljs-variable">$emp</span>.<span class="hljs-function">touchedAttributes</span>()  <span class="hljs-comment">//$touchedAttributes: ["firstName","lastName"]</span></code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-2-5"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-2-5"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 2</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$touchedAttributes </span>: Collection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$emp </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$company </span>: cs.CompanyEntity <span class="hljs-variable">$touchedAttributes</span>:=New collection <span class="hljs-variable">$emp</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">672</span>) <span class="hljs-variable">$emp</span>.firstName:=<span class="hljs-variable">$emp</span>.firstName <span class="hljs-variable">$emp</span>.lastName:=<span class="hljs-string">"Martin"</span> <span class="hljs-variable">$company</span>:=ds.Company.<span class="hljs-function">get</span>(<span class="hljs-number">121</span>) <span class="hljs-variable">$emp</span>.employer:=<span class="hljs-variable">$company</span> <span class="hljs-variable">$touchedAttributes</span>:=<span class="hljs-variable">$emp</span>.<span class="hljs-function">touchedAttributes</span>()  <span class="hljs-comment">//collection $touchedAttributes: ["firstName","lastName","employer","employerID"]</span></code></pre><p>Dans ce cas :</p><ul><li>firstName et lastName ont un type <code>storage</code></li><li>employer a un type <code>relatedEntity</code></li><li>employerID est la clé étrangère de l'entité reliéeemployer</li></ul><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_unlock"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_unlock"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.unlock()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17</td><td>Ajout</td></tr></tbody></table></details><p><strong>.unlock()</strong> : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Objet statut</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_description-22"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_description-22"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.unlock()</code> supprime le verrou pessimisteposé sur l'enregistrement correspondant à l'entité dans sa table dudatastore.</p><blockquote><p>Pour plus d'informations, veuillez consulter la section <a href="#EntityClass.html_verrouillage-d-une-entite">Verrouillage d'uneentité</a>.</p></blockquote><p>Un enregistrement est automatiquement déverrouillé lorsqu'iln'est plus référencé par aucune entité dans le process qui l'averrouillé (par exemple : si le verrou est posé sur uniquement surune référence locale d'une entité, l'entité et doncl'enregistrement sont déverrouillés lorsque le process setermine).</p><blockquote><p>Lorsqu'un enregistrement est verrouillé, il doit êtredéverrouillé depuis le process qui l'a verrouillé et via laréférence d'entité sur laquelle le verrou a été posé. Par exemple:</p></blockquote><pre><code class="hljs css language-4d"> <span class="hljs-variable">$e1</span>:=ds.Emp.<span class="hljs-function">all</span>()[<span class="hljs-number">0</span>] <span class="hljs-variable">$e2</span>:=ds.Emp.<span class="hljs-function">all</span>()[<span class="hljs-number">0</span>] <span class="hljs-variable">$res</span>:=<span class="hljs-variable">$e1</span>.<span class="hljs-function">lock</span>() <span class="hljs-comment">//$res.success=true</span> <span class="hljs-variable">$res</span>:=<span class="hljs-variable">$e2</span>.<span class="hljs-function">unlock</span>() <span class="hljs-comment">//$res.success=false</span> <span class="hljs-variable">$res</span>:=<span class="hljs-variable">$e1</span>.<span class="hljs-function">unlock</span>() <span class="hljs-comment">//$res.success=true</span></code></pre><p><strong>Résultat</strong></p><p>L'objet retourné par <code>.unlock()</code> contient lapropriété suivante :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td>Boolean</td><td>Vrai si l'action unlock a été exécutée avec succès, Faux sinon.Si le déverrouillage est effectué sur une entité qui a étésupprimée, sur un enregistrement non verrouillé ou sur unenregistrement verrouillé par un autre process ou une autre entité,success vaut Faux.</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_exemple-17"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_exemple-17"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$employee</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">725</span>) <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">lock</span>() ... <span class="hljs-comment">//processing</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">unlock</span>()<span class="hljs-keyword"> If</span>(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"L'entité est déverrouillée"</span>)<span class="hljs-keyword"> End if</span></code></pre><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#EmailObjectClass.html"><span class="arrow-prev">←</span><span>Email</span></a><a class="docs-next button" href="#EntitySelectionClass.html"><span class="function-name-prevnext">EntitySelection</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#EntityClass.html_attributename">.<em>attributeName</em></a></li><li><a href="#EntityClass.html_clone">.clone()</a></li><li><a href="#EntityClass.html_diff">.diff()</a></li><li><a href="#EntityClass.html_drop">.drop()</a></li><li><a href="#EntityClass.html_first">.first()</a></li><li><a href="#EntityClass.html_fromobject">.fromObject()</a></li><li><a href="#EntityClass.html_getdataclass">.getDataClass()</a></li><li><a href="#EntityClass.html_getkey">.getKey()</a></li><li><a href="#EntityClass.html_getremotecontextattributes">.getRemoteContextAttributes()</a></li><li><a href="#EntityClass.html_getselection">.getSelection()</a></li><li><a href="#EntityClass.html_getstamp">.getStamp()</a></li><li><a href="#EntityClass.html_indexof">.indexOf()</a></li><li><a href="#EntityClass.html_isnew">.isNew()</a></li><li><a href="#EntityClass.html_last">.last()</a></li><li><a href="#EntityClass.html_lock">.lock()</a></li><li><a href="#EntityClass.html_next">.next()</a></li><li><a href="#EntityClass.html_previous">.previous()</a></li><li><a href="#EntityClass.html_reload-">.reload( )</a></li><li><a href="#EntityClass.html_save">.save()</a></li><li><a href="#EntityClass.html_toobject">.toObject()</a></li><li><a href="#EntityClass.html_touched-">.touched( )</a></li><li><a href="#EntityClass.html_touchedattributes-">.touchedAttributes()</a></li><li><a href="#EntityClass.html_unlock">.unlock()</a></li></ul></nav></div></div></body></html>