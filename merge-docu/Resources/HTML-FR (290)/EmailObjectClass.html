<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="fr"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Email · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="La création, l'envoi et la réception d'emails dans 4D s'effectuent par l'intermédiaire des objets `Email`."name="description" /><meta content="fr" name="docsearch:language" /><meta content="Email · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="La création, l'envoi et la réception d'emails dans 4D s'effectuent par l'intermédiaire des objets `Email`."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#EmailObjectClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">Email<a aria-hidden="true" class="anchor" id="EmailObjectClass.html"></a></h1></header><article><div><p><span>La création, l'envoi et la réception d'emails dans 4Ds'effectuent par l'intermédiaire des objets<code>Email</code>.</span></p><p><span>Des objets <code>Email</code> sont créés lorsque vousrecevez des emails via une fonction de classe <em>transporter</em>:</span></p><ul><li><span>IMAP - fonctions <a href="#EmailObjectClass.html_getmail"><code>.getMail()</code></a> et<a href="#EmailObjectClass.html_getmails"><code>.getMails()</code></a> pourrécupérer des emails depuis un serveur IMAP</span></li><li><span>POP3 - fonction <a href="#EmailObjectClass.html_getmail"><code>.getMail()</code></a> pourrécupérer un email depuis un serveur POP3.</span></li></ul><blockquote><p><span>Vous pouvez également créer un nouvel objet<code>Email</code> vide en appelant la commande 4D <a href="https://doc.4d.com/4dv18/help/command/en/page1471.html"><code>Newobject</code></a> puis le remplir avec des <a href="#EmailObjectClass.html_email-object">propriétés d'objetEmail</a>.</span></p></blockquote><p><span>Vous envoyez des objets <code>Email</code> à l'aide de lafonction SMTP <a href="#EmailObjectClass.html_send"><code>.send()</code></a>.</span></p><p><span>Les commandes <a href="#EmailObjectClass.html_mail-convert-from-mime"><code>MAIL Convertfrom MIME</code></a> et <a href="#EmailObjectClass.html_mail-convert-to-mime"><code>MAIL Convert toMIME</code></a> peuvent être utilisées pour convertir des objets<code>Email</code> depuis et vers des contenus MIME.</span></p><h3><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_objet-email"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_objet-email"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Objet Email</span></h3><p><span>Les objets Email exposent les propriétés suivantes:</span></p><blockquote><p><span>Le format des objets Email de 4D suit la <a href="https://jmap.io/spec-mail.html">spécification JMAP</a>.</span></p></blockquote><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#EmailObjectClass.html_attachments"><strong>.attachments</strong>: Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;collection d'objets<code>4D.MailAttachment</code></p></td></tr><tr><td><a href="#EmailObjectClass.html_bcc"><strong>.bcc</strong> :Text<br /><strong>.bcc</strong> : Object<br /><strong>.bcc</strong> : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;copie carbone invisible (cci) des<a href="#EmailObjectClass.html_email-addresses">adresse(s)</a> desdestinataires cachés de l'email</p></td></tr><tr><td><a href="#EmailObjectClass.html_bodystructure"><strong>.bodyStructure</strong>: Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<em>EmailBodyPart</em>, i.e. lastructure MIME complète du corps du message (optionnel)</p></td></tr><tr><td><a href="#EmailObjectClass.html_bodyvalues"><strong>.bodyValues</strong> :Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<em>EmailBodyValue</em> contenant unobjet pour chaque &lt;partID&gt; de <code>bodyStructure</code>(facultatif)</p></td></tr><tr><td><a href="#EmailObjectClass.html_cc"><strong>.cc</strong> :Text<br /><strong>.cc</strong> : Object<br /><strong>.cc</strong> : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;les <a href="#EmailObjectClass.html_email-addresses">adresse(s) emailsupplémentaire(s)</a> des destinataires en Copie Carbone (CC) del'email</p></td></tr><tr><td><a href="#EmailObjectClass.html_comments"><strong>.comments</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;en-tête de commentairessupplémentaire</p></td></tr><tr><td><a href="#EmailObjectClass.html_from"><strong>.from</strong> :Text<br /><strong>.from</strong> : Object<br /><strong>.from</strong> : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#EmailObjectClass.html_email-addresses">adresse(s)</a> d'envoid'origine de l'email</p></td></tr><tr><td><a href="#EmailObjectClass.html_headers"><strong>.headers</strong> :Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;collection d'objets<code>EmailHeader</code>, dans l'ordre dans lequel ils apparaissentdans le message</p></td></tr><tr><td><a href="#EmailObjectClass.html_htmlbody"><strong>.htmlBody</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;représentation HTML de l'email(l'encodage par défaut est UTF-8) (facultatif, SMTP uniquement)</p></td></tr><tr><td><a href="#EmailObjectClass.html_id"><strong>.id</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;ID unique du serveur IMAP</p></td></tr><tr><td><a href="#EmailObjectClass.html_inreplyto"><strong>.inReplyTo</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;identifiant(s) du ou des messagesoriginaux auquel/auxquels le message courant est un message deréponse</p></td></tr><tr><td><a href="#EmailObjectClass.html_keywords"><strong>.keywords</strong> :Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;un ensemble de mots-clés sous formed'objet, où chaque nom de propriété est un mot-clé et où chaquevaleur est mise à Vrai</p></td></tr><tr><td><a href="#EmailObjectClass.html_messageid"><strong>.messageId</strong> :Texte</a><p>&nbsp;&nbsp;&nbsp;&nbsp;en-tête d'identificateur de message("message-id")</p></td></tr><tr><td><a href="#EmailObjectClass.html_receivedat"><strong>.receivedAt</strong> :Texte</a><p>&nbsp;&nbsp;&nbsp;&nbsp;l'horodatage de l'arrivée de l'e-mailsur le serveur IMAP au format ISO 8601 UTC (ex :2020-09-13T16:11:53Z)</p></td></tr><tr><td><a href="#EmailObjectClass.html_references"><strong>.references</strong> :Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;collection de tous les identifiants demessages de la chaîne de réponses précédente</p></td></tr><tr><td><a href="#EmailObjectClass.html_replyto"><strong>.replyTo</strong> :Texte<br /><strong>.replyTo</strong> : Objet<br /><strong>.replyTo</strong> : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#EmailObjectClass.html_email-addresses">adresse(s)</a> desdestinataires de réponse à l'email</p></td></tr><tr><td><a href="#EmailObjectClass.html_sendat"><strong>.sendAt</strong> :Texte</a><p>&nbsp;&nbsp;&nbsp;&nbsp;horodatage de l'email au format ISO 8601UTC</p></td></tr><tr><td><a href="#EmailObjectClass.html_sender"><strong>.sender</strong> :Texte<br /><strong>.sender</strong> : Objet<br /><strong>.sender</strong> : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#EmailObjectClass.html_email-addresses">adresse(s) source(s)</a>de l'email</p></td></tr><tr><td><a href="#EmailObjectClass.html_size"><strong>.size</strong> :Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;taille (exprimée en octets) de l'objetEmail retourné par le serveur IMAP</p></td></tr><tr><td><a href="#EmailObjectClass.html_subject"><strong>.subject</strong> :Texte</a><p>&nbsp;&nbsp;&nbsp;&nbsp;description du sujet</p></td></tr><tr><td><a href="#EmailObjectClass.html_textbody"><strong>.textBody</strong> :Texte</a><p>&nbsp;&nbsp;&nbsp;&nbsp;représentation en texte brut de l'email(l'encodage par défaut est UTF-8) (facultatif, SMTP uniquement)</p></td></tr><tr><td><a href="#EmailObjectClass.html_to"><strong>.to</strong> :Texte<br /><strong>.to</strong> : Objet<br /><strong>.to</strong> : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;le ou les <a href="#EmailObjectClass.html_email-addresses">adresse(s)</a> desdestinataires principaux de l'email</p></td></tr></tbody></table><h3><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_adresses-email"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_adresses-email"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Adresses Email</span></h3><p><span>Toutes les propriétés qui contiennent des adresses email(<a href="#EmailObjectClass.html_from"><code>from</code></a>,<a href="#EmailObjectClass.html_cc"><code>cc</code></a>, <a href="#EmailObjectClass.html_bcc"><code>bcc</code></a>, <a href="#EmailObjectClass.html_to"><code>to</code></a>, <a href="#EmailObjectClass.html_sender"><code>sender</code></a>, <a href="#EmailObjectClass.html_replyto"><code>replyTo</code></a>)acceptent des valeurs de type texte, objet oucollection.</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_text"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_text"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Text</span></h4><ul><li><span>une adresse uniquement : "<a href="mailto:somebody@domain.com">somebody@domain.com</a>"</span></li><li><span>un nom+adresse : "Somebody <a href="mailto:somebody@domain.com">somebody@domain.com</a>"</span></li><li><span>combinaison de plusieurs adresses : "Somebody <a href="mailto:somebody@domain.com">somebody@domain.com</a>,<a href="mailto:me@home.org">me@home.org</a>"</span></li></ul><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_object"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_object"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Object</span></h4><p><span>Un objet avec deux propriétés :</span></p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td>Nom à afficher (peut être null)</td></tr><tr><td>email</td><td>Text</td><td>Adresse email</td></tr></tbody></table><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_collection"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_collection"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Collection</span></h4><p><span>Une collection d'objets adresse.</span></p><h3><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_traitement-du-body"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_traitement-du-body"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Traitement du body</span></h3><p><span>Les propriétés <a href="#EmailObjectClass.html_textbody"><code>textBody</code></a> et<a href="#EmailObjectClass.html_htmlbody"><code>htmlBody</code></a>sont utilisées uniquement par la fonction <a href="#EmailObjectClass.html_send">SMTP.send()</a> pour permettred'envoyer des emails simples. Lorsque les deux propriété sontremplies, le type MIME content-type multipart/alternative estutilisé. Le client email doit alors reconnaître la partiemultipart/alternative et afficher la partie texte ou htmlnécessaire.</span></p><p><span><a href="#EmailObjectClass.html_bodystructure"><code>bodyStructure</code></a>et <a href="#EmailObjectClass.html_bodyvalues"><code>bodyValues</code></a>sont utilisés par le <a href="#SMTPTransporterClass.html">SMTP</a>lorsque l'<a href="email-object">objet Email</a> est construitdepuis un document MIME, e.g. généré par la commande <code>MAILConvert from MIME</code>. Dans ce cas, les deux propriétés<code>bodyStructure</code> et <code>bodyValues</code> doivent êtrepassées ensemble, et il est déconseillé d'utiliser<code>textBody</code> et <code>htmlBody</code>.</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_exemple-dobjets-bodystructure-et-bodyvalues"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_exemple-dobjets-bodystructure-et-bodyvalues"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple d'objets bodyStructure et bodyValues</span></h4><pre><span><code class="hljs css language-json">"bodyStructure": {  "type": "multipart/mixed",  "subParts": [    {      "partId": "p0001",      "type": "text/plain"    },    {      "partId": "p0002",      "type": "text/html"    }  ]},"bodyValues": {  "p0001": {    "value": "I have the most brilliant plan. Let me tell you all about it."  },  "p0002": {    "value": "&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;&lt;/title&gt;&lt;style type=\"text/css\"&gt;div{font-size:16px}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div&gt;I have the most brilliant plan. Let me tell you all about it.&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;"  }}</code></span></pre><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_attachments"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_attachments"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.attachments</span></h2><p><span><strong>.attachments</strong> : Collection</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span>La propriété <code>.attachments</code> contient unecollection d'objets <code>4D.MailAttachment</code>.</span></p><p><span>Les objets Attachment (pièce jointe) sont créés à l'aidede la commande <a href="#EmailObjectClass.html_mail-new-attachment"><code>MAIL Newattachment</code></a>. Les objets Attachment ont des <a href="#MailAttachmentClass.html">propriétés et fonctions</a>spécifiques.</span></p><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_bcc"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_bcc"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.bcc</span></h2><p><span><strong>.bcc</strong> : Text<br /><strong>.bcc</strong> : Object<br /><strong>.bcc</strong> : Collection</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-1"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span>La propriété <code>.bcc</code> contient la copie carboneinvisible (cci) des <a href="#EmailObjectClass.html_email-addresses">adresse(s)</a> desdestinataires cachés de l'email.</span></p><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_bodystructure"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_bodystructure"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.bodyStructure</span></h2><p><span><strong>.bodyStructure</strong> : Object</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-2"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span>La propriété <code>.bodyValues</code> stockel'objet<em>EmailBodyValue</em> contenant un objet pour chaque&lt;partID&gt; de <code>bodyStructure</code> (facultatif). Voirsection <a href="#EmailObjectClass.html_traitement-du-body">Traitement dubody</a>.</span></p><p><span>L'objet <code>.bodyStructure</code> contient les propriétésuivantes :</span></p><table><thead><tr><th>Propriété</th><th>Type</th><th>Valeur</th></tr></thead><tbody><tr><td>partID</td><td>Text</td><td>Identifie la partie de manière unique dans l'email</td></tr><tr><td>type</td><td>Text</td><td>(obligatoire) Valeur du champ d'en-tête Content-Type de lapartie</td></tr><tr><td>charset</td><td>Text</td><td>Valeur du paramètre charset du champ d'en-têteContent-Type</td></tr><tr><td>encoding</td><td>Text</td><td>Si <code>isEncodingProblem=true</code>, la valeur deContent-Transfer-Encoding est ajoutée (par défaut indéfini)</td></tr><tr><td>disposition</td><td>Text</td><td>Valeur du champ d'en-tête Content-Disposition de la partie</td></tr><tr><td>language</td><td>Collection de textes</td><td>Liste de balises de langage, telles que définies dans la<a href="https://tools.ietf.org/html/rfc3282">RFC3282</a>, dans lechamp d'en-tête Content-Language de la partie, le cas échéant.</td></tr><tr><td>location</td><td>Text</td><td>URI, tel que défini dans la <a href="https://tools.ietf.org/html/rfc2557">RFC2557</a>, dans le champd'en-tête Content-Location de la partie, le cas échéant.</td></tr><tr><td>subParts</td><td>Collection d'objets</td><td>Parties du corps de chaque enfant (collection d'objets<em>EmailBodyPart</em>)</td></tr><tr><td>headers</td><td>Collection d'objets</td><td>Liste de tous les champs d'en-tête de la partie, dans leurordre d'apparition de l'email (collection d'objets<em>EmailHeader</em> voir propriété <a href="#EmailObjectClass.html_headers-">headers</a>)</td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_bodyvalues"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_bodyvalues"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.bodyValues</span></h2><p><span><strong>.bodyValues</strong> : Object</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-3"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span>La propriété <code>.htmlBody</code> contientlareprésentation HTML de l'email (l'encodage par défaut est UTF-8)(facultatif, SMTP uniquement). Voir section <a href="#EmailObjectClass.html_traitement-du-body">Traitement dubody</a>.</span></p><p><span>L'objet <code>.bodyValues</code> contient les propriétésuivantes :</span></p><table><thead><tr><th>Propriété</th><th>Type</th><th>Valeur</th></tr></thead><tbody><tr><td><em>partID</em>.value</td><td>text</td><td>Valeur de la partie body</td></tr><tr><td><em>partID</em>.isEncodingProblem</td><td>boolean</td><td>Vrai si des sections malformées sont identifiées durant ledécodage du charset, si le charset est inconnu, ou si le contenttransfer-encoding est inconnu. Faux par défaut</td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_cc"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_cc"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.cc</span></h2><p><span><strong>.cc</strong> : Text<br /><strong>.cc</strong> : Object<br /><strong>.cc</strong> : Collection</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-4"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span>La propriété <code>.cc</code> contient les <a href="#EmailObjectClass.html_email-addresses">adresse(s) emailsupplémentaire(s)</a> des destinataires en Copie Carbone (CC) del'email.</span></p><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_comments"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_comments"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.comments</span></h2><p><span><strong>.comments</strong> : Text</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-5"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span>La propriété <code>.comments</code> contient un en-tête decommentaires supplémentaire.</span></p><p><span>Les commentaires n'apparaissent que dans la zone d'en-têtedu message (le body du message reste inchangé).</span></p><p><span>Pour les exigences propres au formatage, veuillezconsulter la <a href="https://tools.ietf.org/html/rfc5322">RFC#5322</a>.</span></p><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_from"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_from"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.from</span></h2><p><span><strong>.from</strong> : Text<br /><strong>.from</strong> : Object<br /><strong>.from</strong> : Collection</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-6"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span>La propriété <code>.from</code> contient les <a href="#EmailObjectClass.html_email-addresses">adresse(s)</a> d'envoid'origine de l'email.</span></p><p><span>Chaque email envoyé comporte à la fois les adresses du<a href="#EmailObjectClass.html_sender">sender</a> et du<strong>from</strong> :</span></p><ul><li><span>le domaine sender correspond à ce que le serveur deréception d'email obtient à l'ouverture de la session,</span></li><li><span>l'adresse from correspond à ce que le(s) destinataire(s)visualise(nt).</span></li></ul><p><span>Pour mieux livrer l'email, il est recommandé d'utiliserles mêmes adresses pour from et sender.</span></p><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_headers"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_headers"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.headers</span></h2><p><span><strong>.headers</strong> : Collection</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-7"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span>La propriété <code>.headers</code> contient une collectiond'objets <code>EmailHeader</code>, dans l'ordre dans lequel ilsapparaissent dans le message. Cette propriété permet auxutilisateurs d'ajouter des en-têtes extended (enregistrés) ou desen-têtes user-defined (non enregistrés, commençant par"X").</span></p><blockquote><p><span>Si une propriété d'objet <code>EmailHeader</code> définitun en-tête tel que "from" ou "cc" qui est déjà défini commepropriété au niveau du mail, la propriété <code>EmailHeader</code>est ignorée.</span></p></blockquote><p><span>Chaque objet de la collection de headers peut contenir lespropriétés suivantes :</span></p><table><thead><tr><th>Propriété</th><th>Type</th><th>Valeur</th></tr></thead><tbody><tr><td>[].name</td><td>Texte</td><td>(obligatoire) Nom du champ en-tête, tel que défini dans la<a href="https://tools.ietf.org/html/rfc5322">RFC#5322</a>. S'ilest null ou indéfini, le champ en-tête n'est pas ajouté à l'en-têteMIME.</td></tr><tr><td>[].value</td><td>Texte</td><td>Valeur du champ d'en-tête telle que définie dans la <a href="https://tools.ietf.org/html/rfc5322">RFC#5322</a></td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_htmlbody"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_htmlbody"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.htmlBody</span></h2><p><span><strong>.htmlBody</strong> : Text</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-8"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span>La propriété <code>.textBody</code> contientlareprésentation en texte brut de l'email (l'encodage par défautest UTF-8) (facultatif, SMTP uniquement). Voir section <a href="#EmailObjectClass.html_traitement-du-body">Traitement dubody</a>.</span></p><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_id"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_id"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.id</span></h2><p><span><strong>.id</strong> : Text</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-9"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span><a href="#IMAPTransporterClass.html">IMAP transporter</a>uniquement.</span></p><p><span>La propriété <code>.id</code> contient l' ID unique duserveur IMAP.</span></p><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_inreplyto"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_inreplyto"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.inReplyTo</span></h2><p><span><strong>.inReplyTo</strong> : Text</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-10"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-10"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span>La propriété <code>.inReplyTo</code> contient le ou lesidentifiant(s) du ou des messages originaux auquel/auxquels lemessage courant est un message de réponse.</span></p><p><span>Pour les exigences propres au formatage, veuillezconsulter la <a href="https://tools.ietf.org/html/rfc5322">RFC#5322</a>.</span></p><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_keywords"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_keywords"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.keywords</span></h2><p><span><strong>.keywords</strong> : Object</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-11"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-11"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span>La propriété <code>.keywords</code> contient un unensemble de mots-clés sous forme d'objet, où chaque nom depropriété est un mot-clé et où chaque valeur est mise àVrai.</span></p><p><span>Cette propriété est l'en-tête "keywords" (voir la <a href="https://tools.ietf.org/html/rfc4021">RFC#4021</a>).</span></p><table><thead><tr><th>Propriété</th><th>Type</th><th>Valeur</th></tr></thead><tbody><tr><td>. &lt;keyword&gt;</td><td>boolean</td><td>Mot-clé à définir à définir (la valeur doit être mise àvrai)</td></tr></tbody></table><p><span>Mots-clés réservés :</span></p><ul><li><span>$draft - Indique qu'un message est unbrouillon</span></li><li><span>$seen - Indique qu'un message a été lu</span></li><li><span>$flagged - Indique qu'un message nécessite une attentionparticulière (ex : Urgent)</span></li><li><span>$answered - Indique qu'un message a reçu uneréponse</span></li><li><span>$deleted - Indique un message à supprimer</span></li></ul><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_exemple"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_exemple"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</span></h4><pre><span><code class="hljs"> <span class="hljs-variable">$mail</span>.keywords[<span class="hljs-string">"<span class="hljs-variable">$flagged</span>"</span>]:=<span class="hljs-literal">True</span> <span class="hljs-variable">$mail</span>.keywords[<span class="hljs-string">"4d"</span>]:=<span class="hljs-literal">True</span></code></span></pre><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_messageid"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_messageid"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.messageId</h2><p><strong>.messageId</strong> : Texte</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-12"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-12"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.messageId</code> contient un en-têted'identificateur de message ("message-id").</p><p>Cet en-tête est généralement"desChiffresOuDesLettres@nomdededomaine", par exemple "<a href="mailto:abcdef.123456@4d.com">abcdef.123456@4d.com</a>". Cetidentifiant unique est notamment utilisé sur les forums ou leslistes de diffusion publiques. En général, les serveurs demessagerie ajoutent automatiquement cet en-tête aux messages qu'ilsenvoient.</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_receivedat"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_receivedat"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.receivedAt</h2><p><strong>.receivedAt</strong> : Texte</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-13"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-13"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p><a href="#IMAPTransporterClass.html">IMAP transporter</a>uniquement.</p><p>La propriété <code>.receivedAt</code> contient l'horodatage del'arrivée de l'e-mail sur le serveur IMAP au format ISO 8601 UTC(ex : 2020-09-13T16:11:53Z).</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_references"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_references"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.references</h2><p><strong>.references</strong> : Collection</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-14"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-14"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.references</code> contient la collection detous les identifiants de messages de la chaîne de réponsesprécédente.</p><p>Pour les exigences propres au formatage, veuillez consulter la<a href="https://tools.ietf.org/html/rfc5322">RFC#5322</a>.</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_replyto"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_replyto"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.replyTo</h2><p><strong>.replyTo</strong> : Texte<br /><strong>.replyTo</strong> : Objet<br /><strong>.replyTo</strong> : Collection</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-15"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-15"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.replyTo</code> contient les <a href="#EmailObjectClass.html_email-addresses">adresse(s)</a> desdestinataires de réponse à l'email.</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_sendat"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_sendat"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.sendAt</h2><p><strong>.sendAt</strong> : Texte</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-16"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-16"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.sendAt</code> contient l' horodatage del'email au format ISO 8601 UTC.</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_sender"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_sender"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.sender</h2><p><strong>.sender</strong> : Texte<br /><strong>.sender</strong> : Objet<br /><strong>.sender</strong> : Collection</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-17"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-17"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.sender</code> contient les <a href="#EmailObjectClass.html_email-addresses">adresse(s) source(s)</a>de l'email.</p><p>Chaque email envoyé comporte à la fois les adresses du<strong>sender</strong> et du <strong><a href="#EmailObjectClass.html_from">from</a></strong> :</p><ul><li>le domaine sender correspond à ce que le serveur de réceptiond'email obtient à l'ouverture de la session,</li><li>l'adresse from correspond à ce que le(s) destinataire(s)visualise(nt).</li></ul><p>Pour mieux livrer l'email, il est recommandé d'utiliser lesmêmes adresses pour from et sender.</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_size"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_size"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.size</h2><p><strong>.size</strong> : Integer</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-18"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-18"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p><a href="#IMAPTransporterClass.html">IMAP transporter</a>uniquement.</p><p>La propriété <code>.size</code> contient la taille (exprimée enoctets) de l'objet Email retourné par le serveur IMAP.</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_subject"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_subject"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.subject</h2><p><strong>.subject</strong> : Texte</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-19"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-19"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.subject</code> contient la description dusujet.</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_textbody"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_textbody"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.textBody</h2><p><strong>.textBody</strong> : Texte</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-20"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-20"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.bodyStructure</code> contientl'objet<em>EmailBodyPart</em>, i.e. la structure MIME complète ducorps du message (optionnel). Voir section <a href="#EmailObjectClass.html_traitement-du-body">Traitement dubody</a>.</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_to"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_to"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.to</h2><p><strong>.to</strong> : Texte<br /><strong>.to</strong> : Objet<br /><strong>.to</strong> : Collection</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-21"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-21"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.to</code> contient le ou les <a href="#EmailObjectClass.html_email-addresses">adresse(s)</a> desdestinataires principaux de l'email.</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_mail-convert-from-mime"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_mail-convert-from-mime"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>MAIL Convert from MIME</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18</td><td>Ajout</td></tr></tbody></table></details><p><strong>MAIL Convert from MIME</strong>( <em>mime</em> : Blob ): Object<br /><strong>MAIL Convert from MIME</strong>( <em>mime</em> : Text ) :Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>mime</td><td>Blob, Text</td><td style="text-align:center">-&gt;</td><td>Email en MIME</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Objet email</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-22"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-22"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La commande <code>MAIL Convert from MIME</code> convertit undocument MIME en un objet email valide.</p><blockquote><p>Le format des objets Email de 4D suit la <a href="https://jmap.io/spec-mail.html">spécification JMAP</a>.</p></blockquote><p>Passez dans <em>mime</em> un document MIME valide à convertir.Il peut être fourni par tout type de serveur ou d'application demessagerie. Vous pouvez passer un BLOB ou un texte dans leparamètre <em>mime</em>. Si le MIME provient d'un fichier, il estrecommandé d'utiliser un paramètre BLOB pour éviter les problèmesliés aux conversions de charset et de retours à la ligne.</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_objet-retourn%C3%A9"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_objet-retourn%25C3%25A9"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Objet retourné</h4><p>Objet email.</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_exemple-1"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_exemple-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 1</h4><p>Vous souhaitez charger un template mail enregistré au formatMIME dans un document texte et l'envoyer par email :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$mime</span>: Blob<span class="hljs-keyword">var</span> <span class="hljs-variable">$mail</span>;<span class="hljs-variable">$server</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$status</span>: Object<span class="hljs-variable">$mime</span>:=<span class="hljs-function">File</span>(<span class="hljs-string">"/PACKAGE/Mails/templateMail.txt"</span>).<span class="hljs-function">getContent</span>())<span class="hljs-variable">$mail</span>:=<span class="hljs-function">MAIL Convert from MIME</span>(<span class="hljs-variable">$mime</span>)<span class="hljs-variable">$mail</span>.to:=<span class="hljs-string">"smith@mail.com"</span><span class="hljs-variable">$mail</span>.subject:=<span class="hljs-string">"Hello world"</span><span class="hljs-variable">$server</span>:=New object<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"smtp.gmail.com"</span><span class="hljs-variable">$server</span>.port:=<span class="hljs-number">465</span><span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXX"</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">SMTP New transporter</span>(<span class="hljs-variable">$server</span>)<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">send</span>(<span class="hljs-variable">$mail</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_exemple-2"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_exemple-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 2</h4><p>Dans cet exemple, vous envoyez directement un document 4D WritePro contenant des images :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$mime</span>: Blob<span class="hljs-keyword">var</span> <span class="hljs-variable">$email</span>;<span class="hljs-variable">$server</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$status</span>: Object<span class="hljs-comment">// Export Mime du document 4D Write Pro</span><span class="hljs-function">WP EXPORT VARIABLE</span>(WParea;<span class="hljs-variable">$mime</span>;wk mime html)<span class="hljs-comment">// convertir la variable Mime de 4D Write Pro en objet email</span><span class="hljs-variable">$email</span>:=<span class="hljs-function">MAIL Convert from MIME</span>(<span class="hljs-variable">$mime</span>)<span class="hljs-comment">// Remplir les en-têtes de l'objet email</span><span class="hljs-variable">$email</span>.subject:=<span class="hljs-string">"4D Write Pro HTML body"</span><span class="hljs-variable">$email</span>.from:=<span class="hljs-string">"YourEmail@gmail.com"</span><span class="hljs-variable">$email</span>.to:=<span class="hljs-string">"RecipientEmail@mail.com"</span><span class="hljs-variable">$server</span>:=New object<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"smtp.gmail.com"</span><span class="hljs-variable">$server</span>.port:=<span class="hljs-number">465</span><span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"YourEmail@gmail.com"</span><span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXX"</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">SMTP New transporter</span>(<span class="hljs-variable">$server</span>)<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">send</span>(<span class="hljs-variable">$email</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_mail-convert-to-mime"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_mail-convert-to-mime"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>MAIL Convert to MIME</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R4</td><td>Ajout</td></tr><tr><td>v17 R5</td><td>Modifié</td></tr></tbody></table></details><p><strong>MAIL Convert to MIME</strong>( <em>mail</em> : Object {; <em>options</em> : Object } ) : Text</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>mail</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Objet email</td></tr><tr><td>options</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Options d'encodage et de charset du mail</td></tr><tr><td>Résultat</td><td>Text</td><td style="text-align:center">&lt;-</td><td>Objet email converti en MIME</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_description-23"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_description-23"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La commande <code>MAIL Convert to MIME</code> convertit un objetemail en un texte MIME. Cette commande est appelée en interne par<a href="#EmailObjectClass.html_send">SMTP_transporter.send( )</a>pour formater l'objet email avant de l'envoyer. Elle peut êtreutilisée pour analyser le format MIME de l'objet.</p><p>Dans <em>mail</em>, passez les éléments du contenu et de lastructure de l'email à convertir. Cela inclut des informationstelles que les adresses e-mail (expéditeur et destinataire(s)), lecontenu de l'e-mail lui-même et son type d'affichage.</p><blockquote><p>Le format des objets Email de 4D suit la <a href="https://jmap.io/spec-mail.html">spécification JMAP</a>.</p></blockquote><p>Dans <em>options</em>, vous pouvez configurer l'encodage et lecharset du mail. Les propriétés suivantes sont disponibles :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>headerCharset</td><td>Text</td><td>Charset et encodage utilisés pour les parties de mail suivantes: le sujet, les noms de fichiers joints et le nom du mail. Valeurspossibles :<table><tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr><tr><td>mail mode ISO2022JP</td><td>US-ASCII_ISO-2022-JP_UTF8_QP</td><td><ul><li><i>headerCharset</i> : US-ASCII si possible, japonais(ISO-2022-JP) &amp; Quoted-printable si possible, sinon UTF-8 &amp;Quoted-printable</li><li><i>bodyCharset</i> : US-ASCII si possible, japonais(ISO-2022-JP) et 7 bits si possible, sinon UTF-8 etQuoted-printable</li></ul></td></tr><tr><td>mail mode ISO88591</td><td>ISO-8859-1</td><td><ul><li><i>headerCharset</i>: ISO-8859-1 &amp; Quoted-printable</li><li><i>bodyCharset</i>: ISO-8859-1 &amp; 8-bit</li></ul></td></tr><tr><td>mail mode UTF8</td><td>US-ASCII_UTF8_QP</td><td><i>headerCharset</i> &amp; <i>bodyCharset</i> : US-ASCII sipossible, sinon UTF-8 &amp; Quoted-printable (<strong>valeur pardéfaut</strong>)</td></tr><tr><td>mail mode UTF8 in base64</td><td>US-ASCII_UTF8_B64</td><td><i>headerCharset</i> &amp;<i>bodyCharset</i> : US-ASCII sipossible, sinon UTF-8 &amp; base64</td></tr></table></td></tr><tr><td>bodyCharset</td><td>Text</td><td>Charset et encodage utilisés pour le contenu html et le textedu body du mail. Valeurs possibles : Identiques à celles deheaderCharset (voir ci-dessus)</td></tr></tbody></table><p>Si le paramètre <em>options</em> est omis, la configuration mailmode UTF8 est utilisée pour les parties en-tête et corps.</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_exemple-3"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_exemple-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$mail</span>: Object<span class="hljs-keyword">var</span> <span class="hljs-variable">$mime</span>: Text<span class="hljs-variable">$mail</span>:=New object<span class="hljs-comment">// Création d'un mail</span><span class="hljs-variable">$mail</span>.from:=<span class="hljs-string">"tsales@massmarket.com"</span><span class="hljs-variable">$mail</span>.subject:=<span class="hljs-string">"Terrific Sale! This week only!"</span><span class="hljs-variable">$mail</span>.textBody:=<span class="hljs-string">"Text format email"</span><span class="hljs-variable">$mail</span>.htmlBody:=<span class="hljs-string">"&lt;html&gt;&lt;body&gt;HTML format email&lt;/body&gt;&lt;/html&gt;"</span><span class="hljs-variable">$mail</span>.to:=New collection<span class="hljs-variable">$mail</span>.to.<span class="hljs-function">push</span>(<span class="hljs-function">New object </span>(<span class="hljs-string">"email"</span>;<span class="hljs-string">"noreply@4d.com"</span>))<span class="hljs-variable">$mail</span>.to.<span class="hljs-function">push</span>(<span class="hljs-function">New object </span>(<span class="hljs-string">"email"</span>;<span class="hljs-string">"test@4d.com"</span>))<span class="hljs-comment">// transform the mail object in MIME</span><span class="hljs-variable">$mime</span>:=<span class="hljs-function">MAIL Convert to MIME</span>(<span class="hljs-variable">$mail</span>)<span class="hljs-comment">// Contents of $mime:</span><span class="hljs-comment">// MIME-Version: 1.0</span><span class="hljs-comment">// Date: Thu, 11 Oct 2018 15:42:25 GMT</span><span class="hljs-comment">// Message-ID: &lt;7CA5D25B2B5E0047A36F2E8CB30362E2&gt;</span><span class="hljs-comment">// Sender: tsales@massmarket.com</span><span class="hljs-comment">// From: tsales@massmarket.com</span><span class="hljs-comment">// To: noreply@4d.com</span><span class="hljs-comment">// To: test@4d.com</span><span class="hljs-comment">// Content-Type: multipart/alternative; boundary="E0AE5773D5E95245BBBD80DD0687E218"</span><span class="hljs-comment">// Subject: Terrific Sale! This week only!</span><span class="hljs-comment">//// --E0AE5773D5E95245BBBD80DD0687E218</span><span class="hljs-comment">// Content-Type: text/plain; charset="UTF-8"</span><span class="hljs-comment">// Content-Transfer-Encoding: quoted-printable</span><span class="hljs-comment">//// Text format email</span><span class="hljs-comment">// --E0AE5773D5E95245BBBD80DD0687E218</span><span class="hljs-comment">// Content-Type: text/html; charset="UTF-8"</span><span class="hljs-comment">// Content-Transfer-Encoding: quoted-printable</span><span class="hljs-comment">//// &lt;html&gt;&lt;body&gt;HTML format email&lt;/body&gt;&lt;/html&gt;</span><span class="hljs-comment">// --E0AE5773D5E95245BBBD80DD0687E218--</span></code></pre><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#DataStoreClass.html"><span class="arrow-prev">←</span><span class="function-name-prevnext">DataStore</span></a><a class="docs-next button" href="#EntityClass.html"><span>Entity</span><span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#EmailObjectClass.html_attachments">.attachments</a></li><li><a href="#EmailObjectClass.html_bcc">.bcc</a></li><li><a href="#EmailObjectClass.html_bodystructure">.bodyStructure</a></li><li><a href="#EmailObjectClass.html_bodyvalues">.bodyValues</a></li><li><a href="#EmailObjectClass.html_cc">.cc</a></li><li><a href="#EmailObjectClass.html_comments">.comments</a></li><li><a href="#EmailObjectClass.html_from">.from</a></li><li><a href="#EmailObjectClass.html_headers">.headers</a></li><li><a href="#EmailObjectClass.html_htmlbody">.htmlBody</a></li><li><a href="#EmailObjectClass.html_id">.id</a></li><li><a href="#EmailObjectClass.html_inreplyto">.inReplyTo</a></li><li><a href="#EmailObjectClass.html_keywords">.keywords</a></li><li><a href="#EmailObjectClass.html_messageid">.messageId</a></li><li><a href="#EmailObjectClass.html_receivedat">.receivedAt</a></li><li><a href="#EmailObjectClass.html_references">.references</a></li><li><a href="#EmailObjectClass.html_replyto">.replyTo</a></li><li><a href="#EmailObjectClass.html_sendat">.sendAt</a></li><li><a href="#EmailObjectClass.html_sender">.sender</a></li><li><a href="#EmailObjectClass.html_size">.size</a></li><li><a href="#EmailObjectClass.html_subject">.subject</a></li><li><a href="#EmailObjectClass.html_textbody">.textBody</a></li><li><a href="#EmailObjectClass.html_to">.to</a></li><li><a href="#EmailObjectClass.html_mail-convert-from-mime">MAILConvert from MIME</a></li><li><a href="#EmailObjectClass.html_mail-convert-to-mime">MAILConvert to MIME</a></li></ul></nav></div></div></body></html>