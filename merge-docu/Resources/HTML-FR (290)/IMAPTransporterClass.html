<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="fr"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>IMAPTransporter · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="La classe `IMAPTransporter` vous permet de récupérer des messages à partir d'un serveur de messagerie IMAP."name="description" /><meta content="fr" name="docsearch:language" /><meta content="IMAPTransporter · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="La classe `IMAPTransporter` vous permet de récupérer des messages à partir d'un serveur de messagerie IMAP."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#IMAPTransporterClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">IMAPTransporter<a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html"></a></h1></header><article><div><p><span>La classe <code>IMAPTransporter</code> vous permet derécupérer des messages à partir d'un serveur de messagerieIMAP.</span></p><h3><span><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_objet-imap-transporter"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_objet-imap-transporter"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Objet IMAP Transporter</span></h3><p><span>Les objets IMAP Transporter sont instanciés avec lacommande <a href="#IMAPTransporterClass.html_imap-new-transporter">IMAP Newtransporter</a>. Leurs propriétés et fonctions sont les suivantes:</span></p><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#IMAPTransporterClass.html_acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong>: Boolean</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>True</strong> si 4D est autoriséà établir une connexion non chiffrée</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_addflags"><strong>.addFlags</strong>(<em>msgIDs</em> : Collection ; <em>keywords</em> : Object ) :Object<br /><strong>.addFlags</strong>( <em>msgIDs</em> : Text ;<em>keywords</em> : Object ) : Object<br /><strong>.addFlags</strong>( <em>msgIDs</em> : Longint ;<em>keywords</em> : Object ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;ajoute des flags (drapeaux) aux<code>msgIDs</code> pour les <code>keywords</code> définis</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_append"><strong>.append</strong>(<em>mailObj</em> : Object ; <em>destinationBox</em> : Text ;<em>options</em> : Object ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;ajoute l'objet <code>mailObj</code> à laboîte <code>destinationBox</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_authenticationmode"><strong>.authenticationMode</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;le mode d'authentification utilisé pourouvrir la session sur le serveur de mail</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_checkconnection"><strong>.checkConnection()</strong>: Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp; vérifie la connexion à l'aide desinformations stockées dans l'objet transporteur</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_checkconnectiondelay"><strong>.checkConnectionDelay</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;durée maximale (en secondes) autoriséeavant vérification de la connexion au serveur</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_connectiontimeout"><strong>.connectionTimeOut</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;la durée maximale (en secondes)autorisée avant vérification de la connexion au serveur</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_copy"><strong>.copy</strong>(<em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) :Object<br /><strong>.copy</strong>( <em>allMsgs</em> : Integer ;<em>destinationBox</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;copie les messages définis dans<em>msgsIDs</em> ou <em>allMsgs</em> dans la<em>destinationBox</em> sur le serveur IMAP</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_createbox"><strong>.createBox</strong>(<em>name</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;crée une nouvelle mailbox avec le<code>name</code> passé en paramètre</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_delete"><strong>.delete</strong>(<em>msgsIDs</em> : Collection ) : Object<br /><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;associe le marqueur "deleted" auxmessages désignés par <code>msgsIDs</code> ou<code>allMsgs</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_deletebox"><strong>.deleteBox</strong>(<em>name</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;supprime définitivement la boîte deréception nommée <code>name</code> sur le serveur IMAP</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_expunge"><strong>.expunge()</strong> :Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;supprime tous les messages marqués"deleted" du serveur de messagerie IMAP.</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getboxinfo"><strong>.getBoxInfo</strong>({ <em>name</em> : Text }) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne un objet <code>boxInfo</code>correspondant à la boîte de réception courante ou à la boîte nommée<em>name</em></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getboxlist"><strong>.getBoxList</strong>({ <em>parameters</em> : Object } ) : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne une collection de boites deréception décrivant toutes les boites de réception disponibles</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getdelimiter"><strong>.getDelimiter()</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne le caractère utilisé pourdélimiter les niveaux de hiérarchie dans le nom de la boite deréception</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getmail"><strong>.getMail</strong>(<em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) :Object<br /><strong>.getMail</strong>( <em>msgID</em>: Text { ;<em>options</em> : Object } ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne l'objet <code>Email</code>correspondant au <em>msgNumber</em> ou <em>msgID</em> dans la boitede réception désignée par <code>IMAP_transporter</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getmails"><strong>.getMails</strong>(<em>ids</em> : Collection { ; <em>options</em> : Object } ) :Object<br /><strong>.getMails</strong>( <em>startMsg</em> : Integer ;<em>endMsg</em> : Integer { ; <em>options</em> : Object } ) :Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne un objet contenant unecollection d'objets <code>Email</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getmimeasblob"><strong>.getMIMEAsBlob</strong>(<em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ): Blob<br /><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ;<em>updateSeen</em> : Boolean } ) : Blob</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne un BLOB avec le contenu MIME dumessage correspondant au <em>msgNumber</em> ou <em>msgID</em> dansla boîte de réception désignée par le<code>IMAP_transporter</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_host"><strong>.host</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;contient le nom ou l'adresse IP duserveur hôte</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_logfile"><strong>.logFile</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;le chemin complet du fichierd'historique qui a été défini (le cas échéant) pour laconnexion</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_move"><strong>.move</strong>(<em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) :Object<br /><strong>.move</strong>( <em>allMsgs</em> : Integer ;<em>destinationBox</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;déplace les messages définis dans<em>msgsIDs</em> ou <em>allMsgs</em> vers la<em>destinationBox</em> sur le serveur IMAP</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_numtoid"><strong>.numToID</strong>(<em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) :Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;convertit les numéros de séquence en IDsuniques IMAP pour les messages de la plage séquentielle désignéepar <em>startMsg</em> et <em>endMsg</em></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_removeflags"><strong>.removeFlags</strong>(<em>msgIDs</em> : Collection ; <em>keywords</em> : Object ) :Object<br /><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ;<em>keywords</em> : Object ) : Object<br /><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ;<em>keywords</em> : Object ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;supprime des flags (drapeaux) des<code>msgIDs</code> pour les <code>keywords</code> définis</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_renamebox"><strong>.renameBox</strong>(<em>currentName</em> : Text ; <em>newName</em> : Text ) :Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;renomme une mailbox sur le serveurIMAP</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_port"><strong>.port</strong> :Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp; le numéro de port utilisé pour lestransactions d'emails</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_searchmails"><strong>.searchMails</strong>(<em>searchCriteria</em> : Text ) : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;recherche les messages qui correspondentaux critères de recherche <em>searchCriteria</em> dans la boîte deréception courante</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_selectbox"><strong>.selectBox</strong>(<em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;sélectionne la mailbox <em>name</em>comme étant la mailbox courante</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_subscribe"><strong>.subscribe</strong>(<em>name</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;permet d'ajouter la mailbox spécifiée àl'ensemble des mailboxes auxquelles vous avez "souscrit" sur leserveur IMAP</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_unsubscribe"><strong>.unsubscribe</strong>(<em>name</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;supprime la mailbox spécifiée del'ensemble des mailboxes auxquelles vous avez "souscrit" sur leserveur IMAP</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_user"><strong>.user</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; le nom d'utilisateur employé pourl'authentification sur le serveur mail</p></td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_imap-new-transporter"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_imap-new-transporter"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>IMAP New transporter</span></h2><details><summary><span>Historique</span></summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R4</td><td>Ajout</td></tr></tbody></table></details><p><span><strong>IMAP New transporter</strong>( <em>server</em> :Object ) : 4D.IMAPTransporter</span></p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>server</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Informations sur le serveur IMAP</td></tr><tr><td>Résultat</td><td>4D.IMAPTransporter</td><td style="text-align:center">&lt;-</td><td><a href="#IMAPTransporterClass.html_imap-transporter-object">Objet IMAPTransporter</a></td></tr></tbody></table><h4><span><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_description"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span>La commande <code>IMAP New transporter</code> configureune nouvelle connexion IMAP en fonction du paramètre<em>server</em> et retourne un nouvel objet <em>transporter</em>.L'objet transporteur retourné sera alors utilisé pour la réceptiond'emails.</span></p><p><span>Dans le paramètre <em>server</em>, passez un objetcontenant les propriétés suivantes :</span></p><table><thead><tr><th><em>server</em></th><th>Valeur par défaut (si omise)</th></tr></thead><tbody><tr><td><a href="#IMAPTransporterClass.html_acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong>: Boolean</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>True</strong> si 4D est autoriséà établir une connexion non chiffrée</p></td><td>Faux</td></tr><tr><td>.<strong>accessTokenOAuth2</strong>: Text<br />.<strong>accessTokenOAuth2</strong>: Object<p>Chaîne de texte ou objet token représentant les informationsd'autorisation OAuth2. Il est utilisé uniquement avec OAUTH2<code>authenticationMode</code>. Si <code>accessTokenOAuth2</code>est utilisé mais que <code>authenticationMode</code> est omis, leprotocole OAuth 2 est utilisé (si le serveur l'autorise). Nonretourné en objet <em><a href="#IMAPTransporterClass.html_imap-transporter-object">IMAPtransporter</a></em>.</p></td><td>aucune</td></tr><tr><td><a href="#IMAPTransporterClass.html_authenticationmode"><strong>.authenticationMode</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;le mode d'authentification utilisé pourouvrir la session sur le serveur de mail</p></td><td>le mode d'authentification le plus sûr pris en charge par leserveur est utilisé</td></tr><tr><td><a href="#IMAPTransporterClass.html_checkconnectiondelay"><strong>.checkConnectionDelay</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;durée maximale (en secondes) autoriséeavant vérification de la connexion au serveur</p></td><td>300</td></tr><tr><td><a href="#IMAPTransporterClass.html_connectiontimeout"><strong>.connectionTimeOut</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;la durée maximale (en secondes)autorisée avant vérification de la connexion au serveur</p></td><td>30</td></tr><tr><td><a href="#IMAPTransporterClass.html_host"><strong>.host</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;contient le nom ou l'adresse IP duserveur hôte</p></td><td><em>obligatoire</em></td></tr><tr><td><a href="#IMAPTransporterClass.html_logfile"><strong>.logFile</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;le chemin complet du fichierd'historique qui a été défini (le cas échéant) pour laconnexion</p></td><td>aucune</td></tr><tr><td>.<strong>password</strong> : Text<p>Mot de passe de l'utilisateur pour l'authentification sur leserveur. Non retourné en objet <em><a href="#IMAPTransporterClass.html_imap-transporter-object">IMAPtransporter</a></em>.</p></td><td>aucune</td></tr><tr><td><a href="#IMAPTransporterClass.html_port"><strong>.port</strong> :Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp; le numéro de port utilisé pour lestransactions d'emails</p></td><td>993</td></tr><tr><td><a href="#IMAPTransporterClass.html_user"><strong>.user</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; le nom d'utilisateur employé pourl'authentification sur le serveur mail</p></td><td>aucune</td></tr></tbody></table><blockquote><p><span><strong>Attention</strong> : Assurez-vous que le timeoutdéfini est inférieur au timeout du serveur, sinon le timeout duclient sera inutile.</span></p></blockquote><h4><span><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_r%C3%A9sultat"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_r%25C3%25A9sultat"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</span></h4><p><span>La fonction retourne un <a href="#IMAPTransporterClass.html_imap-transporter-object"><strong>objetIMAP transporter</strong></a>. Toutes les propriétés retournéessont en <strong>lecture seule</strong>.</span></p><blockquote><p><span>La connexion IMAP est automatiquement fermée lorsquel'objet transporteur est détruit.</span></p></blockquote><h4><span><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</span></h4><pre><span><code class="hljs css language-4d"><span class="hljs-variable">$server</span>:=New object<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span><span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span><span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span><span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span><span class="hljs-variable">$server</span>.logFile:=<span class="hljs-string">"LogTest.txt"</span> <span class="hljs-comment">//log à sauvegarder dans le dossier Logs</span><span class="hljs-keyword">var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">checkConnection</span>()<span class="hljs-keyword">If</span>(<span class="hljs-function">Not</span>(<span class="hljs-variable">$status</span>.success))<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"An error occurred: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">End if</span></code></span></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_4dimaptransporternew"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_4dimaptransporternew"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4D.IMAPTransporter.new()</h2><p><strong>4D.IMAPTransporter.new</strong>( <em>server</em> :Object ) : 4D.IMAPTransporter</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>server</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Informations sur le serveur IMAP</td></tr><tr><td>Résultat</td><td>4D.IMAPTransporter</td><td style="text-align:center">&lt;-</td><td><a href="#IMAPTransporterClass.html_imap-transporter-object">Objet IMAPTransporter</a></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-1"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_description-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>4D.IMAPTransporter.new()</code> crée etretourne un nouvel objet de type <code>4D.IMAPTransporter</code>.Elle est identique à la commande <a href="#IMAPTransporterClass.html_imap-new-transporter"><code>IMAP Newtransporter</code></a> (raccourci).</p><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_acceptunsecureconnection"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_acceptunsecureconnection"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.acceptUnsecureConnection</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R4</td><td>Ajout</td></tr></tbody></table></details><p><strong>.acceptUnsecureConnection</strong> : Boolean</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-2"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_description-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.acceptUnsecureConnection</code> contient<strong>True</strong> si 4D est autorisé à établir une connexionnon chiffrée lorsqu'une connexion chiffrée n'est pas possible.</p><p>Elle contient <strong>False</strong> si les connexions nonchiffrées ne sont pas autorisées, auquel cas une erreur estretournée lorsque la connexion chiffrée n'est pas possible.</p><p>Ports sécurisés disponibles :</p><ul><li><p>SMTP</p><ul><li>465: SMTPS</li><li>587 ou 25 : SMTP avec mise à niveau STARTTLS si le serveur leprend en charge.</li></ul></li><li><p>IMAP</p><ul><li>143 : Port IMAP non chiffré</li><li>993 : IMAP avec mise à niveau STARTTLS si le serveur le prenden charge</li></ul></li><li><p>POP3</p><ul><li>110 : Port POP3 non chiffré</li><li>995 : POP3 avec mise à niveau STARTTLS si le serveur le prenden charge.</li></ul></li></ul><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_addflags"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_addflags"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.addFlags()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R6</td><td>Ajout</td></tr></tbody></table></details><p><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ;<em>keywords</em> : Object ) : Object<br /><strong>.addFlags</strong>( <em>msgIDs</em> : Text ;<em>keywords</em> : Object ) : Object<br /><strong>.addFlags</strong>( <em>msgIDs</em> : Longint ;<em>keywords</em> : Object ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>msgIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection de chaînes : IDs uniques des messages (texte)<br />Texte : ID unique d'un message<br />Numérique (IMAP all) : Tous les messages de la boîtesélectionnée</td></tr><tr><td>keywords</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Mots-clés de flags à ajouter</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération addFlags</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-3"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_description-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.addFlags()</code> ajoute des flags (drapeaux)aux <code>msgIDs</code> pour les <code>keywords</code> définis.</p><p>Dans le paramètre <code>msgIDs</code>, vous pouvez passer soit:</p><ul><li><p>une <em>collection</em> contenant les IDs uniques de messagesspécifiques, ou</p></li><li><p>l'ID unique (<em>texte</em>) d'un seul message ou</p></li><li><p>la constante suivante (<em>entier long</em>) pour tous lesmessages de la boîte sélectionnée :</p><table><thead><tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr></thead><tbody><tr><td>IMAP all</td><td>1</td><td>Sélectionner tous les messages de la boîte sélectionnée</td></tr></tbody></table></li></ul><p>Le paramètre <code>keywords</code> vous permet de passer unobjet avec des valeurs de mots-clés pour les flags spécifiques àajouter à <code>msgIDs</code>. Vous pouvez utiliser les mots-cléssuivants :</p><table><thead><tr><th>Paramètres</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>$draft</td><td>Boolean</td><td>True pour ajouter le marqueur "draft" au message</td></tr><tr><td>$seen</td><td>Booléen</td><td>True pour ajouter le marqueur "seen" au message</td></tr><tr><td>$flagged</td><td>Booléen</td><td>True pour ajouter le marqueur "flagged" au message</td></tr><tr><td>$answered</td><td>Booléen</td><td>True pour ajouter le marqueur "répondu" au message</td></tr><tr><td>$deleted</td><td>Booléen</td><td>True pour ajouter le marqueur "supprimé" au message</td></tr></tbody></table><blockquote><ul><li>Les valeurs à faux sont ignorées.</li><li>L'interprétation des indicateurs de mots-clés peut varier selonle client de messagerie.</li></ul></blockquote><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernièreerreur retournée dans la pile d'erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAPest reçue)</td></tr><tr><td></td><td>[].errcode</td><td>Number</td><td>Code d'erreur 4D</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description de l'erreur 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l'erreur</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-1"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span><span class="hljs-comment">// Créer transporteur</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-comment">// Sélectionner la boîte de messagerie</span><span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-comment">// Marquer tous les messages de la boite de réception (INBOX) comme étant lus/vus</span><span class="hljs-variable">$flags</span>:=New object<span class="hljs-variable">$flags</span>[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">addFlags</span>(IMAP all;<span class="hljs-variable">$flags</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_append"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_append"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.append()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R6</td><td>Ajout</td></tr></tbody></table></details><p><strong>.append</strong>( <em>mailObj</em> : Object ;<em>destinationBox</em> : Text ; <em>options</em> : Object ) :Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>mailObj</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Objet email</td></tr><tr><td>destinationBox</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Mailbox devant recevoir l'objet email</td></tr><tr><td>options</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Objet contenant les informations de charset</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-4"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_description-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.append()</code> ajoute l'objet<code>mailObj</code> à la boîte <code>destinationBox</code>.</p><p>Dans le paramètre <code>mailObj</code>, passez un objet email.Dans le paramètre <code>mailObj</code>, passez un objet email. Lafonction <code>.append()</code> prend en charge les marqueurs demots-clés dans l'attribut <code>keywords</code> des objetsemail.</p><p>Le paramètre optionnel <code>destinationBox</code> vous permetde passer le nom de la boîte de réception dans laquelle l'objet<code>mailObj</code> sera ajouté. S'il est omis, la mailboxcourante sera utilisée.</p><p>Dans le paramètre optionnel <code>options</code>, vous pouvezpasser un objet permettant de définir le charset et l'encodage desdifférentes parties de l'email. Propriétés disponibles :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>headerCharset</td><td>Text</td><td>Charset et encodage utilisés pour les parties de mail suivantes: le sujet, les noms de fichiers joints et le nom du mail. Valeurspossibles : voir le tableau des charsets possibles</td></tr><tr><td>bodyCharset</td><td>Text</td><td>Charset et encodage utilisés pour le contenu html et le textedu body du mail. Valeurs possibles : voir le tableau des charsetspossibles</td></tr></tbody></table><p>Charsets possibles :</p><table><thead><tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr></thead><tbody><tr><td>mail mode ISO2022JP</td><td>US-ASCII_ISO-2022-JP_UTF8_QP</td><td><ul><li>headerCharset : US-ASCII si possible, japonais (ISO-2022-JP)&amp; Quoted-printable si possible, sinon UTF-8 &amp;Quoted-printable</li><li>bodyCharset : US-ASCII si possible, japonais (ISO-2022-JP) et 7bits si possible, sinon UTF-8 et Quoted-printable</li></ul></td></tr><tr><td>mail mode ISO88591</td><td>ISO-8859-1</td><td><ul><li>headerCharset: ISO-8859-1 &amp; Quoted-printable</li><li>bodyCharset: ISO-8859-1 &amp; 8-bit</li></ul></td></tr><tr><td>mail mode UTF8</td><td>US-ASCII_UTF8_QP</td><td>headerCharset &amp; bodyCharset : US-ASCII si possible, sinonUTF-8 &amp; Quoted-printable (<strong>valeur pardéfaut</strong>)</td></tr><tr><td>mail mode UTF8 in base64</td><td>US-ASCII_UTF8_B64</td><td>headerCharset &amp; bodyCharset : US-ASCII si possible, sinonUTF-8 &amp; base64</td></tr></tbody></table><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernièreerreur retournée dans la pile d'erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAPest reçue)</td></tr><tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description de l'erreur 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l'erreur</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-2"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><p>Pour enregistrer un email dans la boîte Drafts :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$settings</span>; <span class="hljs-variable">$status</span>; <span class="hljs-variable">$msg</span>; <span class="hljs-variable">$imap</span>: Object<span class="hljs-variable">$settings</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"host"</span>; <span class="hljs-string">"domain.com"</span>; <span class="hljs-string">"user"</span>; <span class="hljs-string">"xxxx"</span>; <span class="hljs-string">"password"</span>; <span class="hljs-string">"xxxx"</span>; <span class="hljs-string">"port"</span>; <span class="hljs-number">993</span>)<span class="hljs-variable">$imap</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$settings</span>)<span class="hljs-variable">$msg</span>:=New object<span class="hljs-variable">$msg</span>.from:=<span class="hljs-string">"xxxx@domain.com"</span><span class="hljs-variable">$msg</span>.subject:=<span class="hljs-string">"Lorem Ipsum"</span><span class="hljs-variable">$msg</span>.textBody:=<span class="hljs-string">"Lorem ipsum dolor sit amet, consectetur adipiscing elit."</span><span class="hljs-variable">$msg</span>.keywords:=New object<span class="hljs-variable">$msg</span>.keywords[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span><span class="hljs-comment">//marquer le message comme étant lu</span><span class="hljs-variable">$msg</span>.keywords[<span class="hljs-string">"$draft"</span>]:=<span class="hljs-literal">True</span><span class="hljs-comment">//marquer le message comme brouillon</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$imap</span>.<span class="hljs-function">append</span>(<span class="hljs-variable">$msg</span>; <span class="hljs-string">"Drafts"</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_authenticationmode"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_authenticationmode"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.authenticationMode</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R4</td><td>Ajout</td></tr></tbody></table></details><p><strong>.authenticationMode</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-5"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_description-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.authenticationMode</code> contient le moded'authentification utilisé pour ouvrir la session sur le serveur demail.</p><p>Par défaut, le mode le plus sécurisé pris en charge par leserveur est utilisé.</p><p>Valeurs possibles :</p><table><thead><tr><th>Valeur</th><th>Constantes</th><th>Commentaire</th></tr></thead><tbody><tr><td>CRAM-MD5</td><td><code>IMAP authentication CRAM MD5</code></td><td>Authentification à l'aide du protocole CRAM-MD5</td></tr><tr><td>LOGIN</td><td><code>IMAP authentication login</code></td><td>Authentification à l'aide du protocole LOGIN</td></tr><tr><td>OAUTH2</td><td><code>IMAP authentication OAUTH2</code></td><td>Authentification à l'aide du protocole OAuth2</td></tr><tr><td>PLAIN</td><td><code>IMAP authentication plain</code></td><td>Authentification à l'aide du protocole PLAIN</td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_checkconnection"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_checkconnection"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.checkConnection()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R4</td><td>Ajout</td></tr></tbody></table></details><p><strong>.checkConnection()</strong> : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de la connexion de l'objet transporteur</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-6"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_description-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.checkConnection()</code> vérifie la connexionà l'aide des informations stockées dans l'objet transporteur,recrée la connexion si nécessaire et retourne son statut. Cettefonction vous permet de vérifier que les valeurs fournies parl'utilisateur sont valides et cohérentes.</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_objet-retourn%C3%A9"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_objet-retourn%25C3%25A9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Objet retourné</h4><p>La fonction envoie une requête au serveur de mail et retourne unobjet décrivant le statut. Cet objet peut avoir les propriétéssuivantes :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>boolean</td><td>Vrai si la vérification a été effectuée avec succès, sinonFaux</td></tr><tr><td>status</td><td></td><td>number</td><td>(SMTP uniquement) Code du statut retourné par le serveur demessagerie (0 en cas de problème non lié au traitement dumail)</td></tr><tr><td>statusText</td><td></td><td>text</td><td>Message du statut retourné par le serveur de messagerie, oudernière erreur retournée dans la pile d'erreurs 4D</td></tr><tr><td>errors</td><td></td><td>collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur demessagerie est reçue)</td></tr><tr><td></td><td>[ ].errCode</td><td>number</td><td>Code d'erreur 4D</td></tr><tr><td></td><td>[ ].message</td><td>text</td><td>Description de l'erreur 4D</td></tr><tr><td></td><td>[ ].componentSignature</td><td>text</td><td>Signature du composant interne qui a retourné l'erreur</td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_checkconnectiondelay"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_checkconnectiondelay"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.checkConnectionDelay</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R4</td><td>Ajout</td></tr></tbody></table></details><p><strong>.checkConnectionDelay</strong> : Integer</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-7"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_description-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.checkConnectionDelay</code> contient ladurée maximale (en secondes) autorisée avant vérification de laconnexion au serveur. Si cette durée est dépassée entre deux appelsde méthodes, la connexion au serveur sera vérifiée. Par défaut, sila propriété n'a pas été définie dans l'objet <em>server</em>, lavaleur est de 300.</p><blockquote><p><strong>Attention</strong> : Assurez-vous que le timeout définiest inférieur au timeout du serveur, sinon le timeout du clientsera inutile.</p></blockquote><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_connectiontimeout"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_connectiontimeout"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.connectionTimeOut</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R5</td><td>Ajout</td></tr></tbody></table></details><p><strong>.connectionTimeOut</strong> : Integer</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-8"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_description-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.connectionTimeOut</code> contient la duréemaximale (en secondes) autorisée avant vérification de la connexionau serveur. Par défaut, si la propriété n'a pas été définie dansl'objet server (utilisé pour créer l'objet transporteur avec<code>SMTP New transporter</code>, <code>POP3 Newtransporter</code>, <code>IMAP New transporter</code>), la valeurutilisée est 30.</p><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_copy"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_copy"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.copy()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R5</td><td>Ajout</td></tr></tbody></table></details><p><strong>.copy</strong>( <em>msgsIDs</em> : Collection ;<em>destinationBox</em> : Text ) : Object<br /><strong>.copy</strong>( <em>allMsgs</em> : Integer ;<em>destinationBox</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection d'IDs uniques de messages (texte)</td></tr><tr><td>allMsgs</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code> : tous les messages de la boîte deréception sélectionnée</td></tr><tr><td>destinationBox</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Boîte de réception recevant les messages copiés</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération de copie</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-9"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_description-9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.copy()</code> copie les messages définis dans<em>msgsIDs</em> ou <em>allMsgs</em> dans la<em>destinationBox</em> sur le serveur IMAP.</p><p>Vous pouvez passer :</p><ul><li>dans le paramètre <em>msgsIDs</em>, une collection contenantles ID uniques des messages spécifiques à copier, ou</li><li>dans le paramètre <em>allMsgs</em>, la constante <code>IMAPall</code> (integer) pour copier tous les messages de la boîte deréception sélectionnée.</li></ul><p>Le paramètre <em>destinationBox</em> vous permet de passer unevaleur texte avec le nom de la boîte de réception dans laquelleseront placés les messages copiés.</p><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernièreerreur retournée dans la pile d'erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAPest reçue)</td></tr><tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description de l'erreur 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l'erreur</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-1-1"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-1-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 1</h4><p>Pour copier une sélection de messages :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//sélectionner la boite de réception</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)  <span class="hljs-comment">//obtenir la collection des IDs uniques de message</span> <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"4D new feature:\""</span>)  <span class="hljs-comment">// copier les messages identifiés dans la boîte de réception "documents"</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">copy</span>(<span class="hljs-variable">$mailIds</span>;<span class="hljs-string">"documents"</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-2-1"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-2-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 2</h4><p>Pour copier tous les messages de la boîte de réception courante:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//sélectionner la boite de réception</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)  <span class="hljs-comment">// copier les messages dans la boîte de réception "documents"</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">copy</span>(IMAP all;<span class="hljs-string">"documents"</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_createbox"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_createbox"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.createBox()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19</td><td>Ajout</td></tr></tbody></table></details><p><strong>.createBox</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Nom de la nouvelle mailbox</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération de création de mailbox</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-10"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-10"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.createBox()</code> crée une nouvelle mailboxavec le <code>name</code> passé en paramètre. Si le caractèreséparateur de hiérarchie du serveur IMAP apparaît dans le nom de lamailbox, le serveur IMAP créera tous les boîtes parentesnécessaires pour créer la boîte donnée.</p><p>Par exemple, si vous essayez de créer "Projects/IMAP/Doc" dansun serveur dont le "/" est le caractère séparateur de hiérarchie,les éléments suivants seront créés :</p><ul><li>Uniquement la boîte "Doc" si "Projects" &amp; "IMAP" existentdéjà.</li><li>Les boîtes "IMAP" &amp; "Doc" si seule “Projects” existedéjà.</li><li>Les boîtes "Projects" &amp; “IMAP” &amp; "Doc" si ellesn'existent pas déjà.</li></ul><p>Dans le paramètre <code>name</code>, passez le nom de la mailboxà créer.</p><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernièreerreur retournée dans la pile d'erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAPest reçue)</td></tr><tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description de l'erreur 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l'erreur</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-3"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><p>Pour créer une nouvelle boîte “Invoices” :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw </span>: text<span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">If</span>(OK=<span class="hljs-number">1</span>)<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">createBox</span>(<span class="hljs-string">"Invoices"</span>)<span class="hljs-keyword">If</span> (<span class="hljs-variable">$status</span>.success)<span class="hljs-function">ALERT</span>(<span class="hljs-string">"Mailbox creation successful!"</span>)<span class="hljs-keyword">End for each</span><span class="hljs-keyword"> End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_delete"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_delete"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.delete()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R5</td><td>Ajout</td></tr></tbody></table></details><p><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) :Object<br /><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection d'IDs uniques de messages (texte)</td></tr><tr><td>allMsgs</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code> : tous les messages de la boîte deréception sélectionnée</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération de suppression</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-11"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-11"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.delete()</code> associe le marqueur "deleted"aux messages désignés par <code>msgsIDs</code> ou<code>allMsgs</code>.</p><p>Vous pouvez passer :</p><ul><li>dans le paramètre <code>msgsIDs</code>, une collectioncontenant les ID uniques des messages spécifiques à supprimer,ou</li><li>dans le paramètre <code>allMsgs</code>, la constante <code>IMAPall</code> (integer) pour supprimer tous les messages de la boîtede réception sélectionnée.</li></ul><p>L'exécution de cette fonction ne supprime pas réellement lesmessages. Les messages ayant le marqueur "deleted" peuvent toujoursêtre trouvés par la fonction <a href="#IMAPTransporterClass.html_searchmails">.searchMails()</a>. Lesmessages marqués sont supprimés du serveur IMAP uniquement avec<a href="#IMAPTransporterClass.html_expunge"><code>.expunge()</code></a> ouen sélectionnant une autre boîte de réception ou lorsque l'objet<a href="#IMAPTransporterClass.html_imap-transporter-object">transporter</a>(créé avec <a href="#IMAPTransporterClass.html_imap-new-transporter">IMAP Newtransporter</a>) est détruit.</p><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernièreerreur retournée dans la pile d'erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAPest reçue)</td></tr><tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description de l'erreur 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l'erreur</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-1-2"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-1-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 1</h4><p>Pour supprimer une sélection de messages :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//sélectionner la boite de réception</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)  <span class="hljs-comment">//obtenir la collection d'IDs unique des messages</span> <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"Reports\""</span>)  <span class="hljs-comment">// Supprimer les messages sélectionnés</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$mailIds</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-2-2"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-2-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 2</h4><p>Pour supprimer tous les messages de la boîte de réceptioncourante :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//selection de la boîte</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Junk Email"</span>)  <span class="hljs-comment">// suppression de tous les messages de la boîte courante</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(IMAP all)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_deletebox"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_deletebox"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.deleteBox()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19</td><td>Ajout</td></tr></tbody></table></details><p><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Nom de la boîte de réception à supprimer</td></tr></tbody></table><p>|Result|Object|&lt;-|Statut de l'opération de suppression|</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-12"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-12"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.deleteBox()</code> supprime définitivement laboîte de réception nommée <code>name</code> sur le serveur IMAP. Sivous tentez de supprimer la boîte INBOX ou une boîte de réceptionqui n'existe pas, une erreur sera générée.</p><p>Dans le paramètre <code>name</code>, passez le nom de la mailboxà supprimer.</p><blockquote><ul><li>La fonction ne peut pas supprimer une boîte de réceptioncontenant des boîtes "enfant" si la boîte "parente" dispose del'attribute "\Noselect".</li><li>Tous les messages présents dans la boîte seront égalementsupprimés.</li><li>La possibilité de supprimer une boîte de réception dépend duserveur de messagerie.</li></ul></blockquote><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernièreerreur retournée dans la pile d'erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAPest reçue)</td></tr><tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description de l'erreur 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l'erreur</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-4"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><p>Vous souhaitez supprimer la boîte enfant "Nova Orion Industries"à l'intérieur de la boîte "Bills" :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-comment">// delete mailbox</span><span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Nova Orion Industries"</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">deleteBox</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">If</span> (<span class="hljs-variable">$status</span>.success)<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Mailbox deletion successful!"</span>)<span class="hljs-keyword">    Else</span><span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">    End if</span><span class="hljs-keyword">End if</span><span class="hljs-keyword">    Else</span><span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">    End if</span><span class="hljs-keyword">End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_expunge"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_expunge"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.expunge()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R6</td><td>Ajout</td></tr></tbody></table></details><p><strong>.expunge()</strong> : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération expunge</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-13"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-13"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.expunge()</code> supprime tous les messagesmarqués "deleted" du serveur de messagerie IMAP. Le marqueur"deleted" peut être fixé avec les fonctions <a href="#IMAPTransporterClass.html_delete"><code>.delete()</code></a> ou<a href="#IMAPTransporterClass.html_addflags"><code>.addFlags()</code></a>.</p><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernièreerreur retournée dans la pile d'erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAPest reçue)</td></tr><tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description de l'erreur 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l'erreur</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-5"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">var</span> <span class="hljs-variable">$ids </span>: Collection<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span><span class="hljs-comment">// Creation du transporter</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-comment">// Sélection de la boîte</span><span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-comment">// Chercher et sélectionner les messages lus dans INBOX</span><span class="hljs-variable">$ids</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"SEEN"</span>)<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$ids</span>)<span class="hljs-comment">// Purger tous les messages marqués deleted</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">expunge</span>()</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getboxinfo"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getboxinfo"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getBoxInfo()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R5</td><td><em>name</em> est optionnel</td></tr></tbody></table><p>|v18 R4|Added|</p></details><p><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) :Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Nom de la boîte de réception</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Objet boxInfo</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-14"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-14"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.getBoxInfo()</code> retourne un objet<code>boxInfo</code> correspondant à la boîte de réception couranteou à la boîte nommée <em>name</em>. Cette fonction retourne lesmêmes informations que <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>mais sans modifier la boite de réception courante.</p><p>Dans le paramètre optionnel <em>name</em> passez le nom de laboite de réception à laquelle vous souhaitez accéder. Le nom doitreprésenter une hiérarchie claire, de gauche à droite, avec desniveaux séparés par un caractère délimiteur spécifique. Ledélimiteur peut être récupéré à l'aide de la fonction <a href="#IMAPTransporterClass.html_getdelimiter"><code>.getDelimiter()</code></a>.</p><p>Si la boîte de réception nommée <em>name</em> n'est passélectionnable ou n'existe pas, la fonction génère une erreur etretourne <strong>null</strong>.</p><p><strong>Objet retourné</strong></p><p>L'objet <code>boxInfo</code> contient les propriété suivantes:</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Texte</td><td>Nom de la boîte de réception</td></tr><tr><td>mailCount</td><td>number</td><td>Nombre de messages contenus dans la boîte de réception</td></tr><tr><td>mailRecent</td><td>number</td><td>Nombre de messages portant le marqueur "récent" (indiquant lesnouveaux messages)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-6"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>) <span class="hljs-variable">$info</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxInfo</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-function"> ALERT</span>(<span class="hljs-string">"INBOX contains "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$info</span>.mailRecent)+<span class="hljs-string">" recent emails."</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getboxlist"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getboxlist"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getBoxList()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R4</td><td>Ajout</td></tr><tr><td>v19</td><td>Ajout paramètre <code>isSubscribed</code></td></tr></tbody></table></details><p><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ): Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>parameters</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Objet de paramètre</td></tr><tr><td>Résultat</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Collection d'objets mailbox</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-15"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-15"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.getBoxList()</code> retourne une collectionde boites de réception décrivant toutes les boites de réceptiondisponibles. Cette fonction vous permet de gérer localement leslistes de messages situés sur le serveur de messagerie IMAP.</p><p>Dans le paramètre optionnel <code>parameters</code>, passez unobjet contenant des valeurs de filtrage des boîtes de réceptionretournées. Vous pouvez passer :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>isSubscribed</td><td>Booléen</td><td><ul><li><strong>True</strong> pour retourner uniquement les boîtesauxquelles vous êtes abonné</li><li><strong>False</strong> pour retourner toutes les boîtes deréception disponibles</li></ul></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_r%C3%A9sultat-1"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_r%25C3%25A9sultat-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><p>Chaque objet de la collection retournée contient les propriétéssuivantes :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>[].name</td><td>Texte</td><td>Nom de la boîte de réception</td></tr><tr><td>[].selectable</td><td>boolean</td><td>Indique si les droits d'accès permettent ou non à la boite deréception d'être sélectionnée :<ul><li>vrai - la boite de réception peut être sélectionnée</li><li>faux - la boite de réception ne peut pas être sélectionnée</li></ul></td></tr><tr><td>[].inferior</td><td>boolean</td><td>Indique si les droits d'accès permettent ou non la créationd'une hiérarchie inférieure dans la boite de réception :<ul><li>vrai - un niveau inférieur peut être créé</li><li>faux - un niveau inférieur ne peut pas être créé</li></ul></td></tr><tr><td>[].interesting</td><td>boolean</td><td>Indique si la boite de réception a été marquée comme"intéressante" par le serveur :<ul><li>vrai - la boite de réception a été marquée comme "intéressante"par le serveur. Par exemple, elle peut contenir de nouveauxmessages.</li><li>faux - la boite de réception n'a pas été marquée comme"intéressante" par le serveur.</li></ul></td></tr></tbody></table><p>Si le compte ne contient pas de boites de réception, unecollection vide est retournée.</p><blockquote><ul><li>Si aucune connexion n'est ouverte, <code>.getBoxList()</code>ouvrira une connexion.</li><li>Si la connexion n'a pas été utilisée depuis le délai deconnexion (voir <code>IMAP New transporter</code>), la fonction<code>.checkConnection( )</code> est automatiquement appelée.</li></ul></blockquote><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-7"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>) <span class="hljs-variable">$boxList</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxList</span>()<span class="hljs-keyword"> For each</span>(<span class="hljs-variable">$box</span>;<span class="hljs-variable">$boxList</span>)<span class="hljs-keyword">    If</span>(<span class="hljs-variable">$box</span>.interesting)       <span class="hljs-variable">$split</span>:=<span class="hljs-function">Split string</span>(<span class="hljs-variable">$box</span>.name;<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>())<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"New emails are available in the box: "</span>+<span class="hljs-variable">$split</span>[<span class="hljs-variable">$split</span>.length<span class="hljs-number">-1</span>])<span class="hljs-keyword">    End if</span><span class="hljs-keyword"> End for each</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getdelimiter"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getdelimiter"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getDelimiter()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R4</td><td>Ajout</td></tr></tbody></table></details><p><strong>.getDelimiter()</strong> : Text</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Text</td><td style="text-align:center">&lt;-</td><td>Caractère de délimitation de hiérarchie</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-16"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-16"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.getDelimiter()</code> retourne le caractèreutilisé pour délimiter les niveaux de hiérarchie dans le nom de laboite de réception.</p><p>Le délimiteur est un caractère pouvant être utilisé pour :</p><ul><li>créer des boites de réception de niveau inférieur</li><li>rechercher des niveaux inférieurs ou supérieurs dans lahiérarchie de la boite de réception</li></ul><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_r%C3%A9sultat-2"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_r%25C3%25A9sultat-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><p>Caractère de délimitation des noms de boites de réception.</p><blockquote><ul><li>Si aucune connexion n'est ouverte, <code>.getDelimiter()</code>ouvrira une connexion.</li><li>Si la connexion n'a pas été utilisée depuis le <a href="#IMAPTransporterClass.html_checkconnectiondelay">délai deconnexion</a>, la fonction</li></ul></blockquote><p>`.checkConnection( ) <code>est automatiquementappelée.</code></p><h4 spaces-before="0"><code>Exemple</code></h4><pre><code><code class="4d"> var $transporter : 4D.IMAPTransporter $transporter:=IMAP New transporter($server)<br />$boxList:=$transporter.getBoxList()<br /><br /><br />For each($box;$boxList)If($box.interesting)$split:=Split string($box.name;$transporter.getDelimiter())ALERT("New emails are available in the box: "+$split[$split.length-1])End ifEnd for each`</code></code></pre><blockquote><pre><code><code class="hljs">## .getMail()&lt;details&gt;&lt;summary&gt;Historique&lt;/summary&gt;</code></code></pre></blockquote><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R4</td><td>Ajout</td></tr></tbody></table><p><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ;<em>options</em> : Object } ) : Object<br /><strong>.getMail</strong>( <em>msgID</em>: Text { ;<em>options</em> : Object } ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>msgNumber</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Numéro de séquence du message</td></tr><tr><td>msgID</td><td>Text</td><td style="text-align:center">-&gt;</td><td>ID unique du message</td></tr><tr><td>options</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Instructions sur la gestion du message</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td><a href="#IMAPTransporterClass.html_email-object">Objetemail</a></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-17"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-17"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.getMail()</code> retourne l'objet<code>Email</code> correspondant au <em>msgNumber</em> ou<em>msgID</em> dans la boite de réception désignée par<code>IMAP_transporter</code>. Cette fonction vous permet de gérerlocalement le contenu de l'email.</p><p>Dans le premier paramètre, vous pouvez passer soit :</p><ul><li><em>msgNumber</em>, une valeur <em>integer</em> indiquant lenuméro de séquence du message à récupérer ou</li><li><em>msgID</em>, une valeur <em>text</em> indiquant l'ID uniquedu message à récupérer.</li></ul><p>Le paramètre facultatif <em>options</em> vous permet de passerun objet définissant des instructions supplémentaires pour lagestion de votre message. Les propriétés suivantes sont disponibles:</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>updateSeen</td><td>boolean</td><td>Si Vrai, le message est marqué comme "seen" (lu) dans la boitede réception. Si Faux, le message n'est pas marqué comme "seen".Valeur par défaut : Vrai</td></tr><tr><td>withBody</td><td>boolean</td><td>Passez Vrai pour retourner le corps du message. Si Faux, seull'en-tête du message est retourné. Valeur par défaut : Vrai</td></tr></tbody></table><blockquote><ul><li>La fonction génère une erreur et retourne <strong>Null</strong>si <em>msgID</em> désigne un message non existant,</li><li>Si aucune boite de réception n'est sélectionnée avec lafonction <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>,une erreur est générée,</li><li>Si aucune connexion n'est ouverte, <code>.getMail()</code>ouvrira une connexion avec la dernière boite de réception spécifiéepar <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>.</li></ul></blockquote><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_r%C3%A9sultat-3"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_r%25C3%25A9sultat-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><p><code>.getMail()</code> retourne un <a href="#IMAPTransporterClass.html_objet-email"><code>objetEmail</code></a> avec les propriétés IMAP supplémentaires suivantes: <em>id</em>, <em>receivedAt</em> et <em>size</em>.</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-8"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><p>Vous souhaitez lire le message avec ID = 1 :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$info</span>; <span class="hljs-variable">$mail</span>; <span class="hljs-variable">$boxInfo </span>: Variant<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//obligatoire</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>  <span class="hljs-comment">//creation du transporter</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//selection de la mailbox</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)  <span class="hljs-comment">//récupération de l'objet Email d'ID 1</span> <span class="hljs-variable">$mail</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMail</span>(<span class="hljs-number">1</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getmails"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getmails"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getMails()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R5</td><td>Ajout</td></tr></tbody></table></details><p><strong>.getMails</strong>( <em>ids</em> : Collection { ;<em>options</em> : Object } ) : Object<br /><strong>.getMails</strong>( <em>startMsg</em> : Integer ;<em>endMsg</em> : Integer { ; <em>options</em> : Object } ) :Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>ids</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection d'identifiants de messages</td></tr><tr><td>startMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Numéro de séquence du premier message</td></tr><tr><td>endMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Numéro de séquence du dernier message</td></tr><tr><td>options</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Instructions sur la gestion du message</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Objet contenant :<br /><ul><li>une collection d'<a href="#IMAPTransporterClass.html_objet-email">objets Email</a> et</li><li>une collection d'identifiants ou de numéros des messagesmanquants, le cas échéant</li></ul></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-18"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-18"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.getMails()</code> retourne un objet contenantune collection d'objets <code>Email</code>.</p><p><strong>Première syntaxe :</strong></p><p><strong><em>.getMails( ids { ; options } ) -&gt;result</em></strong></p><p>La première syntaxe vous permet de récupérer des messages enfonction de leurs identifiants.</p><p>Dans le paramètre <em>ids</em>, passez une collectiond'identifiants des messages à retourner. Vous pouvez obtenir les IDà l'aide de <a href="#IMAPTransporterClass.html_getmail"><code>.getMail()</code></a>.</p><p>Le paramètre optionnel <em>options</em> vous permet de définirles parties de messages à retourner. Pour une description détailléedes propriétés disponibles, reportez-vous au tableau<strong>Options</strong> ci-dessous.</p><p><strong>Deuxième syntaxe :</strong></p><p><strong><em>.getMails( startMsg ; endMsg { ; options } ) -&gt;result</em></strong></p><p>La deuxième syntaxe vous permet de récupérer des messages enfonction d'une plage séquentielle. Les valeurs passées représententla position des messages dans la boite de réception.</p><p>Dans le paramètre <em>startMsg</em> passez une valeur<em>entier</em> correspondant au numéro du premier message dans uneplage séquentielle. Si vous passez un nombre négatif(<em>startMsg</em> &lt;= 0), le premier message de la boîte deréception sera utilisé comme début de la séquence.</p><p>Dans le paramètre <em>endMsg</em> passez une valeur <em>entierlong</em> correspondant au numéro du dernier message à inclure dansune plage séquentielle. Si vous passez un nombre négatif(<em>endMsg</em> &lt;= 0), le dernier message de la boîte deréception sera utilisé comme fin de séquence.</p><p>Le paramètre optionnel <em>options</em> vous permet de définirles parties de messages à retourner.</p><p><strong>Options</strong></p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>updateSeen</td><td>Booléen</td><td>Si Vrai, les messages sont marqués comme "seen" (lus) dans laboite de réception. Si Faux, les messages ne sont pas marqués comme"seen". Valeur par défaut : Vrai</td></tr><tr><td>withBody</td><td>Booléen</td><td>Passez Vrai pour retourner le corps des messages spécifiés. SiFaux, seuls les en-tête des messages sont retournés. Valeur pardéfaut : Vrai</td></tr></tbody></table><blockquote><ul><li>Si aucune boite de réception n'est sélectionnée avec lafonction <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>,une erreur est générée.</li><li>S'il n'y a pas de connexion ouverte, <code>.getMails()</code>ouvrira une connexion avec la dernière boite de réception spécifiéeà l'aide de <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>.</li></ul></blockquote><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_r%C3%A9sultat-4"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_r%25C3%25A9sultat-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><p><code>.getMails()</code> retourne un objet contenant lescollections suivantes :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>liste</td><td>Collection</td><td>Collection d'objets <a href="#IMAPTransporterClass.html_email-object"><code>Email</code></a>.Si aucun objet Email n'est trouvé, une collection vide estretournée.</td></tr><tr><td>notFound</td><td>Collection</td><td>Collection de :<br /><ul><li>première syntaxe - IDs de messages passés antérieurement quin'existent pas</li><li>deuxième syntaxe - numéros de séquence des messages entrestartMsg et endMsg qui n'existent pas</li></ul>Une collection vide est retournée si tous les messages sonttrouvés.</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-9"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><p>Vous souhaitez récupérer les 20 emails les plus récents sansmodifier le statut "seen" :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>,<span class="hljs-variable">$boxInfo</span>,<span class="hljs-variable">$result </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//obligatoire</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>  <span class="hljs-comment">//create transporter</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//select mailbox</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-keyword">  If</span>(<span class="hljs-variable">$boxInfo</span>.mailCount&gt;<span class="hljs-number">0</span>)        <span class="hljs-comment">// récupérer les en-têtes des 20 derniers messages sans les marquer comme lus</span>    <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMails</span>(<span class="hljs-variable">$boxInfo</span>.mailCount<span class="hljs-number">-20</span>;<span class="hljs-variable">$boxInfo</span>.mailCount;\<span class="hljs-function">        New object</span>(<span class="hljs-string">"withBody"</span>;<span class="hljs-literal">False</span>;<span class="hljs-string">"updateSeen"</span>;<span class="hljs-literal">False</span>))<span class="hljs-keyword">    For each</span>(<span class="hljs-variable">$mail</span>;<span class="hljs-variable">$result</span>.list)        <span class="hljs-comment">// ...</span><span class="hljs-keyword">    End for each</span><span class="hljs-keyword"> End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getmimeasblob"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getmimeasblob"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getMIMEAsBlob()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R4</td><td>Ajout</td></tr></tbody></table></details><p><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer {; <em>updateSeen</em> : Boolean } ) : Blob<br /><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ;<em>updateSeen</em> : Boolean } ) : Blob</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>msgNumber</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Numéro de séquence du message</td></tr><tr><td>msgID</td><td>Text</td><td style="text-align:center">-&gt;</td><td>ID unique du message</td></tr><tr><td>updateSeen</td><td>Booléen</td><td style="text-align:center">-&gt;</td><td>Si Vrai, le message est marqué comme "seen" (lu) dans la boitede réception. Si Faux, le message demeure inchangé.</td></tr><tr><td>Résultat</td><td>BLOB</td><td style="text-align:center">&lt;-</td><td>Blob de la chaine MIME retournée par le serveur mail</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-19"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-19"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.getMIMEAsBlob()</code> retourne un BLOB avecle contenu MIME du message correspondant au <em>msgNumber</em> ou<em>msgID</em> dans la boîte de réception désignée par le<code>IMAP_transporter</code>.</p><p>Dans le premier paramètre, vous pouvez passer soit :</p><ul><li><em>msgNumber</em>, une valeur <em>integer</em> indiquant lenuméro de séquence du message à récupérer ou</li><li><em>msgID</em>, une valeur <em>text</em> indiquant l'ID uniquedu message à récupérer.</li></ul><p>Le paramètre optionnel <em>updateSeen</em> vous permetd'indiquer si le message est marqué comme "seen" (lu) dans la boîtede réception. Vous pouvez passer :</p><ul><li><strong>Vrai</strong> - pour marquer le message comme "seen"(indiquant que le message a été lu)</li><li><strong>Faux</strong> - pour ne pas modifier le statut "seen"du message</li></ul><blockquote><ul><li>La fonction retourne un BLOB vide si <em>msgNumber</em> oumsgID désigne un message inexistant,</li><li>Si aucune boite de réception n'est sélectionnée avec lafonction <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>,une erreur est générée,</li><li>S'il n'y a pas de connexionouverte,<code>.getMIMEAsBlob()</code> ouvrira une connexion avec ladernière boite de réception spécifiée à l'aide de<code>.selectBox()</code>.</li></ul></blockquote><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_r%C3%A9sultat-5"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_r%25C3%25A9sultat-5"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><p><code>.getMIMEAsBlob()</code> retourne un <code>BLOB</code> quipeut être archivé dans une base de données ou converti en un objet<a href="#IMAPTransporterClass.html_objet-email"><code>Email</code></a>avec la commande <code>MAIL Convert from MIME</code>.</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-10"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-10"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$boxInfo </span>: Variant<span class="hljs-keyword"> var</span> <span class="hljs-variable">$blob </span>: Blob<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>  <span class="hljs-comment">//créer transporteur</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//sélectionner la boite de réception</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)  <span class="hljs-comment">//obtenir BLOB</span> <span class="hljs-variable">$blob</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMIMEAsBlob</span>(<span class="hljs-number">1</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_host"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_host"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.host</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R5</td><td>Ajout</td></tr></tbody></table></details><p><strong>.host</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-20"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-20"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.host</code> contient contient le nom oul'adresse IP du serveur hôte. Utilisée pour les échanges decourrier (SMTP, POP3, IMAP).</p><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_logfile"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_logfile"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.logFile</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R5</td><td>Ajout</td></tr></tbody></table></details><p><strong>.logFile</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-21"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-21"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.logFile</code> contient le chemin complet dufichier d'historique qui a été défini (le cas échéant) pour laconnexion. Elle peut être relative (au dossier Logs courant) ouabsolue.</p><p>Contrairement aux fichiers log habituels (activés via lacommande <code>SET DATABASE PARAMETER</code>), les fichiers logétendus stockent le contenu MIME de tous les emails envoyés etn'ont pas de limite de taille. Pour plus d'informations sur lesfichiers log étendus, reportez-vous à :</p><ul><li><strong>Connexions SMTP</strong> - <a href="#IMAPTransporterClass.html_4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DSMTPLog.txt</a></li><li><strong>Connexions POP3</strong> - <a href="#IMAPTransporterClass.html_4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DPOP3Log.txt</a></li><li><strong>Connexions IMAP</strong> - <a href="#IMAPTransporterClass.html_4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DIMAPLog.txt</a></li></ul><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_move"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_move"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.move()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R5</td><td>Ajout</td></tr></tbody></table></details><p><strong>.move</strong>( <em>msgsIDs</em> : Collection ;<em>destinationBox</em> : Text ) : Object<br /><strong>.move</strong>( <em>allMsgs</em> : Integer ;<em>destinationBox</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection d'IDs uniques de messages (texte)</td></tr><tr><td>allMsgs</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code> : tous les messages de la boîte deréception sélectionnée</td></tr><tr><td>destinationBox</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Boîte de réception recevant les messages déplacés</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération de déplacement</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-22"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-22"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.move()</code> déplace les messages définisdans <em>msgsIDs</em> ou <em>allMsgs</em> vers la<em>destinationBox</em> sur le serveur IMAP.</p><p>Vous pouvez passer :</p><ul><li>dans le paramètre <em>msgsIDs</em>, une collection contenantles ID uniques des messages spécifiques à déplacer, ou</li><li>dans le paramètre <em>allMsgs</em>, la constante <code>IMAPall</code> (integer) pour déplacer tous les messages de la boîte deréception sélectionnée.</li></ul><p>Le paramètre <em>destinationBox</em> vous permet de passer unevaleur texte avec le nom de la boîte de réception dans laquelleseront placés les messages déplacés.</p><blockquote><p>Cette fonction est uniquement prise en charge par les serveursIMAP compatibles avec RFC <a href="https://tools.ietf.org/html/rfc8474">8474</a>.</p></blockquote><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernièreerreur retournée dans la pile d'erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAPest reçue)</td></tr><tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description de l'erreur 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l'erreur</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-1-3"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-1-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 1</h4><p>Pour déplacer une sélection de messages :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//sélectionner la boite de réception</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)  <span class="hljs-comment">//obtenir la collection d'IDs uniques des messages</span> <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"4D new feature:\""</span>)  <span class="hljs-comment">// déplacer les messages de la boite de réception courante vers la boite de réception "documents"</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">move</span>(<span class="hljs-variable">$mailIds</span>;<span class="hljs-string">"documents"</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-2-3"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-2-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 2</h4><p>Pour déplacer tous les messages de la boîte de réceptioncourante :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//sélectionner la boite de réception</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)  <span class="hljs-comment">// déplacer tous les messages de la boite de réception courante vers la boite de réception "documents"</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">move</span>(IMAP all;<span class="hljs-string">"documents"</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_numtoid"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_numtoid"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.numToID()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R5</td><td>Ajout</td></tr></tbody></table></details><p><strong>.numToID</strong>( <em>startMsg</em> : Integer ;<em>endMsg</em> : Integer ) : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>startMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Numéro de séquence du premier message</td></tr><tr><td>endMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Numéro de séquence du dernier message</td></tr><tr><td>Résultat</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Collection d'identifiants de messages uniques</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-23"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-23"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.numToID()</code> convertit les numéros deséquence en IDs uniques IMAP pour les messages de la plageséquentielle désignée par <em>startMsg</em> et <em>endMsg</em> dansla boîte de réception courante.</p><p>Dans le paramètre <em>startMsg</em>, passez une valeur integercorrespondant au numéro du premier message dans la plageséquentielle. Si vous passez un nombre négatif (<em>startMsg</em>&lt;= 0), le premier message de la boîte de réception sera utilisécomme début de la séquence.</p><p>Dans le paramètre <em>endMsg</em>, passez une valeur integercorrespondant au numéro du dernier message dans la plageséquentielle. Si vous passez un nombre négatif (<em>endMsg</em>&lt;= 0), le dernier message de la boîte de réception sera utilisécomme fin de séquence.</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_r%C3%A9sultat-6"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_r%25C3%25A9sultat-6"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</h4><p>La fonction retourne une collection de chaînes (IDsuniques).</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-11"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-11"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter<span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$mailIds </span>: Collection <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//sélectionner la boite de réception</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)  <span class="hljs-comment">//obtenir les IDs des 5 derniers messages reçus</span> <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">numToID</span>((<span class="hljs-variable">$boxInfo</span>.mailCount<span class="hljs-number">-5</span>);<span class="hljs-variable">$boxInfo</span>.mailCount)  <span class="hljs-comment">//supprimer les messages de la boite de réception courante</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$mailIds</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_removeflags"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_removeflags"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.removeFlags()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R6</td><td>Ajout</td></tr></tbody></table></details><p><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ;<em>keywords</em> : Object ) : Object<br /><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ;<em>keywords</em> : Object ) : Object<br /><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ;<em>keywords</em> : Object ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>msgIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection de chaînes : IDs uniques des messages (texte)<br />Texte : ID unique d'un message<br />Numérique (IMAP all) : Tous les messages de la boîtesélectionnée</td></tr><tr><td>keywords</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Mots-clés de flags à supprimer</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération removeFlags</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-24"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-24"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.removeFlags()</code> supprime des flags(drapeaux) des <code>msgIDs</code> pour les <code>keywords</code>définis.</p><p>Dans le paramètre <code>msgIDs</code>, vous pouvez passer soit:</p><ul><li><p>une <em>collection</em> contenant les IDs uniques de messagesspécifiques, ou</p></li><li><p>l'ID unique (<em>texte</em>) d'un seul message ou</p></li><li><p>la constante suivante (<em>entier long</em>) pour tous lesmessages de la boîte sélectionnée :</p><table><thead><tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr></thead><tbody><tr><td>IMAP all</td><td>1</td><td>Sélectionner tous les messages de la boîte sélectionnée</td></tr></tbody></table></li></ul><p>Le paramètre <code>keywords</code> vous permet de passer unobjet avec des valeurs de mots-clés pour les flags spécifiques àsupprimer des <code>msgIDs</code>. Vous pouvez utiliser lesmots-clés suivants :</p><table><thead><tr><th>Paramètres</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>$draft</td><td>Booléen</td><td>True pour supprimer le marqueur "draft" du message</td></tr><tr><td>$seen</td><td>Booléen</td><td>True pour supprimer le marqueur "seen" du message</td></tr><tr><td>$flagged</td><td>Booléen</td><td>True pour supprimer le marqueur "flagged" du message</td></tr><tr><td>$answered</td><td>Booléen</td><td>True pour supprimer le marqueur "answered" du message</td></tr><tr><td>$deleted</td><td>Booléen</td><td>True pour supprimer le marqueur "deleted" du message</td></tr></tbody></table><p>Les valeurs à faux sont ignorées.</p><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernièreerreur retournée dans la pile d'erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAPest reçue)</td></tr><tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description de l'erreur 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l'erreur</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-12"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-12"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span><span class="hljs-comment">// Créer le transporteur</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-comment">// Sélectionner la boite de réception</span><span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-comment">// Marquer tous les messages de la boite de réception comme étant non vus</span><span class="hljs-variable">$flags</span>:=New object<span class="hljs-variable">$flags</span>[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">removeFlags</span>(IMAP all;<span class="hljs-variable">$flags</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_renamebox"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_renamebox"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.renameBox()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19</td><td>Ajout</td></tr></tbody></table></details><p><strong>.renameBox</strong>( <em>currentName</em> : Text ;<em>newName</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>currentName</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Nom actuel de la boîte de réception</td></tr><tr><td>newName</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Nouveau nom de la boîte de réception</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération renaming</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-25"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-25"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.renameBox()</code> renomme une mailbox sur leserveur IMAP. Essayer de renommer une mailbox qui n'existe pas oude renommer une mailbox avec un nom qui est déjà utilisé génère uneerreur.</p><p>Dans le paramètre <code>currentName</code>, passez le nom de lamailbox à renommer.</p><p>Passez le nouveau nom de la mailbox dans e paramètre<code>newName</code>.</p><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernièreerreur retournée dans la pile d'erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAPest reçue)</td></tr><tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description de l'erreur 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l'erreur</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-13"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-13"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><p>Pour renommer la mailbox “Invoices” en “Bills”:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw </span>: text<span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-comment">// renommer la boite de réception</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">renameBox</span>(<span class="hljs-string">"Invoices"</span>; <span class="hljs-string">"Bills"</span>)<span class="hljs-keyword">If</span> (<span class="hljs-variable">$status</span>.success)<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox renaming successful!"</span>)<span class="hljs-keyword">   Else</span><span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End if</span><span class="hljs-keyword">End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_port"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_port"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.port</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R4</td><td>Ajout</td></tr></tbody></table></details><p><strong>.port</strong> : Integer</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-26"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-26"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.port</code> contient le numéro de portutilisé pour les transactions d'emails. Par défaut, si la propriété<em>port</em> n'a pas été définie dans l'objet <em>server</em>(utilisé pour créer l'objet transporteur avec <code>SMTP Newtransporter</code>, <code>POP3 New transporter</code>, <code>IMAPNew transporter</code>), le port utilisé est :</p><ul><li><strong>SMTP</strong> - 587</li><li><strong>POP3</strong> - 995</li><li><strong>IMAP</strong> - 993</li></ul><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_searchmails"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_searchmails"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.searchMails()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R5</td><td>Ajout</td></tr></tbody></table></details><p><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ): Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>searchCriteria</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Critère(s) de recherche</td></tr><tr><td>Résultat</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Collection de numéros de messages</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-27"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-27"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><blockquote><p>Cette fonction est basée sur la spécification du <a href="https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol">protocoleIMAP</a>.</p></blockquote><p>La fonction <code>.searchMails()</code> recherche les messagesqui correspondent aux critères de recherche <em>searchCriteria</em>dans la boîte de réception courante. Le paramètre<em>searchCriteria</em> contient un ou plusieurs mots-clés derecherche.</p><p><em>searchCriteria</em> est un paramètre texte listant un ouplusieurs critères de recherche (voir <a href="#IMAPTransporterClass.html_mots-cles-de-recherche-autorises">Mots-clésde recherche autorisés</a> ci-dessous) associés ou non à desvaleurs à rechercher. Un critère de recherche peut être composéd'un ou plusieurs éléments. Par exemple :</p><pre><code class="hljs"><span class="hljs-attr">SearchKey1</span> = FLAGGED<span class="hljs-attr">SearchKey2</span> = NOT FLAGGED<span class="hljs-attr">SearchKey3</span> = FLAGGED DRAFT</code></pre><blockquote><p>La correspondance n'est généralement pas sensible à la casse</p></blockquote><ul><li>Si <em>searchCriteria</em> est une chaîne vide, la recherchesera équivalente à un "tout sélectionner".</li><li>Si <em>searchCriteria</em> contient plusieurs mots-clés derecherche, le résultat est l'intersection (fonction ET) de tous lesmessages qui correspondent à ces critères.</li></ul><pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = FLAGGED FROM <span class="hljs-string">"SMITH"</span></code></pre><p>... retourne tous les messages comportant le marqueur \FlaggedET envoyés par Smith.</p><ul><li>Vous pouvez utiliser les opérateurs <strong>OR</strong> ou<strong>NOT</strong> comme suit :</li></ul><pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = OR SEEN FLAGGED</code></pre><p>... retourne tous les messages comportant le marqueur \Seen OU\Flagged</p><pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = NOT SEEN</code></pre><p>... retourne tous les messages ne comportant pas le marqueur\Seen.</p><pre><code class="hljs">searchCriteria = <span class="hljs-keyword">HEADER</span> CONTENT<span class="hljs-params">-TYPE</span> <span class="hljs-string">"MIXED"</span> <span class="hljs-literal">NOT</span> <span class="hljs-keyword">HEADER</span> CONTENT<span class="hljs-params">-TYPE</span> <span class="hljs-string">"TEXT"</span><span class="hljs-params">...</span></code></pre><p>... retourne les messages dont l'en-tête content-type contient“Mixed” et ne contient pas “Text”.</p><pre><code class="hljs">searchCriteria = <span class="hljs-keyword">HEADER</span> CONTENT-<span class="hljs-keyword">TYPE</span> "E" <span class="hljs-keyword">NOT</span> SUBJECT "o" <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">HEADER</span> CONTENT-<span class="hljs-keyword">TYPE</span> "MIXED"</code></pre><p>... retourne les messages dont l'en-tête content-type contient “e ” et dont l'en-tête Subject ne contient pas “ o ” et dontl'en-tête content-type n'est pas “ Mixed ”.</p><p>A noter que dans les deux derniers exemples, le résultat de larecherche est différent lorsque vous enlevez les parenthèses de lapremière liste de mots-clés.</p><ul><li>Le paramètre <em>searchCriteria</em> peut inclureoptionnellement l'instruction [CHARSET]. Cette instruction estcomposée du mot "CHARSET" suivi d'un jeu de caractères défini[CHARSET] (US ASCII, ISO-8859). Elle indique le codage decaractères utilisé dans la chaine <em>searchCriteria</em>. Parconséquent, vous devez convertir la chaîne <em>searchCriteria</em>dans le jeu de caractères spécifié si vous utilisez l'instruction[CHARSET] (voir les commandes <code>CONVERT FROM TEXT</code> ou<code>Convert to text</code>). Par défaut, 4D encode la chaîne decritères searchCriteria en "Quotable Printable" si elle contientdes caractères étendus.</li></ul><pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = CHARSET <span class="hljs-string">"ISO-8859"</span> BODY <span class="hljs-string">"Help"</span></code></pre><p>signifie que le critère de recherche utilise le jeu decaractères iso-8859 et que le serveur devra convertir la chaîneavant la recherche, si nécessaire.</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_mots-cl%C3%A9s-de-recherche-autoris%C3%A9s"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_mots-cl%25C3%25A9s-de-recherche-autoris%25C3%25A9s"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Mots-clés de recherche autorisés</h4><p>Les mots-clés de recherche peuvent traiter des valeurs des typessuivants :</p><ul><li><p><strong>Valeurs de type date</strong> : Les valeurs de type datesont placées dans des chaînes formatées de la manière suivante :<em>date-day+"-"+date-month+"-"+date-year</em> où date-day indiquela date du jour dans le mois (2 caractères maxi), date-monthindique le mois (Jan/Feb/Mar/Apr/May/Jun/Jul/Aug/Sep/Oct/Dec) etdate-year indique l’année sur 4 chiffres. Exemple :<code>searchCriteria = SENTBEFORE 1-Feb-2020</code>(il n’estgénéralement pas nécessaire de mettre une date entre guillemetspuisqu’elle ne contient pas de caractères spéciaux)</p></li><li><p>**Valeurs de type chaîne ** : Les valeurs de type chaîne peuventcontenir tout type de caractère et doivent être placées entre desguillemets. Toutefois, si la chaîne ne contient pas de caractèresspéciaux (des espaces par exemple), les guillemets ne sont pasobligatoires. Dans tous les cas, les guillemets vous permettent devous assurer que la chaîne sera correctement interprétée. Exemple :<code>searchCriteria = FROM "SMITH"</code> Les recherches baséessur des chaînes de caractères sont du type “contient” : si le champd’un message contient au moins la chaîne recherchée, le message esttrouvé. La recherche ne tient pas compte de la casse descaractères.</p></li><li><p><strong>Noms de champs</strong> : Les valeurs de type nom dechamp contiennent le nom d’un champ d’en-tête. Exemple :<code>searchCriteria = HEADER CONTENT-TYPE "MIXED"</code></p></li><li><p><strong>Marqueurs</strong> : Les valeurs de type marqueur(flags) acceptent un ou plusieurs mots-clés (y compris desmarqueurs standard) séparés par des espaces. Exemple :<code>searchCriteria = KEYWORD \Flagged \Draft</code></p></li><li><p><strong>Ensemble de messages</strong> : Les valeurs de ce typedésignent un ensemble de messages. Elles contiennent une liste denuméros de messages dans un ordre croissant, de 1 au nombre totalde messages dans la boîte aux lettres. Les numéros sont séparés pardes virgules ; un deux-points (:) indique un intervalle (inclusif)de numéros. Exemples : <code>2,4:7,9,12:*</code> représente lesmessages <code>2,4,5,6,7,9,12,13,14,15</code> pour une mailboxcontenant 15 messages. <code>searchCriteria = 1:5 ANSWERED</code>recherche, parmi les messages 1 à 5, ceux qui comportent lemarqueur \Answered. <code>searchCriteria= 2,4 ANSWERED</code>recherche, parmi les messages 2 et 4, ceux qui comportent lemarqueur \Answered.</p></li></ul><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_mots-cl%C3%A9s-de-recherche-autoris%C3%A9s-1"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_mots-cl%25C3%25A9s-de-recherche-autoris%25C3%25A9s-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Mots-clés de recherche autorisés</h4><p><strong>ALL</strong>: Tous les messages de la boîte deréception.<br /><strong>ANSWERED</strong>: Messages comportant le marqueur\Answered.<br /><strong>UNANSWERED</strong>: Messages ne comportant pas le marqueur\Answered.<br /><strong>DELETED</strong>: Messages comportant le marqueur\Deleted.<br /><strong>UNDELETED</strong>: Messages ne comportant pas le marqueur\Deleted.<br /><strong>DRAFT</strong>: Messages comportant le marqueur\Draft.<br /><strong>UNDRAFT</strong>: Messages ne comportant pas le marqueur\Draft.<br /><strong>FLAGGED</strong>: Messages comportant le marqueur\Flagged.<br /><strong>UNFLAGGED</strong>: Messages ne comportant pas le marqueur\Flagged.<br /><strong>RECENT</strong>: Messages comportant le marqueur\Recent.<br /><strong>OLD</strong>: Messages ne comportant pas le marqueur\Recent.<br /><strong>SEEN</strong>: Messages comportant le marqueur \Seen.<br /><strong>UNSEEN</strong>: Messages ne comportant pas le marqueur\Seen.<br /><strong>NEW</strong>: Messages comportant le marqueur \Recent etpas le marqueur \Seen. Equivaut à “(RECENT UNSEEN)”.<br />***KEYWORD ***flag******: Messages comportant le marqueurspécifié.<br />***UNKEYWORD ***flag******: Messages ne comportant pas le marqueurspécifié.<br />***BEFORE ***date******: Messages dont la date interne estantérieure à la date spécifiée.<br />***ON ***date******: Messages dont la date interne est égale à ladate spécifiée.<br />***SINCE ***date******: Messages dont la date interne est égale oupostérieure à la date spécifiée.<br />***SENTBEFORE ***date******: Messages dont l’en-tête Date estantérieur à la date spécifiée.<br />***SENTON ***date******: Messages dont l’en-tête Date est égal à ladate spécifiée.<br />***SENTSINCE ***date******: Messages dont l’en-tête Date est égalou postérieur à la date spécifiée.<br />***TO ***string******: Messages contenant la chaîne spécifiée dansl’en-tête Destinataire.<br />***FROM ***string******: Messages contenant la chaîne spécifiéedans l’en-tête Emetteur.<br />***CC ***string******: Messages contenant la chaîne spécifiée dansl’en-tête CC.<br />***BCC ***string******: Messages contenant la chaîne spécifiée dansl’en-tête BCC.<br />***SUBJECT ***string******: Messages contenant la chaîne spécifiéedans l’en-tête Objet.<br />***BODY ***string******: Messages dont le corps contient la chaînespécifiée.<br />***TEXT ***string******: Messages contenant la chaîne spécifiéedans l’en-tête ou le corps.<br />***HEADER <em>field-name</em> ***string******: Messages dontl’en-tête contient le champ défini et dont ce champ contient lachaîne définie.<br />***UID ***message-UID******: Messages dont le numéro uniquecorrespond à la valeur spécifiée.<br />***LARGER ***n******: Messages dont la taille en octets estsupérieure à la taille spécifiée.<br />***SMALLER ***n******: Messages dont la taille en octets estinférieure à la taille spécifiée.<br />***NOT ***search-key******: Messages ne correspondant pas aucritère spécifié.<br />***OR <em>search-key1</em> ***search-key2******: Messagescorrespondant au premier ou au deuxième critère spécifié.</p><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_selectbox"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_selectbox"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.selectBox()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R4</td><td>Ajout</td></tr></tbody></table></details><p><strong>.selectBox</strong>( <em>name</em> : Text { ;<em>state</em> : Integer } ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Nom de la boîte de réception</td></tr><tr><td>state</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Statut de l'accès à la boite de réception</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Objet boxInfo</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-28"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-28"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.selectBox()</code> sélectionne la mailbox<em>name</em> comme étant la mailbox courante. Cette fonction vouspermet de récupérer des informations sur la boite de réception.</p><blockquote><p>Pour lire les informations à partir d'une mailbox sans changerla mailbox courante, utilisez <a href="#IMAPTransporterClass.html_getboxinfo"><code>.getBoxInfo()</code></a>.</p></blockquote><p>Dans le paramètre <em>name</em> passez le nom de la mailbox àlaquelle vous souhaitez accéder. Le nom doit représenter unehiérarchie claire, de gauche à droite, avec des niveaux séparés parun caractère délimiteur spécifique. Le délimiteur peut êtrerécupéré à l'aide de la fonction <a href="#IMAPTransporterClass.html_getdelimiter"><code>.getDelimiter()</code></a>.</p><p>Le paramètre optionnel <em>state</em> définit le type d'accès àla mailbox. Les valeurs possibles sont les suivantes :</p><table><thead><tr><th>Constante</th><th>Valeur</th><th>Commentaire</th></tr></thead><tbody><tr><td>IMAP read only state</td><td>1</td><td>La mailbox sélectionnée est accessible avec les privilèges delecture seule. Les messages contenant un marqueur "recent"(indication de nouveaux messages) restent inchangés.</td></tr><tr><td>IMAP read write state</td><td>0</td><td>La mailbox sélectionnée est accessible avec des privilèges delecture et d'écriture. Les messages sont considérés "seen" etperdent le marqueur "recent" (indication des nouveaux messages).(Valeur par défaut)</td></tr></tbody></table><blockquote><ul><li>La fonction génère une erreur et retourne <strong>Null</strong>si <em>name</em> désigne une mailbox inexistante.</li><li>Si aucune connexion n'est ouverte, <code>.selectBox()</code>ouvrira une connexion.</li><li>Si la connexion n'a pas été utilisée depuis le délai deconnexion (voir <code>IMAP New transporter</code>), la fonction<a href="#IMAPTransporterClass.html_checkconnection"><code>.checkConnection()</code></a> est automatiquement appelée.</li></ul></blockquote><p><strong>Objet retourné</strong></p><p>L'objet <code>boxInfo</code> contient les propriété suivantes:</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td>Nom de la boîte de réception</td></tr><tr><td>mailCount</td><td>number</td><td>Nombre de messages contenus dans la boîte de réception</td></tr><tr><td>mailRecent</td><td>number</td><td>Nombre de messages avec le marqueur "recent"</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-14"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-14"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>; <span class="hljs-variable">$boxinfo </span>: Object <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>) <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_subscribe"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_subscribe"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.subscribe()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19</td><td>Ajout</td></tr></tbody></table></details><p><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Nom de la boîte de réception</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération subscribe</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-29"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-29"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.subscribe()</code> permet d'ajouter lamailbox spécifiée à l'ensemble des mailboxes auxquelles vous avez"souscrit" sur le serveur IMAP. Ainsi, vous pouvez contrôler lataille de la liste des boîtes de réception disponibles ensouscrivant uniquement à celles que vous souhaitez généralementconsulter.</p><p>Dans le paramètre <code>name</code>, passez le nom de la mailboxà ajouter (subscribe) à la liste de mailboxes auxquelles vous avez"souscrit".</p><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernièreerreur retournée dans la pile d'erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAPest reçue)</td></tr><tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description de l'erreur 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l'erreur</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-15"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-15"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><p>Pour souscrire à la mailbox "Atlas Corp” dans la hiérarchie"Bills" :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Atlas Corp"</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">subscribe</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">If</span> (<span class="hljs-variable">$status</span>.success)<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox subscription successful!"</span>)<span class="hljs-keyword">   Else</span><span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">   End if</span><span class="hljs-keyword">End if</span><span class="hljs-keyword">   Else</span><span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">   End if</span><span class="hljs-keyword">End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_unsubscribe"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_unsubscribe"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.unsubscribe()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19</td><td>Ajout</td></tr></tbody></table></details><p><strong>.unsubscribe</strong>( <em>name</em> : Text ) :Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Nom de la boîte de réception</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de l'opération unsubscribe</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-30"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-30"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.unsubscribe()</code> supprime la mailboxspécifiée de l'ensemble des mailboxes auxquelles vous avez"souscrit" sur le serveur IMAP. Elle vous permet de réduire lenombre de mailboxes que vous consultez régulièrement.</p><p>Dans le paramètre <code>name</code>, passez le nom de la mailboxà supprimer (unsubscribe) de la liste de mailboxes auxquelles vousavez "souscrit".</p><p><strong>Objet retourné</strong></p><p>La fonction retourne un objet décrivant le statut IMAP :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booléen</td><td>Vrai si l'opération est réussie, sinon Faux</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>Message du statut retourné par le serveur IMAP, ou dernièreerreur retournée dans la pile d'erreurs 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur IMAPest reçue)</td></tr><tr><td></td><td>[].errcode</td><td>Nombre</td><td>Code d'erreur 4D</td></tr><tr><td></td><td>[].message</td><td>Text</td><td>Description de l'erreur 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Text</td><td>Signature du composant interne qui a retourné l'erreur</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_exemple-16"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_exemple-16"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><p>Pour ne plus souscrire à la mailbox "Atlas Corp” dans lahiérarchie "Bills" :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Atlas Corp"</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">unsubscribe</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">If</span> (<span class="hljs-variable">$status</span>.success)<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox unsubscription successful!"</span>)<span class="hljs-keyword">   Else</span><span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">   End if</span><span class="hljs-keyword">End if</span><span class="hljs-keyword">   Else</span><span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">   End if</span><span class="hljs-keyword">End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_user"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_user"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.user</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R4</td><td>Ajout</td></tr></tbody></table></details><p><strong>.user</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_description-31"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_description-31"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.user</code> contient le nom d'utilisateuremployé pour l'authentification sur le serveur mail.</p><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#FunctionClass.html"><span class="arrow-prev">←</span><span>Formula</span></a><a class="docs-next button" href="#MailAttachmentClass.html"><span class="function-name-prevnext">MailAttachment</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#IMAPTransporterClass.html_imap-new-transporter">IMAPNew transporter</a></li><li><a href="#IMAPTransporterClass.html_4dimaptransporternew">4D.IMAPTransporter.new()</a></li><li><a href="#IMAPTransporterClass.html_acceptunsecureconnection">.acceptUnsecureConnection</a></li><li><a href="#IMAPTransporterClass.html_addflags">.addFlags()</a></li><li><a href="#IMAPTransporterClass.html_append">.append()</a></li><li><a href="#IMAPTransporterClass.html_authenticationmode">.authenticationMode</a></li><li><a href="#IMAPTransporterClass.html_checkconnection">.checkConnection()</a></li><li><a href="#IMAPTransporterClass.html_checkconnectiondelay">.checkConnectionDelay</a></li><li><a href="#IMAPTransporterClass.html_connectiontimeout">.connectionTimeOut</a></li><li><a href="#IMAPTransporterClass.html_copy">.copy()</a></li><li><a href="#IMAPTransporterClass.html_createbox">.createBox()</a></li><li><a href="#IMAPTransporterClass.html_delete">.delete()</a></li><li><a href="#IMAPTransporterClass.html_deletebox">.deleteBox()</a></li><li><a href="#IMAPTransporterClass.html_expunge">.expunge()</a></li><li><a href="#IMAPTransporterClass.html_getboxinfo">.getBoxInfo()</a></li><li><a href="#IMAPTransporterClass.html_getboxlist">.getBoxList()</a></li><li><a href="#IMAPTransporterClass.html_getdelimiter">.getDelimiter()</a></li><li><a href="#IMAPTransporterClass.html_getmails">.getMails()</a></li><li><a href="#IMAPTransporterClass.html_getmimeasblob">.getMIMEAsBlob()</a></li><li><a href="#IMAPTransporterClass.html_host">.host</a></li><li><a href="#IMAPTransporterClass.html_logfile">.logFile</a></li><li><a href="#IMAPTransporterClass.html_move">.move()</a></li><li><a href="#IMAPTransporterClass.html_numtoid">.numToID()</a></li><li><a href="#IMAPTransporterClass.html_removeflags">.removeFlags()</a></li><li><a href="#IMAPTransporterClass.html_renamebox">.renameBox()</a></li><li><a href="#IMAPTransporterClass.html_port">.port</a></li><li><a href="#IMAPTransporterClass.html_searchmails">.searchMails()</a></li><li><a href="#IMAPTransporterClass.html_selectbox">.selectBox()</a></li><li><a href="#IMAPTransporterClass.html_subscribe">.subscribe()</a></li><li><a href="#IMAPTransporterClass.html_unsubscribe">.unsubscribe()</a></li><li><a href="#IMAPTransporterClass.html_user">.user</a></li></ul></nav></div></div></body></html>