<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="en"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Repair Page · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="This page is used to repair the data file when it has been damaged. Generally, you will only use these functions under the supervision of 4D technical teams, when anomalies have been detected while opening the application or following a [verification](/docs/Rx/en/MSC/verify.html)."name="description" /><meta content="en" name="docsearch:language" /><meta content="Repair Page · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="This page is used to repair the data file when it has been damaged. Generally, you will only use these functions under the supervision of 4D technical teams, when anomalies have been detected while opening the application or following a [verification](/docs/Rx/en/MSC/verify.html)."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#repair.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">RepairPage<a aria-hidden="true" class="anchor" id="repair.html"></a></h1></header><article><div><p><span>This page is used to repair the data file when it has beendamaged. Generally, you will only use these functions under thesupervision of 4D technical teams, when anomalies have beendetected while opening the application or following a <a href="#verify.html">verification</a>.</span></p><p><span><strong>Warning:</strong> Each repair operation involvesthe duplication of the original file, which increases the size ofthe application folder. It is important to take this into account(especially in macOS where 4D applications appear as packages) sothat the size of the application does not increase excessively.Manually removing the copies of the original file inside thepackage can be useful to minimize the package size.</span></p><blockquote><p><span>Repairing is only available in maintenance mode. If youattempt to carry out this operation in standard mode, a warningdialog will inform you that the application will be closed andrestarted in maintenance mode.</span></p></blockquote><blockquote><p><span>When the database is encrypted, repairing data includesdecryption and encryption steps and thus, requires the current dataencryption key. If no valid encryption key has already beenprovided, a dialog requesting the passphrase or the encryption keyis displayed (see Encrypt page).</span></p></blockquote><h2><span><a aria-hidden="true" class="anchor" id="repair.html_file-overview"></a><a aria-hidden="true" class="hash-link" href="#repair.html_file-overview"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>File overview</span></h2><h3><span><a aria-hidden="true" class="anchor" id="repair.html_data-file-to-be-repaired"></a><a aria-hidden="true"class="hash-link" href="#repair.html_data-file-to-be-repaired"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Data file to be repaired</span></h3><p><span>Pathname of the current data file. The<strong>[...]</strong> button can be used to specify another datafile. When you click on this button, a standard Open documentdialog is displayed so that you can designate the data file to berepaired. If you perform a <a href="#repair.html_standard-repair">standard repair</a>, you must selecta data file that is compatible with the open project file. If youperform a <a href="#repair.html_recover-by-record-headers">recoverby record headers</a> repair, you can select any data file. Oncethis dialog has been validated, the pathname of the file to berepaired is indicated in the window.</span></p><h3><span><a aria-hidden="true" class="anchor" id="repair.html_original-files-backup-folder"></a><a aria-hidden="true" class="hash-link" href="#repair.html_original-files-backup-folder"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Original files backup folder</span></h3><p><span>By default, the original data file will be duplicatedbefore the repair operation. It will be placed in a subfolder named“Replaced files (repairing)” in the application folder. The second<strong>[...]</strong> button can be used to specify anotherlocation for the original files to be saved before repairingbegins. This option can be used more particularly when repairingvoluminous files while using different disks.</span></p><h3><span><a aria-hidden="true" class="anchor" id="repair.html_repaired-files"></a><a aria-hidden="true" class="hash-link" href="#repair.html_repaired-files"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Repaired files</span></h3><p><span>4D creates a new blank data file at the location of theoriginal file. The original file is moved into the folder named"\Replaced Files (Repairing) date time" whose location is set inthe "Original files backup folder" area (application folder bydefault). The blank file is filled with the recovereddata.</span></p><h2><span><a aria-hidden="true" class="anchor" id="repair.html_standard-repair"></a><a aria-hidden="true" class="hash-link" href="#repair.html_standard-repair"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Standard repair</span></h2><p><span>Standard repair should be chosen when only a few recordsor indexes are damaged (address tables are intact). The data iscompacted and repaired. This type of repair can only be performedwhen the data and structure file match.</span></p><p><span>When the repair procedure is finished, the "Repair" pageof the MSC is displayed. A message indicates if the repair wassuccessful. If so, you can open the application immediately.<img alt="" src="https://developer.4d.com/docs/Rx/assets/en/MSC/MSC_RepairOK.png" /></span></p><h2><span><a aria-hidden="true" class="anchor" id="repair.html_recover-by-record-headers"></a><a aria-hidden="true"class="hash-link" href="#repair.html_recover-by-record-headers"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Recover by record headers</span></h2><p><span>Use this low-level repair option only when the data fileis severely damaged and after all other solutions (restoring from abackup, standard repair) have proven to be ineffective.</span></p><p><span>4D records vary in size, so it is necessary to keep thelocation where they are stored on disk in a specific table, namedaddress table, in order to find them again. The program thereforeaccesses the address of the record via an index and the addresstable. If only records or indexes are damaged, the standard repairoption is usually sufficient to resolve the problem. However, whenthe address table itself is affected, it requires a moresophisticated recovery since it will be necessary to reconstituteit. To do this, the MSC uses the marker located in the header ofeach record. The markers are compared to a summary of the record,including the bulk of their information, and from which it ispossible to reconstruct the address table.</span></p><blockquote><p><span>If you have deselected the <strong>Records definitivelydeleted</strong> option in the properties of a table in thestructure, performing a recovery by header markers may causerecords that were previously deleted to reappear.</span></p><p><span>Recovery by headers does not take integrity constraintsinto account. More specifically, after this operation you may getduplicated values with unique fields or NULL values with fieldsdeclared <strong>Never Null</strong>.</span></p></blockquote><p><span>When you click on <strong>Scan and repair...</strong>, 4Dperforms a complete scan of the data file. When the scan iscomplete, the results appear in the following window:</span></p><p><span><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/MSC/mscrepair2.png" /></span></p><blockquote><p><span>If all the records and all the tables have been assigned,only the main area is displayed.</span></p></blockquote><p><span>The "Records found in the data file" area includes twotables summarizing the information from the scan of the datafile.</span></p><ul><li><p><span>The first table lists the information from the data filescan. Each row shows a group of recoverable records in the datafile:</span></p><ul><li><span>The <strong>Order</strong> column indicates the recoveryorder for the group of records.</span></li><li><span>The <strong>Count</strong> column indicates the number ofthe records in the table.</span></li><li><span>The <strong>Destination table</strong> column indicatesthe names of tables that were automatically assigned to the groupsof identified records. The names of tables assigned automaticallyappear in green. Groups that were not assigned, i.e. tables thatcould not be associated with any records appear in red.</span></li><li><span>The <strong>Recover</strong> column lets you indicate,for each group, whether you want to recover the records. Bydefault, this option is checked for every group with records thatcan be associated with a table.</span></li></ul></li><li><p><span>The second table lists the tables of the projectfile.</span></p></li></ul><h3><span><a aria-hidden="true" class="anchor" id="repair.html_manual-assigning"></a><a aria-hidden="true" class="hash-link" href="#repair.html_manual-assigning"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Manual assigning</span></h3><p><span>If several groups of records could not be assigned totables due to a damaged address table, you can assign themmanually. To do this, first select an unassigned group of recordsin the first table. The "Content of the records" area then displaysa preview of the contents of the first records of the group to makeit easier to assign them:</span></p><p><span><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/MSC/mscrepair3.png" /></span></p><p><span>Next select the table you want to assign to the group inthe "Unassigned tables" table and click on the <strong>Identifytable</strong> button. You can also assign a table using drag anddrop. The group of records is then associated with the table and itwill be recovered in this table. The names of tables that areassigned manually appear in black. Use the <strong>Ignorerecords</strong> button to remove the association made manuallybetween the table and the group of records.</span></p><h2><span><a aria-hidden="true" class="anchor" id="repair.html_open-log-file"></a><a aria-hidden="true" class="hash-link" href="#repair.html_open-log-file"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Open log file</span></h2><p><span>After repair is completed, 4D generates a log file in theLogs folder of the project. This file allows you to view all theoperations carried out. It is created in XML format and named:<em>ApplicationName</em><em>_Repair_Log_yyyy-mm-ddhh-mm-ss.xml</em>" where:</span></p><ul><li><span><em>ApplicationName</em> is the name of the project filewithout any extension, for example "Invoices",</span></li><li><span><em>yyyy-mm-dd hh-mm-ss</em> is the timestamp of thefile, based upon the local system time when the maintenanceoperation was started, for example "2019-02-1115-20-45".</span></li></ul><p><span>When you click on the <strong>Open log file</strong>button, 4D displays the most recent log file in the default browserof the machine.</span></p></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#restore.html"><span class="arrow-prev">←</span> <span>RestorePage</span></a><a class="docs-next button" href="#encrypt.html"><span>Encrypt Page</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#repair.html_file-overview">File overview</a><ul class="toc-headings"><li><a href="#repair.html_data-file-to-be-repaired">Data file to berepaired</a></li><li><a href="#repair.html_original-files-backup-folder">Originalfiles backup folder</a></li><li><a href="#repair.html_repaired-files">Repaired files</a></li></ul></li><li><a href="#repair.html_standard-repair">Standard repair</a></li><li><a href="#repair.html_recover-by-record-headers">Recover byrecord headers</a><ul class="toc-headings"><li><a href="#repair.html_manual-assigning">Manualassigning</a></li></ul></li><li><a href="#repair.html_open-log-file">Open log file</a></li></ul></nav></div></div></body></html>