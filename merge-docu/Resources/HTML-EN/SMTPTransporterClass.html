<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="en"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>SMTPTransporter · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="The `SMTPTransporter` class allows you to configure SMTP connections and send emails through *SMTP transporter* objects."name="description" /><meta content="en" name="docsearch:language" /><meta content="SMTPTransporter · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="The `SMTPTransporter` class allows you to configure SMTP connections and send emails through *SMTP transporter* objects."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#SMTPTransporterClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">SMTPTransporter<a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html"></a></h1></header><article><div><p><span>The <code>SMTPTransporter</code> class allows you toconfigure SMTP connections and send emails through <em>SMTPtransporter</em> objects.</span></p><h3><span><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_smtp-transporter-object"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_smtp-transporter-object"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>SMTP Transporter object</span></h3><p><span>SMTP Transporter objects are instantiated with the<a href="#SMTPTransporterClass.html_smtp-new-transporter">SMTP Newtransporter</a> command. They provide the following properties andfunctions:</span></p><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#SMTPTransporterClass.html_acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong>: Boolean</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>True</strong> if 4D is allowedto establish an unencrypted connection</p></td></tr><tr><td><a href="#SMTPTransporterClass.html_authenticationmode"><strong>.authenticationMode</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the authentication mode used to open thesession on the mail server</p></td></tr><tr><td><a href="#SMTPTransporterClass.html_bodycharset"><strong>.bodyCharset</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; the charset and encoding used for thebody part of the email</p></td></tr><tr><td><a href="#SMTPTransporterClass.html_checkconnection"><strong>.checkConnection()</strong>: Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp; checks the connection using informationstored in the transporter object</p></td></tr><tr><td><a href="#SMTPTransporterClass.html_connectiontimeout"><strong>.connectionTimeOut</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the maximum wait time (in seconds)allowed to establish a connection to the server</p></td></tr><tr><td><a href="#SMTPTransporterClass.html_headercharset"><strong>.headerCharset</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; the charset and encoding used for theemail header</p></td></tr><tr><td><a href="#SMTPTransporterClass.html_host"><strong>.host</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the name or the IP address of the hostserver</p></td></tr><tr><td><a href="#SMTPTransporterClass.html_keepalive"><strong>.keepAlive</strong>: Boolean</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>True</strong> if the SMTPconnection must be kept alive until the <code>transporter</code>object is destroyed</p></td></tr><tr><td><a href="#SMTPTransporterClass.html_logfile"><strong>.logFile</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the path of the extended log filedefined (if any) for the mail connection</p></td></tr><tr><td><a href="#SMTPTransporterClass.html_port"><strong>.port</strong> :Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp; the port number used for mailtransactions</p></td></tr><tr><td><a href="#SMTPTransporterClass.html_send"><strong>.send</strong>(<em>mail</em> : Object ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;sends the <a href="#SMTPTransporterClass.html_email-object"><em>mail</em> object</a>to the SMTP server defined in the <code>transporter</code> objectand returns a status object</p></td></tr><tr><td><a href="#SMTPTransporterClass.html_sendtimeout"><strong>.sendTimeOut</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp; the maximum wait time (in seconds) of acall to <code>.send( )</code> before a timeout occurs</p></td></tr><tr><td><a href="#SMTPTransporterClass.html_user"><strong>.user</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; the user name used for authenticationon the mail server</p></td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_smtp-new-transporter"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_smtp-new-transporter"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>SMTP New transporter</span></h2><details><summary><span>History</span></summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18</td><td>New logFile property</td></tr><tr><td>v17 R5</td><td>New bodyCharset and headerCharset properties</td></tr><tr><td>v17 R4</td><td>Added</td></tr></tbody></table></details><p><span><strong>SMTP New transporter</strong>( <em>server</em> :Object ) : 4D.SMTPTransporter</span></p><table><thead><tr><th>Parameter</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>server</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Mail server information</td></tr><tr><td>Result</td><td>4D.SMTPTransporter</td><td style="text-align:center">&lt;-</td><td><a href="#SMTPTransporterClass.html_smtp-transporter-object">SMTPtransporter object</a></td></tr></tbody></table><h4><span><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_description"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_description"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span>The <code>SMTP New transporter</code> command configures anew SMTP connection according to the <em>server</em> parameter andreturns a new <em><a href="#SMTPTransporterClass.html_smtp-transporter-object">SMTPtransporter</a></em> object. The returned transporter object willthen usually be used to send emails.</span></p><blockquote><p><span>This command does not open any connection to the SMTPserver. The SMTP connection is actually opened when the <a href="#SMTPTransporterClass.html_send"><code>.send()</code></a> functionis executed.</span></p><p><span>The SMTP connection is automatically closed:</span></p><ul><li><span>when the transporter object is destroyed if the <a href="#SMTPTransporterClass.html_keepalive"><code>keepAlive</code></a>property is true (default),</span></li><li><span>after each <a href="#SMTPTransporterClass.html_send"><code>.send( )</code></a>function execution if the <a href="#SMTPTransporterClass.html_keepalive"><code>keepAlive</code></a>property is set to false.</span></li></ul></blockquote><p><span>In the <em>server</em> parameter, pass an objectcontaining the following properties:</span></p><table><thead><tr><th><em>server</em></th><th>Default value (if omitted)</th></tr></thead><tbody><tr><td><a href="#SMTPTransporterClass.html_acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong>: Boolean</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>True</strong> if 4D is allowedto establish an unencrypted connection</p></td><td>False</td></tr><tr><td>.<strong>accessTokenOAuth2</strong>: Text<br />.<strong>accessTokenOAuth2</strong>: Object<p>Text string or token object representing OAuth2 authorizationcredentials. Used only with OAUTH2 <code>authenticationMode</code>.If <code>accessTokenOAuth2</code> is used but<code>authenticationMode</code> is omitted, the OAuth 2 protocol isused (if allowed by the server). Not returned in <em><a href="#SMTPTransporterClass.html_smtp-transporter-object">SMTPtransporter</a></em> object.</p></td><td>none</td></tr><tr><td><a href="#SMTPTransporterClass.html_authenticationmode"><strong>.authenticationMode</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the authentication mode used to open thesession on the mail server</p></td><td>the most secure authentication mode supported by the server isused</td></tr><tr><td><a href="#SMTPTransporterClass.html_bodycharset"><strong>.bodyCharset</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; the charset and encoding used for thebody part of the email</p></td><td><code>mail mode UTF8</code> (US-ASCII_UTF8_QP)</td></tr><tr><td><a href="#SMTPTransporterClass.html_connectiontimeout"><strong>.connectionTimeOut</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the maximum wait time (in seconds)allowed to establish a connection to the server</p></td><td>30</td></tr><tr><td><a href="#SMTPTransporterClass.html_headercharset"><strong>.headerCharset</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; the charset and encoding used for theemail header</p></td><td><code>mail mode UTF8</code> (US-ASCII_UTF8_QP)</td></tr><tr><td><a href="#SMTPTransporterClass.html_host"><strong>.host</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the name or the IP address of the hostserver</p></td><td><em>mandatory</em></td></tr><tr><td><a href="#SMTPTransporterClass.html_keepalive"><strong>.keepAlive</strong>: Boolean</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>True</strong> if the SMTPconnection must be kept alive until the <code>transporter</code>object is destroyed</p></td><td>True</td></tr><tr><td><a href="#SMTPTransporterClass.html_logfile"><strong>.logFile</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;the path of the extended log filedefined (if any) for the mail connection</p></td><td>none</td></tr><tr><td><strong>password</strong> : Text<p>User password for authentication on the server. Not returned in<em><a href="#SMTPTransporterClass.html_smtp-transporter-object">SMTPtransporter</a></em> object.</p></td><td>none</td></tr><tr><td><a href="#SMTPTransporterClass.html_port"><strong>.port</strong> :Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp; the port number used for mailtransactions</p></td><td>587</td></tr><tr><td><a href="#SMTPTransporterClass.html_sendtimeout"><strong>.sendTimeOut</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp; the maximum wait time (in seconds) of acall to <code>.send( )</code> before a timeout occurs</p></td><td>100</td></tr><tr><td><a href="#SMTPTransporterClass.html_user"><strong>.user</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; the user name used for authenticationon the mail server</p></td><td>none</td></tr></tbody></table><h4><span><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_result"></a><a aria-hidden="true" class="hash-link" href="#SMTPTransporterClass.html_result"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Result</span></h4><p><span>The function returns a <a href="#SMTPTransporterClass.html_smtp-transporter-object"><strong>SMTPtransporter object</strong></a>. All returned properties are<strong>read-only</strong>.</span></p><h4><span><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_example"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_example"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Example</span></h4><pre><span><code class="hljs css language-4d"> <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"smtp.gmail.com"</span> <span class="hljs-comment">//Mandatory</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">465</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4D@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXX"</span> <span class="hljs-variable">$server</span>.logFile:=<span class="hljs-string">"LogTest.txt"</span> <span class="hljs-comment">//Extended log to save in the Logs folder</span><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.SMTPTransporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">SMTP New transporter</span>(<span class="hljs-variable">$server</span>) <span class="hljs-variable">$email</span>:=New object <span class="hljs-variable">$email</span>.subject:=<span class="hljs-string">"my first mail "</span> <span class="hljs-variable">$email</span>.from:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$email</span>.to:=<span class="hljs-string">"4d@4d.com;test@4d.com"</span> <span class="hljs-variable">$email</span>.textBody:=<span class="hljs-string">"Hello World"</span> <span class="hljs-variable">$email</span>.htmlBody:=<span class="hljs-string">"&lt;h1&gt;Hello World&lt;/h1&gt;&lt;h4&gt;'Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit...'&lt;/h4&gt;\ &lt;p&gt;There are many variations of passages of Lorem Ipsum available."</span>\ +<span class="hljs-string">"The generated Lorem Ipsum is therefore always free from repetition, injected humour, or non-characteristic words etc.&lt;/p&gt;"</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">send</span>(<span class="hljs-variable">$email</span>)<span class="hljs-keyword"> If</span>(<span class="hljs-function">Not</span>(<span class="hljs-variable">$status</span>.success))<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"An error occurred sending the mail: "</span>+<span class="hljs-variable">$status</span>.message)<span class="hljs-keyword"> End if</span></code></span></pre><h2><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_4dsmtptransporternew"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_4dsmtptransporternew"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4D.SMTPTransporter.new()</h2><p><strong>4D.SMTPTransporter.new</strong>( <em>server</em> :Object ) : 4D.SMTPTransporter</p><table><thead><tr><th>Parameter</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>server</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Mail server information</td></tr><tr><td>Result</td><td>4D.SMTPTransporter</td><td style="text-align:center">&lt;-</td><td><a href="#SMTPTransporterClass.html_smtp-transporter-object">SMTPtransporter object</a></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_description-1"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_description-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>The <code>4D.SMTPTransporter.new()</code> function creates andreturns a new object of the <code>4D.SMTPTransporter</code> type.It is identical to the <a href="#SMTPTransporterClass.html_smtp-new-transporter"><code>SMTP Newtransporter</code></a> command (shortcut).</p><h2><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_acceptunsecureconnection"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_acceptunsecureconnection"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.acceptUnsecureConnection</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.acceptUnsecureConnection</strong> : Boolean</p><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_description-2"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_description-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>The <code>.acceptUnsecureConnection</code> property contains<strong>True</strong> if 4D is allowed to establish an unencryptedconnection when encrypted connection is not possible.</p><p>It contains <strong>False</strong> if unencrypted connectionsare unallowed, in which case an error in returned when encryptedconnection is not possible.</p><p>Available secured ports are:</p><ul><li><p>SMTP</p><ul><li>465: SMTPS</li><li>587 or 25: SMTP with STARTTLS upgrade if supported by theserver.</li></ul></li><li><p>IMAP</p><ul><li>143: IMAP non-encrypted port</li><li>993: IMAP with STARTTLS upgrade if supported by the server</li></ul></li><li><p>POP3</p><ul><li>110: POP3 non-encrypted port</li><li>995: POP3 with STARTTLS upgrade if supported by theserver.</li></ul></li></ul><h2><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_authenticationmode"></a><a aria-hidden="true" class="hash-link" href="#SMTPTransporterClass.html_authenticationmode"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.authenticationMode</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.authenticationMode</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_description-3"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_description-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>The <code>.authenticationMode</code> property contains theauthentication mode used to open the session on the mailserver.</p><p>By default, the most secured mode supported by the server isused.</p><p>Possible values are:</p><table><thead><tr><th>Value</th><th>Constants</th><th>Comment</th></tr></thead><tbody><tr><td>CRAM-MD5</td><td><code>SMTP authentication CRAM MD5</code></td><td>Authentication using CRAM-MD5 protocol</td></tr><tr><td>LOGIN</td><td><code>SMTP authentication login</code></td><td>Authentication using LOGIN protocol</td></tr><tr><td>OAUTH2</td><td><code>SMTP authentication OAUTH2</code></td><td>Authentication using OAuth2 protocol</td></tr><tr><td>PLAIN</td><td><code>SMTP authentication plain</code></td><td>Authentication using PLAIN protocol</td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_bodycharset"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_bodycharset"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.bodyCharset</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v18</td><td>Support for UTF8 base64</td></tr><tr><td>v17 R5</td><td>Added</td></tr></tbody></table></details><p><strong>.bodyCharset</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_description-4"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_description-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>The <code>.bodyCharset</code> property contains the charset andencoding used for the body part of the email.</p><ul><li>subject,</li><li>attachment filename(s),</li><li>email name.</li></ul><p><strong>Possible values:</strong></p><table><thead><tr><th>Constant</th><th>Value</th><th>Comment</th></tr></thead><tbody><tr><td>mail mode ISO2022JP</td><td>US-ASCII_ISO-2022-JP_UTF8_QP</td><td><ul><li><em>headerCharset</em>: US-ASCII if possible, Japanese(ISO-2022-JP) &amp; Quoted-printable if possible, otherwise UTF-8&amp; Quoted-printable</li><li><em>bodyCharset</em>: US-ASCII if possible, Japanese(ISO-2022-JP) &amp; 7-bit if possible, otherwise UTF-8 &amp;Quoted-printable</li></ul></td></tr><tr><td>mail mode ISO88591</td><td>ISO-8859-1</td><td><ul><li><em>headerCharset</em>: ISO-8859-1 &amp; Quoted-printable</li><li><em>bodyCharset</em>: ISO-8859-1 &amp; 8-bit</li></ul></td></tr><tr><td>mail mode UTF8</td><td>US-ASCII_UTF8_QP</td><td><em>headerCharset</em> &amp; <em>bodyCharset</em>: US-ASCII ifpossible, otherwise UTF-8 &amp; Quoted-printable (<strong>defaultvalue</strong>)</td></tr><tr><td>mail mode UTF8 in base64</td><td>US-ASCII_UTF8_B64</td><td><em>headerCharset</em> &amp; <em>bodyCharset</em>: US-ASCII ifpossible, otherwise UTF-8 &amp; base64</td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_checkconnection"></a><a aria-hidden="true" class="hash-link" href="#SMTPTransporterClass.html_checkconnection"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.checkConnection()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.checkConnection()</strong> : Object</p><table><thead><tr><th>Parameter</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Result</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Status of the transporter object connection</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_description-5"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_description-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>The <code>.checkConnection()</code> function checks theconnection using information stored in the transporter object,recreates the connection if necessary, and returns the status. Thisfunction allows you to verify that the values provided by the userare valid and consistent.</p><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_returned-object"></a><a aria-hidden="true" class="hash-link" href="#SMTPTransporterClass.html_returned-object"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Returned object</h4><p>The function sends a request to the mail server and returns anobject describing the mail status. This object can contain thefollowing properties:</p><table><thead><tr><th>Property</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>boolean</td><td>True if the check is successful, False otherwise</td></tr><tr><td>status</td><td></td><td>number</td><td>(SMTP only) Status code returned by the mail server (0 in caseof an issue unrelated to the mail processing)</td></tr><tr><td>statusText</td><td></td><td>text</td><td>Status message returned by the mail server, or last errorreturned in the 4D error stack</td></tr><tr><td>errors</td><td></td><td>collection</td><td>4D error stack (not returned if a mail server response isreceived)</td></tr><tr><td></td><td>[ ].errCode</td><td>number</td><td>4D error code</td></tr><tr><td></td><td>[ ].message</td><td>text</td><td>Description of the 4D error</td></tr><tr><td></td><td>[ ].componentSignature</td><td>text</td><td>Signature of the internal component which returned theerror</td></tr></tbody></table><p>For information about SMTP status codes, please refer to<a href="https://www.usps.org/info/smtp_status.html">thispage</a>.</p><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_example-1"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_example-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Example</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$pw </span>: Text<span class="hljs-keyword"> var</span> <span class="hljs-variable">$options </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.SMTPTransporter <span class="hljs-variable">$options</span>:=New object <span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"smtp.gmail.com"</span> <span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span> <span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">SMTP New transporter</span>(<span class="hljs-variable">$options</span>) <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">checkConnection</span>()<span class="hljs-keyword"> If</span>(<span class="hljs-variable">$status</span>.success=<span class="hljs-literal">True</span>)<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"SMTP connection check successful!"</span>)<span class="hljs-keyword"> Else</span><span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Error # "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$status</span>.status)+<span class="hljs-string">", "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_connectiontimeout"></a><a aria-hidden="true" class="hash-link" href="#SMTPTransporterClass.html_connectiontimeout"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.connectionTimeOut</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R5</td><td>Added</td></tr></tbody></table></details><p><strong>.connectionTimeOut</strong> : Integer</p><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_description-6"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_description-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>The <code>.connectionTimeOut</code> property contains themaximum wait time (in seconds) allowed to establish a connection tothe server. By default, if the property has not been set in theserver object (used to create the transporter object with<code>SMTP New transporter</code>, <code>POP3 Newtransporter</code>, or <code>IMAP New transporter</code>), thevalue is 30.</p><h2><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_headercharset"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_headercharset"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.headerCharset</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R5</td><td>Added</td></tr></tbody></table></details><p><strong>.headerCharset</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_description-7"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_description-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>The <code>.headerCharset</code> property contains the charsetand encoding used for the email header. The header includes thefollowing parts of the email:</p><ul><li>subject,</li><li>attachment filename(s),</li><li>email name.</li></ul><p><strong>Possible values:</strong></p><table><thead><tr><th>Constant</th><th>Value</th><th>Comment</th></tr></thead><tbody><tr><td>mail mode ISO2022JP</td><td>US-ASCII_ISO-2022-JP_UTF8_QP</td><td><ul><li><em>headerCharset</em>: US-ASCII if possible, Japanese(ISO-2022-JP) &amp; Quoted-printable if possible, otherwise UTF-8&amp; Quoted-printable</li><li><em>bodyCharset</em>: US-ASCII if possible, Japanese(ISO-2022-JP) &amp; 7-bit if possible, otherwise UTF-8 &amp;Quoted-printable</li></ul></td></tr><tr><td>mail mode ISO88591</td><td>ISO-8859-1</td><td><ul><li><em>headerCharset</em>: ISO-8859-1 &amp; Quoted-printable</li><li><em>bodyCharset</em>: ISO-8859-1 &amp; 8-bit</li></ul></td></tr><tr><td>mail mode UTF8</td><td>US-ASCII_UTF8_QP</td><td><em>headerCharset</em> &amp; <em>bodyCharset</em>: US-ASCII ifpossible, otherwise UTF-8 &amp; Quoted-printable (defaultvalue)</td></tr><tr><td>mail mode UTF8 in base64</td><td>US-ASCII_UTF8_B64</td><td><em>headerCharset</em> &amp; <em>bodyCharset</em>: US-ASCII ifpossible, otherwise UTF-8 &amp; base64</td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_host"></a><a aria-hidden="true" class="hash-link" href="#SMTPTransporterClass.html_host"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.host</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R5</td><td>Added</td></tr></tbody></table></details><p><strong>.host</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_description-8"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_description-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>The <code>.host</code> property contains the name or the IPaddress of the host server. Used for mail transactions (SMTP, POP3,IMAP).</p><h2><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_keepalive"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_keepalive"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.keepAlive</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.keepAlive</strong> : Boolean</p><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_description-9"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_description-9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>The <code>.keepAlive</code> property contains<strong>True</strong> if the SMTP connection must be kept aliveuntil the <code>transporter</code> object is destroyed, and<strong>False</strong> otherwise. By default, if the<code>keepAlive</code> property has not been set in the<code>server</code> object (used to create the<code>transporter</code> object with <code>SMTP Newtransporter</code>), it is <strong>True</strong>.</p><p>The SMTP connection is automatically closed:</p><ul><li>when the <code>transporter</code> object is destroyed if the<code>.keepAlive</code> property is true,</li><li>after each <code>.send( )</code> function execution if the<code>.keepAlive</code> property is set to false.</li></ul><h2><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_logfile"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_logfile"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.logFile</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R5</td><td>Added</td></tr></tbody></table></details><p><strong>.logFile</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_description-10"></a><a aria-hidden="true" class="hash-link" href="#SMTPTransporterClass.html_description-10"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>The <code>.logFile</code> property contains the path of theextended log file defined (if any) for the mail connection. It canbe relative (to the current Logs folder) or absolute.</p><p>Unlike regular log files (enabled via the <code>SET DATABASEPARAMETER</code> command), extended log files store MIME contentsof all sent mails and do not have any size limit. For moreinformation about extended log files, refer to:</p><ul><li><strong>SMTP connections</strong> - <a href="#SMTPTransporterClass.html_4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DSMTPLog.txt</a></li><li><strong>POP3 connections</strong> - <a href="#SMTPTransporterClass.html_4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DPOP3Log.txt</a></li><li><strong>IMAP connections</strong> - <a href="#SMTPTransporterClass.html_4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DIMAPLog.txt</a></li></ul><h2><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_port"></a><a aria-hidden="true" class="hash-link" href="#SMTPTransporterClass.html_port"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.port</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.port</strong> : Integer</p><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_description-11"></a><a aria-hidden="true" class="hash-link" href="#SMTPTransporterClass.html_description-11"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>The <code>.port</code> property contains the port number usedfor mail transactions. By default, if the <em>port</em> propertyhas not been set in the <em>server</em> object (used to create thetransporter object with <code>SMTP New transporter</code>,<code>POP3 New transporter</code>, <code>IMAP Newtransporter</code>), the port used is:</p><ul><li><strong>SMTP</strong> - 587</li><li><strong>POP3</strong> - 995</li><li><strong>IMAP</strong> - 993</li></ul><h2><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_send"></a><a aria-hidden="true" class="hash-link" href="#SMTPTransporterClass.html_send"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.send()</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R5</td><td>Support of mime contents</td></tr><tr><td>v17 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.send</strong>( <em>mail</em> : Object ) : Object</p><table><thead><tr><th>Parameter</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>mail</td><td>Object</td><td style="text-align:center">-&gt;</td><td><a href="#SMTPTransporterClass.html_email-object">Email</a> tosend</td></tr><tr><td>Result</td><td>Object</td><td style="text-align:center">&lt;-</td><td>SMTP status</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_description-12"></a><a aria-hidden="true" class="hash-link" href="#SMTPTransporterClass.html_description-12"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>The <code>.send()</code> function sends the <a href="#SMTPTransporterClass.html_email-object"><em>mail</em> object</a>to the SMTP server defined in the <code>transporter</code> objectand returns a status object.</p><blockquote><p>The <code>transporter</code> object must have already beencreated using the <code>SMTP New transporter</code> command.</p></blockquote><p>The method creates the SMTP connection if it is not alreadyalive. If the <code>.keepAlive</code> property of the<code>transporter</code> object is <strong>false</strong>, the SMTPconnection is automatically closed after the execution of<code>.send()</code>, otherwise it stays alive until the<code>transporter</code> object is destroyed. For more information,please refer to the <a href="#SMTPTransporterClass.html_smtp-new-transporter"><code>SMTP Newtransporter</code></a> command description.</p><p>In <em>mail</em>, pass a valid <a href="#SMTPTransporterClass.html_email-object"><code>Email</code>object</a> to send. The origination (where the email is comingfrom) and destination (one or more recipients) properties must beincluded, the remaining properties are optional.</p><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_returned-object-1"></a><a aria-hidden="true" class="hash-link" href="#SMTPTransporterClass.html_returned-object-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Returned object</h4><p>The function returns an object describing the SMTP status of theoperation. This object can contain the following properties:</p><table><thead><tr><th>Property</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td>boolean</td><td>True if the send is successful, False otherwise</td></tr><tr><td>status</td><td>number</td><td>Status code returned by the SMTP server (0 in case of an issueunrelated to the mail processing)</td></tr><tr><td>statusText</td><td>text</td><td>Status message returned by the SMTP server</td></tr></tbody></table><p>In case of an issue unrelated to the SMTP processing (e.g. amandatory property is missing in mail), 4D generates an error thatyou can intercept using a method installed by the <code>ON ERRCALL</code> command. Use the <code>GET LAST ERROR STACK</code>command for information about the error.</p><p>In this case, the resulting status object contains the followingvalues:</p><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody><tr><td>success</td><td>False</td></tr><tr><td>status</td><td>0</td></tr><tr><td>statusText</td><td>"Failed to send email"</td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_sendtimeout"></a><a aria-hidden="true"class="hash-link" href="#SMTPTransporterClass.html_sendtimeout"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.sendTimeOut</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.sendTimeOut</strong> : Integer</p><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_description-13"></a><a aria-hidden="true" class="hash-link" href="#SMTPTransporterClass.html_description-13"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>The <code>.sendTimeOut</code> property contains the maximum waittime (in seconds) of a call to <code>.send( )</code> before atimeout occurs. By default, if the <code>.sendTimeOut</code>property has not been set in the <code>server</code> object, thevalue 100 is used.</p><h2><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_user"></a><a aria-hidden="true" class="hash-link" href="#SMTPTransporterClass.html_user"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.user</h2><details><summary>History</summary><table><thead><tr><th>Version</th><th>Changes</th></tr></thead><tbody><tr><td>v17 R4</td><td>Added</td></tr></tbody></table></details><p><strong>.user</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="SMTPTransporterClass.html_description-14"></a><a aria-hidden="true" class="hash-link" href="#SMTPTransporterClass.html_description-14"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>The <code>.user</code> property contains the user name used forauthentication on the mail server.</p><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#SignalClass.html"><span class="arrow-prev">←</span><span>Signal</span></a><a class="docs-next button" href="#SystemWorkerClass.html"><span class="function-name-prevnext">SystemWorker</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#SMTPTransporterClass.html_smtp-new-transporter">SMTPNew transporter</a></li><li><a href="#SMTPTransporterClass.html_4dsmtptransporternew">4D.SMTPTransporter.new()</a></li><li><a href="#SMTPTransporterClass.html_acceptunsecureconnection">.acceptUnsecureConnection</a></li><li><a href="#SMTPTransporterClass.html_authenticationmode">.authenticationMode</a></li><li><a href="#SMTPTransporterClass.html_bodycharset">.bodyCharset</a></li><li><a href="#SMTPTransporterClass.html_checkconnection">.checkConnection()</a></li><li><a href="#SMTPTransporterClass.html_connectiontimeout">.connectionTimeOut</a></li><li><a href="#SMTPTransporterClass.html_headercharset">.headerCharset</a></li><li><a href="#SMTPTransporterClass.html_host">.host</a></li><li><a href="#SMTPTransporterClass.html_keepalive">.keepAlive</a></li><li><a href="#SMTPTransporterClass.html_logfile">.logFile</a></li><li><a href="#SMTPTransporterClass.html_port">.port</a></li><li><a href="#SMTPTransporterClass.html_send">.send()</a></li><li><a href="#SMTPTransporterClass.html_sendtimeout">.sendTimeOut</a></li><li><a href="#SMTPTransporterClass.html_user">.user</a></li></ul></nav></div></div></body></html>