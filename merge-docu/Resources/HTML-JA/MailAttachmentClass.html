<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="ja"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>MailAttachment · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="Attachment オブジェクトによって、[`Email`](/docs/Rx/ja/API/EmailObjectClass.html) オブジェクト内のファイルを参照することができます。 MailAttachment オブジェクトは [`MAIL New attachment`](#mail-new-attachment) コマンドによって作成されます。"name="description" /><meta content="ja" name="docsearch:language" /><meta content="MailAttachment · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="Attachment オブジェクトによって、[`Email`](/docs/Rx/ja/API/EmailObjectClass.html) オブジェクト内のファイルを参照することができます。 MailAttachment オブジェクトは [`MAIL New attachment`](#mail-new-attachment) コマンドによって作成されます。"property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#MailAttachmentClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">MailAttachment<a aria-hidden="true" class="anchor" id="MailAttachmentClass.html"></a></h1></header><article><div><p><span>Attachment オブジェクトによって、<a href="#EmailObjectClass.html"><code>Email</code></a>オブジェクト内のファイルを参照することができます。 MailAttachment オブジェクトは <a href="#MailAttachmentClass.html_mail-new-attachment"><code>MAIL Newattachment</code></a> コマンドによって作成されます。</span></p><h3><span><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_attachment-%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_attachment-%25E3%2582%25AA%25E3%2583%2596%25E3%2582%25B8%25E3%2582%25A7%25E3%2582%25AF%25E3%2583%2588"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Attachment オブジェクト</span></h3><p><span>Attachment オブジェクトは、次の読み取り専用プロパティや、関数を提供します:</span></p><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#MailAttachmentClass.html_cid"><strong>.cid</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; 添付ファイルの ID</p></td></tr><tr><td><a href="#MailAttachmentClass.html_disposition"><strong>.disposition</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<code>Content-Disposition</code>ヘッダーの値</p></td></tr><tr><td><a href="#MailAttachmentClass.html_getcontent"><strong>.getContent()</strong>: 4D.Blob</a><p>&nbsp;&nbsp;&nbsp;&nbsp;添付オブジェクトの中身を <code>4D.Blob</code>オブジェクトとして返します</p></td></tr><tr><td><a href="#MailAttachmentClass.html_name"><strong>.name</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;添付ファイルの名前と拡張子</p></td></tr><tr><td><a href="#MailAttachmentClass.html_path"><strong>.path</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;添付ファイルの POSIXパス</p></td></tr><tr><td><a href="#MailAttachmentClass.html_platformpath"><strong>.platformPath</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;カレントプラットフォームのシンタックスで表現されたファイルのパス</p></td></tr><tr><td><a href="#MailAttachmentClass.html_type"><strong>.type</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;添付ファイルの <code>content-type</code></p></td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_mail-new-attachment"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_mail-new-attachment"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>MAIL New attachment</span></h2><details><summary><span>履歴</span></summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v19 R2</td><td>4D.File, 4D.ZipFile, 4D.Blob の受け入れ</td></tr></tbody></table></details><p><span><strong>MAIL New attachment</strong>( <em>file</em> :4D.File { ; <em>name</em> : Text {; <em>cid</em> : Text{ ;<em>type</em> : Text { ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment<br /><strong>MAIL New attachment</strong>( <em>zipFile</em> : 4D.ZipFile{ ; <em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> :Text { ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment<br /><strong>MAIL New attachment</strong>( <em>blob</em> : 4D.Blob { ;<em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> : Text{ ; <em>disposition</em> :Text } } } } ) : 4D.MailAttachment<br /><strong>MAIL New attachment</strong>( <em>path</em> : Text { ;<em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> : Text{ ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment</span></p><table><thead><tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr></thead><tbody><tr><td>file</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>添付ファイル</td></tr><tr><td>zipFile</td><td>4D.ZipFile</td><td style="text-align:center">-&gt;</td><td>添付 Zipファイル</td></tr><tr><td>blob</td><td>4D.Blob</td><td style="text-align:center">-&gt;</td><td>添付を格納した BLOB</td></tr><tr><td>path</td><td>Text</td><td style="text-align:center">-&gt;</td><td>添付ファイルのパス</td></tr><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>メールクライアントが添付を指定するのに使用する名前 + 拡張子</td></tr><tr><td>cid</td><td>Text</td><td style="text-align:center">-&gt;</td><td>添付の ID (HTMLメッセージのみ)、あるいは cid が不要な場合は "" (空の文字列)</td></tr><tr><td>type</td><td>Text</td><td style="text-align:center">-&gt;</td><td>content-type ヘッダーの値</td></tr><tr><td>disposition</td><td>Text</td><td style="text-align:center">-&gt;</td><td>content-disposition ヘッダーの値: "inline" あるいは "attachment"</td></tr><tr><td>戻り値</td><td>4D.MailAttachment</td><td style="text-align:center">&lt;-</td><td>Attachment オブジェクト</td></tr></tbody></table><h4><span><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_%E8%AA%AC%E6%98%8E"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_%25E8%25AA%25AC%25E6%2598%258E"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</span></h4><p><span><code>MAIL New attachment</code> コマンドは、 <a href="#MailAttachmentClass.html_email-%25E3%2582%25AA%25E3%2583%2596%25E3%2582%25B8%25E3%2582%25A7%25E3%2582%25AF%25E3%2583%2588">Email オブジェクト</a> に追加することができる添付オブジェクトを作成します。</span></p><p><span>添付を定義するには、次のパラメーターが使えます:</span></p><ul><li><span><em>file</em>: 添付ファイルを格納する <code>4D.File</code>オブジェクトを渡します。</span></li><li><span><em>zipfile</em>: 添付ファイルを格納する <code>4D.ZipFile</code>オブジェクトを渡します。</span></li><li><span><em>blob</em>: 添付そのものを <code>4D.Blob</code>に格納して渡します。</span></li><li><span><em>path</em>: システムシンタックスで表現された添付ファイルのパスを<strong>テキスト</strong> 値で渡します。 完全なパス名、または単純なファイル名を渡すことができます(ファイル名のみの場合、4D はプロジェクトファイルと同じディレクトリ内を検索します)。</span></li></ul><p><span>任意の <em>name</em>引数として、添付を指定するためにメールクライアントが使用する名前と拡張子を渡すことができます。 <em>name</em>が省略された場合:</span></p><ul><li><span>ファイルパスを渡していれば、そのファイル名と拡張子が使用されます。</span></li><li><span>BLOB を渡していれば、拡張子がないランダムな名前が自動的に生成されます。</span></li></ul><p><span>任意の <em>cid</em> 引数を使用すると、添付ファイルの内部ID を渡すことができます。 この ID は<code>Content-Id</code> ヘッダーの値で、HTMLメッセージにおいてのみ使用されます。 cidを使い、<code>\&lt;img src="cid:ID"&gt;</code> のようなHTMLタグによってメッセージ本文で定義された参照と添付ファイルが紐づけられます。 これはつまり、添付ファイルの中身 (例:ピクチャー) がメールクライアント上ではメッセージ本文内に表示されるべきであることを意味しています。最終的な表示は、メールクライアントによって若干異なる可能性があります。 <em>cid</em>を使用したくない場合、空の文字列を引数として渡します。</span></p><p><span>任意の <em>type</em> 引数を渡すと、添付ファイルの <code>content-type</code>を明示的に設定することができます。 たとえば、MIMEタイプを定義する文字列 ("video/mpeg"など) を渡すことができます。この content-type の値は拡張子とは関係なく添付ファイルに対して設定されます。MIMEタイプについての詳細は、<a href="https://ja.wikipedia.org/wiki/Multipurpose_Internet_Mail_Extensions">Wikipedia上のMIME に関するページ</a> を参照ください。</span></p><p><span>この引数が省略された場合、あるいはこの引数に空の文字列が渡された場合はデフォルトで、添付ファイルの<code>content-type</code> は拡張子に基づいて設定されます。 主なMIMEタイプについては、以下のルールが適用されます:</span></p><table><thead><tr><th>拡張子</th><th>Content-Type</th></tr></thead><tbody><tr><td>jpg, jpeg</td><td>image/jpeg</td></tr><tr><td>png</td><td>image/png</td></tr><tr><td>gif</td><td>image/gif</td></tr><tr><td>pdf</td><td>application/pdf</td></tr><tr><td>doc</td><td>application/msword</td></tr><tr><td>xls</td><td>application/vnd.ms-excel</td></tr><tr><td>ppt</td><td>application/vnd.ms-powerpoint</td></tr><tr><td>zip</td><td>application/zip</td></tr><tr><td>gz</td><td>application/gzip</td></tr><tr><td>json</td><td>application/json</td></tr><tr><td>js</td><td>application/javascript</td></tr><tr><td>ps</td><td>application/postscript</td></tr><tr><td>xml</td><td>application/xml</td></tr><tr><td>htm, html</td><td>text/html</td></tr><tr><td>mp3</td><td>audio/mpeg</td></tr><tr><td><em>その他</em></td><td>application/octet-stream</td></tr></tbody></table><p><span>任意の <em>disposition</em> 引数を渡して、添付ファイルの<code>content-disposition</code> ヘッダーを指定できます。 "Mail"定数テーマ内の、以下の定数のいずれか 1つを渡すことができます:</span></p><table><thead><tr><th>定数</th><th>値</th><th>説明</th></tr></thead><tbody><tr><td>mail disposition attachment</td><td>"attachment"</td><td>Content-disposition ヘッダーの値を "attachment"に設定します。これは添付ファイルはメッセージ内でリンクとして提供される必要があることを意味します。</td></tr><tr><td>mail disposition inline</td><td>"inline"</td><td>Content-disposition ヘッダーの値を "inline"に設定します。これは添付ファイルはメッセージ本文内の、"cid" の位置にレンダリングされる必要があることを意味します。レンダリングの結果はメールクライアントによって異なります。</td></tr></tbody></table><p><span><em>disposition</em> 引数が省略された場合はデフォルトで:</span></p><ul><li><span><em>cid</em> 引数が使われていた場合、<code>Content-disposition</code>ヘッダーは "inline" に設定されます。</span></li><li><span><em>cid</em>引数が渡されていない、あるいは空の文字列が渡されていた場合、<code>Content-disposition</code>ヘッダーは "attachment" に設定されます。</span></li></ul><h4><span><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_%E4%BE%8B%E9%A1%8C-1"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_%25E4%25BE%258B%25E9%25A1%258C-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 1</span></h4><p><span>ユーザーが選択したファイルを添付し、HTML 本文に画像を埋め込んだメールを送信します:</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-variable">$doc</span>:=<span class="hljs-function">Select document</span>(<span class="hljs-string">""</span>;<span class="hljs-string">"*"</span>;<span class="hljs-string">"添付するファイルを選択したください"</span>;<span class="hljs-number">0</span>)<span class="hljs-keyword">If</span> (OK=<span class="hljs-number">1</span>) <span class="hljs-comment">// もしドキュメントが選択されていれば</span><span class="hljs-function">C_OBJECT</span>(<span class="hljs-variable">$email</span>;<span class="hljs-variable">$server</span>;<span class="hljs-variable">$transporter</span>)<span class="hljs-variable">$server</span>:=New object<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"smtp.mail.com"</span><span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"test_user@mail.com"</span><span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"p@ssw@rd"</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">SMTP New transporter</span>(<span class="hljs-variable">$server</span>)<span class="hljs-variable">$email</span>:=New object<span class="hljs-variable">$email</span>.from:=<span class="hljs-string">"test_user@mail.com"</span><span class="hljs-variable">$email</span>.to:=<span class="hljs-string">"test_user@mail.com"</span><span class="hljs-variable">$email</span>.subject:=<span class="hljs-string">"添付の付いたテストメッセージです"</span><span class="hljs-comment">// ファイルをダウンロードするリンクを追加します</span><span class="hljs-variable">$email</span>.attachments:=<span class="hljs-function">New collection</span>(<span class="hljs-function">MAIL New attachment</span>(Document))<span class="hljs-comment">// インラインピクチャーを挿入します (cid を使用)</span><span class="hljs-variable">$email</span>.attachments[<span class="hljs-number">1</span>]:=<span class="hljs-function">MAIL New attachment</span>(<span class="hljs-string">"c:\\Pictures\\4D.jpg"</span>;<span class="hljs-string">""</span>;<span class="hljs-string">"4D"</span>)<span class="hljs-variable">$email</span>.htmlBody:=<span class="hljs-string">"&lt;html&gt;"</span>+\<span class="hljs-string">"&lt;body&gt;Hello World!"</span>+\<span class="hljs-string">"&lt;img src='cid:4D' &gt;"</span>+\<span class="hljs-string">"&lt;/body&gt;"</span>+\<span class="hljs-string">"&lt;/head&gt;"</span>+\<span class="hljs-string">"&lt;/html&gt;"</span><span class="hljs-variable">$transporter</span>.<span class="hljs-function">send</span>(<span class="hljs-variable">$email</span>) <span class="hljs-comment">// メールを送信します</span><span class="hljs-keyword">End if</span></code></span></pre><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_%E4%BE%8B%E9%A1%8C-2"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_%25E4%25BE%258B%25E9%25A1%258C-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 2</h4><p>4D Write Pro エリアを添付したメールを送信します:</p><pre><code class="hljs css language-4d"><span class="hljs-function">C_BLOB</span>(<span class="hljs-variable">$blob</span>)<span class="hljs-function">WP EXPORT VARIABLE</span>(WPArea;<span class="hljs-variable">$blob</span>;wk docx)<span class="hljs-function">C_OBJECT</span>(<span class="hljs-variable">$email</span>;<span class="hljs-variable">$server</span>;<span class="hljs-variable">$transporter</span>)<span class="hljs-variable">$server</span>:=New object<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"smtp.mail.com"</span><span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"user@mail.com"</span><span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"p@ssw@rd"</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">SMTP New transporter</span>(<span class="hljs-variable">$server</span>)<span class="hljs-variable">$email</span>:=New object<span class="hljs-variable">$email</span>.from:=<span class="hljs-string">"user@mail.com"</span><span class="hljs-variable">$email</span>.to:=<span class="hljs-string">"customer@mail.com"</span><span class="hljs-variable">$email</span>.subject:=<span class="hljs-string">"新規年次レポート"</span><span class="hljs-variable">$email</span>.textBody:=<span class="hljs-string">"添付のとおり、新しい年次レポートをご連絡します。"</span><span class="hljs-variable">$email</span>.attachments:=<span class="hljs-function">New collection</span>(<span class="hljs-function">MAIL New attachment</span>(<span class="hljs-variable">$blob</span>;<span class="hljs-string">"Annual report.docx"</span>))<span class="hljs-variable">$transporter</span>.<span class="hljs-function">send</span>(<span class="hljs-variable">$email</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_4dmailattachmentnew"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_4dmailattachmentnew"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4D.MailAttachment.new()</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v19 R2</td><td>4D.File, 4D.ZipFile, 4D.Blob の受け入れ</td></tr></tbody></table></details><p><strong>4D.MailAttachment.new</strong>( <em>file</em> : 4D.File{ ; <em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> :Text { ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment<br /><strong>4D.MailAttachment.new</strong>( <em>zipFile</em> :4D.ZipFile { ; <em>name</em> : Text {; <em>cid</em> : Text{ ;<em>type</em> : Text { ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment<br /><strong>4D.MailAttachment.new</strong>( <em>blob</em> : 4D.Blob { ;<em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> : Text{ ; <em>disposition</em> :Text } } } } ) : 4D.MailAttachment<br /><strong>4D.MailAttachment.new</strong>( <em>path</em> : Text { ;<em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> : Text{ ; <em>disposition</em> :Text } } } } ) : 4D.MailAttachment</p><table><thead><tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr></thead><tbody><tr><td>file</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>添付ファイル</td></tr><tr><td>zipFile</td><td>4D.ZipFile</td><td style="text-align:center">-&gt;</td><td>添付 Zipファイル</td></tr><tr><td>blob</td><td>4D.Blob</td><td style="text-align:center">-&gt;</td><td>添付を格納した BLOB</td></tr><tr><td>path</td><td>Text</td><td style="text-align:center">-&gt;</td><td>添付ファイルのパス</td></tr><tr><td>name</td><td>Text</td><td style="text-align:center">-&gt;</td><td>メールクライアントが添付を指定するのに使用する名前 + 拡張子</td></tr><tr><td>cid</td><td>Text</td><td style="text-align:center">-&gt;</td><td>添付の ID (HTMLメッセージのみ)、あるいは cid が不要な場合は "" (空の文字列)</td></tr><tr><td>type</td><td>Text</td><td style="text-align:center">-&gt;</td><td>content-type ヘッダーの値</td></tr><tr><td>disposition</td><td>Text</td><td style="text-align:center">-&gt;</td><td>content-disposition ヘッダーの値: "inline" あるいは "attachment"</td></tr><tr><td>戻り値</td><td>4D.MailAttachment</td><td style="text-align:center">&lt;-</td><td>Attachment オブジェクト</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_%E8%AA%AC%E6%98%8E-1"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_%25E8%25AA%25AC%25E6%2598%258E-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>4D.MailAttachment.new()</code> 関数は、<code>4D.MailAttachment</code> 型の新規オブジェクト作成して返します。この関数の機能は、<a href="#MailAttachmentClass.html_mail-new-attachment"><code>MAILNew attachment</code></a> コマンドと同一です。</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_cid"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_cid"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.cid</h2><p><strong>.cid</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_%E8%AA%AC%E6%98%8E-2"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_%25E8%25AA%25AC%25E6%2598%258E-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.cid</code> プロパティは、 添付ファイルの IDを格納します。 このプロパティはHTMLメッセージでのみ使用されます。 このプロパティがない場合、ファイルは単なる添付 (リンク) として管理されます。</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_disposition"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_disposition"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.disposition</h2><p><strong>.disposition</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_%E8%AA%AC%E6%98%8E-3"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_%25E8%25AA%25AC%25E6%2598%258E-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.disposition</code> プロパティは、<code>Content-Disposition</code> ヘッダーの値を格納します。 二つの値が利用可能です:</p><ul><li>"inline": 添付ファイルはメッセージコンテンツ内に、"cid"の場所にレンダリングされます。レンダリングの結果はメールクライアントによって異なります。</li><li>"attachment": 添付ファイルはメッセージ内でリンクとして提供されます。</li></ul><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_getcontent"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_getcontent"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getContent()</h2><p><strong>.getContent()</strong> : 4D.Blob</p><table><thead><tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr></thead><tbody><tr><td>戻り値</td><td>4D.Blob</td><td style="text-align:center">&lt;-</td><td>添付の中身</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_%E8%AA%AC%E6%98%8E-4"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_%25E8%25AA%25AC%25E6%2598%258E-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.getContent()</code> 関数は、 添付オブジェクトの中身を<code>4D.Blob</code> オブジェクトとして返します。 <a href="#MailAttachmentClass.html_mail-convert-from-mime"><code>MAILConvert from MIME</code></a>コマンドによって取得した添付オブジェクトに対して、この関数を使用することができます。</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_name"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_name"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.name</h2><p><strong>.name</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_%E8%AA%AC%E6%98%8E-5"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_%25E8%25AA%25AC%25E6%2598%258E-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.name</code> プロパティは、 添付ファイルの名前と拡張子を格納します。 <a href="#MailAttachmentClass.html_mail-new-attachment"><code>MAIL Newattachment</code></a> コマンドで別の名称を指定しなかった場合のデフォルトは、ファイルの名称です。</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_path"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_path"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.path</h2><p><strong>.path</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_%E8%AA%AC%E6%98%8E-6"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_%25E8%25AA%25AC%25E6%2598%258E-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.path</code> プロパティは、 添付ファイルの POSIXパス(存在すれば) を格納します。</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_platformpath"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_platformpath"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.platformPath</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v19</td><td>追加</td></tr></tbody></table></details><p><strong>.platformPath</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_%E8%AA%AC%E6%98%8E-7"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_%25E8%25AA%25AC%25E6%2598%258E-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.platformPath</code> プロパティは、カレントプラットフォームのシンタックスで表現されたファイルのパスを返します。</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_type"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_type"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.type</h2><p><strong>.type</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_%E8%AA%AC%E6%98%8E-8"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_%25E8%25AA%25AC%25E6%2598%258E-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.type</code> プロパティは、 添付ファイルの<code>content-type</code>を格納します。 <a href="#MailAttachmentClass.html_mail-new-attachment"><code>MAIL Newattachment</code></a>コマンドにて、このタイプが明示的に渡されていない場合、<code>content-type</code>はファイルの拡張子に基づきます。</p><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#IMAPTransporterClass.html"><span class="arrow-prev">←</span><span>IMAPTransporter</span></a><a class="docs-next button" href="#POP3TransporterClass.html"><span>POP3Transporter</span><span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#MailAttachmentClass.html_mail-new-attachment">MAILNew attachment</a></li><li><a href="#MailAttachmentClass.html_4dmailattachmentnew">4D.MailAttachment.new()</a></li><li><a href="#MailAttachmentClass.html_cid">.cid</a></li><li><a href="#MailAttachmentClass.html_disposition">.disposition</a></li><li><a href="#MailAttachmentClass.html_getcontent">.getContent()</a></li><li><a href="#MailAttachmentClass.html_name">.name</a></li><li><a href="#MailAttachmentClass.html_path">.path</a></li><li><a href="#MailAttachmentClass.html_platformpath">.platformPath</a></li><li><a href="#MailAttachmentClass.html_type">.type</a></li></ul></nav></div></div></body></html>