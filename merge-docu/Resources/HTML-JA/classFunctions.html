<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="ja"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>ORDAクラス関数の呼び出し · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="RESTリクエストを使って、ORDAデータモデルに定義されている [データモデルクラス関数](/docs/Rx/ja/ORDA/ordaClasses.html) を呼び出すことで、ターゲット 4Dアプリケーションの公開API を活用できます。"name="description" /><meta content="ja" name="docsearch:language" /><meta content="ORDAクラス関数の呼び出し · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="RESTリクエストを使って、ORDAデータモデルに定義されている [データモデルクラス関数](/docs/Rx/ja/ORDA/ordaClasses.html) を呼び出すことで、ターゲット 4Dアプリケーションの公開API を活用できます。"property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#ClassFunctions.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">ORDAクラス関数の呼び出し<a aria-hidden="true" class="anchor" id="classFunctions.html"></a></h1></header><article><div><p><span>RESTリクエストを使って、ORDAデータモデルに定義されている <a href="#ordaClasses.html">データモデルクラス関数</a> を呼び出すことで、ターゲット 4Dアプリケーションの公開APIを活用できます。</span></p><p><span>関数を呼び出すには () を省き、適切な ORDA のコンテキストにおいて POST リクエストでおこないます。たとえば、City DataClassクラスに <code>getCity()</code>関数を定義した場合、次のリクエストで呼び出すことができます:</span></p><p><span><code>/rest/City/getCity</code></span></p><p><span>POST リクエストのボディに関数に渡す引数を含めます:<code>["Aguada"]</code></span></p><p><span>この呼び出しは、4Dランゲージでは次のステートメントに相当します:</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-variable">$city</span>:=ds.City.<span class="hljs-function">getCity</span>(<span class="hljs-string">"Aguada"</span>)</code></span></pre><blockquote><p>RESTリクエストで直接呼び出せるのは <code>exposed</code> キーワードが付いた関数のみです。<a href="#classFunctions.html_%25E5%2585%25AC%25E9%2596%258Bvs%25E9%259D%259E%25E5%2585%25AC%25E9%2596%258B%25E9%2596%25A2%25E6%2595%25B0">公開vs非公開関数</a> の章を参照ください。</p></blockquote><h2><a aria-hidden="true" class="anchor" id="classFunctions.html_%E9%96%A2%E6%95%B0%E3%81%AE%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_%25E9%2596%25A2%25E6%2595%25B0%25E3%2581%25AE%25E5%2591%25BC%25E3%2581%25B3%25E5%2587%25BA%25E3%2581%2597"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>関数の呼び出し</h2><p>関数は必ず REST の <strong>POST</strong> リクエストで呼び出さなくてはなりません(GETリクエストの場合はエラーが返されます)。</p><p>サーバーのデータストアーの対応するオブジェクトを対象に、関数は呼び出されます。</p><table><thead><tr><th>クラス関数</th><th>シンタックス</th></tr></thead><tbody><tr><td><a href="#classFunctions.html_datastore-%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9">DataStore クラス</a></td><td><code>/rest/$catalog/DataStoreClassFunction</code></td></tr><tr><td><a href="#classFunctions.html_dataclass-%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9">DataClass クラス</a></td><td><code>/rest/{dataClass}/DataClassClassFunction</code></td></tr><tr><td><a href="#classFunctions.html_entityselection-%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9">EntitySelection クラス</a></td><td><code>/rest/{dataClass}/EntitySelectionClassFunction</code></td></tr><tr><td></td><td><code>/rest/{dataClass}/EntitySelectionClassFunction/$entityset/entitySetNumber</code></td></tr><tr><td></td><td><code>/rest/{dataClass}/EntitySelectionClassFunction/$filter</code></td></tr><tr><td></td><td><code>/rest/{dataClass}/EntitySelectionClassFunction/$orderby</code></td></tr><tr><td><a href="#classFunctions.html_entity-%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9">Entity クラス</a></td><td><code>/rest/{dataClass}(key)/EntityClassFunction/</code></td></tr></tbody></table><blockquote><p><code>/rest/{dataClass}/Function</code> は DataClassクラスまたはEntitySelectionクラスの関数を呼び出すのに使えます (<code>/rest/{dataClass}</code>はデータクラスの全エンティティをエンティティセレクションに返します)。<br />EntitySelection クラスの関数が先に探されます。 見つからない場合に、DataClassクラスを探します。つまり、同じ名称の関数が DataClassクラスとEntitySelectionクラスの両方に定義されている場合、DataClassクラスの関数が実行されることはありません。</p></blockquote><blockquote><p>プロジェクトがコンパイル済みモードで実行される場合、RESTサーバーは常にプリエンプティブプロセスを使用するため、RESTリクエストから呼び出されるすべての4Dコードは <strong>スレッドセーフでなければなりません</strong> (<a href="#classFunctions.html_web%25E3%2582%25B5%25E3%2583%25BC%25E3%2583%2590%25E3%2583%25BC%25E3%2581%25AB%25E3%2581%258A%25E3%2581%2584%25E3%2581%25A6%25E3%2583%2597%25E3%2583%25AA%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2597%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2596%25E3%2583%25A2%25E3%2583%25BC%25E3%2583%2589%25E3%2582%2592%25E6%259C%2589%25E5%258A%25B9%25E5%258C%2596%25E3%2581%2599%25E3%2582%258B"><em>プリエンプティブプロセスを使用</em>の設定値</a> は、RESTサーバーによって無視されます)。</p></blockquote><h2><a aria-hidden="true" class="anchor" id="classFunctions.html_%E5%BC%95%E6%95%B0"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_%25E5%25BC%2595%25E6%2595%25B0"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>引数</h2><p>ORDAユーザークラスに定義された関数には、引数を渡すことができます。 サーバーサイドでこれらの引数は、クラス関数の $1,$2 などのパラメーターに受け渡されます。</p><p>次のルールが適用されます:</p><ul><li>引数はすべて、<strong>POSTリクエストのボディ</strong> に渡す必要があります:</li><li>引数はコレクション (JSON形式) の中に格納する必要があります。</li><li>JSON コレクションがサポートしているスカラーなデータ型はすべて引数として渡せます。</li><li>エンティティやエンティティセレクションも引数として受け渡せます。 この際、対応するORDAオブジェクトにデータを割り当てるために RESTサーバーが使用する専用の属性 (__DATACLASS, __ENTITY,__ENTITIES, __DATASET) を JSONオブジェクトに含めなくてはなりません。</li></ul><p><a href="#classFunctions.html_%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E5%25BC%2595%25E6%2595%25B0%25E3%2581%25A8%25E3%2581%2597%25E3%2581%25A6%25E5%258F%2597%25E3%2581%2591%25E5%258F%2596%25E3%2582%258B">エンティティを引数として受け取る例題</a> と <a href="#classFunctions.html_%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%25BB%25E3%2583%25AC%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3%25E3%2582%2592%25E5%25BC%2595%25E6%2595%25B0%25E3%2581%25A8%25E3%2581%2597%25E3%2581%25A6%25E5%258F%2597%25E3%2581%2591%25E5%258F%2596%25E3%2582%258B">エンティティセレクションを引数として受け取る例題</a> を参照ください。</p><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_%E3%82%B9%E3%82%AB%E3%83%A9%E3%83%BC%E5%80%A4%E3%81%AE%E5%BC%95%E6%95%B0"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_%25E3%2582%25B9%25E3%2582%25AB%25E3%2583%25A9%25E3%2583%25BC%25E5%2580%25A4%25E3%2581%25AE%25E5%25BC%2595%25E6%2595%25B0"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>スカラー値の引数</h3><p>引数は、ボディに定義されたコレクションに格納します。 たとえば、DataClass クラス関数<code>getCities()</code> はがテキスト引数を受け取る場合:<code>/rest/City/getCities</code></p><p><strong>ボディの引数:</strong> ["Aguada","Paris"]</p><p>引数としてサポートされるのは、JSONポインターを含むすべての JSON のデータ型です。 日付は ISO8601形式の文字列として渡せます (例: "2020-08-22T22:00:000Z")。</p><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_%E3%82%A8%E3%83%B3%E3%83%86%E3%82%A3%E3%83%86%E3%82%A3%E5%BC%95%E6%95%B0"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E5%25BC%2595%25E6%2595%25B0"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>エンティティ引数</h3><p>引数として渡されたエンティティは、キー (__KEY プロパティ) によってサーバー上で参照されます。リクエストにおいてキーが省略されていれば、サーバーのメモリに新規エンティティが読み込まれます。エンティティが持つ属性について、値を受け渡すことも可能です。サーバー上でこれらの値は自動的に当該エンティティ用に使用されます。</p><blockquote><p>サーバー上の既存エンティティについて変更された属性値をリクエストが送信した場合、呼び出したORDAデータモデル関数は自動的に変更後の値で実行されます。この機能によって、たとえばエンティティに対する処理の、すべてのビジネスルールを適用した後の結果をクライアントアプリケーションから確認することが可能です。その結果をもとにエンティティをサーバー上で保存するかどうかを判断できます。</p></blockquote><table><thead><tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>エンティティの属性</td><td>混合</td><td>任意 - 変更する値</td></tr><tr><td>__DATACLASS</td><td>String</td><td>必須 - エンティティのデータクラスを指定します</td></tr><tr><td>__ENTITY</td><td>Boolean</td><td>必須 - true は引数がエンティティであることをサーバーに通知します</td></tr><tr><td>__KEY</td><td>混合 (プライマリーキーと同じ型)</td><td>任意 - エンティティのプライマリーキー</td></tr></tbody></table><ul><li>__KEY が省略された場合、指定した属性を持つ新規エンティティがサーバー上で作成されます。</li><li>__KEY が提供された場合、__KEY が合致するエンティティが指定した属性とともにサーバー上に読み込まれます。</li></ul><p>エンティティを <a href="#classFunctions.html_%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E4%25BD%259C%25E6%2588%2590%25E3%2581%2599%25E3%2582%258B">作成</a> または <a href="#classFunctions.html_%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E6%259B%25B4%25E6%2596%25B0%25E3%2581%2599%25E3%2582%258B">更新</a> する例題を参照ください。</p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_%E3%83%AA%E3%83%AC%E3%83%BC%E3%83%88%E3%82%A8%E3%83%B3%E3%83%86%E3%82%A3%E3%83%86%E3%82%A3%E5%BC%95%E6%95%B0"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_%25E3%2583%25AA%25E3%2583%25AC%25E3%2583%25BC%25E3%2583%2588%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E5%25BC%2595%25E6%2595%25B0"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>リレートエンティティ引数</h4><p><a href="#classFunctions.html_%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E5%25BC%2595%25E6%2595%25B0">エンティティ引数</a> と同じプロパティを持ちます。異なる点は、リレートエンティティは存在していなければならないため、プライマリーキーを格納する __KEY を省略できません。</p><p>リレートエンティティを持つエンティティを <a href="#classFunctions.html_%25E3%2583%25AA%25E3%2583%25AC%25E3%2583%25BC%25E3%2583%2588%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E6%258C%2581%25E3%2581%25A4%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E4%25BD%259C%25E6%2588%2590%25E3%2581%2599%25E3%2582%258B">作成</a> または <a href="#classFunctions.html_%25E3%2583%25AA%25E3%2583%25AC%25E3%2583%25BC%25E3%2583%2588%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E6%258C%2581%25E3%2581%25A4%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E6%259B%25B4%25E6%2596%25B0%25E3%2581%2599%25E3%2582%258B">更新</a> する例題を参照ください。</p><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_%E3%82%A8%E3%83%B3%E3%83%86%E3%82%A3%E3%83%86%E3%82%A3%E3%82%BB%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E5%BC%95%E6%95%B0"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%25BB%25E3%2583%25AC%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3%25E5%25BC%2595%25E6%2595%25B0"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>エンティティセレクション引数</h3><p>引数として渡すエンティティセレクションはあらかじめ <a href="#classFunctions.html_methodentityset">$method=entityset</a>によって定義されている必要があります。</p><blockquote><p>変更されたエンティティセレクションをリクエストがサーバーに送信した場合、呼び出したORDAデータモデル関数は自動的に変更後のエンティティセレクションで実行されます。</p></blockquote><table><thead><tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>エンティティの属性</td><td>混合</td><td>任意 - 変更する値</td></tr><tr><td>__DATASET</td><td>String</td><td>必須 - エンティティセレクションのエンティティセットID (UUID)</td></tr><tr><td>__ENTITIES</td><td>Boolean</td><td>必須 - true は引数がエンティティセレクションであることをサーバーに通知します</td></tr></tbody></table><p><a href="#classFunctions.html_%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%25BB%25E3%2583%25AC%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3%25E3%2582%2592%25E5%25BC%2595%25E6%2595%25B0%25E3%2581%25A8%25E3%2581%2597%25E3%2581%25A6%25E5%258F%2597%25E3%2581%2591%25E5%258F%2596%25E3%2582%258B">エンティティセレクションを引数として受け取る例題</a> を参照ください。</p><h2><a aria-hidden="true" class="anchor" id="classFunctions.html_%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88%E3%81%AE%E4%BE%8B%E9%A1%8C"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_%25E3%2583%25AA%25E3%2582%25AF%25E3%2582%25A8%25E3%2582%25B9%25E3%2583%2588%25E3%2581%25AE%25E4%25BE%258B%25E9%25A1%258C"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>リクエストの例題</h2><p>このデータベースは、localhost (ポート8111) 上でリモートデータストアーとして公開されています。</p><p><img alt="alt-text" src="https://developer.4d.com/docs/Rx/assets/en/REST/ordastructure.png" /></p><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_%E3%83%87%E3%83%BC%E3%82%BF%E3%82%B9%E3%83%88%E3%82%A2%E3%83%BC%E3%82%AF%E3%83%A9%E3%82%B9%E9%96%A2%E6%95%B0%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_%25E3%2583%2587%25E3%2583%25BC%25E3%2582%25BF%25E3%2582%25B9%25E3%2583%2588%25E3%2582%25A2%25E3%2583%25BC%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9%25E9%2596%25A2%25E6%2595%25B0%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>データストアークラス関数を使用する</h3><p>US_Cities <code>DataStore</code>クラスは API を提供しています:</p><pre><code class="hljs">// cs.DataStore クラス<span class="hljs-class"><span class="hljs-keyword">Class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">DataStoreImplementation</span></span>exposed <span class="hljs-function"><span class="hljs-keyword">Function</span> <span class="hljs-title">getName</span>(</span>)    <span class="hljs-number">$0</span>:=<span class="hljs-string">"US cities and zip codes manager"</span> </code></pre><p>次のリクエストを実行します:</p><p><strong>POST</strong><code>127.0.0.1:8111/rest/$catalog/getName</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_%E6%88%BB%E3%82%8A%E5%80%A4"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_%25E6%2588%25BB%25E3%2582%258A%25E5%2580%25A4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>戻り値</h4><pre><code class="hljs">{<span class="hljs-attr">"result"</span>: <span class="hljs-string">"US cities and zip codes manager"</span> }</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_dataclass%E3%82%AF%E3%83%A9%E3%82%B9%E9%96%A2%E6%95%B0%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_dataclass%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9%25E9%2596%25A2%25E6%2595%25B0%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>DataClassクラス関数を使用する</h3><p><code>City</code> DataClassクラスは、引数として受け取った名前をもとに City エンティティを返すAPI を提供しています:</p><pre><code class="hljs"><span class="hljs-comment">// cs.City クラス</span><span class="hljs-keyword">Class extends</span> DataClass<span class="hljs-function">exposed Function getCity</span>()<span class="hljs-keyword">    var</span> <span class="hljs-variable">$0 </span>: cs.CityEntity<span class="hljs-keyword">    var</span> <span class="hljs-variable">$1</span>,<span class="hljs-variable">$nameParam </span>: text    <span class="hljs-variable">$nameParam</span>:=<span class="hljs-variable">$1</span>    <span class="hljs-variable">$0</span>:=<span class="hljs-literal">This</span>.<span class="hljs-function">query</span>(<span class="hljs-string">"name = :1"</span>;<span class="hljs-variable">$nameParam</span>).<span class="hljs-function">first</span>()</code></pre><p>次のリクエストを実行します:</p><p><strong>POST</strong><code>127.0.0.1:8111/rest/City/getCity</code></p><p>リクエストのボディ: ["Aguada"]</p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_%E6%88%BB%E3%82%8A%E5%80%A4-1"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_%25E6%2588%25BB%25E3%2582%258A%25E5%2580%25A4-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>戻り値</h4><p>結果は、次のエンティティです:</p><pre><code class="hljs">{    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"City"</span>,    <span class="hljs-attr">"__DATACLASS"</span>: <span class="hljs-string">"City"</span>,    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"1"</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"2020-03-09T08:03:19.923Z"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Aguada"</span>,    <span class="hljs-attr">"countyFIPS"</span>: <span class="hljs-number">72003</span>,    <span class="hljs-attr">"county"</span>: {        <span class="hljs-attr">"__deferred"</span>: {            <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"/rest/County(72003)"</span>,            <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"72003"</span>         }    },    <span class="hljs-attr">"zips"</span>: {        <span class="hljs-attr">"__deferred"</span>: {            <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"/rest/City(1)/zips?$expand=zips"</span>         }    }}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_entity%E3%82%AF%E3%83%A9%E3%82%B9%E9%96%A2%E6%95%B0%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_entity%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9%25E9%2596%25A2%25E6%2595%25B0%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Entityクラス関数を使用する</h3><p><code>CityEntity</code> Entityクラスは API を提供しています:</p><pre><code class="hljs">// cs.CityEntity クラス<span class="hljs-class"><span class="hljs-keyword">Class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Entity</span></span>exposed <span class="hljs-function"><span class="hljs-keyword">Function</span> <span class="hljs-title">getPopulation</span>(</span>)    <span class="hljs-number">$0</span>:=This.zips.sum(<span class="hljs-string">"population"</span>)</code></pre><p>次のリクエストを実行します:</p><p><strong>POST</strong><code>127.0.0.1:8111/rest/City(2)/getPopulation</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_%E6%88%BB%E3%82%8A%E5%80%A4-2"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_%25E6%2588%25BB%25E3%2582%258A%25E5%2580%25A4-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>戻り値</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: <span class="hljs-number">48814</span>}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_entityselection%E3%82%AF%E3%83%A9%E3%82%B9%E9%96%A2%E6%95%B0%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_entityselection%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9%25E9%2596%25A2%25E6%2595%25B0%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>EntitySelectionクラス関数を使用する</h3><p><code>CitySelection</code> EntitySelectionクラスは API を提供しています:</p><pre><code class="hljs">// cs.CitySelection クラス<span class="hljs-class"><span class="hljs-keyword">Class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EntitySelection</span></span>exposed <span class="hljs-function"><span class="hljs-keyword">Function</span> <span class="hljs-title">getPopulation</span>(</span>)    <span class="hljs-number">$0</span>:=This.zips.sum(<span class="hljs-string">"population"</span>)</code></pre><p>次のリクエストを実行します:</p><p><strong>POST</strong><code>127.0.0.1:8111/rest/City/getPopulation/?$filter="ID&lt;3"</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_%E6%88%BB%E3%82%8A%E5%80%A4-3"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_%25E6%2588%25BB%25E3%2582%258A%25E5%2580%25A4-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>戻り値</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: <span class="hljs-number">87256</span>}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_entityselection%E3%82%AF%E3%83%A9%E3%82%B9%E9%96%A2%E6%95%B0%E3%81%A8%E3%82%A8%E3%83%B3%E3%83%86%E3%82%A3%E3%83%86%E3%82%A3%E3%82%BB%E3%83%83%E3%83%88%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_entityselection%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9%25E9%2596%25A2%25E6%2595%25B0%25E3%2581%25A8%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%25BB%25E3%2583%2583%25E3%2583%2588%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>EntitySelectionクラス関数とエンティティセットを使用する</h3><p><code>StudentsSelection</code> クラスは <code>getAgeAverage</code>関数を持ちます:</p><pre><code class="hljs"><span class="hljs-comment">// cs.StudentsSelection クラス</span><span class="hljs-keyword">Class extends</span> EntitySelectionexposed<span class="hljs-keyword"> Function</span> getAgeAverage<span class="hljs-function">    C_LONGINT</span>(<span class="hljs-variable">$sum</span>;<span class="hljs-variable">$0</span>)<span class="hljs-function">    C_OBJECT</span>(<span class="hljs-variable">$s</span>)    <span class="hljs-variable">$sum</span>:=<span class="hljs-number">0</span><span class="hljs-keyword">    For each</span> (<span class="hljs-variable">$s</span>;<span class="hljs-literal">This</span>)        <span class="hljs-variable">$sum</span>:=<span class="hljs-variable">$sum</span>+<span class="hljs-variable">$s</span>.<span class="hljs-function">age</span>()<span class="hljs-keyword">    End for each</span>     <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$sum</span>/<span class="hljs-literal">This</span>.length</code></pre><p>あらかじめ作成した既存のエンティティセットを使い、次のリクエストを実行します:</p><p><strong>POST</strong><code>127.0.0.1:8044/rest/Students/getAgeAverage/$entityset/17E83633FFB54ECDBF947E5C620BB532</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_%E6%88%BB%E3%82%8A%E5%80%A4-4"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_%25E6%2588%25BB%25E3%2582%258A%25E5%2580%25A4-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>戻り値</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: <span class="hljs-number">34</span>}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_entityselection%E3%82%AF%E3%83%A9%E3%82%B9%E9%96%A2%E6%95%B0%E3%81%A8-orderby-%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_entityselection%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9%25E9%2596%25A2%25E6%2595%25B0%25E3%2581%25A8-orderby-%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>EntitySelectionクラス関数と orderBy を使用する</h3><p><code>StudentsSelection</code> クラスは <code>getLastSummary</code>関数を持ちます:</p><pre><code class="hljs"><span class="hljs-comment">// cs.StudentsSelection クラス</span><span class="hljs-keyword">Class extends</span> EntitySelectionexposed<span class="hljs-keyword"> Function</span> getLastSummary<span class="hljs-function">    C_TEXT</span>(<span class="hljs-variable">$0</span>)<span class="hljs-function">    C_OBJECT</span>(<span class="hljs-variable">$last</span>)    <span class="hljs-variable">$last</span>:=<span class="hljs-literal">This</span>.<span class="hljs-function">last</span>()    <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$last</span>.firstname+<span class="hljs-string">" - "</span>+<span class="hljs-variable">$last</span>.lastname+<span class="hljs-string">" is ... "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$last</span>.<span class="hljs-function">age</span>())</code></pre><p>次のリクエストを実行します:</p><p><strong>POST</strong><code>127.0.0.1:8044/rest/Students/getLastSummary/$entityset/?$filter="lastname=b@"&amp;$orderby="lastname"</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_%E6%88%BB%E3%82%8A%E5%80%A4-5"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_%25E6%2588%25BB%25E3%2582%258A%25E5%2580%25A4-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>戻り値</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: <span class="hljs-string">"Wilbert - Bull is ... 21"</span> }</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_%E3%82%A8%E3%83%B3%E3%83%86%E3%82%A3%E3%83%86%E3%82%A3%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E4%25BD%259C%25E6%2588%2590%25E3%2581%2599%25E3%2582%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>エンティティを作成する</h3><p><code>Students</code> DataClassクラスは、データを含むエンティティをクライアントから受け取る<code>pushData()</code> 関数を持ちます。 <code>checkData()</code>メソッドはいくつかの検証を実行します。 問題がなければ、エンティティは保存されて返されます。</p><pre><code class="hljs"><span class="hljs-comment">// cs.Students クラス</span><span class="hljs-keyword">Class extends</span> DataClassexposed<span class="hljs-keyword"> Function</span> pushData<span class="hljs-keyword">    var</span> <span class="hljs-variable">$1</span>, <span class="hljs-variable">$entity</span>, <span class="hljs-variable">$status</span>, <span class="hljs-variable">$0 </span>: Object    <span class="hljs-variable">$entity</span>:=<span class="hljs-variable">$1</span>    <span class="hljs-variable">$status</span>:=<span class="hljs-function">checkData</span>(<span class="hljs-variable">$entity</span>) <span class="hljs-comment">// $status は success ブールプロパティを持つオブジェクトです</span>    <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$status</span><span class="hljs-keyword">    If</span> (<span class="hljs-variable">$status</span>.success)        <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$entity</span>.<span class="hljs-function">save</span>()<span class="hljs-keyword">       If</span> (<span class="hljs-variable">$status</span>.success)           <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$entity</span><span class="hljs-keyword">      End if</span><span class="hljs-keyword">     End if</span></code></pre><p>次のリクエストを実行します:</p><p><strong>POST</strong><code>http://127.0.0.1:8044/rest/Students/pushData</code></p><p>リクエストのボディ:</p><pre><code class="hljs">[{<span class="hljs-attr">"__DATACLASS"</span>:<span class="hljs-string">"Students"</span>,<span class="hljs-attr">"__ENTITY"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"firstname"</span>:<span class="hljs-string">"Ann"</span>,<span class="hljs-attr">"lastname"</span>:<span class="hljs-string">"Brown"</span> }]</code></pre><p><code>__KEY</code> が提供されていないため、サーバー上では<strong>クライアントから受け取った属性を持つ</strong> 新規の Studentsエンティティが読み込まれます。<code>pushData()</code> 関数が <code>save()</code>を実行するため、この新規エンティティは保存されます。</p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_%E6%88%BB%E3%82%8A%E5%80%A4-6"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_%25E6%2588%25BB%25E3%2582%258A%25E5%2580%25A4-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>戻り値</h4><pre><code class="hljs">{    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__DATACLASS"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"55"</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"2020-06-16T10:54:41.805Z"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">55</span>,    <span class="hljs-attr">"firstname"</span>: <span class="hljs-string">"Ann"</span>,    <span class="hljs-attr">"lastname"</span>: <span class="hljs-string">"BROWN"</span>,    <span class="hljs-attr">"schoolID"</span>: <span class="hljs-literal">null</span>,    <span class="hljs-attr">"school"</span>: <span class="hljs-literal">null</span>}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_%E3%82%A8%E3%83%B3%E3%83%86%E3%82%A3%E3%83%86%E3%82%A3%E3%82%92%E6%9B%B4%E6%96%B0%E3%81%99%E3%82%8B"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E6%259B%25B4%25E6%2596%25B0%25E3%2581%2599%25E3%2582%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>エンティティを更新する</h3><p>__KEY 属性を使って、上の例題と同じことをおこなうと、エンティティを更新します。</p><p>次のリクエストを実行します:</p><p><strong>POST:</strong><code>http://127.0.0.1:8044/rest/Students/pushData</code></p><p>リクエストのボディ:</p><pre><code class="hljs">[{<span class="hljs-attr">"__DATACLASS"</span>:<span class="hljs-string">"Students"</span>,<span class="hljs-attr">"__ENTITY"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"lastname"</span>:<span class="hljs-string">"Brownie"</span>,<span class="hljs-attr">"__KEY"</span>:<span class="hljs-number">55</span>}]</code></pre><p><code>__KEY</code> が提供されているため、<strong>クライアントから受け取ったlastname属性値を持つ</strong> プライマリーキーが 55 の Studentsエンティティが読み込まれます。pushData() 関数が <code>save()</code> を実行するため、このエンティティは更新されます。</p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_%E6%88%BB%E3%82%8A%E5%80%A4-7"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_%25E6%2588%25BB%25E3%2582%258A%25E5%2580%25A4-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>戻り値</h4><pre><code class="hljs">{    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__DATACLASS"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"55"</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"2020-06-16T11:10:21.679Z"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">3</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">55</span>,    <span class="hljs-attr">"firstname"</span>: <span class="hljs-string">"Ann"</span>,    <span class="hljs-attr">"lastname"</span>: <span class="hljs-string">"BROWNIE"</span>,    <span class="hljs-attr">"schoolID"</span>: <span class="hljs-literal">null</span>,    <span class="hljs-attr">"school"</span>: <span class="hljs-literal">null</span> }</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_%E3%83%AA%E3%83%AC%E3%83%BC%E3%83%88%E3%82%A8%E3%83%B3%E3%83%86%E3%82%A3%E3%83%86%E3%82%A3%E3%82%92%E6%8C%81%E3%81%A4%E3%82%A8%E3%83%B3%E3%83%86%E3%82%A3%E3%83%86%E3%82%A3%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_%25E3%2583%25AA%25E3%2583%25AC%25E3%2583%25BC%25E3%2583%2588%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E6%258C%2581%25E3%2581%25A4%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E4%25BD%259C%25E6%2588%2590%25E3%2581%2599%25E3%2582%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>リレートエンティティを持つエンティティを作成する</h3><p>プライマリーキー 2 を持つ Schoolsエンティティをリレートエンティティとして、新規Studentsエンティティを作成します。</p><p>次のリクエストを実行します:</p><p><strong>POST:</strong><code>http://127.0.0.1:8044/rest/Students/pushData</code></p><p>リクエストのボディ:</p><pre><code class="hljs">[{<span class="hljs-attr">"__DATACLASS"</span>:<span class="hljs-string">"Students"</span>,<span class="hljs-attr">"__ENTITY"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"firstname"</span>:<span class="hljs-string">"John"</span>,<span class="hljs-attr">"lastname"</span>:<span class="hljs-string">"Smith"</span>,<span class="hljs-attr">"school"</span>:{<span class="hljs-attr">"__KEY"</span>:<span class="hljs-number">2</span>}}]</code></pre><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_%E6%88%BB%E3%82%8A%E5%80%A4-8"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_%25E6%2588%25BB%25E3%2582%258A%25E5%2580%25A4-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>戻り値</h4><pre><code class="hljs">{    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__DATACLASS"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"56"</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"2020-06-16T11:16:47.601Z"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">56</span>,    <span class="hljs-attr">"firstname"</span>: <span class="hljs-string">"John"</span>,    <span class="hljs-attr">"lastname"</span>: <span class="hljs-string">"SMITH"</span>,    <span class="hljs-attr">"schoolID"</span>: <span class="hljs-number">2</span>,       <span class="hljs-attr">"school"</span>: {        <span class="hljs-attr">"__deferred"</span>: {            <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"/rest/Schools(2)"</span>,            <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"2"</span>         }    }}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_%E3%83%AA%E3%83%AC%E3%83%BC%E3%83%88%E3%82%A8%E3%83%B3%E3%83%86%E3%82%A3%E3%83%86%E3%82%A3%E3%82%92%E6%8C%81%E3%81%A4%E3%82%A8%E3%83%B3%E3%83%86%E3%82%A3%E3%83%86%E3%82%A3%E3%82%92%E6%9B%B4%E6%96%B0%E3%81%99%E3%82%8B"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_%25E3%2583%25AA%25E3%2583%25AC%25E3%2583%25BC%25E3%2583%2588%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E6%258C%2581%25E3%2581%25A4%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E6%259B%25B4%25E6%2596%25B0%25E3%2581%2599%25E3%2582%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>リレートエンティティを持つエンティティを更新する</h3><p>既存の Schools エンティティを既存の Studentsエンティティに紐付けます。<code>StudentsEntity</code> クラスは次の API を提供しています:</p><pre><code class="hljs"><span class="hljs-comment">// cs.StudentsEntity クラス</span><span class="hljs-keyword">Class extends</span> Entity<span class="hljs-function">exposed Function putToSchool</span>()<span class="hljs-keyword">    var</span> <span class="hljs-variable">$1</span>, <span class="hljs-variable">$school </span>, <span class="hljs-variable">$0</span>, <span class="hljs-variable">$status </span>: Object        <span class="hljs-comment">// $1 は Schools エンティティ</span>    <span class="hljs-variable">$school</span>:=<span class="hljs-variable">$1</span>        <span class="hljs-comment">// Schools リレートエンティティをカレントの Students エンティティに紐付けます</span>    <span class="hljs-literal">This</span>.school:=<span class="hljs-variable">$school </span><span class="hljs-comment">// このとき、school は N対1リレーション名です</span>    <span class="hljs-variable">$status</span>:=<span class="hljs-literal">This</span>.<span class="hljs-function">save</span>()    <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$status</span></code></pre><p>Studentsエンティティを対象に次のリクエストを実行します:<br /><strong>POST</strong><code>http://127.0.0.1:8044/rest/Students(1)/putToSchool</code><br />リクエストのボディ:</p><pre><code class="hljs">[{<span class="hljs-attr">"__DATACLASS"</span>:<span class="hljs-string">"Schools"</span>,<span class="hljs-attr">"__ENTITY"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"__KEY"</span>:<span class="hljs-number">2</span>}]</code></pre><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_%E6%88%BB%E3%82%8A%E5%80%A4-9"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_%25E6%2588%25BB%25E3%2582%258A%25E5%2580%25A4-9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>戻り値</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: {        <span class="hljs-attr">"success"</span>: <span class="hljs-literal">true</span>    }}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_%E3%82%A8%E3%83%B3%E3%83%86%E3%82%A3%E3%83%86%E3%82%A3%E3%82%BB%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E5%BC%95%E6%95%B0%E3%81%A8%E3%81%97%E3%81%A6%E5%8F%97%E3%81%91%E5%8F%96%E3%82%8B"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%25BB%25E3%2583%25AC%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3%25E3%2582%2592%25E5%25BC%2595%25E6%2595%25B0%25E3%2581%25A8%25E3%2581%2597%25E3%2581%25A6%25E5%258F%2597%25E3%2581%2591%25E5%258F%2596%25E3%2582%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>エンティティセレクションを引数として受け取る</h3><p><code>Students</code> DataClassクラスは、受け取ったエンティティセレクション ($1) を更新する<code>setFinalExam()</code> 関数を持ちます。 実際には、エンティティセレクション内の各エンティティの<em>finalExam</em> 属性値を、2つ目に渡した引数 ($2) に更新します。最後に、更新されたエンティティのプライマリーキーを返します。</p><pre><code class="hljs"><span class="hljs-comment">// cs.Students クラス</span><span class="hljs-keyword">Class extends</span> DataClass<span class="hljs-function">exposed Function setFinalExam</span>()<span class="hljs-keyword">    var</span> <span class="hljs-variable">$1</span>, <span class="hljs-variable">$es</span>, <span class="hljs-variable">$student</span>, <span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">    var</span> <span class="hljs-variable">$2</span>, <span class="hljs-variable">$examResult </span>: Text<span class="hljs-keyword">    var</span> <span class="hljs-variable">$keys</span>, <span class="hljs-variable">$0 </span>: Collection      <span class="hljs-comment">// エンティティセレクション</span>    <span class="hljs-variable">$es</span>:=<span class="hljs-variable">$1</span>    <span class="hljs-variable">$examResult</span>:=<span class="hljs-variable">$2</span>    <span class="hljs-variable">$keys</span>:=<span class="hljs-function">New collection</span>()      <span class="hljs-comment">// エンティティセレクションをループします</span><span class="hljs-keyword">    For each</span> (<span class="hljs-variable">$student</span>;<span class="hljs-variable">$es</span>)        <span class="hljs-variable">$student</span>.finalExam:=<span class="hljs-variable">$examResult</span>        <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$student</span>.<span class="hljs-function">save</span>()<span class="hljs-keyword">        If</span> (<span class="hljs-variable">$status</span>.success)            <span class="hljs-variable">$keys</span>.<span class="hljs-function">push</span>(<span class="hljs-variable">$student</span>.ID)<span class="hljs-keyword">        End if</span><span class="hljs-keyword">     End for each</span>     <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$keys</span></code></pre><p>次のようなリクエストでエンティティセットをあらかじめ作成します:</p><p><code>http://127.0.0.1:8044/rest/Students/?$filter="ID&lt;3"&amp;$method=entityset</code></p><p>次のリクエストを実行します:</p><p><strong>POST</strong><code>http://127.0.0.1:8044/rest/Students/setFinalExam</code></p><p>リクエストのボディ:</p><pre><code class="hljs">[{<span class="hljs-attr">"__ENTITIES"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"__DATASET"</span>:<span class="hljs-string">"9B9C053A111E4A288E9C1E48965FE671"</span> },<span class="hljs-string">"Passed"</span> ]</code></pre><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_%E6%88%BB%E3%82%8A%E5%80%A4-10"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_%25E6%2588%25BB%25E3%2582%258A%25E5%2580%25A4-10"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>戻り値</h4><p>プライマリーキー 1と2 のエンティティが更新されました:</p><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: [        <span class="hljs-number">1</span>,        <span class="hljs-number">2</span>    ]}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E5%81%B4%E3%81%A7%E6%9B%B4%E6%96%B0%E3%81%95%E3%82%8C%E3%81%9F%E3%82%A8%E3%83%B3%E3%83%86%E3%82%A3%E3%83%86%E3%82%A3%E3%82%BB%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25A4%25E3%2582%25A2%25E3%2583%25B3%25E3%2583%2588%25E5%2581%25B4%25E3%2581%25A7%25E6%259B%25B4%25E6%2596%25B0%25E3%2581%2595%25E3%2582%258C%25E3%2581%259F%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%25BB%25E3%2583%25AC%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>クライアント側で更新されたエンティティセレクションを使用する</h3><p><a href="#classFunctions.html_EntitySelection%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9%25E9%2596%25A2%25E6%2595%25B0%25E3%2581%25A8%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%25BB%25E3%2583%2583%25E3%2583%2588%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B">前述</a> の <code>getAgeAverage()</code> 関数を使います。</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$remoteDS</span>, <span class="hljs-variable">$newStudent</span>, <span class="hljs-variable">$students </span>: Object<span class="hljs-keyword">var</span> <span class="hljs-variable">$ageAverage </span>: Integer<span class="hljs-variable">$remoteDS</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"hostname"</span>;<span class="hljs-string">"127.0.0.1:8044"</span>);<span class="hljs-string">"students"</span>)<span class="hljs-comment">// $newStudent は処理する Studentsエンティティです</span><span class="hljs-variable">$newStudent</span>:=...<span class="hljs-variable">$students</span>:=<span class="hljs-variable">$remoteDS</span>.Students.<span class="hljs-function">query</span>(<span class="hljs-string">"school.name = :1"</span>;<span class="hljs-string">"Math school"</span>)<span class="hljs-comment">// クライアント側で $students エンティティセレクションにエンティティを追加します</span><span class="hljs-variable">$students</span>.<span class="hljs-function">add</span>(<span class="hljs-variable">$newStudent</span>) <span class="hljs-comment">// StudentsSelectionクラスに対して、同セレクション内の生徒エンティティの平均年齢を返す関数を呼び出します</span><span class="hljs-comment">// この関数は、クライアント側の追加エンティティを含む更新された内容の $students エンティティセレクションに対して、サーバー上で実行されます</span><span class="hljs-variable">$ageAverage</span>:=<span class="hljs-variable">$students</span>.<span class="hljs-function">getAgeAverage</span>()</code></pre></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#manData.html"><span class="arrow-prev">←</span><span>データ操作</span></a><a class="docs-next button" href="#REST_requests.html"><span>RESTリクエストについて</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#classFunctions.html_%25E9%2596%25A2%25E6%2595%25B0%25E3%2581%25AE%25E5%2591%25BC%25E3%2581%25B3%25E5%2587%25BA%25E3%2581%2597">関数の呼び出し</a></li><li><a href="#classFunctions.html_%25E5%25BC%2595%25E6%2595%25B0">引数</a><ul class="toc-headings"><li><a href="#classFunctions.html_%25E3%2582%25B9%25E3%2582%25AB%25E3%2583%25A9%25E3%2583%25BC%25E5%2580%25A4%25E3%2581%25AE%25E5%25BC%2595%25E6%2595%25B0">スカラー値の引数</a></li><li><a href="#classFunctions.html_%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E5%25BC%2595%25E6%2595%25B0">エンティティ引数</a></li><li><a href="#classFunctions.html_%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%25BB%25E3%2583%25AC%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3%25E5%25BC%2595%25E6%2595%25B0">エンティティセレクション引数</a></li></ul></li><li><a href="#classFunctions.html_%25E3%2583%25AA%25E3%2582%25AF%25E3%2582%25A8%25E3%2582%25B9%25E3%2583%2588%25E3%2581%25AE%25E4%25BE%258B%25E9%25A1%258C">リクエストの例題</a><ul class="toc-headings"><li><a href="#classFunctions.html_%25E3%2583%2587%25E3%2583%25BC%25E3%2582%25BF%25E3%2582%25B9%25E3%2583%2588%25E3%2582%25A2%25E3%2583%25BC%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9%25E9%2596%25A2%25E6%2595%25B0%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B">データストアークラス関数を使用する</a></li><li><a href="#classFunctions.html_dataclass%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9%25E9%2596%25A2%25E6%2595%25B0%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B">DataClassクラス関数を使用する</a></li><li><a href="#classFunctions.html_entity%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9%25E9%2596%25A2%25E6%2595%25B0%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B">Entityクラス関数を使用する</a></li><li><a href="#classFunctions.html_entityselection%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9%25E9%2596%25A2%25E6%2595%25B0%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B">EntitySelectionクラス関数を使用する</a></li><li><a href="#classFunctions.html_entityselection%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9%25E9%2596%25A2%25E6%2595%25B0%25E3%2581%25A8%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%25BB%25E3%2583%2583%25E3%2583%2588%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B">EntitySelectionクラス関数とエンティティセットを使用する</a></li><li><a href="#classFunctions.html_entityselection%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25B9%25E9%2596%25A2%25E6%2595%25B0%25E3%2581%25A8-orderby-%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B">EntitySelectionクラス関数と orderBy を使用する</a></li><li><a href="#classFunctions.html_%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E4%25BD%259C%25E6%2588%2590%25E3%2581%2599%25E3%2582%258B">エンティティを作成する</a></li><li><a href="#classFunctions.html_%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E6%259B%25B4%25E6%2596%25B0%25E3%2581%2599%25E3%2582%258B">エンティティを更新する</a></li><li><a href="#classFunctions.html_%25E3%2583%25AA%25E3%2583%25AC%25E3%2583%25BC%25E3%2583%2588%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E6%258C%2581%25E3%2581%25A4%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E4%25BD%259C%25E6%2588%2590%25E3%2581%2599%25E3%2582%258B">リレートエンティティを持つエンティティを作成する</a></li><li><a href="#classFunctions.html_%25E3%2583%25AA%25E3%2583%25AC%25E3%2583%25BC%25E3%2583%2588%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E6%258C%2581%25E3%2581%25A4%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%2592%25E6%259B%25B4%25E6%2596%25B0%25E3%2581%2599%25E3%2582%258B">リレートエンティティを持つエンティティを更新する</a></li><li><a href="#classFunctions.html_%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%25BB%25E3%2583%25AC%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3%25E3%2582%2592%25E5%25BC%2595%25E6%2595%25B0%25E3%2581%25A8%25E3%2581%2597%25E3%2581%25A6%25E5%258F%2597%25E3%2581%2591%25E5%258F%2596%25E3%2582%258B">エンティティセレクションを引数として受け取る</a></li><li><a href="#classFunctions.html_%25E3%2582%25AF%25E3%2583%25A9%25E3%2582%25A4%25E3%2582%25A2%25E3%2583%25B3%25E3%2583%2588%25E5%2581%25B4%25E3%2581%25A7%25E6%259B%25B4%25E6%2596%25B0%25E3%2581%2595%25E3%2582%258C%25E3%2581%259F%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%25BB%25E3%2583%25AC%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B">クライアント側で更新されたエンティティセレクションを使用する</a></li></ul></li></ul></nav></div></div></body></html>