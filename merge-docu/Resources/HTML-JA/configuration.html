<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="ja"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>サーバー設定 · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="4D の RESTサーバーは、標準の HTTPリクエストを用いて外部アプリケーションがアプリケーションのデータにアクセスすることを可能にします。つまり、プロジェクトのデータクラス情報を取得したり、データを操作したり、Webアプリケーションにログインしたり、といったことが可能です。"name="description" /><meta content="ja" name="docsearch:language" /><meta content="サーバー設定 · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="4D の RESTサーバーは、標準の HTTPリクエストを用いて外部アプリケーションがアプリケーションのデータにアクセスすることを可能にします。つまり、プロジェクトのデータクラス情報を取得したり、データを操作したり、Webアプリケーションにログインしたり、といったことが可能です。"property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#configuration.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">サーバー設定<a aria-hidden="true" class="anchor" id="configuration.html"></a></h1></header><article><div><p><span>4D の RESTサーバーは、標準のHTTPリクエストを用いて外部アプリケーションがアプリケーションのデータにアクセスすることを可能にします。つまり、プロジェクトのデータクラス情報を取得したり、データを操作したり、Webアプリケーションにログインしたり、といったことが可能です。</span></p><p><span>REST機能を使い始めるまえに、まずは 4D RESTサーバーの設定をおこない、これを起動させる必要があります。</span></p><blockquote><ul><li><span>4D Server上では、開かれる RESTセッションにつき、4D Clientライセンスが1消費されます。<br /></span></li><li><span>シングルユーザーの4D上では、テスト目的で RESTセッションを 3つ開くことができます。</span></li><li><span>リクエストをおこなうアプリケーションの <a href="#authUsers.html">セッション</a>は別途管理する必要があります。</span></li></ul></blockquote><h2><span><a aria-hidden="true" class="anchor" id="configuration.html_rest%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%82%92%E9%96%8B%E5%A7%8B%E3%81%99%E3%82%8B"></a><a aria-hidden="true" class="hash-link" href="#configuration.html_rest%25E3%2582%25B5%25E3%2583%25BC%25E3%2583%2590%25E3%2583%25BC%25E3%2582%2592%25E9%2596%258B%25E5%25A7%258B%25E3%2581%2599%25E3%2582%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>RESTサーバーを開始する</span></h2><p><span>セキュリティ上の理由により、デフォルトでは、4D は RESTリクエストに応答しません。RESTサーバーを開始し、RESTリクエストを処理するには、<strong>ストラクチャー設定</strong> の<strong>Web</strong> ＞ <strong>Web機能</strong>ページにて、<strong>RESTサーバーとして公開</strong> オプションを有効化する必要があります。</span></p><p><span><img alt="alt-text" src="https://developer.4d.com/docs/Rx/assets/en/REST/Settings.png" /></span></p><blockquote><p><span>RESTサービスは 4D の HTTPサーバーを使用するため、4DWebサーバーが開始されていることを確認してください。</span></p></blockquote><p><span>このオプションが有効化されると、「警告:アクセス権が正しく設定されているか確認してください。」という警告メッセージが表示されます。これはREST接続の認証設定がされていない限り、デフォルトではデータベースオブジェクトに自由にアクセスできてしまうためです。</span></p><blockquote><p><span>変更を反映するには、4Dアプリケーションを再起動する必要があります。</span></p></blockquote><h2><span><a aria-hidden="true" class="anchor" id="configuration.html_%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E6%A8%A9%E3%81%AE%E8%A8%AD%E5%AE%9A"></a><a aria-hidden="true" class="hash-link" href="#configuration.html_%25E3%2582%25A2%25E3%2582%25AF%25E3%2582%25BB%25E3%2582%25B9%25E6%25A8%25A9%25E3%2581%25AE%25E8%25A8%25AD%25E5%25AE%259A"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>アクセス権の設定</span></h2><p><span>デフォルトでは、REST接続はすべてのユーザーに対してオープンですが、この状態はライセンス管理上もセキュリティ上も推奨されません。</span></p><p><span>REST接続は次の方法で制限することができます:</span></p><ul><li><span>ストラクチャー設定の "<strong>Web</strong> ＞<strong>Web機能</strong>" ページにて、RESTサービスに割り当てる<strong>読み込み/書き出し</strong> ユーザーグループを設定します;</span></li><li><span><code>On REST Authentication</code>データベースメソッドに、RESTの初期リクエストを処理するコードを書きます。</span></li></ul><blockquote><p><span>上に挙げた 2つの方法を同時に使用することはできません。 <code>On RESTAuthentication</code> データベースメソッドを定義した場合、4D はRESTリクエストの処理を同メソッドに委ねます。 つまり、ストラクチャー設定の "<strong>Web</strong> ＞<strong>Web機能</strong>" ページにて指定した "読み込み/書き出し"の設定は無視されます。</span></p></blockquote><h3><span><a aria-hidden="true" class="anchor" id="configuration.html_%E3%82%B9%E3%83%88%E3%83%A9%E3%82%AF%E3%83%81%E3%83%A3%E3%83%BC%E8%A8%AD%E5%AE%9A%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B"></a><a aria-hidden="true" class="hash-link" href="#configuration.html_%25E3%2582%25B9%25E3%2583%2588%25E3%2583%25A9%25E3%2582%25AF%25E3%2583%2581%25E3%2583%25A3%25E3%2583%25BC%25E8%25A8%25AD%25E5%25AE%259A%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>ストラクチャー設定を使用する</span></h3><p><span>ストラクチャー設定の "<strong>Web</strong> ＞ <strong>Web機能</strong>"ページにある <strong>読み込み/書き出し</strong> 設定は、RESTクエリを使って4Dアプリケーションへのリンクを設立することのできる 4Dユーザーのグループを指定します。</span></p><p><span>デフォルトでは、メニューには <strong>&lt;Anyone&gt;</strong>が選択されています。これは、REST接続はすべてのユーザーに対してオープンであるという状態を示しています。グループを指定すると、そのグループに所属する 4Dユーザーアカウントのみが <a href="#authUsers.html">RESTリクエストを通して 4D にアクセス</a> できるようになります。このグループに所属していないアカウントの場合、4D はリクエストの送信者に対して認証エラーを返します。</span></p><blockquote><p><span>この設定を使用するには、<code>On REST Authentication</code>データベースメソッドを定義してはいけません。これが定義されている場合は、ストラクチャー設定にて指定したアクセス設定は無視されます。</span></p></blockquote><h3><span><a aria-hidden="true" class="anchor" id="configuration.html_on-rest-authentication-%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B"></a><a aria-hidden="true" class="hash-link" href="#configuration.html_on-rest-authentication-%25E3%2583%2587%25E3%2583%25BC%25E3%2582%25BF%25E3%2583%2599%25E3%2583%25BC%25E3%2582%25B9%25E3%2583%25A1%25E3%2582%25BD%25E3%2583%2583%25E3%2583%2589%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>On REST Authentication データベースメソッドを使用する</span></h3><p><span><code>On REST Authentication</code> データベースメソッド は 4D 上でRESTセッションの開始を管理するための方法を提供します。RESTリクエストによって新規セッションが開始される際、このデータベースメソッドは自動的に呼び出されます。 <a href="#authUsers.html">RESTセッション開始のリクエスト</a>を受信すると、そのリクエストヘッダーには接続の識別子が含まれています。 これらの識別子を評価するために <code>On RESTAuthentication</code> データベースメソッドは呼び出されます。評価にあたっては、4Dアプリケーションのユーザーリストを使用することもできますし、独自の識別子のテーブルを使用することもできます。詳細については <code>On REST Authentication</code> データベースメソッドの <a href="https://doc.4d.com/4Dv18/4D/18/On-REST-Authentication-database-method.301-4505004.ja.html">ドキュメンテーション</a> を参照ください。</span></p><h2><span><a aria-hidden="true" class="anchor" id="configuration.html_%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%82%84%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89%E3%81%AE%E5%85%AC%E9%96%8B"></a><a aria-hidden="true" class="hash-link" href="#configuration.html_%25E3%2583%2586%25E3%2583%25BC%25E3%2583%2596%25E3%2583%25AB%25E3%2582%2584%25E3%2583%2595%25E3%2582%25A3%25E3%2583%25BC%25E3%2583%25AB%25E3%2583%2589%25E3%2581%25AE%25E5%2585%25AC%25E9%2596%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>テーブルやフィールドの公開</span></h2><p><span>4Dアプリケーションの RESTサービスが有効化されると、<a href="#configuration.html_%25E3%2583%2587%25E3%2583%25BC%25E3%2582%25BF%25E3%2582%25B9%25E3%2583%2588%25E3%2582%25A2">データストアインターフェース</a>を通して 4Dデータベースのすべてのテーブルとフィールドおよび格納データが RESTセッションによってデフォルトでアクセス可能です。つまり、すべてのデータにアクセス可能ということです。 たとえば、データベースに [Employee]テーブルが含まれている場合、次のように書くことができます:</span></p><pre><span><code class="hljs"><span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/127.0.0.1:8044/rest</span><span class="hljs-regexp">/Employee/</span>?<span class="hljs-variable">$filter</span>=<span class="hljs-string">"salary&gt;10000"</span></code></span></pre><p>このリクエストで、salary (給与) フィールドが 10000以上の社員データが取得されます。</p><blockquote><p>"非表示" 属性を選択されたテーブルやフィールドも、デフォルトで REST に公開されています。</p></blockquote><p>REST 経由でアクセス可能なデータストアオブジェクトを制限するには、アクセス不可にするテーブルやフィールドについて"RESTリソースとして公開" オプションを選択解除する必要があります。 許可されていないリソースへのRESTリクエストがあった場合、4Dはエラーを返します。</p><h3><a aria-hidden="true" class="anchor" id="configuration.html_%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%AE%E5%85%AC%E9%96%8B"></a><a aria-hidden="true" class="hash-link" href="#configuration.html_%25E3%2583%2586%25E3%2583%25BC%25E3%2583%2596%25E3%2583%25AB%25E3%2581%25AE%25E5%2585%25AC%25E9%2596%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>テーブルの公開</h3><p>デフォルトでは、すべてのテーブルが REST に公開されています。</p><p>セキュリティ上の理由から、データベースの一部のテーブルのみを公開したい状況もあるでしょう。 たとえば、[Users]テーブルを作成し、その中にユーザー名とパスワードが保存されている場合、そのテーブルは公開しない方が賢明でしょう。</p><p>テーブルを公開したくない場合は:</p><ol><li><p>ストラクチャーエディターにて対象となるテーブルを選択し、右クリックでコンテキストメニューを開いてテーブルプロパティを選択します。</p></li><li><p><strong>RESTリソースとして公開</strong> オプションの選択を解除します: <img alt="alt-text" src="https://developer.4d.com/docs/Rx/assets/en/REST/table.png" />公開設定を変更する各テーブルに対して、この手順を繰り返します。</p></li></ol><h3><a aria-hidden="true" class="anchor" id="configuration.html_%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89%E3%81%AE%E5%85%AC%E9%96%8B"></a><a aria-hidden="true" class="hash-link" href="#configuration.html_%25E3%2583%2595%25E3%2582%25A3%25E3%2583%25BC%25E3%2583%25AB%25E3%2583%2589%25E3%2581%25AE%25E5%2585%25AC%25E9%2596%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>フィールドの公開</h3><p>デフォルトでは、すべての 4Dデータベースフィールドが REST に公開されています。</p><p>テーブルの一部のフィールドのみを非公開にしたい状況もあるでしょう。 たとえば、[Employees]Salaryのようなフィールドは非公開の方がよいでしょう。</p><p>フィールドを非公開にするには:</p><ol><li><p>ストラクチャーエディターにて対象となるフィールドを選択し、右クリックでコンテキストメニューを開いてフィールドプロパティを選択します。</p></li><li><p>フィールドの <strong>RESTリソースとして公開</strong> オプションの選択を解除します: <img alt="alt-text" src="https://developer.4d.com/docs/Rx/assets/en/REST/field.png" />公開設定を変更する各フィールドに対して、この手順を繰り返します。</p></li></ol><blockquote><p>あるフィールドが REST を通してアクセス可能であるためには、その親テーブルも公開されている必要があります。親テーブルが公開されていない場合、各フィールドの公開設定に関わらず、すべてのフィールドがアクセス不可になります。</p></blockquote></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#gettingStarted.html"><span class="arrow-prev">←</span><span>はじめに</span></a><a class="docs-next button" href="#authUsers.html"><span>ユーザーとセッション</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#configuration.html_rest%25E3%2582%25B5%25E3%2583%25BC%25E3%2583%2590%25E3%2583%25BC%25E3%2582%2592%25E9%2596%258B%25E5%25A7%258B%25E3%2581%2599%25E3%2582%258B">RESTサーバーを開始する</a></li><li><a href="#configuration.html_%25E3%2582%25A2%25E3%2582%25AF%25E3%2582%25BB%25E3%2582%25B9%25E6%25A8%25A9%25E3%2581%25AE%25E8%25A8%25AD%25E5%25AE%259A">アクセス権の設定</a><ul class="toc-headings"><li><a href="#configuration.html_%25E3%2582%25B9%25E3%2583%2588%25E3%2583%25A9%25E3%2582%25AF%25E3%2583%2581%25E3%2583%25A3%25E3%2583%25BC%25E8%25A8%25AD%25E5%25AE%259A%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B">ストラクチャー設定を使用する</a></li><li><a href="#configuration.html_on-rest-authentication-%25E3%2583%2587%25E3%2583%25BC%25E3%2582%25BF%25E3%2583%2599%25E3%2583%25BC%25E3%2582%25B9%25E3%2583%25A1%25E3%2582%25BD%25E3%2583%2583%25E3%2583%2589%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B">On REST Authentication データベースメソッドを使用する</a></li></ul></li><li><a href="#configuration.html_%25E3%2583%2586%25E3%2583%25BC%25E3%2583%2596%25E3%2583%25AB%25E3%2582%2584%25E3%2583%2595%25E3%2582%25A3%25E3%2583%25BC%25E3%2583%25AB%25E3%2583%2589%25E3%2581%25AE%25E5%2585%25AC%25E9%2596%258B">テーブルやフィールドの公開</a><ul class="toc-headings"><li><a href="#configuration.html_%25E3%2583%2586%25E3%2583%25BC%25E3%2583%2596%25E3%2583%25AB%25E3%2581%25AE%25E5%2585%25AC%25E9%2596%258B">テーブルの公開</a></li><li><a href="#configuration.html_%25E3%2583%2595%25E3%2582%25A3%25E3%2583%25BC%25E3%2583%25AB%25E3%2583%2589%25E3%2581%25AE%25E5%2585%25AC%25E9%2596%258B">フィールドの公開</a></li></ul></li></ul></nav></div></div></body></html>