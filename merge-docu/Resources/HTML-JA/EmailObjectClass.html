<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="ja"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Email · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="4Dにおけるメールの作成・送信・受信は `Email` オブジェクトの操作よっておこなわれます。"name="description" /><meta content="ja" name="docsearch:language" /><meta content="Email · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="4Dにおけるメールの作成・送信・受信は `Email` オブジェクトの操作よっておこなわれます。"property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#EmailObjectClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">Email<a aria-hidden="true" class="anchor" id="EmailObjectClass.html"></a></h1></header><article><div><p><span>4Dにおけるメールの作成・送信・受信は <code>Email</code>オブジェクトの操作よっておこなわれます。</span></p><p><span><em>transporter</em> クラス関数を使ってメールを取得する際に、<code>Email</code> オブジェクトが作成されます。</span></p><ul><li><span>IMAP - <a href="#EmailObjectClass.html_getmail"><code>.getMail()</code></a> および<a href="#EmailObjectClass.html_getmails"><code>.getMails()</code></a> 関数はIMAPサーバーからメールを受信します。</span></li><li><span>POP3 - <a href="#EmailObjectClass.html_getmail"><code>.getMail()</code></a> 関数はPOP3サーバーからメールを受信します。</span></li></ul><blockquote><p><span>また、<a href="https://doc.4d.com/4dv18/help/command/en/page1471.html"><code>Newobject</code></a> 4Dコマンドを使って新規かつ空の <code>Email</code>オブジェクトを作成してから、<a href="#EmailObjectClass.html_email-%25E3%2582%25AA%25E3%2583%2596%25E3%2582%25B8%25E3%2582%25A7%25E3%2582%25AF%25E3%2583%2588">Emailオブジェクトプロパティ</a> を設定していくことも可能です。</span></p></blockquote><p><span><code>Email</code> オブジェクトは SMTP <a href="#EmailObjectClass.html_send"><code>.send()</code></a>関数を使って送信します。</span></p><p><span><a href="#EmailObjectClass.html_mail-convert-from-mime"><code>MAIL Convertfrom MIME</code></a> および <a href="#EmailObjectClass.html_mail-convert-to-mime"><code>MAIL Convert toMIME</code></a> コマンドは、MIME コンテンツから <code>Email</code>オブジェクトに、またはその逆の変換をおこなうのに使用できます。</span></p><h3><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_email-%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_email-%25E3%2582%25AA%25E3%2583%2596%25E3%2582%25B8%25E3%2582%25A7%25E3%2582%25AF%25E3%2583%2588"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Email オブジェクト</span></h3><p><span>Email オブジェクトは次のプロパティを提供します:</span></p><blockquote><p><span>4D は Email オブジェクトのフォーマットは <a href="https://jmap.io/spec-mail.html">JMAP specification</a>に準拠します。</span></p></blockquote><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#EmailObjectClass.html_attachments"><strong>.attachments</strong>: Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<code>4D.MailAttachment</code>オブジェクトのコレクション</p></td></tr><tr><td><a href="#EmailObjectClass.html_bcc"><strong>.bcc</strong> :Text<br /><strong>.bcc</strong> : Object<br /><strong>.bcc</strong> : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;非表示 (BCC: Blind Carbon Copy) のメール受信者<a href="#EmailObjectClass.html_email-addresses">アドレス</a></p></td></tr><tr><td><a href="#EmailObjectClass.html_bodystructure"><strong>.bodyStructure</strong>: Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;(任意) メッセージ本文の完全なMIME ストラクチャーである<em>EmailBodyPart</em> オブジェクト</p></td></tr><tr><td><a href="#EmailObjectClass.html_bodyvalues"><strong>.bodyValues</strong> :Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;(任意) <code>bodyStructure</code> の&lt;partID&gt; 毎にオブジェクトを格納している <em>EmailBodyValue</em> オブジェクト</p></td></tr><tr><td><a href="#EmailObjectClass.html_cc"><strong>.cc</strong> :Text<br /><strong>.cc</strong> : Object<br /><strong>.cc</strong> : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;追加 (CC: Carbon Copy) のメール受信者 <a href="#EmailObjectClass.html_email-addresses">アドレス</a></p></td></tr><tr><td><a href="#EmailObjectClass.html_comments"><strong>.comments</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;追加のコメントのヘッダー</p></td></tr><tr><td><a href="#EmailObjectClass.html_from"><strong>.from</strong> :Text<br /><strong>.from</strong> : Object<br /><strong>.from</strong> : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;メールの送信元 <a href="#EmailObjectClass.html_email-addresses">アドレス</a></p></td></tr><tr><td><a href="#EmailObjectClass.html_headers"><strong>.headers</strong> :Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;メッセージ内で現れる順番どおりの<code>EmailHeader</code> オブジェクトのコレクション</p></td></tr><tr><td><a href="#EmailObjectClass.html_htmlbody"><strong>.htmlBody</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;(任意、SMTPのみ) HTML形式のメールメッセージ(デフォルトの文字セットは UTF-8)</p></td></tr><tr><td><a href="#EmailObjectClass.html_id"><strong>.id</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;IMAP サーバーからの固有ID</p></td></tr><tr><td><a href="#EmailObjectClass.html_inreplyto"><strong>.inReplyTo</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;カレントメッセージが返信している、元のメッセージのメッセージID</p></td></tr><tr><td><a href="#EmailObjectClass.html_keywords"><strong>.keywords</strong> :Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;各プロパティ名がキーワードであり、各値が trueであるキーワードセットのオブジェクト</p></td></tr><tr><td><a href="#EmailObjectClass.html_messageid"><strong>.messageId</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;メッセージ識別ヘッダー ("message-id")</p></td></tr><tr><td><a href="#EmailObjectClass.html_receivedat"><strong>.receivedAt</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;IMAPサーバーにメールが到着した時間の、ISO 8601 UTCフォーマットでのタイムスタンプ (例: 2020-09-13T16:11:53Z)</p></td></tr><tr><td><a href="#EmailObjectClass.html_references"><strong>.references</strong> :Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;返信チェーン内メッセージの、全メッセージID のコレクション</p></td></tr><tr><td><a href="#EmailObjectClass.html_replyto"><strong>.replyTo</strong> :Text<br /><strong>.replyTo</strong> : Object<br /><strong>.replyTo</strong> : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;返信用 <a href="#EmailObjectClass.html_email-addresses">アドレス</a></p></td></tr><tr><td><a href="#EmailObjectClass.html_sendat"><strong>.sendAt</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;メールのタイムスタンプ (ISO 8601 UTCフォーマット)</p></td></tr><tr><td><a href="#EmailObjectClass.html_sender"><strong>.sender</strong> :Text<br /><strong>.sender</strong> : Object<br /><strong>.sender</strong> : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;メールのソース <a href="#EmailObjectClass.html_email-addresses">アドレス</a></p></td></tr><tr><td><a href="#EmailObjectClass.html_size"><strong>.size</strong> :Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;IMAPサーバーから返された Email オブジェクトのサイズ(バイト単位)</p></td></tr><tr><td><a href="#EmailObjectClass.html_subject"><strong>.subject</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;メールの件名</p></td></tr><tr><td><a href="#EmailObjectClass.html_textbody"><strong>.textBody</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;(任意、SMTPのみ) 標準テキスト形式のメールメッセージ(デフォルトの文字セットは UTF-8)</p></td></tr><tr><td><a href="#EmailObjectClass.html_to"><strong>.to</strong> :Text<br /><strong>.to</strong> : Object<br /><strong>.to</strong> : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;メールのメインの受信者 <a href="#EmailObjectClass.html_%25E3%2583%25A1%25E3%2583%25BC%25E3%2583%25AB%25E3%2582%25A2%25E3%2583%2589%25E3%2583%25AC%25E3%2582%25B9">アドレス</a></p></td></tr></tbody></table><h3><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E3%83%A1%E3%83%BC%E3%83%AB%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E3%2583%25A1%25E3%2583%25BC%25E3%2583%25AB%25E3%2582%25A2%25E3%2583%2589%25E3%2583%25AC%25E3%2582%25B9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>メールアドレス</span></h3><p><span>メールアドレスを格納するプロパティ (<a href="#EmailObjectClass.html_from"><code>from</code></a>, <a href="#EmailObjectClass.html_cc"><code>cc</code></a>, <a href="#EmailObjectClass.html_bcc"><code>bcc</code></a>, <a href="#EmailObjectClass.html_to"><code>to</code></a>, <a href="#EmailObjectClass.html_sender"><code>sender</code></a>, <a href="#EmailObjectClass.html_replyto"><code>replyTo</code></a>)はすべて、テキスト・オブジェクト・コレクション型の値を受け付けます。</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_%25E3%2583%2586%25E3%2582%25AD%25E3%2582%25B9%25E3%2583%2588"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>テキスト</span></h4><ul><li><span>単一のメールアドレス: "<a href="mailto:somebody@domain.com">somebody@domain.com</a>"</span></li><li><span>単一の表示名+メールアドレス: "Somebody <a href="mailto:somebody@domain.com">somebody@domain.com</a>"</span></li><li><span>複数のメールアドレス: "Somebody <a href="mailto:somebody@domain.com">somebody@domain.com</a>,<a href="mailto:me@home.org">me@home.org</a>"</span></li></ul><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E3%2582%25AA%25E3%2583%2596%25E3%2582%25B8%25E3%2582%25A7%25E3%2582%25AF%25E3%2583%2588"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>オブジェクト</span></h4><p><span>2つのプロパティを持つオブジェクト:</span></p><table><thead><tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>name</td><td>Text</td><td>表示名 (null も可能)</td></tr><tr><td>email</td><td>Text</td><td>メールアドレス</td></tr></tbody></table><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E3%2582%25B3%25E3%2583%25AC%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>コレクション</span></h4><p><span>アドレスオブジェクトのコレクション</span></p><h3><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E3%83%A1%E3%83%BC%E3%83%AB%E6%9C%AC%E6%96%87%E3%81%AE%E6%89%B1%E3%81%84"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E3%2583%25A1%25E3%2583%25BC%25E3%2583%25AB%25E6%259C%25AC%25E6%2596%2587%25E3%2581%25AE%25E6%2589%25B1%25E3%2581%2584"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>メール本文の扱い</span></h3><p><span><a href="#EmailObjectClass.html_textbody"><code>textBody</code></a> および<a href="#EmailObjectClass.html_htmlbody"><code>htmlBody</code></a>はどちらも<a href="#EmailObjectClass.html_send">SMTP.send()</a>でのみ使用され、これによって単純なメールの送信が可能になります。 プロパティが両方ともある場合、MIME content-type のmultipart/alternative が使用されます。 メールクライアントは multipart/alternativeパートを認識し、必要に応じてテキスト部または html 部を表示します。</span></p><p><span><a href="email-%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88">Emailオブジェクト</a> が MIME ドキュメントからビルドされた場合 (例: <code>MAIL Convert fromMIME</code> コマンドで生成されたとき) は、<a href="#EmailObjectClass.html_bodystructure"><code>bodyStructure</code></a>および <a href="#EmailObjectClass.html_bodyvalues"><code>bodyValues</code></a> が<a href="#SMTPTransporterClass.html">SMTP</a> に使用されます。この場合、<code>bodyStructure</code> および <code>bodyValues</code>プロパティは両方一緒に渡される必要があり、<code>textBody</code> および<code>htmlBody</code> の使用は推奨されません。</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_bodystructure-%E3%81%8A%E3%82%88%E3%81%B3-bodyvalues-%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BE%8B"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_bodystructure-%25E3%2581%258A%25E3%2582%2588%25E3%2581%25B3-bodyvalues-%25E3%2582%25AA%25E3%2583%2596%25E3%2582%25B8%25E3%2582%25A7%25E3%2582%25AF%25E3%2583%2588%25E3%2581%25AE%25E4%25BE%258B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>bodyStructure および bodyValues オブジェクトの例</span></h4><pre><span><code class="hljs css language-json">"bodyStructure": {  "type": "multipart/mixed",  "subParts": [    {      "partId": "p0001",      "type": "text/plain"    },    {      "partId": "p0002",      "type": "text/html"    }  ]},"bodyValues": {  "p0001": {    "value": "I have the most brilliant plan. Let me tell you all about it."  },  "p0002": {    "value": "&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;&lt;/title&gt;&lt;style type=\"text/css\"&gt;div{font-size:16px}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div&gt;I have the most brilliant plan. Let me tell you all about it.&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;"  }}</code></span></pre><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_attachments"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_attachments"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.attachments</span></h2><p><span><strong>.attachments</strong> : Collection</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</span></h4><p><span><code>.attachments</code> プロパティは、<code>4D.MailAttachment</code> オブジェクトのコレクションを格納します。</span></p><p><span>MailAttachment オブジェクトは <a href="#EmailObjectClass.html_mail-new-attachment"><code>MAIL Newattachment</code></a> コマンドによって定義されます。 MailAttachment オブジェクトは特有の<a href="#MailAttachmentClass.html">プロパティや関数</a> を持ちます。</span></p><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_bcc"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_bcc"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.bcc</span></h2><p><span><strong>.bcc</strong> : Text<br /><strong>.bcc</strong> : Object<br /><strong>.bcc</strong> : Collection</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-1"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</span></h4><p><span><code>.bcc</code> プロパティは、 非表示 (BCC: Blind Carbon Copy)のメール受信者 <a href="#EmailObjectClass.html_email-addresses">アドレス</a>を格納します。</span></p><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_bodystructure"></a><a aria-hidden="true"class="hash-link" href="#EmailObjectClass.html_bodystructure"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.bodyStructure</span></h2><p><span><strong>.bodyStructure</strong> : Object</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-2"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</span></h4><p><span><code>.bodyStructure</code> プロパティは、 (任意) メッセージ本文の完全なMIMEストラクチャーである <em>EmailBodyPart</em> オブジェクトを格納します。 <a href="#EmailObjectClass.html_%25E3%2583%25A1%25E3%2583%25BC%25E3%2583%25AB%25E6%259C%25AC%25E6%2596%2587%25E3%2581%25AE%25E6%2589%25B1%25E3%2581%2584">メール本文の扱い</a> を参照ください。</span></p><p><span><code>.bodyStructure</code>オブジェクトには、次のプロパティが格納されています:</span></p><table><thead><tr><th>プロパティ</th><th>タイプ</th><th>値</th></tr></thead><tbody><tr><td>partID</td><td>Text</td><td>メールのパートを固有に識別する ID</td></tr><tr><td>type</td><td>Text</td><td>(必須) パートの Content-Type ヘッダーフィールドの値</td></tr><tr><td>charset</td><td>Text</td><td>Content-Type ヘッダーフィールドの Charset の値</td></tr><tr><td>encoding</td><td>Text</td><td><code>isEncodingProblem=true</code>の場合、Content-Transfer-Encoding の値が追加されます (デフォルトでは未定義)</td></tr><tr><td>disposition</td><td>Text</td><td>パートの Content-Disposition ヘッダーフィールドの値</td></tr><tr><td>language</td><td>Text の Collection</td><td>パートの Content-Language ヘッダーフィールドの、<a href="https://tools.ietf.org/html/rfc3282">RFC3282</a> で定義されている言語タグの一覧(あれば)</td></tr><tr><td>location</td><td>Text</td><td>パートの Content-Location ヘッダーフィールドの、<a href="https://tools.ietf.org/html/rfc2557">RFC2557</a> で定義されている URI(あれば)</td></tr><tr><td>subParts</td><td>Object の Collection</td><td>それぞれの子の本文パート (<em>EmailBodyPart</em> オブジェクトのコレクション)</td></tr><tr><td>headers</td><td>Object の Collection</td><td>パート内の全ヘッダーフィールドの、メッセージ内で出現する順の一覧 (<em>EmailHeader</em>オブジェクトのコレクション。<a href="#EmailObjectClass.html_headers">headers</a>プロパティ参照)</td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_bodyvalues"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_bodyvalues"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.bodyValues</span></h2><p><span><strong>.bodyValues</strong> : Object</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-3"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</span></h4><p><span><code>.bodyValues</code> プロパティは、 (任意)<code>bodyStructure</code> の &lt;partID&gt; 毎にオブジェクトを格納している<em>EmailBodyValue</em> オブジェクトを格納します。 <a href="#EmailObjectClass.html_%25E3%2583%25A1%25E3%2583%25BC%25E3%2583%25AB%25E6%259C%25AC%25E6%2596%2587%25E3%2581%25AE%25E6%2589%25B1%25E3%2581%2584">メール本文の扱い</a> を参照ください。</span></p><p><span><code>.bodyValues</code>オブジェクトには、次のプロパティが格納されています:</span></p><table><thead><tr><th>プロパティ</th><th>タイプ</th><th>値</th></tr></thead><tbody><tr><td><em>partID</em>.value</td><td>テキスト</td><td>本文パートの値</td></tr><tr><td><em>partID</em>.isEncodingProblem</td><td>boolean</td><td>文字セットをデコーディング中に、不正なフォーマットのセクション、未知の文字セット、あるいは未知のcontent-transfer-encoding が見つかった場合には true。 デフォルトは false。</td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_cc"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_cc"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.cc</span></h2><p><span><strong>.cc</strong> : Text<br /><strong>.cc</strong> : Object<br /><strong>.cc</strong> : Collection</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-4"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</span></h4><p><span><code>.cc</code> プロパティは、 追加 (CC: Carbon Copy) のメール受信者<a href="#EmailObjectClass.html_email-addresses">アドレス</a>を格納します。</span></p><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_comments"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_comments"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.comments</span></h2><p><span><strong>.comments</strong> : Text</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-5"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</span></h4><p><span><code>.comments</code> プロパティは、追加のコメントのヘッダーを格納します。</span></p><p><span>コメントはメッセージのヘッダーセクション内にのみ表示されます(つまり本文部分には触れないということです)。</span></p><p><span>特定のフォーマット条件についての詳細は、<a href="https://tools.ietf.org/html/rfc5322">RFC#5322</a>を参照ください。</span></p><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_from"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_from"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.from</span></h2><p><span><strong>.from</strong> : Text<br /><strong>.from</strong> : Object<br /><strong>.from</strong> : Collection</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-6"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</span></h4><p><span><code>.from</code> プロパティは、 メールの送信元 <a href="#EmailObjectClass.html_email-addresses">アドレス</a>を格納します。</span></p><p><span>送信されるメールには、それぞれ <a href="#EmailObjectClass.html_sender">sender</a> および<strong>from</strong> アドレスの両方がついています:</span></p><ul><li><span>senderドメインは、受信側のメールサーバーがセッションを開いたときに受け取るドメインです。</span></li><li><span>from アドレスは、受信者から見えるアドレスです。</span></li></ul><p><span>混乱を避けるため、sender および fromアドレスには同じアドレスを使用することが推奨されます。</span></p><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_headers"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_headers"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.headers</span></h2><p><span><strong>.headers</strong> : Collection</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-7"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</span></h4><p><span><code>.headers</code> プロパティは、 メッセージ内で現れる順番どおりの<code>EmailHeader</code> オブジェクトのコレクションを格納します。 これによってユーザーは拡張された(登録された) ヘッダーや、ユーザー定義された (登録されていない、"X" で始まる)ヘッダーを追加することができます。</span></p><blockquote><p><span>メールレベルですでにプロパティとして設定されている "from" または "cc" などのヘッダーを<code>EmailHeader</code>オブジェクトプロパティが定義している場合、<code>EmailHeader</code>プロパティは無視されます。</span></p></blockquote><p><span>ヘッダーコレクションの各オブジェクトには、次のプロパティが格納されることがあります:</span></p><table><thead><tr><th>プロパティ</th><th>タイプ</th><th>値</th></tr></thead><tbody><tr><td>[].name</td><td>テキスト</td><td>(必須) <a href="https://tools.ietf.org/html/rfc5322">RFC#5322</a>で定義されているヘッダーフィールド名。 null または未定義の場合には、ヘッダーフィールドは MIMEヘッダーに追加されません。</td></tr><tr><td>[].value</td><td>テキスト</td><td><a href="https://tools.ietf.org/html/rfc5322">RFC#5322</a>で定義されているヘッダーフィールド値。</td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_htmlbody"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_htmlbody"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.htmlBody</span></h2><p><span><strong>.htmlBody</strong> : Text</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-8"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</span></h4><p><span><code>.htmlBody</code> プロパティは、 (任意、SMTPのみ) HTML形式のメールメッセージ(デフォルトの文字セットは UTF-8)を格納します。 <a href="#EmailObjectClass.html_%25E3%2583%25A1%25E3%2583%25BC%25E3%2583%25AB%25E6%259C%25AC%25E6%2596%2587%25E3%2581%25AE%25E6%2589%25B1%25E3%2581%2584">メール本文の扱い</a> を参照ください。</span></p><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_id"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_id"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.id</span></h2><p><span><strong>.id</strong> : Text</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-9"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</span></h4><p><span><a href="#IMAPTransporterClass.html">IMAP transporter</a>のみ。</span></p><p><span><code>.id</code> プロパティは、 IMAPサーバーからの固有IDを格納します。</span></p><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_inreplyto"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_inreplyto"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.inReplyTo</span></h2><p><span><strong>.inReplyTo</strong> : Text</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-10"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-10"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</span></h4><p><span><code>.inReplyTo</code> プロパティは、カレントメッセージが返信している、元のメッセージのメッセージIDを格納します。</span></p><p><span>特定のフォーマット条件についての詳細は、<a href="https://tools.ietf.org/html/rfc5322">RFC#5322</a>を参照ください。</span></p><h2><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_keywords"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_keywords"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.keywords</span></h2><p><span><strong>.keywords</strong> : Object</span></p><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-11"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-11"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</span></h4><p><span><code>.keywords</code> プロパティは、 各プロパティ名がキーワードであり、各値が trueであるキーワードセットのオブジェクトを格納します。</span></p><p><span>このプロパティは "keywords" ヘッダーです (<a href="https://tools.ietf.org/html/rfc4021">RFC#4021</a> 参照)。</span></p><table><thead><tr><th>プロパティ</th><th>タイプ</th><th>値</th></tr></thead><tbody><tr><td>.&lt;keyword&gt;</td><td>boolean</td><td>設定するキーワード (値は true でなければなりません)。</td></tr></tbody></table><p><span>予約されたキーワード:</span></p><ul><li><span>$draft - メッセージが下書きであることを表します</span></li><li><span>$seen - メッセージが読まれたことを表します</span></li><li><span>$flagged - メッセージが注視されるべきであることを表します (例:至急のメール)</span></li><li><span>$answered - メッセージに返信がされたことを表します</span></li><li><span>$deleted - メッセージが消去されることを表します</span></li></ul><h4><span><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E4%BE%8B%E9%A1%8C"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E4%25BE%258B%25E9%25A1%258C"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</span></h4><pre><span><code class="hljs"> <span class="hljs-variable">$mail</span>.keywords[<span class="hljs-string">"<span class="hljs-variable">$flagged</span>"</span>]:=<span class="hljs-literal">True</span> <span class="hljs-variable">$mail</span>.keywords[<span class="hljs-string">"4d"</span>]:=<span class="hljs-literal">True</span></code></span></pre><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_messageid"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_messageid"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.messageId</h2><p><strong>.messageId</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-12"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-12"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.messageId</code> プロパティは、 メッセージ識別ヘッダー("message-id")を格納します。</p><p>通常は、"lettersOrNumbers@domainname" の形式、たとえば "<a href="mailto:abcdef.123456@4d.com">abcdef.123456@4d.com</a>" などです。この固有ID は特にフォーラムや公開メーリングリストで使用されています。一般的に、メールサーバーは送信するメッセージにこのヘッダーを自動的に追加します。</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_receivedat"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_receivedat"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.receivedAt</h2><p><strong>.receivedAt</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-13"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-13"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><a href="#IMAPTransporterClass.html">IMAP transporter</a>のみ。</p><p><code>.receivedAt</code> プロパティは、 IMAPサーバーにメールが到着した時間の、ISO 8601UTC フォーマットでのタイムスタンプ (例: 2020-09-13T16:11:53Z)を格納します。</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_references"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_references"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.references</h2><p><strong>.references</strong> : Collection</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-14"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-14"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.references</code> プロパティは、 返信チェーン内メッセージの、全メッセージIDのコレクションを格納します。</p><p>特定のフォーマット条件についての詳細は、<a href="https://tools.ietf.org/html/rfc5322">RFC#5322</a> を参照ください。</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_replyto"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_replyto"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.replyTo</h2><p><strong>.replyTo</strong> : Text<br /><strong>.replyTo</strong> : Object<br /><strong>.replyTo</strong> : Collection</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-15"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-15"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.replyTo</code> プロパティは、 返信用 <a href="#EmailObjectClass.html_email-addresses">アドレス</a>を格納します。</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_sendat"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_sendat"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.sendAt</h2><p><strong>.sendAt</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-16"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-16"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.sendAt</code> プロパティは、 メールのタイムスタンプ (ISO 8601UTCフォーマット)を格納します。</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_sender"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_sender"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.sender</h2><p><strong>.sender</strong> : Text<br /><strong>.sender</strong> : Object<br /><strong>.sender</strong> : Collection</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-17"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-17"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.sender</code> プロパティは、 メールのソース <a href="#EmailObjectClass.html_email-addresses">アドレス</a>を格納します。</p><p>送信されるメールには、それぞれ <strong>sender</strong> および <strong><a href="#EmailObjectClass.html_from">from</a></strong> アドレスの両方がついています:</p><ul><li>sender ドメインは、受信側のメールサーバーがセッションを開いたときに受け取るドメインです。</li><li>from アドレスは、受信者から見えるアドレスです。</li></ul><p>混乱を避けるため、sender および from アドレスには同じアドレスを使用することが推奨されます。</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_size"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_size"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.size</h2><p><strong>.size</strong> : Integer</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-18"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-18"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><a href="#IMAPTransporterClass.html">IMAP transporter</a>のみ。</p><p><code>.size</code> プロパティは、 IMAPサーバーから返された Email オブジェクトのサイズ(バイト単位)を格納します。</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_subject"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_subject"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.subject</h2><p><strong>.subject</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-19"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-19"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.subject</code> プロパティは、 メールの件名を格納します。</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_textbody"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_textbody"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.textBody</h2><p><strong>.textBody</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-20"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-20"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.textBody</code> プロパティは、 (任意、SMTPのみ) 標準テキスト形式のメールメッセージ(デフォルトの文字セットは UTF-8)を格納します。 <a href="#EmailObjectClass.html_%25E3%2583%25A1%25E3%2583%25BC%25E3%2583%25AB%25E6%259C%25AC%25E6%2596%2587%25E3%2581%25AE%25E6%2589%25B1%25E3%2581%2584">メール本文の扱い</a> を参照ください。</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_to"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_to"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.to</h2><p><strong>.to</strong> : Text<br /><strong>.to</strong> : Object<br /><strong>.to</strong> : Collection</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-21"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-21"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.to</code> プロパティは、 メールのメインの受信者 <a href="#EmailObjectClass.html_%25E3%2583%25A1%25E3%2583%25BC%25E3%2583%25AB%25E3%2582%25A2%25E3%2583%2589%25E3%2583%25AC%25E3%2582%25B9">アドレス</a>を格納します。</p><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_mail-convert-from-mime"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_mail-convert-from-mime"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>MAIL Convert from MIME</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v18</td><td>追加</td></tr></tbody></table></details><p><strong>MAIL Convert from MIME</strong>( <em>mime</em> : Blob ): Object<br /><strong>MAIL Convert from MIME</strong>( <em>mime</em> : Text ) :Object</p><table><thead><tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr></thead><tbody><tr><td>mime</td><td>Blob, Text</td><td style="text-align:center">-&gt;</td><td>MIME形式のメール</td></tr><tr><td>戻り値</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Email オブジェクト</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-22"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-22"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>MAIL Convert from MIME</code> コマンドは、 MIMEドキュメントを有効なEmailオブジェクトへと変換します。</p><blockquote><p>戻り値の Email オブジェクトのフォーマットは <a href="https://jmap.io/spec-mail.html">JMAP specification</a> に準拠します。</p></blockquote><p><em>mime</em> には、変換する有効な MIME ドキュメントを渡します。これはどのメールサーバーまたはアプリケーションから提供されたものでも可能です。 <em>mime</em> 引数として、BLOBまたはテキストを渡すことができます。 MIMEがファイルから渡された場合、文字セットと改行コード変換に関する問題を避けるため、BLOB型の引数を使用することが推奨されます。</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%BF%94%E3%81%95%E3%82%8C%E3%82%8B%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25BF%2594%25E3%2581%2595%25E3%2582%258C%25E3%2582%258B%25E3%2582%25AA%25E3%2583%2596%25E3%2582%25B8%25E3%2582%25A7%25E3%2582%25AF%25E3%2583%2588"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>返されるオブジェクト</h4><p>Email オブジェクト。</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E4%BE%8B%E9%A1%8C-1"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E4%25BE%258B%25E9%25A1%258C-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 1</h4><p>テキストドキュメントとして保存された MIME のメールのテンプレートを読み込み、メールを送信します。</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$mime</span>: Blob<span class="hljs-keyword">var</span> <span class="hljs-variable">$mail</span>;<span class="hljs-variable">$server</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$status</span>: Object<span class="hljs-variable">$mime</span>:=<span class="hljs-function">File</span>(<span class="hljs-string">"/PACKAGE/Mails/templateMail.txt"</span>).<span class="hljs-function">getContent</span>())<span class="hljs-variable">$mail</span>:=<span class="hljs-function">MAIL Convert from MIME</span>(<span class="hljs-variable">$mime</span>)<span class="hljs-variable">$mail</span>.to:=<span class="hljs-string">"smith@mail.com"</span><span class="hljs-variable">$mail</span>.subject:=<span class="hljs-string">"Hello world"</span><span class="hljs-variable">$server</span>:=New object<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"smtp.gmail.com"</span><span class="hljs-variable">$server</span>.port:=<span class="hljs-number">465</span><span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXX"</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">SMTP New transporter</span>(<span class="hljs-variable">$server</span>)<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">send</span>(<span class="hljs-variable">$mail</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E4%BE%8B%E9%A1%8C-2"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E4%25BE%258B%25E9%25A1%258C-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 2</h4><p>この例題では、ピクチャーが含まれた 4D Write Pro ドキュメントを直接送信します:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$mime</span>: Blob<span class="hljs-keyword">var</span> <span class="hljs-variable">$email</span>;<span class="hljs-variable">$server</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$status</span>: Object<span class="hljs-comment">// 4D Write Pro ドキュメントを MIME に書き出します</span><span class="hljs-function">WP EXPORT VARIABLE</span>(WParea;<span class="hljs-variable">$mime</span>;wk mime html)<span class="hljs-comment">// 4D Write Pro MIME 変数をメールオブジェクトに変換します</span><span class="hljs-variable">$email</span>:=<span class="hljs-function">MAIL Convert from MIME</span>(<span class="hljs-variable">$mime</span>)<span class="hljs-comment">// Email オブジェクトのヘッダーを設定します</span><span class="hljs-variable">$email</span>.subject:=<span class="hljs-string">"4D Write Pro HTML body"</span><span class="hljs-variable">$email</span>.from:=<span class="hljs-string">"YourEmail@gmail.com"</span><span class="hljs-variable">$email</span>.to:=<span class="hljs-string">"RecipientEmail@mail.com"</span><span class="hljs-variable">$server</span>:=New object<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"smtp.gmail.com"</span><span class="hljs-variable">$server</span>.port:=<span class="hljs-number">465</span><span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"YourEmail@gmail.com"</span><span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXX"</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">SMTP New transporter</span>(<span class="hljs-variable">$server</span>)<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">send</span>(<span class="hljs-variable">$email</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_mail-convert-to-mime"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_mail-convert-to-mime"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>MAIL Convert to MIME</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v17 R4</td><td>追加</td></tr><tr><td>v17 R5</td><td>変更</td></tr></tbody></table></details><p><strong>MAIL Convert to MIME</strong>( <em>mail</em> : Object {; <em>options</em> : Object } ) : Text</p><table><thead><tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr></thead><tbody><tr><td>mail</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Email オブジェクト</td></tr><tr><td>options</td><td>Object</td><td style="text-align:center">-&gt;</td><td>文字セットとエンコーディングのメールオプション</td></tr><tr><td>戻り値</td><td>Text</td><td style="text-align:center">&lt;-</td><td>MIME に変換された Emailオブジェクト</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E8%AA%AC%E6%98%8E-23"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E8%25AA%25AC%25E6%2598%258E-23"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>MAIL Convert to MIME</code> コマンドは、 EmailオブジェクトをMIMEテキストへと変換します。 このコマンドは、Email オブジェクトを送信する前に整形する目的で<a href="#EmailObjectClass.html_send">SMTP_transporter.send()</a>コマンドによって内部的に呼び出されます。 また、オブジェクトの MIME フォーマットを解析するためにも使用されます。</p><p><em>mail</em> には、変換するメールのコンテンツとストラクチャーの詳細を渡します。 この情報には、メールアドレス(送信者と受信者)、メッセージそのもの、メッセージの表示タイプなどが含まれます。</p><blockquote><p>Email オブジェクトのフォーマットは <a href="https://jmap.io/spec-mail.html">JMAP specification</a> に準拠します。</p></blockquote><p><em>options</em> 引数を渡すと、メールに対して特定の文字セットとエンコーディング設定を指定することができます。次のプロパティを利用することができます:</p><table><thead><tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>headerCharset</td><td>Text</td><td>メールの以下の部分で使用される文字セットとエンコーディング: 件名、添付ファイル名、メール名の属性。 とりうる値:<table><tr><th>定数</th><th>値</th><th>説明</th></tr><tr><td>mail mode ISO2022JP</td><td>US-ASCII_ISO-2022-JP_UTF8_QP</td><td><ul><li><i>headerCharset</i>: 可能なら US-ASCII 、次に可能なら Japanese(ISO-2022-JP) &amp; Quoted-printable 、それも不可なら UTF-8 &amp;Quoted-printable</li><li><i>bodyCharset</i>: 可能なら US-ASCII、次に可能なら Japanese (ISO-2022-JP)&amp; 7-bit、それも不可なら UTF-8 &amp; Quoted-printable</li></ul></td></tr><tr><td>mail mode ISO88591</td><td>ISO-8859-1</td><td><ul><li><i>headerCharset</i>: ISO-8859-1 &amp; Quoted-printable</li><li><i>bodyCharset</i>: ISO-8859-1 &amp; 8-bit</li></ul></td></tr><tr><td>mail mode UTF8</td><td>US-ASCII_UTF8_QP</td><td><i>headerCharset</i> &amp; <i>bodyCharset</i>: 可能ならUS-ASCII、それが不可なら UTF-8 &amp; Quoted-printable(<strong>デフォルト値</strong>)</td></tr><tr><td>mail mode UTF8 in base64</td><td>US-ASCII_UTF8_B64</td><td><i>headerCharset</i> &amp; <i>bodyCharset</i>: 可能な場合はUS-ASCII、それ以外は UTF-8 &amp; base64</td></tr></table></td></tr><tr><td>bodyCharset</td><td>Text</td><td>メールの HTML およびテキスト本文コンテンツで使用される文字セットとエンコーディング。 取りうる値:headerCharset と同じ(上記参照)</td></tr></tbody></table><p><em>options</em> 引数が省略された場合、ヘッダーおよび本文においては mail mode UTF8設定が使用されます。</p><h4><a aria-hidden="true" class="anchor" id="EmailObjectClass.html_%E4%BE%8B%E9%A1%8C-3"></a><a aria-hidden="true" class="hash-link" href="#EmailObjectClass.html_%25E4%25BE%258B%25E9%25A1%258C-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$mail</span>: Object<span class="hljs-keyword">var</span> <span class="hljs-variable">$mime</span>: Text<span class="hljs-variable">$mail</span>:=New object<span class="hljs-comment">// メール作成</span><span class="hljs-variable">$mail</span>.from:=<span class="hljs-string">"tsales@massmarket.com"</span><span class="hljs-variable">$mail</span>.subject:=<span class="hljs-string">"Terrific Sale! This week only!"</span><span class="hljs-variable">$mail</span>.textBody:=<span class="hljs-string">"Text format email"</span><span class="hljs-variable">$mail</span>.htmlBody:=<span class="hljs-string">"&lt;html&gt;&lt;body&gt;HTML format email&lt;/body&gt;&lt;/html&gt;"</span><span class="hljs-variable">$mail</span>.to:=New collection<span class="hljs-variable">$mail</span>.to.<span class="hljs-function">push</span>(<span class="hljs-function">New object </span>(<span class="hljs-string">"email"</span>;<span class="hljs-string">"noreply@4d.com"</span>))<span class="hljs-variable">$mail</span>.to.<span class="hljs-function">push</span>(<span class="hljs-function">New object </span>(<span class="hljs-string">"email"</span>;<span class="hljs-string">"test@4d.com"</span>))<span class="hljs-comment">// Email オブジェクトを MIME に変換します</span><span class="hljs-variable">$mime</span>:=<span class="hljs-function">MAIL Convert to MIME</span>(<span class="hljs-variable">$mail</span>)<span class="hljs-comment">// $mime の中身:</span><span class="hljs-comment">// MIME-Version: 1.0</span><span class="hljs-comment">// Date: Thu, 11 Oct 2018 15:42:25 GMT</span><span class="hljs-comment">// Message-ID: &lt;7CA5D25B2B5E0047A36F2E8CB30362E2&gt;</span><span class="hljs-comment">// Sender: tsales@massmarket.com</span><span class="hljs-comment">// From: tsales@massmarket.com</span><span class="hljs-comment">// To: noreply@4d.com</span><span class="hljs-comment">// To: test@4d.com</span><span class="hljs-comment">// Content-Type: multipart/alternative; boundary="E0AE5773D5E95245BBBD80DD0687E218"</span><span class="hljs-comment">// Subject: Terrific Sale! This week only!</span><span class="hljs-comment">//// --E0AE5773D5E95245BBBD80DD0687E218</span><span class="hljs-comment">// Content-Type: text/plain; charset="UTF-8"</span><span class="hljs-comment">// Content-Transfer-Encoding: quoted-printable</span><span class="hljs-comment">//// Text format email</span><span class="hljs-comment">// --E0AE5773D5E95245BBBD80DD0687E218</span><span class="hljs-comment">// Content-Type: text/html; charset="UTF-8"</span><span class="hljs-comment">// Content-Transfer-Encoding: quoted-printable</span><span class="hljs-comment">//// &lt;html&gt;&lt;body&gt;HTML format email&lt;/body&gt;&lt;/html&gt;</span><span class="hljs-comment">// --E0AE5773D5E95245BBBD80DD0687E218--</span></code></pre><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#DataStoreClass.html"><span class="arrow-prev">←</span><span class="function-name-prevnext">DataStore</span></a><a class="docs-next button" href="#EntityClass.html"><span>Entity</span><span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#EmailObjectClass.html_attachments">.attachments</a></li><li><a href="#EmailObjectClass.html_bcc">.bcc</a></li><li><a href="#EmailObjectClass.html_bodystructure">.bodyStructure</a></li><li><a href="#EmailObjectClass.html_bodyvalues">.bodyValues</a></li><li><a href="#EmailObjectClass.html_cc">.cc</a></li><li><a href="#EmailObjectClass.html_comments">.comments</a></li><li><a href="#EmailObjectClass.html_from">.from</a></li><li><a href="#EmailObjectClass.html_headers">.headers</a></li><li><a href="#EmailObjectClass.html_htmlbody">.htmlBody</a></li><li><a href="#EmailObjectClass.html_id">.id</a></li><li><a href="#EmailObjectClass.html_inreplyto">.inReplyTo</a></li><li><a href="#EmailObjectClass.html_keywords">.keywords</a></li><li><a href="#EmailObjectClass.html_messageid">.messageId</a></li><li><a href="#EmailObjectClass.html_receivedat">.receivedAt</a></li><li><a href="#EmailObjectClass.html_references">.references</a></li><li><a href="#EmailObjectClass.html_replyto">.replyTo</a></li><li><a href="#EmailObjectClass.html_sendat">.sendAt</a></li><li><a href="#EmailObjectClass.html_sender">.sender</a></li><li><a href="#EmailObjectClass.html_size">.size</a></li><li><a href="#EmailObjectClass.html_subject">.subject</a></li><li><a href="#EmailObjectClass.html_textbody">.textBody</a></li><li><a href="#EmailObjectClass.html_to">.to</a></li><li><a href="#EmailObjectClass.html_mail-convert-from-mime">MAILConvert from MIME</a></li><li><a href="#EmailObjectClass.html_mail-convert-to-mime">MAILConvert to MIME</a></li></ul></nav></div></div></body></html>