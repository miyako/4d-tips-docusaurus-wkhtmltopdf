<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="fr"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Formula · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="Les commandes [Formula](#formula) et [Formula from string](#formula-from-string) vous permettent de créer des [objets `4D.Function`](#about-4dfunction-objects) natifs pour exécuter toute expression ou code 4D exprimé sous forme de texte."name="description" /><meta content="fr" name="docsearch:language" /><meta content="Formula · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="Les commandes [Formula](#formula) et [Formula from string](#formula-from-string) vous permettent de créer des [objets `4D.Function`](#about-4dfunction-objects) natifs pour exécuter toute expression ou code 4D exprimé sous forme de texte."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#FunctionClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">Formula<a aria-hidden="true" class="anchor" id="FunctionClass.html"></a></h1></header><article><div><p><span>Les commandes <a href="#FunctionClass.html_formula">Formula</a> et <a href="#FunctionClass.html_formula-from-string">Formula from string</a>vous permettent de créer des <a href="#FunctionClass.html_about-4dfunction-objects">objets<code>4D.Function</code></a> natifs pour exécuter toute expressionou code 4D exprimé sous forme de texte.</span></p><h3><span><a aria-hidden="true" class="anchor" id="FunctionClass.html_objets-formula"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_objets-formula"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Objets Formula</span></h3><p><span>Les objets Formula peuvent être encapsulés dans despropriétés d'objet :</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=New object <span class="hljs-variable">$f</span>.message:=<span class="hljs-function">Formula</span>(<span class="hljs-function">ALERT</span>(<span class="hljs-string">"Hello world"</span>))</code></span></pre><p>Cette propriété est une "fonction objet", c'est-à-dire unefonction qui est liée à son objet parent. Pour exécuter unefonction stockée dans une propriété objet, utilisez l'opérateur<strong>()</strong> après le nom de la propriété, comme par exemple:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$f</span>.<span class="hljs-function">message</span>() <span class="hljs-comment">//affiche"Hello world"</span></code></pre><p>La syntaxe avec des crochets est également prise en charge :</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$f</span>[<span class="hljs-string">"message"</span>]() <span class="hljs-comment">//affiche "Hello world"</span></code></pre><p>A noter que, même si elle n'a pas de paramètres (voirci-dessous), une fonction objet à exécuter doit être appelée avecdes parenthèses (). En appelant uniquement une seule propriété, unenouvelle référence à la formule sera retournée (et ne sera pasexécutée) :</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$o</span>:=<span class="hljs-variable">$f</span>.message <span class="hljs-comment">//retourne l'objet formule en $o </span></code></pre><p>Vous pouvez également exécuter une fonction à l'aide desfonctions <a href="#FunctionClass.html_apply"><code>apply()</code></a> et <a href="#FunctionClass.html_call"><code>call()</code></a> :</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$f</span>.message.<span class="hljs-function">apply</span>() <span class="hljs-comment">//affiche "Hello world"</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_passer-des-param%C3%A8tres"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_passer-des-param%25C3%25A8tres"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Passer des paramètres</h4><p>Vous pouvez passer des paramètres à vos formules en utilisant<a href="#FunctionClass.html_sequential-parameters">la syntaxeséquentielle des paramètres</a> basée sur $1, $2...$n. Par exemple,vous pouvez écrire :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: Object <span class="hljs-variable">$f</span>:=New object <span class="hljs-variable">$f</span>.message:=<span class="hljs-function">Formula</span>(<span class="hljs-function">ALERT</span>(<span class="hljs-string">"Hello "</span>+<span class="hljs-variable">$1</span>)) <span class="hljs-variable">$f</span>.<span class="hljs-function">message</span>(<span class="hljs-string">"John"</span>) <span class="hljs-comment">//affiche "Hello John"</span></code></pre><p>Ou en utilisant la fonction <a href="#FunctionClass.html_call">.call()</a> :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: Object <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-variable">$1</span>+<span class="hljs-string">" "</span>+<span class="hljs-variable">$2</span>) <span class="hljs-variable">$text</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-literal">Null</span>;<span class="hljs-string">"Hello"</span>;<span class="hljs-string">"World"</span>) <span class="hljs-comment">//retourne "Hello World"</span> <span class="hljs-variable">$text</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-literal">Null</span>;<span class="hljs-string">"Welcome to"</span>;<span class="hljs-function">String</span>(<span class="hljs-function">Year of</span>(Current date))) <span class="hljs-comment">//retourne "Welcome to 2019" (par exemple)</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_param%C3%A8tres-dune-seule-m%C3%A9thode"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_param%25C3%25A8tres-dune-seule-m%25C3%25A9thode"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Paramètres d'une seule méthode</h4><p>Pour plus de commodité, lorsque la formule est constituée d'uneseule méthode projet, les paramètres peuvent être omis dansl'initialisation de l'objet formule. Ils peuvent simplement êtrepassés lorsque la formule est appelée. Par exemple :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(myMethod)  <span class="hljs-comment">//Ecrire Formula(myMethod($1;$2)) n'est pas nécessaire</span> <span class="hljs-variable">$text</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-literal">Null</span>;<span class="hljs-string">"Hello"</span>;<span class="hljs-string">"World"</span>) <span class="hljs-comment">//retourne "Hello World"</span> <span class="hljs-variable">$text</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>() <span class="hljs-comment">//retourne "How are you?"</span>  <span class="hljs-comment">//myMethod</span> #<span class="hljs-function">DECLARE </span>(<span class="hljs-variable">$param1 </span>: Text; <span class="hljs-variable">$param2 </span>: Text)-&gt;<span class="hljs-variable">$return </span>: Text<span class="hljs-keyword"> If</span>(Count parameters=<span class="hljs-number">2</span>)    <span class="hljs-variable">$return</span>:=<span class="hljs-variable">$param1</span>+<span class="hljs-string">" "</span>+<span class="hljs-variable">$param2</span><span class="hljs-keyword"> Else</span>    <span class="hljs-variable">$return</span>:=<span class="hljs-string">"How are you?"</span><span class="hljs-keyword"> End if</span></code></pre><p>Les paramètres sont reçus dans la méthode, dans l'ordre où ilssont spécifiés dans l'appel.</p><h3><a aria-hidden="true" class="anchor" id="FunctionClass.html_%C3%A0-propos-des-objets-4dfunction"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_%25C3%25A0-propos-des-objets-4dfunction"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>À propos des objets 4D.Function</h3><p>Un objet <code>4D.Function</code> contient un morceau de codequi peut être exécuté à partir d'un objet, soit en utilisantl'opérateur <code>()</code>, soit en utilisant les fonctions<a href="#FunctionClass.html_apply"><code>apply()</code></a> et<a href="#FunctionClass.html_call"><code>call()</code></a>. 4Dpropose trois types d'objets Function :</p><ul><li>les fonctions natives, c'est-à-dire les fonctions intégrées dediverses classes 4D telles que <code>collection.sort()</code> ou<code>file.copyTo()</code>.</li><li>les fonctions utilisateur, créées dans les <a href="#classes.html">classes</a> utilisateur à l'aide du <a href="#FunctionClass.html_function">mot-clé Function</a>.</li><li>les fonctions de formule, c'est-à-dire les fonctions quipeuvent exécuter n'importe quelle formule 4D.</li></ul><h3><a aria-hidden="true" class="anchor" id="FunctionClass.html_sommaire"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_sommaire"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Sommaire</h3><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#FunctionClass.html_apply"><strong>.apply</strong>() :any<br /><strong>.apply</strong>( <em>thisObj</em> : Object { ;<em>formulaParams</em> : Collection } ) : any</a><p>&nbsp;&nbsp;&nbsp;&nbsp;exécute l'objet <code>formula</code>auquel elle est appliquée et retourne la valeur résultante</p></td></tr><tr><td><a href="#FunctionClass.html_call"><strong>.call</strong>() :any<br /><strong>.call</strong>( <em>thisObj</em> : Object { ;...<em>params</em> : any } ) : any</a><p>&nbsp;&nbsp;&nbsp;&nbsp;exécute l'objet <code>formula</code>auquel elle est appliquée et retourne la valeur résultante</p></td></tr><tr><td><a href="#FunctionClass.html_source"><strong>.source</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;contient l'expression source de<code>formula</code> sous forme de texte</p></td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="FunctionClass.html_formula"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_formula"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Formula</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R6</td><td>Renommée (New formula -&gt; Formula)</td></tr><tr><td>v17 R3</td><td>Ajout</td></tr></tbody></table></details><p><strong>Formula</strong> ( <em>formulaExp</em> : Expression ) :4D.Function</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>formulaExp</td><td>Expression</td><td style="text-align:center">-&gt;</td><td>Formule à retourner comme objet</td></tr><tr><td>Résultat</td><td>4D.Function</td><td style="text-align:center">&lt;-</td><td>Fonction native encapsulant la formule</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_description"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_description"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La commande <code>Formula</code> crée un objet <code>4DFunction</code> basé sur l'expression <em>formulaExp</em>.<em>formulaExp</em> peut être aussi simple qu'une valeur unique oucomplexe, comme une méthode projet avec des paramètres.</p><p>Le fait d'avoir une formule en tant qu'objet permet de la passeren tant que paramètre (champ calculé) à des commandes ou à desméthodes ou de l'exécuter à partir de divers composants sans avoirà les déclarer comme "partagés par les composants et la base dedonnées hôte". Lorsqu'il est appelé, l'objet formula est évaluédans le contexte de la base de données ou du composant qui l'acréé.</p><p>La formule retournée peut être appelée avec :</p><ul><li>les méthodes <a href="#FunctionClass.html_call"><code>.call()</code></a> ou <a href="#FunctionClass.html_apply"><code>.apply()</code></a>, ou</li><li>la syntaxe de la notation objet (voir <a href="#FunctionClass.html_formula-object">objet formula</a>).</li></ul><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-number">1</span>+<span class="hljs-number">2</span>) <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"myFormula"</span>;<span class="hljs-variable">$f</span>)  <span class="hljs-comment">//three different ways to call the formula</span> <span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-variable">$o</span>) <span class="hljs-comment">//retourne 3</span> <span class="hljs-variable">$f</span>.<span class="hljs-function">apply</span>(<span class="hljs-variable">$o</span>) <span class="hljs-comment">//retourne 3</span> <span class="hljs-variable">$o</span>.<span class="hljs-function">myFormula</span>() <span class="hljs-comment">//retourne 3</span></code></pre><p>Vous pouvez passer des <a href="#FunctionClass.html_passing-parameters">paramètres</a> à<code>Formula</code>, comme le montre l'<a href="#FunctionClass.html_example-4">exemple 4</a> ci-dessous.</p><p>Vous pouvez indiquer l'objet sur lequel la formule est exécutée,comme le montre l'<a href="#FunctionClass.html_example-5">exemple5</a>. Les propriétés de l'objet sont alors accessibles via lacommande <code>This</code>.</p><p>Si <em>formuleExp</em> utilise des variables locales, leursvaleurs sont copiées et stockées dans l'objet formule retourné lorsde sa création. Lors de son exécution, la formule utilise cesvaleurs copiées plutôt que la valeur courante des variableslocales. A noter que l'utilisation de tableaux comme variableslocales n'est pas prise en charge.</p><p>L'objet créé par <code>Formula</code> peut être enregistré parexemple, dans un champ de base de données ou dans un documentblob.</p><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_exemple-1"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_exemple-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 1</h4><p>Une formule simple :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-number">1</span>+<span class="hljs-number">2</span>)<span class="hljs-keyword"> var</span> <span class="hljs-variable">$o </span>: Object <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"f"</span>;<span class="hljs-variable">$f</span>) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$o</span>.f() <span class="hljs-comment">// retourne 3</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_exemple-2"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_exemple-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 2</h4><p>Une formule utilisant des variables locales :</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$value</span>:=<span class="hljs-number">10</span> <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"f"</span>;<span class="hljs-function">Formula</span>(<span class="hljs-variable">$value</span>)) <span class="hljs-variable">$value</span>:=<span class="hljs-number">20</span> <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$o</span>.f() <span class="hljs-comment">// retourne 10</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_exemple-3"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_exemple-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 3</h4><p>Une formule simple utilisant des paramètres :</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"f"</span>;<span class="hljs-function">Formula</span>(<span class="hljs-variable">$1</span>+<span class="hljs-variable">$2</span>)) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$o</span>.f(<span class="hljs-number">10</span>;<span class="hljs-number">20</span>) <span class="hljs-comment">//retourne 30</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_exemple-4"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_exemple-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 4</h4><p>Une formule utilisant une méthode projet avec des paramètres:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"f"</span>;<span class="hljs-function">Formula</span>(myMethod)) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$o</span>.f(<span class="hljs-string">"param1"</span>;<span class="hljs-string">"param2"</span>) <span class="hljs-comment">// équivalent à $result:=myMethod("param1";"param2")</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_exemple-5"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_exemple-5"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 5</h4><p>Avec l'utilisation de <code>This</code> :</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"fullName"</span>;<span class="hljs-function">Formula</span>(<span class="hljs-literal">This</span>.firstName+<span class="hljs-string">" "</span>+<span class="hljs-literal">This</span>.lastName)) <span class="hljs-variable">$o</span>.firstName:=<span class="hljs-string">"John"</span> <span class="hljs-variable">$o</span>.lastName:=<span class="hljs-string">"Smith"</span> <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$o</span>.<span class="hljs-function">fullName</span>() <span class="hljs-comment">//retourne "John Smith"</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_exemple-6"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_exemple-6"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 6</h4><p>Appeler une formule à l'aide de la notation objet :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$feta</span>; <span class="hljs-variable">$robot </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$calc </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$robot</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Robot"</span>;<span class="hljs-string">"price"</span>;<span class="hljs-number">543</span>;<span class="hljs-string">"quantity"</span>;<span class="hljs-number">2</span>) <span class="hljs-variable">$feta</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Feta"</span>;<span class="hljs-string">"price"</span>;<span class="hljs-number">12.5</span>;<span class="hljs-string">"quantity"</span>;<span class="hljs-number">5</span>) <span class="hljs-variable">$calc</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-literal">This</span>.total:=<span class="hljs-literal">This</span>.price*<span class="hljs-literal">This</span>.quantity)  <span class="hljs-comment">//définit la formule aux propriétés d'objet</span> <span class="hljs-variable">$feta</span>.calc:=<span class="hljs-variable">$calc</span> <span class="hljs-variable">$robot</span>.calc:=<span class="hljs-variable">$calc</span>  <span class="hljs-comment">//appeler la formule</span> <span class="hljs-variable">$feta</span>.<span class="hljs-function">calc</span>() <span class="hljs-comment">// $feta={name:Feta,price:12.5,quantity:5,total:62.5,calc:"[object Formula]"}</span> <span class="hljs-variable">$robot</span>.<span class="hljs-function">calc</span>() <span class="hljs-comment">// $robot={name:Robot,price:543,quantity:2,total:1086,calc:"[object Formula]"}</span></code></pre><h2><a aria-hidden="true" class="anchor" id="FunctionClass.html_formula-from-string"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_formula-from-string"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Formula from string</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R6</td><td>Renommée : New formula from string -&gt; Formula fromstring</td></tr><tr><td>v17 R3</td><td>Ajout</td></tr></tbody></table></details><p><strong>Formula from string</strong>( <em>formulaString</em> :Text ) : 4D.Function</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>formulaString</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Formule texte à retourner comme objet</td></tr><tr><td>Résultat</td><td>4D.Function</td><td style="text-align:center">&lt;-</td><td>Objet natif encapsulant la formule</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_description-1"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_description-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La commande <code>Formula from string</code> crée un objet4D.Function basé sur <em>formulaString</em>. <em>formulaString</em>peut être aussi simple qu'une valeur unique ou complexe, comme uneméthode projet avec des paramètres.</p><p>Cette commande est similaire à <a href="#FunctionClass.html_formula"><code>Formula</code></a>, saufqu'elle traite une formule de type texte. Dans la plupart des cas,il est recommandé d'utiliser la commande <code>Formula</code>.<code>Formula from string</code> ne doit être utilisée que lorsquela formule d'origine a été exprimée sous forme de texte (parexemple, stockée en externe dans un fichier JSON). Dans cecontexte, l'utilisation de la syntaxe avec des tokens est fortementconseillée.</p><blockquote><p>Le contenu des variables locales n'étant pas accessible par sonnom en mode compilé, il ne peut pas être utilisé dans la<em>formulaString</em>. Si vous tentez d'accéder à une variablelocale avec <code>Formula from string</code>, cela génèrera uneerreur (-10737).</p></blockquote><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_exemple"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_exemple"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><p>Le code suivant permettra de créer un dialogue acceptant uneformule dans un format texte :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$textFormula </span>: Text<span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$textFormula</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please type a formula"</span>)<span class="hljs-keyword"> If</span>(ok=<span class="hljs-number">1</span>)    <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula from string</span>(<span class="hljs-variable">$textFormula</span>)<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Result = "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>()))<span class="hljs-keyword"> End if</span></code></pre><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/API/formulaDialog.png" /></p><p>... et exécute la formule :</p><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/API/formulaAlert.png" /></p><h2><a aria-hidden="true" class="anchor" id="FunctionClass.html_apply"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_apply"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.apply()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R3</td><td>Ajout</td></tr></tbody></table></details><p><strong>.apply</strong>() : any<br /><strong>.apply</strong>( <em>thisObj</em> : Object { ;<em>formulaParams</em> : Collection } ) : any</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>thisObj</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Objet à retourner par la commande This dans la formule</td></tr><tr><td>formulaParams</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Collection des valeurs à passer en tant que $1...$n lorsque<code>formula</code> est exécuté</td></tr><tr><td>Résultat</td><td>any</td><td style="text-align:center">&lt;-</td><td>Valeur obtenue à partir de l'exécution de la formule</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_description-2"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_description-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.apply()</code> exécute l'objet<code>formula</code> auquel elle est appliquée et retourne lavaleur résultante. L'objet formula peut être créé à l'aide descommandes <code>Formula</code> ou <code>Formula fromstring</code>.</p><p>Dans le paramètre <em>thisObj</em>, vous pouvez passer uneréférence à l'objet à utiliser en tant que <code>This</code> dansla formule.</p><p>Vous pouvez également passer une collection à utiliser commeparamètres $1...$n dans la formule à l'aide du paramètre facultatif<em>formulaParams</em>.</p><p>A noter que <code>.apply()</code> est similaire à <a href="#FunctionClass.html_call"><code>.call()</code></a>, néanmoins lesparamètres sont passés sous forme de collection. Cela peut êtreutile pour passer des résultats calculés.</p><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_exemple-1-1"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_exemple-1-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 1</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-variable">$1</span>+<span class="hljs-variable">$2</span>+<span class="hljs-variable">$3</span>) <span class="hljs-variable">$c</span>:=<span class="hljs-function">New collection</span>(<span class="hljs-number">10</span>;<span class="hljs-number">20</span>;<span class="hljs-number">30</span>) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">apply</span>(<span class="hljs-literal">Null</span>;<span class="hljs-variable">$c</span>) <span class="hljs-comment">// retourne 60</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_exemple-2-1"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_exemple-2-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 2</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$calc </span>: 4D.<span class="hljs-keyword">Function</span><span class="hljs-keyword"> var</span> <span class="hljs-variable">$feta</span>; <span class="hljs-variable">$robot </span>: Object <span class="hljs-variable">$robot</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Robot"</span>;<span class="hljs-string">"price"</span>;<span class="hljs-number">543</span>;<span class="hljs-string">"quantity"</span>;<span class="hljs-number">2</span>) <span class="hljs-variable">$feta</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Feta"</span>;<span class="hljs-string">"price"</span>;<span class="hljs-number">12.5</span>;<span class="hljs-string">"quantity"</span>;<span class="hljs-number">5</span>) <span class="hljs-variable">$calc</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-literal">This</span>.total:=<span class="hljs-literal">This</span>.price*<span class="hljs-literal">This</span>.quantity) <span class="hljs-variable">$calc</span>.<span class="hljs-function">apply</span>(<span class="hljs-variable">$feta</span>) <span class="hljs-comment">// $feta={name:Feta,price:12.5,quantity:5,total:62.5}</span> <span class="hljs-variable">$calc</span>.<span class="hljs-function">apply</span>(<span class="hljs-variable">$robot</span>) <span class="hljs-comment">// $robot={name:Robot,price:543,quantity:2,total:1086}</span></code></pre><h2><a aria-hidden="true" class="anchor" id="FunctionClass.html_call"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_call"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.call()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R3</td><td>Ajout</td></tr></tbody></table></details><p><strong>.call</strong>() : any<br /><strong>.call</strong>( <em>thisObj</em> : Object { ;...<em>params</em> : any } ) : any</p><table><thead><tr><th>Paramètres</th><th>Type</th><th></th><th>Description</th></tr></thead><tbody><tr><td>thisObj</td><td>Object</td><td>-&gt;</td><td>Objet à retourner par la commande This dans la formule</td></tr><tr><td>params</td><td>any</td><td>-&gt;</td><td>Valeur(s) à passer en tant que $1...$n lorsque formula estexécuté</td></tr><tr><td>Résultat</td><td>any</td><td>&lt;-</td><td>Valeur obtenue à partir de l'exécution de la formule</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_description-3"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_description-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.call()</code> exécute l'objet<code>formula</code> auquel elle est appliquée et retourne lavaleur résultante. L'objet formula peut être créé à l'aide descommandes <code>Formula</code> ou <code>Formula fromstring</code>.</p><p>Dans le paramètre <em>thisObj</em>, vous pouvez passer uneréférence à l'objet à utiliser en tant que <code>This</code> dansla formule.</p><p>Vous pouvez également passer des valeurs à utiliser commeparamètres <em>$1...$n</em> dans la formule à l'aide du paramètrefacultatif <em>params</em>.</p><p>A noter que <code>.call()</code> est similaire à <a href="#FunctionClass.html_apply"><code>.apply()</code></a>, néanmoinsles paramètres sont passés directement.</p><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_exemple-1-2"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_exemple-1-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 1</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-function">Uppercase</span>(<span class="hljs-variable">$1</span>)) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-literal">Null</span>;<span class="hljs-string">"hello"</span>) <span class="hljs-comment">// retourne "HELLO"</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_exemple-2-2"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_exemple-2-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 2</h4><pre><code class="hljs css language-4d"> <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"value"</span>;<span class="hljs-number">50</span>) <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-literal">This</span>.value*<span class="hljs-number">2</span>) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-variable">$o</span>) <span class="hljs-comment">// retourne 100</span></code></pre><h2><a aria-hidden="true" class="anchor" id="FunctionClass.html_source"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_source"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.source</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R2</td><td>Ajout</td></tr></tbody></table></details><p><strong>.source</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_description-4"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_description-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.source</code> contient l'expression sourcede <code>formula</code> sous forme de texte.</p><p>Cette propriété est en <strong>lecture seule</strong>.</p><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_exemple-7"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_exemple-7"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$of </span>: 4D.<span class="hljs-keyword">Function</span><span class="hljs-keyword"> var</span> <span class="hljs-variable">$tf </span>: Text <span class="hljs-variable">$of</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-function">String</span>(Current time;HH MM AM PM)) <span class="hljs-variable">$tf</span>:=<span class="hljs-variable">$of</span>.source <span class="hljs-comment">//"String(Current time;HH MM AM PM)"</span></code></pre><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#FolderClass.html"><span class="arrow-prev">←</span><span>Folder</span></a><a class="docs-next button" href="#IMAPTransporterClass.html"><span>IMAPTransporter</span><span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#FunctionClass.html_formula">Formula</a></li><li><a href="#FunctionClass.html_formula-from-string">Formula fromstring</a></li><li><a href="#FunctionClass.html_apply">.apply()</a></li><li><a href="#FunctionClass.html_call">.call()</a></li><li><a href="#FunctionClass.html_source">.source</a></li></ul></nav></div></div></body></html>