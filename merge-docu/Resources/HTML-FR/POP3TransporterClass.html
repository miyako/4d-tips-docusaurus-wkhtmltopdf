<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="fr"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>POP3Transporter · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="La classe `POP3Transporter` vous permet de récupérer des messages à partir d'un serveur de messagerie POP3."name="description" /><meta content="fr" name="docsearch:language" /><meta content="POP3Transporter · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="La classe `POP3Transporter` vous permet de récupérer des messages à partir d'un serveur de messagerie POP3."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#POP3TransporterClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">POP3Transporter<a aria-hidden="true" class="anchor" id="POP3TransporterClass.html"></a></h1></header><article><div><p><span>La classe <code>POP3Transporter</code> vous permet derécupérer des messages à partir d'un serveur de messageriePOP3.</span></p><h3><span><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_objet-pop3-transporter"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_objet-pop3-transporter"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Objet POP3 Transporter</span></h3><p><span>Les objets Transporter POP3 sont instanciés avec lacommande <a href="#POP3TransporterClass.html_pop3-new-transporter">POP3 Newtransporter</a>. Leurs propriétés et fonctions sont les suivantes:</span></p><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#POP3TransporterClass.html_acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong>: Boolean</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>True</strong> si 4D est autoriséà établir une connexion non chiffrée</p></td></tr><tr><td><a href="#POP3TransporterClass.html_authenticationmode"><strong>.authenticationMode</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;le mode d'authentification utilisé pourouvrir la session sur le serveur de mail</p></td></tr><tr><td><a href="#POP3TransporterClass.html_checkconnection"><strong>.checkConnection()</strong>: Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp; vérifie la connexion à l'aide desinformations stockées dans l'objet transporteur</p></td></tr><tr><td><a href="#POP3TransporterClass.html_connectiontimeout"><strong>.connectionTimeOut</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;la durée maximale (en secondes)autorisée avant vérification de la connexion au serveur</p></td></tr><tr><td><a href="#POP3TransporterClass.html_delete"><strong>.delete</strong>(<em>msgNumber</em> : Integer )</a><p>&nbsp;&nbsp;&nbsp;&nbsp;marque l'email <em>msgNumber</em> commedevant être supprimé sur le serveur POP3</p></td></tr><tr><td><a href="#POP3TransporterClass.html_getboxinfo"><strong>.getBoxInfo()</strong>: Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;</p></td></tr><tr><td><a href="#POP3TransporterClass.html_getmail"><strong>.getMail</strong>(<em>msgNumber</em> : Integer ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne l'objet <code>Email</code>correspondant au <em>msgNumber</em> de la boite de réceptiondésignée par le <a href="#POP3TransporterClass.html_pop3-transporter-object"><code>POP3transporter</code></a></p></td></tr><tr><td><a href="#POP3TransporterClass.html_getmailinfo"><strong>.getMailInfo</strong>(<em>msgNumber</em> : Integer ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;</p></td></tr><tr><td><a href="#POP3TransporterClass.html_getmailinfolist"><strong>.getMailInfoList()</strong>: Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne une collection d'objets<code>mailInfo</code> décrivant les messages de la boite deréception désignés par le <a href="#POP3TransporterClass.html_pop3-transporter-object"><code>POP3transporter</code></a></p></td></tr><tr><td><a href="#POP3TransporterClass.html_getmimeasblob"><strong>.getMIMEAsBlob</strong>(<em>msgNumber</em> : Integer ) : Blob</a><p>&nbsp;&nbsp;&nbsp;&nbsp;retourne un BLOB avec le contenu MIME dumessage correspondant au <em>msgNumber</em> dans la boîte deréception désignée par le <a href="#POP3TransporterClass.html_pop3-transporter-object"><code>POP3_transporter</code></a></p></td></tr><tr><td><a href="#POP3TransporterClass.html_host"><strong>.host</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;contient le nom ou l'adresse IP duserveur hôte</p></td></tr><tr><td><a href="#POP3TransporterClass.html_logfile"><strong>.logFile</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;le chemin complet du fichierd'historique qui a été défini (le cas échéant) pour laconnexion</p></td></tr><tr><td><a href="#POP3TransporterClass.html_port"><strong>.port</strong> :Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp; le numéro de port utilisé pour lestransactions d'emails</p></td></tr><tr><td><a href="#POP3TransporterClass.html_undeleteall"><strong>.undeleteAll()</strong></a><p>&nbsp;&nbsp;&nbsp;&nbsp;supprime tous les marqueurs desuppression définis pour les emails de <a href="#POP3TransporterClass.html_pop3-transporter-object"><code>POP3_transporter</code></a></p></td></tr><tr><td><a href="#POP3TransporterClass.html_user"><strong>.user</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; le nom d'utilisateur employé pourl'authentification sur le serveur mail</p></td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_pop3-new-transporter"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_pop3-new-transporter"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>POP3 New transporter</span></h2><details><summary><span>Historique</span></summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R2</td><td>Ajout</td></tr></tbody></table></details><p><span><strong>POP3 New transporter</strong>( <em>server</em> :Object ) : 4D.POP3Transporter</span></p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>server</td><td>object</td><td style="text-align:center">-&gt;</td><td>Informations sur le serveur IMAP</td></tr><tr><td>Résultat</td><td>4D.POP3Transporter</td><td style="text-align:center">&lt;-</td><td><a href="#POP3TransporterClass.html_pop3-transporter-object">Objet POP3transporter</a></td></tr></tbody></table><h4><span><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_description"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</span></h4><p><span>La commande <code>POP3 New transporter</code> configureune nouvelle connexion POP3en fonction du paramètre <em>server</em>et retourne un nouvel objet <em><a href="#POP3TransporterClass.html_pop3-transporter-object">POP3transporter</a></em>. L'objet transporteur retourné sera alorsutilisé pour la réception d'emails.</span></p><p><span>Dans le paramètre <em>server</em>, passez un objetcontenant les propriétés suivantes :</span></p><table><thead><tr><th><em>server</em></th><th>Valeur par défaut (si omise)</th></tr></thead><tbody><tr><td><a href="#POP3TransporterClass.html_acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong>: Boolean</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>True</strong> si 4D est autoriséà établir une connexion non chiffrée</p></td><td>Faux</td></tr><tr><td>.<strong>accessTokenOAuth2</strong>: Text<br />.<strong>accessTokenOAuth2</strong>: Object<p>Chaîne de texte ou objet token représentant les informationsd'autorisation OAuth2. Il est utilisé uniquement avec OAUTH2<code>authenticationMode</code>. Si <code>accessTokenOAuth2</code>est utilisé mais que <code>authenticationMode</code> est omis, leprotocole OAuth 2 est utilisé (si le serveur l'autorise). Nonretourné dans l'objet <em><a href="#POP3TransporterClass.html_smtptransporterobject">SMTPtransporter</a></em>.</p></td><td>aucune</td></tr><tr><td><a href="#POP3TransporterClass.html_authenticationmode"><strong>.authenticationMode</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;le mode d'authentification utilisé pourouvrir la session sur le serveur de mail</p></td><td>le mode d'authentification le plus sûr pris en charge par leserveur est utilisé</td></tr><tr><td><a href="#POP3TransporterClass.html_connectiontimeout"><strong>.connectionTimeOut</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;la durée maximale (en secondes)autorisée avant vérification de la connexion au serveur</p></td><td>30</td></tr><tr><td><a href="#POP3TransporterClass.html_host"><strong>.host</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;contient le nom ou l'adresse IP duserveur hôte</p></td><td><em>obligatoire</em></td></tr><tr><td><a href="#POP3TransporterClass.html_logfile"><strong>.logFile</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;le chemin complet du fichierd'historique qui a été défini (le cas échéant) pour laconnexion</p></td><td>aucune</td></tr><tr><td><strong>.password</strong> : Text<p>Mot de passe de l'utilisateur pour l'authentification sur leserveur. Non retourné dans l'objet <em><a href="#POP3TransporterClass.html_smtptransporterobject">SMTPtransporter</a></em>.</p></td><td>aucune</td></tr><tr><td><a href="#POP3TransporterClass.html_port"><strong>.port</strong> :Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp; le numéro de port utilisé pour lestransactions d'emails</p></td><td>995</td></tr><tr><td><a href="#POP3TransporterClass.html_user"><strong>.user</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; le nom d'utilisateur employé pourl'authentification sur le serveur mail</p></td><td>aucune</td></tr></tbody></table><h4><span><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_r%C3%A9sultat"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_r%25C3%25A9sultat"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Résultat</span></h4><p><span>La fonction retourne un <a href="#POP3TransporterClass.html_pop3-transporter-object"><strong>objetPOP3 transporter</strong></a>. Toutes les propriétés retournéessont en <strong>lecture seule</strong>.</span></p><blockquote><p><span>La connexion POP3 est automatiquement fermée lorsquel'objet transporteur est détruit.</span></p></blockquote><h4><span><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_exemple"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_exemple"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</span></h4><pre><span><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"pop.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">995</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$server</span>.logFile:=<span class="hljs-string">"LogTest.txt"</span> <span class="hljs-comment">//log à enregistrer dans le dossier Logs</span><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.POP3Transporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">POP3 New transporter</span>(<span class="hljs-variable">$server</span>) <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">checkConnection</span>()<span class="hljs-keyword"> If</span>(<span class="hljs-function">Not</span>(<span class="hljs-variable">$status</span>.success))<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"An error occurred receiving the mail: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End if</span></code></span></pre><h2><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_4dpop3transporternew"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_4dpop3transporternew"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4D.POP3Transporter.new()</h2><p><strong>4D.POP3Transporter.new</strong>( <em>server</em> :Object ) : 4D.POP3Transporter</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>server</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Informations sur le serveur IMAP</td></tr><tr><td>Résultat</td><td>4D.POP3Transporter</td><td style="text-align:center">&lt;-</td><td><a href="#POP3TransporterClass.html_pop3-transporter-object">Objet POP3transporter</a></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description-1"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_description-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>4D.POP3Transporter.new()</code> crée etretourne un nouvel objet de type <code>4D.POP3Transporter</code>.Elle est identique à la commande <a href="#POP3TransporterClass.html_pop3-new-transporter"><code>POP3 Newtransporter</code></a> (raccourci).</p><h2><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_acceptunsecureconnection"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_acceptunsecureconnection"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.acceptUnsecureConnection</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R4</td><td>Ajout</td></tr></tbody></table></details><p><strong>.acceptUnsecureConnection</strong> : Boolean</p><h4><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description-2"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_description-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.acceptUnsecureConnection</code> contient<strong>True</strong> si 4D est autorisé à établir une connexionnon chiffrée lorsqu'une connexion chiffrée n'est pas possible.</p><p>Elle contient <strong>False</strong> si les connexions nonchiffrées ne sont pas autorisées, auquel cas une erreur estretournée lorsque la connexion chiffrée n'est pas possible.</p><p>Ports sécurisés disponibles :</p><ul><li><p>SMTP</p><ul><li>465: SMTPS</li><li>587 ou 25 : SMTP avec mise à niveau STARTTLS si le serveur leprend en charge.</li></ul></li><li><p>IMAP</p><ul><li>143 : Port IMAP non chiffré</li><li>993 : IMAP avec mise à niveau STARTTLS si le serveur le prenden charge</li></ul></li><li><p>POP3</p><ul><li>110 : Port POP3 non chiffré</li><li>995 : POP3 avec mise à niveau STARTTLS si le serveur le prenden charge.</li></ul></li></ul><h2><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_authenticationmode"></a><a aria-hidden="true" class="hash-link" href="#POP3TransporterClass.html_authenticationmode"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.authenticationMode</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R4</td><td>Ajout</td></tr></tbody></table></details><p><strong>.authenticationMode</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description-3"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_description-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.authenticationMode</code> contient le moded'authentification utilisé pour ouvrir la session sur le serveur demessagerie.</p><p>Par défaut, le mode le plus sécurisé pris en charge par leserveur est utilisé.</p><p>Valeurs possibles :</p><table><thead><tr><th>Valeur</th><th>Constantes</th><th>Commentaire</th></tr></thead><tbody><tr><td>APOP</td><td><code>POP3 authentication APOP</code></td><td>Authentification à l'aide du protocole APOP (POP3uniquement)</td></tr><tr><td>CRAM-MD5</td><td><code>POP3 authentication CRAM-MD5</code></td><td>Authentification à l'aide du protocole CRAM-MD5</td></tr><tr><td>LOGIN</td><td><code>POP3 authentication login</code></td><td>Authentification à l'aide du protocole LOGIN</td></tr><tr><td>OAUTH2</td><td><code>POP3 authentication OAUTH2</code></td><td>Authentification à l'aide du protocole OAuth2</td></tr><tr><td>PLAIN</td><td><code>POP3 authentication plain</code></td><td>Authentification à l'aide du protocole PLAIN</td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_checkconnection"></a><a aria-hidden="true" class="hash-link" href="#POP3TransporterClass.html_checkconnection"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.checkConnection()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R4</td><td>Ajout</td></tr></tbody></table></details><p><strong>.checkConnection()</strong> : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Statut de la connexion de l'objet transporteur</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description-4"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_description-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La fonction <code>.checkConnection()</code> vérifie la connexionà l'aide des informations stockées dans l'objet transporteur,recrée la connexion si nécessaire et retourne son statut. Cettefonction vous permet de vérifier que les valeurs fournies parl'utilisateur sont valides et cohérentes.</p><h4><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_objet-retourn%C3%A9"></a><a aria-hidden="true" class="hash-link" href="#POP3TransporterClass.html_objet-retourn%25C3%25A9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Objet retourné</h4><p>La fonction envoie une requête au serveur de mail et retourne unobjet décrivant le statut. Cet objet peut avoir les propriétéssuivantes :</p><table><thead><tr><th>Propriété</th><th></th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>success</td><td></td><td>boolean</td><td>Vrai si la vérification a été effectuée avec succès, sinonFaux</td></tr><tr><td>status</td><td></td><td>number</td><td>(SMTP uniquement) Code du statut retourné par le serveur demessagerie (0 en cas de problème non lié au traitement dumail)</td></tr><tr><td>statusText</td><td></td><td>text</td><td>Message du statut retourné par le serveur de messagerie, oudernière erreur retournée dans la pile d'erreurs 4D</td></tr><tr><td>errors</td><td></td><td>collection</td><td>Pile d'erreurs 4D (non retournée si une réponse du serveur demessagerie est reçue)</td></tr><tr><td></td><td>[ ].errCode</td><td>number</td><td>Code d'erreur 4D</td></tr><tr><td></td><td>[ ].message</td><td>text</td><td>Description de l'erreur 4D</td></tr><tr><td></td><td>[ ].componentSignature</td><td>text</td><td>Signature du composant interne qui a retourné l'erreur</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_exemple-1"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_exemple-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$pw </span>:  Text<span class="hljs-keyword"> var</span> <span class="hljs-variable">$options </span>: Object <span class="hljs-variable">$options</span>:=New object <span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-function"> if</span>(OK=<span class="hljs-number">1</span>)    <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"pop3.gmail.com"</span>    <span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span>    <span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span>    <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">POP3 New transporter</span>(<span class="hljs-variable">$options</span>)    <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">checkConnection</span>()<span class="hljs-keyword">    If</span>(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"POP3 connection check successful!"</span>)<span class="hljs-keyword">    Else</span><span class="hljs-function">       ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">    End if</span><span class="hljs-keyword"> End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_connectiontimeout"></a><a aria-hidden="true" class="hash-link" href="#POP3TransporterClass.html_connectiontimeout"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.connectionTimeOut</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R5</td><td>Ajout</td></tr></tbody></table></details><p><strong>.connectionTimeOut</strong> : Integer</p><h4><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description-5"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_description-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.connectionTimeOut</code> contient la duréemaximale (en secondes) autorisée avant vérification de la connexionau serveur. Par défaut, si la propriété n'a pas été définie dansl'objet server (utilisé pour créer l'objet transporteur avec<code>SMTP New transporter</code>, <code>POP3 Newtransporter</code>, <code>IMAP New transporter</code>), la valeurutilisée est 30.</p><h2><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_delete"></a><a aria-hidden="true" class="hash-link" href="#POP3TransporterClass.html_delete"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.delete()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R2</td><td>Ajout</td></tr></tbody></table></details><p><strong>.delete</strong>( <em>msgNumber</em> : Integer )</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>msgNumber</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Numéro du message à supprimer</td></tr></tbody></table><h5><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description-6"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_description-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h5><p>La fonction <code>.delete( )</code> marque l'email<em>msgNumber</em> comme devant être supprimé sur le serveurPOP3.</p><p>Dans le paramètre <em>msgNumber</em>, passez le numéro del'email à supprimer. Ce numéro est retourné dans la propriéténumber par la fonction <a href="#POP3TransporterClass.html_getmailinfolist"><code>.getMailInfoList()</code></a>.</p><p>L'exécution de cette méthode ne supprime pas réellement l'email.L'email marqué sera supprimé sur le serveur POP3 uniquement lorsquel'objet <code>POP3_transporter</code> (créé à l'aide de <code>POP3New transporter</code>) sera détruit. Le marqueur pourra égalementêtre retiré via la fonction <code>.undeleteAll()</code>.</p><blockquote><p>Si la session courante se termine inopinément et que leconnexion est fermée (ex : timeout, panne de réseau, etc.), unmessage d'erreur est généré et les messages marqués poursuppression demeureront sur le serveur POP3.</p></blockquote><h5><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_exemple-2"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_exemple-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h5><pre><code class="hljs css language-4d"> <span class="hljs-variable">$mailInfoList</span>:=<span class="hljs-variable">$POP3_transporter</span>.<span class="hljs-function">getMailInfoList</span>()<span class="hljs-keyword"> For each</span>(<span class="hljs-variable">$mailInfo</span>;<span class="hljs-variable">$mailInfoList</span>)  <span class="hljs-comment">// Marquer votre e-mail comme "à supprimer à la fin de la session"</span>    <span class="hljs-variable">$POP3_transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$mailInfo</span>.number)<span class="hljs-keyword"> End for each</span>  <span class="hljs-comment">// Forcer la fermeture de la session pour supprimer les e-mails marqués pour suppression</span><span class="hljs-function"> CONFIRM</span>(<span class="hljs-string">"Selected messages will be deleted."</span>;<span class="hljs-string">"Delete"</span>;<span class="hljs-string">"Undo"</span>)<span class="hljs-keyword"> If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-comment">//suppression confirmée</span>    <span class="hljs-variable">$POP3_transporter</span>:=<span class="hljs-literal">Null</span><span class="hljs-keyword"> Else</span>    <span class="hljs-variable">$POP3_transporter</span>.<span class="hljs-function">undeleteAll</span>() <span class="hljs-comment">//supprimer les marqueurs de suppression</span><span class="hljs-keyword"> End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_getboxinfo"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_getboxinfo"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getBoxInfo()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R2</td><td>Ajout</td></tr></tbody></table></details><p><strong>.getBoxInfo()</strong> : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Objet boxInfo</td></tr></tbody></table><h5><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description-7"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_description-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h5><p>La fonction <code>.getBoxInfo()</code>retourne un objet<code>boxInfo</code> correspondant à la boîte de réception désignéepar le <a href="#POP3TransporterClass.html_pop3-transporter-object"><code>POP3transporter</code></a>. Cette fonction vous permet de récupérer desinformations sur la boite de réception.</p><p>L'objet <code>boxInfo</code> contient les propriété suivantes:</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>mailCount</td><td>Nombre</td><td>Nombre de messages contenus dans la boîte de réception</td></tr><tr><td>size</td><td>Nombre</td><td>Taille du message en octets</td></tr></tbody></table><h5><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_exemple-3"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_exemple-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h5><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>; <span class="hljs-variable">$boxinfo </span>: Object <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"pop.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">995</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">POP3 New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//mailbox info</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxInfo</span>()<span class="hljs-function"> ALERT</span>(<span class="hljs-string">"The mailbox contains "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$boxInfo</span>.mailCount)+<span class="hljs-string">" messages."</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_getmail"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_getmail"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getMail()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R2</td><td>Ajout</td></tr></tbody></table></details><p><strong>.getMail</strong>( <em>msgNumber</em> : Integer ) :Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>msgNumber</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Numéro du message dans la liste</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td><a href="#POP3TransporterClass.html_email-object">Objetemail</a></td></tr></tbody></table><h5><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description-8"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_description-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h5><p>La fonction <code>.getMail()</code> retourne l'objet<code>Email</code> correspondant au <em>msgNumber</em> de la boitede réception désignée par le <a href="#POP3TransporterClass.html_pop3-transporter-object"><code>POP3transporter</code></a>. Cette fonction vous permet de gérerlocalement le contenu de l'email.</p><p>Passez dans <em>msgNumber</em> le numéro du message à récupérer.Ce numéro est retourné dans la propriété number par la fonction<a href="#POP3TransporterClass.html_getmailinfolist"><code>.getMailInfoList()</code></a>.</p><p>La fonction retourne Null si :</p><ul><li><em>msgNumber</em> désigne un message inexistant,</li><li>le message a été marqué pour suppression à l'aide de<code>.delete()</code>.</li></ul><p><strong>Objet retourné</strong></p><p><code>.getMail()</code> retourne un <a href="#POP3TransporterClass.html_email-object">objet<code>Email</code></a>.</p><h5><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_exemple-4"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_exemple-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h5><p>Vous souhaitez connaitre l'expéditeur du premier mail de laboite de réception :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>; <span class="hljs-variable">$transporter </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$mailInfo </span>: Collection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$sender </span>: Variant <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"pop.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">995</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">POP3 New transporter</span>(<span class="hljs-variable">$server</span>) <span class="hljs-variable">$mailInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMailInfoList</span>() <span class="hljs-variable">$sender</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMail</span>(<span class="hljs-variable">$mailInfo</span>[<span class="hljs-number">0</span>].number).from</code></pre><h2><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_getmailinfo"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_getmailinfo"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getMailInfo()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R2</td><td>Ajout</td></tr></tbody></table></details><p><strong>.getMailInfo</strong>( <em>msgNumber</em> : Integer ) :Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>msgNumber</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Numéro du message dans la liste</td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Objet MailInfo</td></tr></tbody></table><h5><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description-9"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_description-9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h5><p>La fonction <code>.getMailInfo()</code>retourne un objet<code>mailInfo</code> correspondant au <em>msgNumber</em> de laboite de réception désignée par le <a href="#POP3TransporterClass.html_pop3-transporter-object"><code>POP3transporter</code></a>. Cette fonction vous permet de récupérer desinformations sur l'email.</p><p>Dans le paramètre <em>msgNumber</em>, passez le numéro del'email à récupérer. Ce numéro est retourné dans la propriéténumber par la fonction <a href="#POP3TransporterClass.html_getmailinfolist"><code>.getMailInfoList()</code></a>.</p><p>L'objet <code>mailInfo</code> retourné contient les propriétésuivantes :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>size</td><td>Nombre</td><td>Taille du message en octets</td></tr><tr><td>id</td><td>Text</td><td>ID unique du message</td></tr></tbody></table><p>La fonction retourne <strong>Null</strong> si :</p><ul><li><em>msgNumber</em> désigne un message inexistant,</li><li>le message a été marqué pour suppression à l'aide de<code>.delete()</code>.</li></ul><h5><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_exemple-5"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_exemple-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h5><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>; <span class="hljs-variable">$mailInfo </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$mailNumber </span>: Integer <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"pop.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">995</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.POP3Transporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">POP3 New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//message info</span> <span class="hljs-variable">$mailInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMailInfo</span>(<span class="hljs-number">1</span>) <span class="hljs-comment">//obtenir le premier e-mail</span><span class="hljs-keyword"> If</span>(<span class="hljs-variable">$mailInfo </span>#<span class="hljs-literal">Null</span>)<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"First mail size is:"</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$mailInfo</span>.size)+<span class="hljs-string">" bytes."</span>)<span class="hljs-keyword"> End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_getmailinfolist"></a><a aria-hidden="true" class="hash-link" href="#POP3TransporterClass.html_getmailinfolist"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getMailInfoList()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R2</td><td>Ajout</td></tr></tbody></table></details><p><strong>.getMailInfoList()</strong> : Collection</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>Résultat</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Collection d'objets <code>mailInfo</code></td></tr></tbody></table><h5><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description-10"></a><a aria-hidden="true" class="hash-link" href="#POP3TransporterClass.html_description-10"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h5><p>La fonction <code>.getMailInfoList()</code> retourne unecollection d'objets <code>mailInfo</code> décrivant les messages dela boite de réception désignés par le <a href="#POP3TransporterClass.html_pop3-transporter-object"><code>POP3transporter</code></a>. Cette fonction vous permet de gérerlocalement les listes de messages situés sur le serveur demessagerie POP3.</p><p>Chaque objet <code>mailInfo</code> retourné contient lespropriété suivantes :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>[ ].size</td><td>Nombre</td><td>Taille du message en octets</td></tr><tr><td>[ ].number</td><td>Nombre</td><td>Numéro du message</td></tr><tr><td>[ ].id</td><td>Text</td><td>ID unique du message (utile si vous stockez le messagelocalement)</td></tr></tbody></table><p>Si la boîte de réception ne contient pas de message, unecollection vide est retournée.</p><h4><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_propri%C3%A9t%C3%A9s-number-et-id"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_propri%25C3%25A9t%25C3%25A9s-number-et-id"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Propriétés number et ID</h4><p><em>number</em> est le numéro d'un message de la boite deréception au moment de la création du<code>POP3_transporter</code>. La propriété <em>number</em> n'estpas une valeur statique liée à un message spécifique. Elle changed'une session à l'autre en fonction de sa relation à d'autresmessages de la boîte de réception au moment de l'ouverture de lasession. Les numéros assignés aux messages sont valides uniquementpendant la durée de vie du <a href="#POP3TransporterClass.html_pop3-transporter-object"><code>POP3_transporter</code></a>.Lorsque le <code>POP3_transporter</code> est supprimé, les messagesmarqués pour suppression seront supprimés. Lorsque l'utilisateur sereconnecte au serveur, les messages courants de la boîte deréception sont renumérotés de 1 à x.</p><p>A l'inverse, <em>id</em> est un numéro unique assigné à unmessage lorsqu'il a été reçu par le serveur. Ce numéro est calculéà l'aide de l'heure et de la date de réception du message et savaleur est assignée par votre serveur POP3. Malheureusement, lesserveurs POP3 n'utilisent pas l'<em>id</em> comme référenceprimaire à leurs messages. Durant les sessions POP3, vous aurezbesoin d'indiquer le <em>number</em> comme référence aux messagesdu serveur. Les développeurs doivent être vigilants s'ilsdéveloppent des solutions qui importent des références aux messagesdans une base de données tout en laissant le corps du message surle serveur.</p><h5><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_exemple-6"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_exemple-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h5><p>Vous souhaitez connaitre le nombre total d'emails de la boîte deréception ainsi que leur taille :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"pop.gmail.com"</span> <span class="hljs-comment">//Obligatoire</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">995</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.POP3Transporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">POP3 New transporter</span>(<span class="hljs-variable">$server</span>)<span class="hljs-function"> C_COLLECTION</span>(<span class="hljs-variable">$mailInfo</span>)<span class="hljs-function"> C_LONGINT</span>(<span class="hljs-variable">$vNum</span>;<span class="hljs-variable">$vSize</span>) <span class="hljs-variable">$mailInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMailInfoList</span>() <span class="hljs-variable">$vNum</span>:=<span class="hljs-variable">$mailInfo</span>.length <span class="hljs-variable">$vSize</span>:=<span class="hljs-variable">$mailInfo</span>.<span class="hljs-function">sum</span>(<span class="hljs-string">"size"</span>)<span class="hljs-function"> ALERT</span>(<span class="hljs-string">"The mailbox contains "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$vNum</span>)+<span class="hljs-string">" message(s) for "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$vSize</span>)+<span class="hljs-string">" bytes."</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_getmimeasblob"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_getmimeasblob"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getMIMEAsBlob()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R3</td><td>Ajout</td></tr></tbody></table></details><p><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer ): Blob</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>msgNumber</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Numéro du message dans la liste</td></tr><tr><td>Résultat</td><td>Blob</td><td style="text-align:center">&lt;-</td><td>Blob de la chaine MIME retournée par le serveur mail</td></tr></tbody></table><h5><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description-11"></a><a aria-hidden="true" class="hash-link" href="#POP3TransporterClass.html_description-11"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h5><p>La fonction <code>.getMIMEAsBlob()</code> retourne un BLOB avecle contenu MIME du message correspondant au <em>msgNumber</em> dansla boîte de réception désignée par le <a href="#POP3TransporterClass.html_pop3-transporter-object"><code>POP3_transporter</code></a>.</p><p>Dans le paramètre <em>msgNumber</em>, passez le numéro del'email à récupérer. Ce numéro est retourné dans la propriéténumber par la fonction <a href="#POP3TransporterClass.html_getmailinfolist"><code>.getMailInfoList()</code></a>.</p><p>La fonction retourne un Blob vide si :</p><ul><li><em>msgNumber</em> désigne un message inexistant,</li><li>le message a été marqué pour suppression à l'aide de<code>.delete()</code>.</li></ul><p><strong>BLOB retourné</strong></p><p><code>.getMIMEAsBlob()</code> retourne un <code>BLOB</code> quipeut être archivé dans une base de données ou converti en un objet<a href="#POP3TransporterClass.html_objet-email"><code>Email</code></a>avec la commande <code>MAIL Convert from MIME</code>.</p><h5><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_exemple-7"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_exemple-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h5><p>Vous souhaitez connaitre le nombre total d'emails de la boîte deréception ainsi que leur taille :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$mailInfo </span>: Collection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$blob </span>: Blob<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.POP3Transporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"pop.gmail.com"</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">995</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">POP3 New transporter</span>(<span class="hljs-variable">$server</span>) <span class="hljs-variable">$mailInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMailInfoList</span>() <span class="hljs-variable">$blob</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMIMEAsBlob</span>(<span class="hljs-variable">$mailInfo</span>[<span class="hljs-number">0</span>].number)</code></pre><h2><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_host"></a><a aria-hidden="true" class="hash-link" href="#POP3TransporterClass.html_host"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.host</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R5</td><td>Ajout</td></tr></tbody></table></details><p><strong>.host</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description-12"></a><a aria-hidden="true" class="hash-link" href="#POP3TransporterClass.html_description-12"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.host</code> contient contient le nom oul'adresse IP du serveur hôte. Utilisée pour les échanges decourrier (SMTP, POP3, IMAP).</p><h2><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_logfile"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_logfile"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.logFile</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R5</td><td>Ajout</td></tr></tbody></table></details><p><strong>.logFile</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description-13"></a><a aria-hidden="true" class="hash-link" href="#POP3TransporterClass.html_description-13"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.logFile</code> contient le chemin complet dufichier d'historique qui a été défini (le cas échéant) pour laconnexion. Elle peut être relative (au dossier Logs courant) ouabsolue.</p><p>Contrairement aux fichiers log habituels (activés via lacommande <code>SET DATABASE PARAMETER</code>), les fichiers logétendus stockent le contenu MIME de tous les emails envoyés etn'ont pas de limite de taille. Pour plus d'informations sur lesfichiers log étendus, reportez-vous à :</p><ul><li><strong>Connexions SMTP</strong> - <a href="#POP3TransporterClass.html_4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DSMTPLog.txt</a></li><li><strong>Connexions POP3</strong> - <a href="#POP3TransporterClass.html_4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DPOP3Log.txt</a></li><li><strong>Connexions IMAP</strong> - <a href="#POP3TransporterClass.html_4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DIMAPLog.txt</a></li></ul><h2><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_port"></a><a aria-hidden="true" class="hash-link" href="#POP3TransporterClass.html_port"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.port</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R4</td><td>Ajout</td></tr></tbody></table></details><p><strong>.port</strong> : Integer</p><h4><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description-14"></a><a aria-hidden="true" class="hash-link" href="#POP3TransporterClass.html_description-14"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.port</code> contient le numéro de portutilisé pour les transactions d'emails. Par défaut, si la propriété<em>port</em> n'a pas été définie dans l'objet <em>server</em>(utilisé pour créer l'objet transporteur avec <code>SMTP Newtransporter</code>, <code>POP3 New transporter</code>, <code>IMAPNew transporter</code>), le port utilisé est :</p><ul><li><strong>SMTP</strong> - 587</li><li><strong>POP3</strong> - 995</li><li><strong>IMAP</strong> - 993</li></ul><h2><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_undeleteall"></a><a aria-hidden="true"class="hash-link" href="#POP3TransporterClass.html_undeleteall"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.undeleteAll()</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18 R2</td><td>Ajout</td></tr></tbody></table></details><p><strong>.undeleteAll()</strong> | Paramètres | Type | |Description | | ---------- | ---- |::| ---------------------------| | | | | Ne requiert aucun paramètre |</p><h5><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description-15"></a><a aria-hidden="true" class="hash-link" href="#POP3TransporterClass.html_description-15"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h5><p>La fonction <code>.undeleteAll()</code> supprime tous lesmarqueurs de suppression définis pour les emails de <a href="#POP3TransporterClass.html_pop3-transporter-object"><code>POP3_transporter</code></a>.</p><h2><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_user"></a><a aria-hidden="true" class="hash-link" href="#POP3TransporterClass.html_user"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.user</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v17 R4</td><td>Ajout</td></tr></tbody></table></details><p><strong>.user</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="POP3TransporterClass.html_description-16"></a><a aria-hidden="true" class="hash-link" href="#POP3TransporterClass.html_description-16"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.user</code> contient le nom d'utilisateuremployé pour l'authentification sur le serveur mail.</p><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#MailAttachmentClass.html"><span class="arrow-prev">←</span><span class="function-name-prevnext">MailAttachment</span></a><a class="docs-next button" href="#SessionClass.html"><span>Session</span><span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#POP3TransporterClass.html_pop3-new-transporter">POP3New transporter</a></li><li><a href="#POP3TransporterClass.html_4dpop3transporternew">4D.POP3Transporter.new()</a></li><li><a href="#POP3TransporterClass.html_acceptunsecureconnection">.acceptUnsecureConnection</a></li><li><a href="#POP3TransporterClass.html_authenticationmode">.authenticationMode</a></li><li><a href="#POP3TransporterClass.html_checkconnection">.checkConnection()</a></li><li><a href="#POP3TransporterClass.html_connectiontimeout">.connectionTimeOut</a></li><li><a href="#POP3TransporterClass.html_delete">.delete()</a></li><li><a href="#POP3TransporterClass.html_getboxinfo">.getBoxInfo()</a></li><li><a href="#POP3TransporterClass.html_getmail">.getMail()</a></li><li><a href="#POP3TransporterClass.html_getmailinfo">.getMailInfo()</a></li><li><a href="#POP3TransporterClass.html_getmailinfolist">.getMailInfoList()</a></li><li><a href="#POP3TransporterClass.html_getmimeasblob">.getMIMEAsBlob()</a></li><li><a href="#POP3TransporterClass.html_host">.host</a></li><li><a href="#POP3TransporterClass.html_logfile">.logFile</a></li><li><a href="#POP3TransporterClass.html_port">.port</a></li><li><a href="#POP3TransporterClass.html_undeleteall">.undeleteAll()</a></li><li><a href="#POP3TransporterClass.html_user">.user</a></li></ul></nav></div></div></body></html>