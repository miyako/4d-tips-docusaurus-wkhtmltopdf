<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="fr"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>ZIPArchive · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="Une archive ZIP 4D est un objet `File` ou `Folder` contenant un ou plusieurs fichiers ou dossiers, qui sont compressés afin d'être plus petits que leur taille d'origine. Ces archives sont créées avec une extension &quot;.zip&quot; et peuvent être utilisées pour économiser de l'espace sur le disque ou transférer des fichiers sur des supports de taille limitée (par exemple, l'email ou le réseau)."name="description" /><meta content="fr" name="docsearch:language" /><meta content="ZIPArchive · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="Une archive ZIP 4D est un objet `File` ou `Folder` contenant un ou plusieurs fichiers ou dossiers, qui sont compressés afin d'être plus petits que leur taille d'origine. Ces archives sont créées avec une extension &quot;.zip&quot; et peuvent être utilisées pour économiser de l'espace sur le disque ou transférer des fichiers sur des supports de taille limitée (par exemple, l'email ou le réseau)."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#ZipArchiveClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">ZIPArchive<a aria-hidden="true" class="anchor" id="ZipArchiveClass.html"></a></h1></header><article><div><p><span>Une archive ZIP 4D est un objet <code>File</code> ou<code>Folder</code> contenant un ou plusieurs fichiers ou dossiers,qui sont compressés afin d'être plus petits que leur tailled'origine. Ces archives sont créées avec une extension ".zip" etpeuvent être utilisées pour économiser de l'espace sur le disque outransférer des fichiers sur des supports de taille limitée (parexemple, l'email ou le réseau).</span></p><ul><li><span>Créez une archive ZIP 4D avec la commande <a href="#ZipArchiveClass.html_zip-create-archive">ZIP Createarchive</a>.</span></li><li><span>Les instances <a href="#ZipFileClass.html"><code>ZIPFile</code></a> et <a href="#ZipFolderClass.html"><code>ZIPFolder</code></a> de 4D sontdisponibles via la propriété <a href="#ZipArchiveClass.html_root"><code>root</code></a>(<code>ZIPFolder</code>) de l'objet retourné par la commande<a href="#ZipArchiveClass.html_zip-read-archive">ZIP Readarchive</a>.</span></li></ul><h3><span><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_exemple"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_exemple"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</span></h3><p><span>Pour récupérer et visualiser le contenu d'un objet ZIPfile :</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$path</span>; <span class="hljs-variable">$archive </span>: 4D.File<span class="hljs-keyword">var</span> <span class="hljs-variable">$zipFile </span>: 4D.ZipFile<span class="hljs-keyword">var</span> <span class="hljs-variable">$zipFolder </span>: 4D.ZipFolder<span class="hljs-keyword">var</span> <span class="hljs-variable">$txt </span>: Text<span class="hljs-variable">$path</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/Archive.zip"</span>)<span class="hljs-variable">$archive</span>:=<span class="hljs-function">ZIP Read archive</span>(<span class="hljs-variable">$path</span>)<span class="hljs-variable">$zipFolder</span>:=<span class="hljs-variable">$archive</span>.root <span class="hljs-comment">// stocker le dossier principal du zip</span><span class="hljs-variable">$zipFile</span>:=<span class="hljs-variable">$zipFolder</span>.<span class="hljs-function">files</span>()[<span class="hljs-number">0</span>] <span class="hljs-comment">//lire le premier fichier zippé</span><span class="hljs-keyword">If</span>(<span class="hljs-variable">$zipFile</span>.extension=<span class="hljs-string">".txt"</span>)    <span class="hljs-variable">$txt</span>:=<span class="hljs-variable">$zipFile</span>.<span class="hljs-function">getText</span>()<span class="hljs-keyword">End if</span></code></span></pre><h3><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_sommaire"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_sommaire"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Sommaire</h3><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#ZipArchiveClass.html_root"><strong>.root</strong> :4D.ZipFolder</a><p>&nbsp;&nbsp;&nbsp;&nbsp;Un dossier virtuel permettant d'accéderau contenu de l'archive ZIP</p></td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_zip-create-archive"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_zip-create-archive"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>ZIP Create archive</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v19 R3</td><td>Ajout des propriétés <code>ZIP Compression LZMA</code>,<code>ZIP Compression xy</code>, <code>.level</code></td></tr><tr><td>v18</td><td>Ajout</td></tr></tbody></table></details><p><strong>ZIP Create archive</strong> ( <em>fileToZip</em> :4D.File ; <em>destinationFile</em> : 4D.File ) : Object<br /><strong>ZIP Create archive</strong> ( <em>folderToZip</em> :4D.Folder ; <em>destinationFile</em> : 4D.File { ; <em>options</em>: Integer }) : Object<br /><strong>ZIP Create archive</strong> ( <em>zipStructure</em> :Object ; <em>destinationFile</em> : 4D.File ) : Object</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>fileToZip</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>Objet fichier ou dossier à compresser</td></tr><tr><td>folderToZip</td><td>4D.Folder</td><td style="text-align:center">-&gt;</td><td>Objet fichier ou dossier à compresser</td></tr><tr><td>zipStructure</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Objet fichier ou dossier à compresser</td></tr><tr><td>destinationFile</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>Fichier de destination de l'archive</td></tr><tr><td>options</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Si <em>folderToZip</em> utilisé : <code>ZIP Without enclosingfolder</code></td></tr><tr><td>Résultat</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Objet statut</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_description"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_description"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La commande <code>ZIP Create archive</code> crée un objetarchive ZIP compressé et retourne le statut de l'opération.</p><p>Vous pouvez passer un objet 4D.File, 4D.Folder, ou une structureZip en tant que premier paramètre :</p><ul><li><p><em>fileToZip</em> : passez simplement un <code>4D.File</code> àcompresser.</p></li><li><p><em>folderToZip</em> : passez un <code>4D.Folder</code> àcompresser. Dans ce cas, le paramètre <em>options</em> vous permetde compresser uniquement le contenu du dossier (c'est-à-dired'exclure le dossier parent). Par défaut, l'archive <code>ZIPCreate archive</code> compressera le dossier et son contenu, desorte que l'opération de décompression recrée un dossier. Si voussouhaitez que l'opération de décompression ne restaure que lecontenu du dossier, passez la constante <code>ZIP Without enclosingfolder</code> dans le paramètre <em>options</em>.</p></li><li><p><em>zipStructure</em> : passez un objet décrivant l'objet ZIParchive. Les propriétés suivantes sont disponibles pour définir lastructure :</p></li></ul><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>compression</td><td>Integer</td><td><ul><li><code>ZIP Compression standard</code>: Réduire la compression(par défaut)</li><li><code>ZIP Compression LZMA</code>: compression LZMA</li><li><code>ZIP Compression XZ</code>: compression XZ</li><li><code>ZIP Compression none</code>: Pas de compression</li></ul></td></tr><tr><td>level</td><td>Integer</td><td>Niveau de compression. Valeurs possibles : 1 à 10. Une valeurplus faible produira un fichier plus volumineux, tandis qu'unevaleur plus élevée produira un fichier plus petit. Le niveau decompression a toutefois un impact sur les performances. Valeur pardéfaut (si omis) :<ul><li><code>ZIP Compression standard</code>: 6</li><li><code>ZIP Compression LZMA</code>: 4</li><li><code>ZIP Compression XZ</code>: 4</li></ul></td></tr><tr><td>encryption</td><td>Integer</td><td>Le chiffrement à utiliser si un mot de passe est défini :<ul><li><code>ZIP Encryption AES128</code>: chiffrement AES à l'aided'une clé 128 octets.</li><li><code>ZIP Encryption AES192</code>: chiffrement AES à l'aided'une clé 192 octets.</li><li><code>ZIP Encryption AES256</code>: chiffrement AES à l'aided'une clé 256 octets (par défaut si un mot de passe estdéfini).</li><li><code>ZIP Encryption none</code>: les données ne sont paschiffrées (par défaut si aucun mot de passe n'est défini)</li></ul></td></tr><tr><td>password</td><td>Text</td><td>Un mot de passe à définir si le chiffrement est requis.</td></tr><tr><td>Historique</td><td>Collection</td><td><ul><li>une collection d'objets <code>4D.File</code> ou<code>4D.Folder</code> ou</li><li>une collection d'objets dont les propriétés sont les suivantes:</li><table><tr><td>Propriété</td><td>Type</td><td>Description</td></tr><tr><td>source</td><td>4D.File ou 4D.Folder</td><td>File ou Folder</td></tr><tr><td>destination</td><td>Text</td><td>(facultatif) - Indiquer un chemin de fichier relatif pourmodifier l'organisation du contenu de l'archive</td></tr><tr><td>option</td><td>number</td><td>(facultatif) - <code>ZIP Ignore invisible files</code> ou 0pour compresser tout le fichier</td></tr></table></ul></td></tr><tr><td>callback</td><td>4D.Function</td><td>Une formule de rétro-appel qui recevra la progression de lacompression (0 à 100) dans $1.</td></tr></tbody></table><p>Dans le paramètre <em>destinationFile</em>, passez un objet<code>4D.File</code> décrivant l'archive ZIP à créer (nom,emplacement, etc.). Il est conseillé d'utiliser l'extension ".zip"si vous souhaitez que l'archive ZIP soit traitée automatiquementpar un logiciel.</p><p>Une fois que l'archive est créée, vous pouvez utiliser lacommande <a href="#ZipArchiveClass.html_zip-read-archive">ZIP Readarchive</a> pour y accéder.</p><p><strong>Objet statut</strong></p><p>L'objet statut retourné contient les propriétés suivantes :</p><table><thead><tr><th>Propriété</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>statusText</td><td>Text</td><td>Message d'erreur (le cas échéant) :<ul><li>Impossible d'ouvrir l'archive ZIP</li><li>Impossible de créer une archive ZIP</li><li>Le mot de passe est requis pour le chiffrement</li></ul></td></tr><tr><td>status</td><td>Integer</td><td>Code d'état</td></tr><tr><td>success</td><td>Boolean</td><td>Vrai si l'archive a été créée avec succès, sinon faux</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_exemple-1"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_exemple-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 1</h4><p>Pour compresser un <code>4D.File</code> :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$file</span>; <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/file.zip"</span>) <span class="hljs-variable">$file</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/text.txt"</span>) <span class="hljs-variable">$status</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$file</span>;<span class="hljs-variable">$destination</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_exemple-2"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_exemple-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 2</h4><p>Pour compresser un <code>4D.Folder</code> sans le dossierlui-même :</p><pre><code class="hljs css language-4D"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$folder </span>: 4D.Folder<span class="hljs-keyword"> var</span> <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/Images.zip"</span>) <span class="hljs-variable">$folder</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"MyDocs/Images"</span>) <span class="hljs-variable">$status</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$folder</span>;<span class="hljs-variable">$destination</span>;ZIP Without enclosing folder)</code></pre><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_exemple-3"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_exemple-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 3</h4><p>Pour compresser une structure d'archive ZIP avec un mot de passeet une barre de progression :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$zip</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> progID : Integer <span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/Archive.zip"</span>) <span class="hljs-variable">$zip</span>:=New object <span class="hljs-variable">$zip</span>.files:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"MyDocs/Resources"</span>).<span class="hljs-function">folders</span>() <span class="hljs-variable">$zip</span>.password:=<span class="hljs-string">"password"</span> <span class="hljs-variable">$zip</span>.callback:=<span class="hljs-function">Formula</span>(<span class="hljs-function">myFormulaCompressingMethod</span>(<span class="hljs-variable">$1</span>)) progID:=Progress New <span class="hljs-comment">//nous utilisons le composant 4D Progress</span> <span class="hljs-variable">$status</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$zip</span>;<span class="hljs-variable">$destination</span>)<span class="hljs-function"> Progress QUIT</span>(progID)</code></pre><p><code>myFormulaCompressingMethod</code>:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$1 </span>: Integer<span class="hljs-function"> Progress SET PROGRESS</span>(progID;<span class="hljs-function">Num</span>(<span class="hljs-variable">$1</span>/<span class="hljs-number">100</span>))</code></pre><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_exemple-4"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_exemple-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 4</h4><p>Vous souhaitez passer une collection de dossiers et de fichiersà compresser à l'objet <em>zipStructure</em> :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$zip</span>;<span class="hljs-variable">$err </span>: Object <span class="hljs-variable">$zip</span>:=New object <span class="hljs-variable">$zip</span>.files:=New collection <span class="hljs-variable">$zip</span>.files.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"source"</span>;<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"Tests/text.txt"</span>))) <span class="hljs-variable">$zip</span>.files.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"source"</span>;<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"Tests/text2.txt"</span>))) <span class="hljs-variable">$zip</span>.files.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"source"</span>;<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"Images/image.png"</span>))) <span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"file.zip"</span>) <span class="hljs-variable">$err</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$zip</span>;<span class="hljs-variable">$destination</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_exemple-5"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_exemple-5"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple 5</h4><p>Vous souhaitez utiliser un autre algorithme de compression à unniveau de compression élevé :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword">var</span> <span class="hljs-variable">$zip</span>; <span class="hljs-variable">$err </span>: Object<span class="hljs-variable">$zip</span>:=New object<span class="hljs-variable">$zip</span>.files:=New collection<span class="hljs-variable">$zip</span>.files.<span class="hljs-function">push</span>(<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"images"</span>))<span class="hljs-variable">$zip</span>.compression:=ZIP Compression LZMA<span class="hljs-variable">$zip</span>.level:=<span class="hljs-number">7</span> <span class="hljs-comment">//4 par défaut</span><span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"images.zip"</span>)<span class="hljs-variable">$err</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$zip</span>; <span class="hljs-variable">$destination</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_zip-read-archive"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_zip-read-archive"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>ZIP Read archive</h2><details><summary>Historique</summary><table><thead><tr><th>Version</th><th>Modifications</th></tr></thead><tbody><tr><td>v18</td><td>Ajout</td></tr></tbody></table></details><p><strong>ZIP Read archive</strong> ( <em>zipFile</em> : 4D.File {; <em>password</em> : Text }) : 4D.ZipArchive</p><table><thead><tr><th>Paramètres</th><th>Type</th><th style="text-align:center"></th><th>Description</th></tr></thead><tbody><tr><td>zipFile</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>Fichier archive ZIP</td></tr><tr><td>password</td><td>Text</td><td style="text-align:center">-&gt;</td><td>Mot de passe de l'archive ZIP, le cas échéant</td></tr><tr><td>Résultat</td><td>4D.ZipArchive</td><td style="text-align:center">&lt;-</td><td>Objet archive</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_description-1"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_description-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La commande <code>ZIP Read archive</code> récupère le contenu du<em>zipFile</em> et le retourne sous forme d'objet<code>4D.ZipArchive</code>.</p><blockquote><p>Cette commande ne décompresse pas l'archive ZIP, elle fournitseulement un aperçu de son contenu. Pour extraire le contenu d'unearchive, vous devez utiliser des méthodes telles que <a href="#ZipArchiveClass.html_copyto">file.copyTo()</a> ou <a href="#ZipArchiveClass.html_copyto">folder.copyTo()</a>.</p></blockquote><p>Passez un objet <code>4D.File</code> référençant l'archive ZIPcompressée dans le paramètre <em>zipFile</em>. Le fichier d'archivecible est ouvert jusqu'à la fin de l'exécution de la commande<code>ZIP Read archive</code> et jusqu'à ce que tous lescontenus/références soient extrait(e)s/publié(e)s ; il est ensuitefermé automatiquement.</p><p>Si le <em>zipFile</em> est protégé par un mot de passe, vousdevez utiliser le paramètre <em>password</em> pour fournir un motde passe. Si un mot de passe est requis mais qu'il n'est pas passélorsque vous tentez de lire le contenu de l'archive, une erreur estgénérée.</p><p><strong>Objet archive</strong></p><p>L'objet <code>4D.ZipArchive</code> retourné contient une seulepropriété, <a href="#ZipArchiveClass.html_root"><code>root</code></a>, dont la valeurest un objet <code>4D.ZipFolder</code>. Ce dossier décrit lecontenu de l'archive ZIP.</p><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_exemple-6"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_exemple-6"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><p>Pour récupérer et visualiser le contenu d'un objet ZIP file:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$archive </span>: 4D.ZipArchive<span class="hljs-keyword"> var</span> <span class="hljs-variable">$path </span>: 4D.File <span class="hljs-variable">$path</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/Archive.zip"</span>) <span class="hljs-variable">$archive</span>:=<span class="hljs-function">ZIP Read archive</span>(<span class="hljs-variable">$path</span>)</code></pre><p>Pour récupérer la liste des fichiers et dossiers de l'archive:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$folders</span>:=<span class="hljs-variable">$archive</span>.root.<span class="hljs-function">folders</span>() <span class="hljs-variable">$files</span>:=<span class="hljs-variable">$archive</span>.root.<span class="hljs-function">files</span>()</code></pre><p>Pour lire le contenu d'un fichier sans l'extraire du dossierroot :</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> If</span>(<span class="hljs-variable">$files</span>[<span class="hljs-variable">$i</span>].extension=<span class="hljs-string">".txt"</span>)    <span class="hljs-variable">$txt</span>:=<span class="hljs-variable">$files</span>[<span class="hljs-variable">$i</span>].<span class="hljs-function">getText</span>()<span class="hljs-keyword"> Else</span>    <span class="hljs-variable">$blob</span>:=<span class="hljs-variable">$files</span>[<span class="hljs-variable">$i</span>].<span class="hljs-function">getContent</span>()<span class="hljs-keyword"> End if</span></code></pre><p>Pour extraire à partir du dossier root :</p><pre><code class="hljs css language-4d">  <span class="hljs-comment">//extract a file</span> <span class="hljs-variable">$folderResult</span>:=<span class="hljs-variable">$files</span>[<span class="hljs-variable">$i</span>].<span class="hljs-function">copyTo</span>(<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"MyDocs"</span>))  <span class="hljs-comment">//extract all files</span> <span class="hljs-variable">$folderResult</span>:=<span class="hljs-variable">$archive</span>.root.<span class="hljs-function">copyTo</span>(<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"MyDocs"</span>))</code></pre><h2><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_root"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_root"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.root</h2><p><strong>.root</strong> : 4D.ZipFolder</p><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_description-2"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_description-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Description</h4><p>La propriété <code>.root</code> contient Un dossier virtuelpermettant d'accéder au contenu de l'archive ZIP.</p><p>Le dossier <code>root</code> et son contenu sont manipulés àl'aide des fonctions et propriétés des classes <a href="#ZipFileClass.html">ZipFile</a> et <a href="#ZipFolderClass.html">ZipFolder</a>.</p><p>Cette propriété est en <strong>lecture seule</strong>.</p><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#WebServerClass.html"><span class="arrow-prev">←</span><span class="function-name-prevnext">WebServer</span></a><a class="docs-next button" href="#ZipFileClass.html"><span>ZIPFile</span><span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#ZipArchiveClass.html_zip-create-archive">ZIP Createarchive</a></li><li><a href="#ZipArchiveClass.html_zip-read-archive">ZIP Readarchive</a></li><li><a href="#ZipArchiveClass.html_root">.root</a></li></ul></nav></div></div></body></html>