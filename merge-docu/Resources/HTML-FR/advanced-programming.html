<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="fr"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Programmation avancée avec Javascript · 4DDocumentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="Une zone 4D View Pro est un [objet de formulaire de zone Web](/docs/Rx/fr/FormObjects/webAreaOverview.html) qui utilise le [moteur de rendu Web intégré](/docs/Rx/fr/FormObjects/propertiesWebArea.html#use-embedded-web-rendering-engine). En tant que telle, elle se comporte comme n'importe quelle autre zone Web, à laquelle vous pouvez faire exécuter du code Javascript en appelant la commande 4D [`WA Evaluate Javascript`](https://doc.4d.com/4dv19/help/command/en/page1029.html)."name="description" /><meta content="fr" name="docsearch:language" /><meta content="Programmation avancée avec Javascript · 4D Documentation"property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="Une zone 4D View Pro est un [objet de formulaire de zone Web](/docs/Rx/fr/FormObjects/webAreaOverview.html) qui utilise le [moteur de rendu Web intégré](/docs/Rx/fr/FormObjects/propertiesWebArea.html#use-embedded-web-rendering-engine). En tant que telle, elle se comporte comme n'importe quelle autre zone Web, à laquelle vous pouvez faire exécuter du code Javascript en appelant la commande 4D [`WA Evaluate Javascript`](https://doc.4d.com/4dv19/help/command/en/page1029.html)."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#advanced-programming.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">Programmation avancéeavec Javascript<a aria-hidden="true" class="anchor" id="advanced-programming.html"></a></h1></header><article><div><p><span>Une zone 4D View Pro est un <a href="#webAreaOverview.html">objet de formulaire de zone Web</a> quiutilise le <a href="#advanced-programming.html_use-embedded-web-rendering-engine">moteurde rendu Web intégré</a>. En tant que telle, elle se comporte commen'importe quelle autre zone Web, à laquelle vous pouvez faireexécuter du code Javascript en appelant la commande 4D <a href="https://doc.4d.com/4dv19/help/command/en/page1029.html"><code>WAEvaluate Javascript</code></a>.</span></p><p><span>Etant donné que 4D View Pro est alimenté par la <a href="#overview.html">solution de feuille de calcul SpreadJS</a>, vouspouvez également appeler les méthodes Javascript de SpreadJS dansles zones 4D View Pro.</span></p><h2><span><a aria-hidden="true" class="anchor" id="advanced-programming.html_exemple-concret--masquer-le-ruban"></a><a aria-hidden="true"class="hash-link" href="#advanced-programming.html_exemple-concret--masquer-le-ruban"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple concret : masquer le ruban</span></h2><p><span>4D View Pro étant une zone Web, vous pouvez sélectionnerun élément de page Web et modifier son comportement à l'aide deJavascript. L'exemple suivant permet de masquer le <a href="#advanced-programming.html_ribbon">ruban</a> spreadJS :</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-comment">//Méthode objet du bouton</span><span class="hljs-keyword">var</span> <span class="hljs-variable">$js</span>; <span class="hljs-variable">$answer </span>: Text<span class="hljs-variable">$js</span>:=<span class="hljs-string">"document.getElementsByClassName('ribbon')[0].setAttribute('style','display: none');"</span><span class="hljs-variable">$js</span>+=<span class="hljs-string">"window.dispatchEvent(new Event('resize'));"</span><span class="hljs-variable">$answer</span>:=<span class="hljs-function">WA Evaluate JavaScript</span>(*; <span class="hljs-string">"ViewProArea"</span>; <span class="hljs-variable">$js</span>)</code></span></pre><h2><a aria-hidden="true" class="anchor" id="advanced-programming.html_appeler-des-m%C3%A9thodes-javascript-de-spreadjs"></a><a aria-hidden="true" class="hash-link" href="#advanced-programming.html_appeler-des-m%25C3%25A9thodes-javascript-de-spreadjs"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Appeler des méthodes JavaScript de SpreadJS</h2><p>Vous pouvez exploiter la bibliothèque de méthodes Javascript deSpreadJS et les appeler directement pour gérer vos feuilles decalcul.</p><p>4D dispose d'une propriété <code>Utils.spread</code> intégréequi pointe vers la feuille de calcul (également appelée workbook)dans la zone 4D View Pro, ce qui simplifie l'appel des <a href="#SpreadJS~GC.Spread.Sheets.Workbook.html">méthodes de Workbook</a>SpreadJS.</p><h4><a aria-hidden="true" class="anchor" id="advanced-programming.html_exemple"></a><a aria-hidden="true"class="hash-link" href="#advanced-programming.html_exemple"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Exemple</h4><p>Le code suivant annule la dernière action dans la feuille decalcul :</p><pre><code class="hljs css language-4d"><span class="hljs-function">WA Evaluate JavaScript</span>(*; <span class="hljs-string">"ViewProArea"</span>; <span class="hljs-string">"Utils.spread.undoManager().undo()"</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="advanced-programming.html_d%C3%A9p%C3%B4t-4d-view-pro-tips"></a><a aria-hidden="true"class="hash-link" href="#advanced-programming.html_d%25C3%25A9p%25C3%25B4t-4d-view-pro-tips"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Dépôt 4D View Pro Tips</h2><p><a href="https://github.com/4d-depot/4D-View-Pro-Tips">4D-View-Pro-Tips</a>est un dépôt GitHub qui contient un projet rempli de fonctionsutiles pour vous permettre de gérer les images flottantes, de trierles colonnes ou les lignes, de créer une culture personnalisée, etbien plus encore ! N'hésitez pas à le cloner et à l'expérimenter!</p></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#method-list.html"><span class="arrow-prev">←</span> <span>Listedes méthodes</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#advanced-programming.html_exemple-concret--masquer-le-ruban">Exempleconcret : masquer le ruban</a></li><li><a href="#advanced-programming.html_appeler-des-m%25C3%25A9thodes-javascript-de-spreadjs">Appeler des méthodes JavaScript de SpreadJS</a></li><li><a href="#advanced-programming.html_d%25C3%25A9p%25C3%25B4t-4d-view-pro-tips">Dépôt 4D View Pro Tips</a></li></ul></nav></div></div></body></html>