<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="ja"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>式と関数 · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="## フォーミュラの使い方" name="description" /><meta content="ja" name="docsearch:language" /><meta content="式と関数 · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="## フォーミュラの使い方" property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#formulas.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">式と関数<a aria-hidden="true" class="anchor" id="formulas.html"></a></h1></header><article><div><h2><span><a aria-hidden="true" class="anchor" id="formulas.html_%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9F%E3%83%A5%E3%83%A9%E3%81%AE%E4%BD%BF%E3%81%84%E6%96%B9"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_%25E3%2583%2595%25E3%2582%25A9%25E3%2583%25BC%25E3%2583%259F%25E3%2583%25A5%25E3%2583%25A9%25E3%2581%25AE%25E4%25BD%25BF%25E3%2581%2584%25E6%2596%25B9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>フォーミュラの使い方</span></h2><p><span>スプレッドシートのフォーミュラとは、セルの値を計算する式のことです。</span></p><h3><span><a aria-hidden="true" class="anchor" id="formulas.html_%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9F%E3%83%A5%E3%83%A9%E3%81%AE%E5%85%A5%E5%8A%9B"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_%25E3%2583%2595%25E3%2582%25A9%25E3%2583%25BC%25E3%2583%259F%25E3%2583%25A5%25E3%2583%25A9%25E3%2581%25AE%25E5%2585%25A5%25E5%258A%259B"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>フォーミュラの入力</span></h3><p><span>4D View Pro エリアにフォーミュラを入力するには:</span></p><ol><li><span>フォーミュラを入力するセルを選択します。</span></li><li><span>= (等号) を入力します。</span></li><li><span>フォーミュラを入力し、<strong>Enter</strong>キーを入力します。</span></li></ol><p><span>フォーミュラ入力の際には、次のショートカットを使うことができます:</span></p><ul><li><span>フォーミュラにセル参照を入力する代わりに、参照するセルをクリックします:</span></li></ul><p><span><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/formulas.PNG" /></span></p><ul><li><span>入力したい関数の頭文字を入力します。すると、利用可能な関数と参照の一覧がポップアップメニューに表示され、必要な要素を選択することができます:</span></li></ul><p><span><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/formula2.PNG" /></span></p><p><span>また、命名フォーミュラを作成すると、その名前で呼び出すことが可能です。 この場合、<a href="#formulas.html_vp-add-formula-name">VP ADD FORMULA NAME</a>コマンドを使用して命名フォーミュラを入力します。</span></p><h3><span><a aria-hidden="true" class="anchor" id="formulas.html_%E6%BC%94%E7%AE%97%E5%AD%90%E3%81%A8%E3%82%AA%E3%83%9A%E3%83%A9%E3%83%B3%E3%83%89"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_%25E6%25BC%2594%25E7%25AE%2597%25E5%25AD%2590%25E3%2581%25A8%25E3%2582%25AA%25E3%2583%259A%25E3%2583%25A9%25E3%2583%25B3%25E3%2583%2589"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>演算子とオペランド</span></h3><p><span>すべてのフォーミュラはオペランドと演算子から成り立っています:</span></p><ul><li><span><strong>演算子</strong>: 後述の <a href="#formulas.html_%25E5%2580%25A4%25E3%2581%25A8%25E6%25BC%2594%25E7%25AE%2597%25E5%25AD%2590">値と演算子</a> 参照。</span></li><li><span><strong>オペランド</strong> は、いくつかのカテゴリーに分けられます:</span><ul><li><span><a href="#formulas.html_%25E5%2580%25A4%25E3%2581%25A8%25E6%25BC%2594%25E7%25AE%2597%25E5%25AD%2590">値</a> (5つのデータ型がサポートされています)</span></li><li><span><a href="#formulas.html_%25E3%2582%25BB%25E3%2583%25AB%25E5%258F%2582%25E7%2585%25A7">他のセルへの参照</a> (相対参照、絶対参照、ミックス参照、あるいは名前での参照)</span></li><li><span><a href="#formulas.html_%25E3%2583%2593%25E3%2583%25AB%25E3%2583%2588%25E3%2582%25A4%25E3%2583%25B3%25E3%2583%2595%25E3%2582%25A1%25E3%2583%25B3%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3">標準のスプレッドシートファンクション (関数)</a></span></li><li><span>4Dフォーミュラに基づく <a href="#formulas.html_4d%25E3%2583%2595%25E3%2582%25A1%25E3%2583%25B3%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3">4Dファンクション</a> (4D変数、フィールド、メソッド、コマンド、式が利用可能です)</span></li></ul></li></ul><h2><span><a aria-hidden="true" class="anchor" id="formulas.html_%E5%80%A4%E3%81%A8%E6%BC%94%E7%AE%97%E5%AD%90"></a><a aria-hidden="true"class="hash-link" href="#formulas.html_%25E5%2580%25A4%25E3%2581%25A8%25E6%25BC%2594%25E7%25AE%2597%25E5%25AD%2590"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>値と演算子</span></h2><p><span>4D View Pro は 5つのデータ型をサポートします。それぞれのデータ型について、特定の定数と演算子がサポートされています。</span></p><table><thead><tr><th>データ型</th><th>値</th><th>演算子</th></tr></thead><tbody><tr><td><a href="#number.html">数値</a></td><td>1.2<br />1.2 E3<br />1.2E-3<br />10.3x</td><td>+ (加法)<br />- (減法)<br />* (乗法)<br />/ (除法)<br />^ (べき乗、数値を自身に対してかける回数)<br />% (パーセント -- 演算子の前の数値を100で割る)</td></tr><tr><td><a href="#date.html">日付</a></td><td>10/24/2017</td><td>+ (日付 + 日数 -&gt; 日付)<br />+ (日付 + 時間 -&gt; 日付 + その日の時間)<br />- (日付 - 日数 -&gt; 日付)<br />- (日付 - 日付 -&gt; 2つの日付間の日数)</td></tr><tr><td><a href="#time.html">時間</a></td><td>10:12:10</td><td>経過時間演算子:<p>+ (加法)<br />- (減法)<br />* (経過時間 * 数値 -&gt; 経過時間)<br />/ (経過時間 / 数値 -&gt; 経過時間)</p></td></tr><tr><td><a href="#string.html">文字列</a></td><td>'Sophie' または "Sophie"</td><td>&amp; (連結)</td></tr><tr><td><a href="#boolean.html">ブール</a></td><td>TRUE または FALSE</td><td>-</td></tr></tbody></table><h3><span><a aria-hidden="true" class="anchor" id="formulas.html_%E6%AF%94%E8%BC%83%E6%BC%94%E7%AE%97%E5%AD%90"></a><a aria-hidden="true"class="hash-link" href="#formulas.html_%25E6%25AF%2594%25E8%25BC%2583%25E6%25BC%2594%25E7%25AE%2597%25E5%25AD%2590"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>比較演算子</span></h3><p><span>同じ型の 2つのオペランドに対して以下の演算子を使用することができます:</span></p><table><thead><tr><th>演算子</th><th>比較</th></tr></thead><tbody><tr><td>=</td><td>等しい</td></tr><tr><td>&lt;&gt;</td><td>異なる</td></tr><tr><td>&gt;</td><td>大きい</td></tr><tr><td>&lt;</td><td>小さい</td></tr><tr><td>&gt;=</td><td>以上</td></tr><tr><td>&lt;=</td><td>以下</td></tr></tbody></table><h3><span><a aria-hidden="true" class="anchor" id="formulas.html_%E6%BC%94%E7%AE%97%E5%AD%90%E3%81%AE%E5%84%AA%E5%85%88%E9%A0%86%E4%BD%8D"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_%25E6%25BC%2594%25E7%25AE%2597%25E5%25AD%2590%25E3%2581%25AE%25E5%2584%25AA%25E5%2585%2588%25E9%25A0%2586%25E4%25BD%258D"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>演算子の優先順位</span></h3><p><span>以下は演算子を優先度順に並べたものです (優先度が高い方が上):</span></p><table><thead><tr><th>演算子</th><th>説明</th></tr></thead><tbody><tr><td>()</td><td>カッコ (グループ化)</td></tr><tr><td>-</td><td>否定</td></tr><tr><td>+</td><td>追加</td></tr><tr><td>%</td><td>パーセント</td></tr><tr><td>^</td><td>べき乗</td></tr><tr><td>* と /</td><td>乗法と除法</td></tr><tr><td>+ と -</td><td>加法と減法</td></tr><tr><td>&amp;</td><td>連結</td></tr><tr><td>= &gt; &lt; &gt;= &lt;= &lt;&gt;</td><td>比較</td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="formulas.html_%E3%82%BB%E3%83%AB%E5%8F%82%E7%85%A7"></a><a aria-hidden="true"class="hash-link" href="#formulas.html_%25E3%2582%25BB%25E3%2583%25AB%25E5%258F%2582%25E7%2585%25A7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>セル参照</span></h2><p><span>フォーミュラ (式) は多くの場合、セルアドレスを使って他のセルを参照します。このような式を他のセルにコピーすることも可能です。 たとえば、C8 に入力された以下の式では、すぐ上にある2つのセルの値を足して結果を表示します。</span></p><pre><span><code class="hljs"><span class="hljs-section">= C6 + C7</span></code></span></pre><p>この式はセル C6 と C7 を参照します。 つまり、式内で使用する値については他のセルを参照するよう、4D View Proに指示しています。</p><p>こういった式を別のセルにコピーあるいは移動させた場合、式内のセルアドレスは参照の仕方によって連動して変化したり変化しなかったりします。</p><ul><li>参照が変化するものは <strong>相対参照</strong>と呼ばれ、式が入っているセルを基準として、相対的にどれだけ上下左右に離れているかでセルを参照します。</li><li>常に特定のセルを参照するものは <strong>絶対参照</strong> と呼ばれます。</li><li>また、複合参照といって、特定の行あるいはカラムに参照を固定することもできます。</li></ul><h3><a aria-hidden="true" class="anchor" id="formulas.html_%E5%8F%82%E7%85%A7%E3%81%AE%E8%A8%98%E6%B3%95"></a><a aria-hidden="true"class="hash-link" href="#formulas.html_%25E5%258F%2582%25E7%2585%25A7%25E3%2581%25AE%25E8%25A8%2598%25E6%25B3%2595"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>参照の記法</h3><p>セル座標 ( <code>C5</code> など) のみを使用すると、4D View Proはそれを相対参照として解釈します。 文字と数字の前に $ (ドル) 記号を入れることで、参照を絶対参照にすることができます (例:<code>$C$5</code>)。</p><p>ドル記号を文字あるいは数字の前だけに入れることで相対参照と絶対参照を組み合わせることができます (例:<code>$C5</code>、<code>C$5</code>)。複合参照を使用すると、行かカラムを絶対参照として指定しながら、もう片方については相対的に参照させることが可能になります。</p><p>素早くかつ正確に絶対参照を指定するには、セルを命名し、その名前をセルアドレス代わりに使用する方法があります。命名セルへの参照は常に絶対参照です。 命名セルまたは命名セルレンジを作成・編集するには、<a href="#formulas.html_vp-add-range-name"><code>VP ADD RANGENAME</code></a> メソッドを使用します。</p><p>以下の表は異なる記法による効果をまとめたものです:</p><table><thead><tr><th>例題</th><th>参照タイプ</th><th>説明</th></tr></thead><tbody><tr><td>C5</td><td>相対</td><td>参照は相対的にセル C5 を指しており、参照が最初に使用されたセルが位置の基準となります。</td></tr><tr><td>$C$5</td><td>絶対</td><td>参照は絶対参照です。 どこで使用されるかにかかわらず、常にセル C5 を参照します。</td></tr><tr><td>$C5</td><td>Mixed</td><td>常にカラム C を参照しますが、行の参照は相対的で、参照が最初に使用されたセルを基準に決まります。</td></tr><tr><td>C$5</td><td>Mixed</td><td>常に 5行目を参照しますが、カラムの参照は相対的で、参照が最初に使用されたセルを基準に決まります。</td></tr><tr><td>セル名</td><td>絶対</td><td>参照は絶対参照です。 どこで使用されるかにかかわらず、常に <a href="#formulas.html_vp-add-range-name">命名されたセルまたはレンジ</a> を参照します。</td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="formulas.html_%E3%83%93%E3%83%AB%E3%83%88%E3%82%A4%E3%83%B3%E3%83%95%E3%82%A1%E3%83%B3%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_%25E3%2583%2593%25E3%2583%25AB%25E3%2583%2588%25E3%2582%25A4%25E3%2583%25B3%25E3%2583%2595%25E3%2582%25A1%25E3%2583%25B3%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>ビルトインファンクション</h2><p>スプレッドシートのファンクションとは、セルの値を計算する規定のフォーミュラのことで、関数とも呼ばれます。入力したい関数の頭文字を入力すると、利用可能な関数と参照の一覧がポップアップメニューに表示され、必要な要素を選択することができます:</p><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/vpFormula2.PNG" /></p><p>詳細や例題については <a href="#FormulaFunctions.html"><strong>SpreadJS'sextented list of functions</strong></a> (英文) を参照ください。</p><h2><a aria-hidden="true" class="anchor" id="formulas.html_4d%E3%83%95%E3%82%A1%E3%83%B3%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_4d%25E3%2583%2595%25E3%2582%25A1%25E3%2583%25B3%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4Dファンクション</h2><p>4D View Pro では、<a href="#FunctionClass.html">4Dフォーミュラ</a> を実行する<strong>4Dカスタムファンクション</strong> を定義・使用することができます。4Dカスタムファンクションを使用すると、4D View Proドキュメントの可能性が広がり、4Dデータベースとの強力な連携が可能になります。</p><p>4Dカスタムファンクションを使用すると、4D View Pro のフォーミュラ内で以下が利用可能になります:</p><ul><li>4Dプロセス変数</li><li>フィールド</li><li>プロジェクトメソッド</li><li>4Dランゲージコマンド</li><li>または、有効な 4D式</li></ul><p>4Dカスタムファンクションは、4D View Pro エリアから <a href="#formulas.html_%25E5%25BC%2595%25E6%2595%25B0">引数</a>を受け取り、値を返すことができます。</p><p>これらのカスタムファンクションは <a href="#formulas.html_vp-set-custom-functions"><code>VP SET CUSTOMFUNCTIONS</code></a> メソッドを使って宣言します。 例:</p><pre><code class="hljs css language-4d">o:=New object<span class="hljs-comment">// 4D View Pro におけるファンクション名: "DRIVERS_LICENCE"</span><span class="hljs-variable">$o</span>.DRIVERS_LICENCE:=New object<span class="hljs-comment">// プロセス変数</span><span class="hljs-variable">$o</span>.DRIVERS_LICENCE.formula:=<span class="hljs-function">Formula</span>(DriverLicence)<span class="hljs-comment">// テブルフィールド</span><span class="hljs-variable">$o</span>.DRIVERS_LICENCE.formula:=<span class="hljs-function">Formula</span>([Users]DriverLicence)<span class="hljs-comment">// プロジェクトメソッド</span><span class="hljs-variable">$o</span>.DRIVERS_LICENCE.formula:=<span class="hljs-function">Formula</span>(DriverLicenceState)<span class="hljs-comment">// 4Dコマンド</span><span class="hljs-variable">$o</span>.DRIVERS_LICENCE:=<span class="hljs-function">Formula</span>(<span class="hljs-function">Choose</span>(DriverLicence; <span class="hljs-string">"Obtained"</span>; <span class="hljs-string">"Failed"</span>))<span class="hljs-comment">//4D式と引数</span><span class="hljs-variable">$o</span>.DRIVERS_LICENCE.formula:=<span class="hljs-function">Formula</span>(ds.Users.<span class="hljs-function">get</span>(<span class="hljs-variable">$1</span>).DriverLicence)<span class="hljs-variable">$o</span>.DRIVERS_LICENCE.parameters:=New collection<span class="hljs-variable">$o</span>.DRIVERS_LICENCE.parameters.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>; <span class="hljs-string">"ID"</span>; <span class="hljs-string">"type"</span>; Is longint))</code></pre><blockquote><p><a href="https://blog.4d.com/4d-view-pro-use-4d-formulas-in-your-spreadsheet/">4D View Pro: Use 4D formulas in your spreadsheet (英文ブログ記事)</a>も参照ください。</p></blockquote><h3><a aria-hidden="true" class="anchor" id="formulas.html_hello-world-%E4%BE%8B%E9%A1%8C"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_hello-world-%25E4%25BE%258B%25E9%25A1%258C"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Hello World 例題</h3><p>4Dプロジェクトメソッドを使って、4D View Pro エリアのセルに "Hello World" と表示させます。</p><ol><li>"myMethod" プロジェクトメソッドを作成し、次のコードを書きます:</li></ol><pre><code class="hljs css language-4d"> #DECLARE-&gt;<span class="hljs-variable">$hw Text</span> <span class="hljs-variable">$hw</span>:=<span class="hljs-string">"Hello World"</span></code></pre><ol start="2"><li>4D View Pro エリアが設置されたフォームを開く前に、以下のコードを実行します:</li></ol><pre><code class="hljs css language-4d"><span class="hljs-keyword">  Case of</span>    :(Form event code=On Load)<span class="hljs-keyword">       var</span> <span class="hljs-variable">$o </span>: Object       <span class="hljs-variable">$o</span>:=New object  <span class="hljs-comment">// "myMethod" メソッドから "vpHello" ファンクションを定義します</span>       <span class="hljs-variable">$o</span>.vpHello:=New object       <span class="hljs-variable">$o</span>.vpHello.formula:=<span class="hljs-function">Formula</span>(myMethod)<span class="hljs-function">       VP SET CUSTOM FUNCTIONS</span>(<span class="hljs-string">"ViewProArea"</span>;<span class="hljs-variable">$o</span>)<span class="hljs-keyword"> End case</span></code></pre><ol start="3"><li><p>4D View Pro エリアのセルに次を入力します:</p><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/vpProjMeth1.PNG" /></p><p>すると、4D によって "myMethod "が呼び出され、セルの表示は次のようになります:</p><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/vpProjMeth2.PNG" /></p></li></ol><h3><a aria-hidden="true" class="anchor" id="formulas.html_%E5%BC%95%E6%95%B0"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_%25E5%25BC%2595%25E6%2595%25B0"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>引数</h3><p>プロジェクトのメソッドを呼び出す 4Dファンクションには、以下のシンタックスで引数を渡すことができます:</p><pre><code class="hljs">=METHODNAME(param1,param2,...,paramN)</code></pre><p><em>methodName</em> はこれらの引数を $1, $2...$N に受け取ります。</p><p>引数を渡さない場合でも ( ) の使用は必須です:</p><pre><code class="hljs">=METHODWITHOUTNAME()</code></pre><p><a href="#formulas.html_vp-set-custom-functions">VP SET CUSTOMFUNCTIONS</a> メソッドを使用して宣言したファンクションの <em>parameters</em>コレクションを使って、引数の名前、型、数を宣言することができます。 オプションとして、<em>minParams</em> および<em>maxParams</em> プロパティにより、ユーザーから渡される引数の数を制御することができます。</p><p>サポートされている引数の型の詳細については、<a href="#formulas.html_vp-set-custom-functions">VP SET CUSTOMFUNCTIONS</a> メソッドの説明を参照ください。</p><blockquote><p>引数を宣言していない場合には、メソッドに値を順番に渡すことができ ($1、$2...に受け取られます)、それらの型は自動的に変換されます。 <em>jstype</em> の日付は、4Dコードでは2つのプロパティを持つ <a href="#object.html">オブジェクト</a> として渡されます:<br />|プロパティ| 型| 説明| |---|---|---| |value| Date| 日付| |time |Real| 時間(秒単位)|</p></blockquote><p>4Dプロジェクトメソッドは、$0 を介して 4D View Pro のセルフォーミュラに値を返すこともできます。以下のデータ型の戻り値がサポートされています:</p><ul><li><p><a href="#string.html">テキスト</a> (4D View Pro 内で文字列に変換)</p></li><li><p><a href="#number.html">実数</a>/<a href="#number.html">倍長整数</a>(4D View Pro 内で数値に変換)</p></li><li><p><a href="#date.html">日付</a> (4D View Pro 内で JS日付型に変換 - 時間、分、秒 =0)</p></li><li><p><a href="#time.html">時間</a> (4D View Pro 内で JS日付型に変換 -日付は基準日、つまり 1899年12月30日)</p></li><li><p><a href="#boolean.html">ブール</a> (4D View Pro 内でブールに変換)</p></li><li><p><a href="#picture.html">ピクチャー</a> (jpg,png,gif,bmp,svg, その他のタイプはpng に変換) の場合、URI (data:image/png;base64,xxxx) が作成され、フォーミュラを実行した 4DView Pro のセルにおいて背景として使用されます。</p></li><li><p>次の 2つのプロパティを持つ <a href="#object.html">オブジェクト</a>(日付と時間の受け渡しを可能にします):</p><table><thead><tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>value</td><td>日付</td><td>日付値</td></tr><tr><td>time</td><td>実数</td><td>数値 (秒単位)</td></tr></tbody></table></li></ul><p>4Dメソッドが何も返さない場合は、自動的に空の文字列が返されます。</p><p>以下の場合は、4D View Pro セルにエラーが返されます:</p><ul><li>4Dメソッドが上記以外のデータ型を返した場合。</li><li>4Dメソッドの実行中にエラーが発生した場合 (ユーザーが "中止" ボタンをクリックした場合)。</li></ul><h4><a aria-hidden="true" class="anchor" id="formulas.html_%E4%BE%8B%E9%A1%8C"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_%25E4%25BE%258B%25E9%25A1%258C"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$o </span>: Object<span class="hljs-variable">$o</span>.BIRTH_INFORMATION:=New object<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.formula:=<span class="hljs-function">Formula</span>(BirthInformation)<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.parameters:=New collection<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.parameters.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"First name"</span>;<span class="hljs-string">"type"</span>;Is text))<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.parameters.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Birthday"</span>;<span class="hljs-string">"type"</span>;Is date))<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.parameters.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Time of birth"</span>;<span class="hljs-string">"type"</span>;Is time))<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.summary:=<span class="hljs-string">"渡された情報に基づきフォーマットされた文字列を返します"</span><span class="hljs-function">VP SET CUSTOM FUNCTIONS</span>(<span class="hljs-string">"ViewProArea"</span>; <span class="hljs-variable">$o</span>)</code></pre><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/params.PNG" /></p><h2><a aria-hidden="true" class="anchor" id="formulas.html_%E4%BA%92%E6%8F%9B%E6%80%A7"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_%25E4%25BA%2592%25E6%258F%259B%25E6%2580%25A7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>互換性</h2><p>4D View Pro エリアでフィールドやメソッドをファンクションとして宣言する場合、代わりの方法も利用可能です。これらの方法は、互換性のために維持されており、特定のケースで使用することができます。 しかしながら、<a href="#formulas.html_vp-set-custom-functions"><code>VP SET CUSTOMFUNCTIONS</code></a> の使用が推奨されます。</p><h3><a aria-hidden="true" class="anchor" id="formulas.html_%E4%BB%AE%E6%83%B3%E3%82%B9%E3%83%88%E3%83%A9%E3%82%AF%E3%83%81%E3%83%A3%E3%83%BC%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%9F%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89%E5%8F%82%E7%85%A7"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_%25E4%25BB%25AE%25E6%2583%25B3%25E3%2582%25B9%25E3%2583%2588%25E3%2583%25A9%25E3%2582%25AF%25E3%2583%2581%25E3%2583%25A3%25E3%2583%25BC%25E3%2582%2592%25E4%25BD%25BF%25E3%2581%25A3%25E3%2581%259F%25E3%2583%2595%25E3%2582%25A3%25E3%2583%25BC%25E3%2583%25AB%25E3%2583%2589%25E5%258F%2582%25E7%2585%25A7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>仮想ストラクチャーを使ったフィールド参照</h3><p>4D View Pro では、データベースの仮想ストラクチャーを使用して 4Dフィールドを参照することができます。つまり、*引数とともに <a href="https://doc.4d.com/4dv19/help/command/ja/page601.html"><code>SETTABLE TITLES</code></a> や <a href="https://doc.4d.com/4dv19/help/command/ja/page602.html"><code>SETFIELD TITLES</code></a> コマンドで宣言されている場合です。この代替方法は、アプリケーションがすでに仮想ストラクチャーに依存している場合に便利です (そうでない場合は、<a href="#formulas.html_4d%25E3%2583%2595%25E3%2582%25A1%25E3%2583%25B3%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3"><code>VPSET CUSTOM FUNCTIONS</code> の使用</a> が推奨されます)。</p><blockquote><p><strong>警告</strong>: 仮想ストラクチャーと <code>VP SET CUSTOMFUNCTIONS</code> を同時に使用することはできません。 <code>VP SET CUSTOMFUNCTIONS</code> が呼び出されると、4D View Pro エリアは <code>SET TABLETITLES</code> や <code>SET FIELD TITLES</code> コマンドに基づく機能を無視します。</p></blockquote><h4><a aria-hidden="true" class="anchor" id="formulas.html_%E8%A6%81%E4%BB%B6"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_%25E8%25A6%2581%25E4%25BB%25B6"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>要件</h4><ul><li>フィールドは、データベースの仮想ストラクチャーに属していること。 つまり、*引数とともに <a href="https://doc.4d.com/4dv19/help/command/ja/page601.html"><code>SETTABLE TITLES</code></a> や <a href="https://doc.4d.com/4dv19/help/command/ja/page602.html"><code>SETFIELD TITLES</code></a> コマンドで宣言されていなくてはなりません。</li><li>テーブルとフィールド名は ECMA 準拠であること (<a href="#formulas.html_sec-7.6">ECMA Script standard</a> 参照)。</li><li>フィールドの型が 4D View Pro でサポートされていること (前述参照)。</li></ul><p>準拠していないフィールドがフォーミュラに呼び出されると、4D View Pro セルにエラーが返されます。</p><h4><a aria-hidden="true" class="anchor" id="formulas.html_%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9F%E3%83%A5%E3%83%A9%E3%81%A7%E3%81%AE%E4%BB%AE%E6%83%B3%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89%E3%81%AE%E4%BD%BF%E7%94%A8"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_%25E3%2583%2595%25E3%2582%25A9%25E3%2583%25BC%25E3%2583%259F%25E3%2583%25A5%25E3%2583%25A9%25E3%2581%25A7%25E3%2581%25AE%25E4%25BB%25AE%25E6%2583%25B3%25E3%2583%2595%25E3%2582%25A3%25E3%2583%25BC%25E3%2583%25AB%25E3%2583%2589%25E3%2581%25AE%25E4%25BD%25BF%25E7%2594%25A8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>フォーミュラでの仮想フィールドの使用</h4><p>フォーミュラ内に仮想フィールドへの参照を挿入するには、次のシンタックスを使います:</p><pre><code class="hljs"><span class="hljs-function"><span class="hljs-title">TABLENAME_FIELDNAME</span><span class="hljs-params">()</span></span></code></pre><p>たとえば、"People" テーブルの "Name"フィールドを仮想ストラクチャーで宣言した場合、以下のようなファンクションを呼び出すことができます:</p><pre><code class="hljs">=PEOPLE_NAME()=<span class="hljs-built_in">LEN</span>(PEOPLE_NAME())</code></pre><blockquote><p>フィールドが [4Dメソッド] と同名の場合は、フィールド名が優先されます。</p></blockquote><h4><a aria-hidden="true" class="anchor" id="formulas.html_%E4%BE%8B%E9%A1%8C-1"></a><a aria-hidden="true"class="hash-link" href="#formulas.html_%25E4%25BE%258B%25E9%25A1%258C-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h4><p>4D の仮想フィールドを使用して、4D View Pro エリアのセル内に人の名前を表示します:</p><ol><li>"Employee" テーブルと "L_Name" フィールドを作成します:</li></ol><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/vpFieldMeth1.PNG" /></p><ol start="2"><li><p>次のコードを実行して、仮想ストラクチャーを初期化します:</p><pre><code class="hljs css language-4d"><span class="hljs-function">ARRAY TEXT</span>(<span class="hljs-variable">$tableTitles</span>;<span class="hljs-number">1</span>)<span class="hljs-function">    ARRAY LONGINT</span>(<span class="hljs-variable">$tableNum</span>;<span class="hljs-number">1</span>)    <span class="hljs-variable">$tableTitles{1}</span>:=<span class="hljs-string">"Emp"</span>    <span class="hljs-variable">$tableNum{1}</span>:=<span class="hljs-number">2</span><span class="hljs-function">    SET TABLE TITLES</span>(<span class="hljs-variable">$tableTitles</span>;<span class="hljs-variable">$tableNum</span>;*)<span class="hljs-function">    ARRAY TEXT</span>(<span class="hljs-variable">$fieldTitles</span>;<span class="hljs-number">1</span>)<span class="hljs-function">    ARRAY LONGINT</span>(<span class="hljs-variable">$fieldNum</span>;<span class="hljs-number">1</span>)    <span class="hljs-variable">$fieldTitles{1}</span>:=<span class="hljs-string">"Name"</span>    <span class="hljs-variable">$fieldNum{1}</span>:=<span class="hljs-number">2</span> <span class="hljs-comment">// ラストネーム</span><span class="hljs-function">    SET FIELD TITLES</span>([Employee];<span class="hljs-variable">$fieldTitles</span>;<span class="hljs-variable">$fieldNum</span>;*)</code></pre></li><li><p>4D View Pro エリアのセルに "=e" と入力します":</p></li></ol><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/vpFieldMeth2.PNG" /></p><ol start="4"><li>(Tabキーを使用して) EMP_NAME を選択し、閉じる ")" を入力します。</li></ol><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/vpFieldMeth3.PNG" /></p><ol start="5"><li>セルを確定すると、カレントの従業員の名前が表示されます:</li></ol><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/vpFieldMeth4.PNG" /></p><blockquote><p>[Employee] テーブルはカレントレコードを持っている必要があります。</p></blockquote><h3><a aria-hidden="true" class="anchor" id="formulas.html_%E8%A8%B1%E5%8F%AF%E3%81%95%E3%82%8C%E3%81%9F%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%81%AE%E5%AE%A3%E8%A8%80"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_%25E8%25A8%25B1%25E5%258F%25AF%25E3%2581%2595%25E3%2582%258C%25E3%2581%259F%25E3%2583%25A1%25E3%2582%25BD%25E3%2583%2583%25E3%2583%2589%25E3%2581%25AE%25E5%25AE%25A3%25E8%25A8%2580"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>許可されたメソッドの宣言</h3><p>4D View Pro のフォーミュラ内にて 4Dプロジェクトメソッドを直接呼び出すことができます。セキュリティ上の理由から、ユーザーによって呼び出し可能なメソッドは <a href="#formulas.html_vp-set-allowed-methods">VP SET ALLOWED METHODS</a>によって明示的に宣言されなくてはなりません。</p><h4><a aria-hidden="true" class="anchor" id="formulas.html_%E8%A6%81%E4%BB%B6-1"></a><a aria-hidden="true"class="hash-link" href="#formulas.html_%25E8%25A6%2581%25E4%25BB%25B6-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>要件</h4><p>4D View Pro フォーミュラ内で呼び出すには、プロジェクトメソッドは以下の条件を満たしている必要があります:</p><ul><li><strong>許可されている</strong>: <a href="#formulas.html_vp-set-allowed-methods">VP SET ALLOWED METHODS</a>によって明示的に宣言されていること。</li><li><strong>実行可能</strong>:メソッドがホストデータベースに属している、あるいはロードされたコンポーネントに属しており当該メソッドの"コンポーネントとホストデータベース間で共有" オプションが有効化されていること (<a href="#formulas.html_%25E3%2583%2597%25E3%2583%25AD%25E3%2582%25B8%25E3%2582%25A7%25E3%2582%25AF%25E3%2583%2588%25E3%2583%25A1%25E3%2582%25BD%25E3%2583%2583%25E3%2583%2589%25E3%2581%25AE%25E5%2585%25B1%25E6%259C%2589">プロジェクトメソッドの共有</a>参照)。</li><li>既存の 4D View Pro ファンクションと <strong>競合していない</strong>: 4D View Proビルトインファンクションと同じ名前のプロジェクトメソッドを呼び出した場合、ファンクションの方が呼び出されます。</li></ul><blockquote><p><a href="#formulas.html_vp-set-custom-functions">VP SET CUSTOMFUNCTIONS</a> および <a href="#formulas.html_vp-set-allowed-methods">VP SET ALLOWED METHODS</a>コマンドのいずれもがセッション中に実行されていない場合、4D View Pro カスタムファンクションには 4D の汎用的な<code>SET ALLOWED METHODS</code> コマンドで許可されたメソッドが使用できます。この場合、プロジェクトメソッド名は JavaScript の字句文法に則ってなければなりません (<a href="#formulas.html_sec-7.6">ECMA Script standard</a> 参照)。ストラクチャー設定のグローバルなフィルタリングオプション (セキュリティページ ＞ データアクセス権)はいずれの場合でも無視されます。</p></blockquote></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#configuring.html"><span class="arrow-prev">←</span> <span>4D ViewPro エリアの設定</span></a><a class="docs-next button" href="#method-list.html"><span>メソッド一覧</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#formulas.html_%25E3%2583%2595%25E3%2582%25A9%25E3%2583%25BC%25E3%2583%259F%25E3%2583%25A5%25E3%2583%25A9%25E3%2581%25AE%25E4%25BD%25BF%25E3%2581%2584%25E6%2596%25B9">フォーミュラの使い方</a><ul class="toc-headings"><li><a href="#formulas.html_%25E3%2583%2595%25E3%2582%25A9%25E3%2583%25BC%25E3%2583%259F%25E3%2583%25A5%25E3%2583%25A9%25E3%2581%25AE%25E5%2585%25A5%25E5%258A%259B">フォーミュラの入力</a></li><li><a href="#formulas.html_%25E6%25BC%2594%25E7%25AE%2597%25E5%25AD%2590%25E3%2581%25A8%25E3%2582%25AA%25E3%2583%259A%25E3%2583%25A9%25E3%2583%25B3%25E3%2583%2589">演算子とオペランド</a></li></ul></li><li><a href="#formulas.html_%25E5%2580%25A4%25E3%2581%25A8%25E6%25BC%2594%25E7%25AE%2597%25E5%25AD%2590">値と演算子</a><ul class="toc-headings"><li><a href="#formulas.html_%25E6%25AF%2594%25E8%25BC%2583%25E6%25BC%2594%25E7%25AE%2597%25E5%25AD%2590">比較演算子</a></li><li><a href="#formulas.html_%25E6%25BC%2594%25E7%25AE%2597%25E5%25AD%2590%25E3%2581%25AE%25E5%2584%25AA%25E5%2585%2588%25E9%25A0%2586%25E4%25BD%258D">演算子の優先順位</a></li></ul></li><li><a href="#formulas.html_%25E3%2582%25BB%25E3%2583%25AB%25E5%258F%2582%25E7%2585%25A7">セル参照</a><ul class="toc-headings"><li><a href="#formulas.html_%25E5%258F%2582%25E7%2585%25A7%25E3%2581%25AE%25E8%25A8%2598%25E6%25B3%2595">参照の記法</a></li></ul></li><li><a href="#formulas.html_%25E3%2583%2593%25E3%2583%25AB%25E3%2583%2588%25E3%2582%25A4%25E3%2583%25B3%25E3%2583%2595%25E3%2582%25A1%25E3%2583%25B3%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3">ビルトインファンクション</a></li><li><a href="#formulas.html_4d%25E3%2583%2595%25E3%2582%25A1%25E3%2583%25B3%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3">4Dファンクション</a><ul class="toc-headings"><li><a href="#formulas.html_hello-world-%25E4%25BE%258B%25E9%25A1%258C">HelloWorld 例題</a></li><li><a href="#formulas.html_%25E5%25BC%2595%25E6%2595%25B0">引数</a></li></ul></li><li><a href="#formulas.html_%25E4%25BA%2592%25E6%258F%259B%25E6%2580%25A7">互換性</a><ul class="toc-headings"><li><a href="#formulas.html_%25E4%25BB%25AE%25E6%2583%25B3%25E3%2582%25B9%25E3%2583%2588%25E3%2583%25A9%25E3%2582%25AF%25E3%2583%2581%25E3%2583%25A3%25E3%2583%25BC%25E3%2582%2592%25E4%25BD%25BF%25E3%2581%25A3%25E3%2581%259F%25E3%2583%2595%25E3%2582%25A3%25E3%2583%25BC%25E3%2583%25AB%25E3%2583%2589%25E5%258F%2582%25E7%2585%25A7">仮想ストラクチャーを使ったフィールド参照</a></li><li><a href="#formulas.html_%25E8%25A8%25B1%25E5%258F%25AF%25E3%2581%2595%25E3%2582%258C%25E3%2581%259F%25E3%2583%25A1%25E3%2582%25BD%25E3%2583%2583%25E3%2583%2589%25E3%2581%25AE%25E5%25AE%25A3%25E8%25A8%2580">許可されたメソッドの宣言</a></li></ul></li></ul></nav></div></div></body></html>