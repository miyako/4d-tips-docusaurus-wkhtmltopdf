<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="ja"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Formula · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="[Formula](#formula) あるいは [Formula from string](#formula-from-string) コマンドを使用すると、ネイティブな [`4D.Function`オブジェクト](#4dfunction-オブジェクトについて) を作成することができ、それによってあらゆる 4D式やテキストとして表されたコードを実行することが可能です。"name="description" /><meta content="ja" name="docsearch:language" /><meta content="Formula · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="[Formula](#formula) あるいは [Formula from string](#formula-from-string) コマンドを使用すると、ネイティブな [`4D.Function`オブジェクト](#4dfunction-オブジェクトについて) を作成することができ、それによってあらゆる 4D式やテキストとして表されたコードを実行することが可能です。"property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#FunctionClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">Formula<a aria-hidden="true" class="anchor" id="FunctionClass.html"></a></h1></header><article><div><p><span><a href="#FunctionClass.html_formula">Formula</a> あるいは<a href="#FunctionClass.html_formula-from-string">Formula fromstring</a> コマンドを使用すると、ネイティブな <a href="#FunctionClass.html_4dfunction-%25E3%2582%25AA%25E3%2583%2596%25E3%2582%25B8%25E3%2582%25A7%25E3%2582%25AF%25E3%2583%2588%25E3%2581%25AB%25E3%2581%25A4%25E3%2581%2584%25E3%2581%25A6"><code>4D.Function</code>オブジェクト</a> を作成することができ、それによってあらゆる4D式やテキストとして表されたコードを実行することが可能です。</span></p><h3><span><a aria-hidden="true" class="anchor" id="FunctionClass.html_formula-%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_formula-%25E3%2582%25AA%25E3%2583%2596%25E3%2582%25B8%25E3%2582%25A7%25E3%2582%25AF%25E3%2583%2588"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Formula オブジェクト</span></h3><p><span>Formulaオブジェクトは、オブジェクトプロパティに格納することができます。</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=New object <span class="hljs-variable">$f</span>.message:=<span class="hljs-function">Formula</span>(<span class="hljs-function">ALERT</span>(<span class="hljs-string">"Hello world"</span>))</code></span></pre><p>このようなプロパティは "オブジェクト関数"、つまり親オブジェクトに紐づいた関数です。オブジェクトプロパティに保存されている関数を実行するには、プロパティ名のあとに <strong>()</strong>をつけます:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$f</span>.<span class="hljs-function">message</span>() <span class="hljs-comment">// "Hello world" を表示します</span></code></pre><p>大カッコを使用したシンタックスもサポートされます:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$f</span>[<span class="hljs-string">"message"</span>]() <span class="hljs-comment">// "Hello world" と表示します</span></code></pre><p>たとえ引数を受け取らなかったとしても (後述参照)、オブジェクト関数を実行するためにはカッコ ( )をつけて呼び出す必要があるという点に注意してください。オブジェクトプロパティのみを呼び出した場合、フォーミュラへの新しい参照が返されます (そしてフォーミュラは実行はされません):</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$o</span>:=<span class="hljs-variable">$f</span>.message <span class="hljs-comment">// $o にはフォーミュラオブジェクトが返されます </span></code></pre><p><a href="#FunctionClass.html_apply"><code>apply()</code></a> および<a href="#FunctionClass.html_call"><code>call()</code></a>関数を使って関数を実行することもできます:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$f</span>.message.<span class="hljs-function">apply</span>() <span class="hljs-comment">// "Hello world!" を表示します</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E5%BC%95%E6%95%B0%E3%81%AE%E5%8F%97%E3%81%91%E6%B8%A1%E3%81%97"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_%25E5%25BC%2595%25E6%2595%25B0%25E3%2581%25AE%25E5%258F%2597%25E3%2581%2591%25E6%25B8%25A1%25E3%2581%2597"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>引数の受け渡し</h4><p>フォーミュラには、<a href="#FunctionClass.html_%25E9%25A0%2586%25E7%2595%25AA%25E5%25BC%2595%25E6%2595%25B0">順番引数シンタックス</a>$1, $2...$n を使用して引数を渡すことができます。 たとえば:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: Object <span class="hljs-variable">$f</span>:=New object <span class="hljs-variable">$f</span>.message:=<span class="hljs-function">Formula</span>(<span class="hljs-function">ALERT</span>(<span class="hljs-string">"Hello "</span>+<span class="hljs-variable">$1</span>)) <span class="hljs-variable">$f</span>.<span class="hljs-function">message</span>(<span class="hljs-string">"John"</span>) <span class="hljs-comment">// "Hello John" を表示します</span></code></pre><p>あるいは、<a href="#FunctionClass.html_call">.call()</a> 関数を使用して:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: Object <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-variable">$1</span>+<span class="hljs-string">" "</span>+<span class="hljs-variable">$2</span>) <span class="hljs-variable">$text</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-literal">Null</span>;<span class="hljs-string">"Hello"</span>;<span class="hljs-string">"World"</span>) <span class="hljs-comment">// "Hello World" を返します</span> <span class="hljs-variable">$text</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-literal">Null</span>;<span class="hljs-string">"Welcome to"</span>;<span class="hljs-function">String</span>(<span class="hljs-function">Year of</span>(Current date))) <span class="hljs-comment">// "Welcome to 2019" (例) を返します</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E5%8D%98%E4%B8%80%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E7%94%A8%E3%81%AE%E5%BC%95%E6%95%B0"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_%25E5%258D%2598%25E4%25B8%2580%25E3%2583%25A1%25E3%2582%25BD%25E3%2583%2583%25E3%2583%2589%25E7%2594%25A8%25E3%2581%25AE%25E5%25BC%2595%25E6%2595%25B0"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>単一メソッド用の引数</h4><p>利便性のために、フォーミュラが単一のプロジェクトメソッドから作成された場合には、引数はフォーミュラオブジェクトの初期化では省略することができます。省略された引数は、フォーミュラを呼び出す時に一緒に渡すことができます。 たとえば:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(myMethod)  <span class="hljs-comment">// ここで Formula(myMethod($1;$2) と書く必要はありません</span> <span class="hljs-variable">$text</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-literal">Null</span>;<span class="hljs-string">"Hello"</span>;<span class="hljs-string">"World"</span>) <span class="hljs-comment">// "Hello World" を返します</span> <span class="hljs-variable">$text</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>() <span class="hljs-comment">// "How are you?" を返します</span>  <span class="hljs-comment">//myMethod</span> #<span class="hljs-function">DECLARE </span>(<span class="hljs-variable">$param1 </span>: Text; <span class="hljs-variable">$param2 </span>: Text)-&gt;<span class="hljs-variable">$return </span>: Text<span class="hljs-keyword"> If</span>(Count parameters=<span class="hljs-number">2</span>)    <span class="hljs-variable">$return</span>:=<span class="hljs-variable">$param1</span>+<span class="hljs-string">" "</span>+<span class="hljs-variable">$param2</span><span class="hljs-keyword"> Else</span>    <span class="hljs-variable">$return</span>:=<span class="hljs-string">"How are you?"</span><span class="hljs-keyword"> End if</span></code></pre><p>引数はメソッド内において、呼び出し時に指定した順で受け取られます。</p><h3><a aria-hidden="true" class="anchor" id="FunctionClass.html_4dfunction-%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_4dfunction-%25E3%2582%25AA%25E3%2583%2596%25E3%2582%25B8%25E3%2582%25A7%25E3%2582%25AF%25E3%2583%2588%25E3%2581%25AB%25E3%2581%25A4%25E3%2581%2584%25E3%2581%25A6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4D.Function オブジェクトについて</h3><p><code>4D.Function</code> オブジェクトにはコードが格納されています。このコードは<code>()</code> 演算子を使用して、または <a href="#FunctionClass.html_apply"><code>apply()</code></a> や <a href="#FunctionClass.html_call"><code>call()</code></a>関数を使用して呼び出すことができます。 4D では 3種類の Function オブジェクトが利用できます:</p><ul><li>ネイティブ関数、つまり、<code>collection.sort()</code> や<code>file.copyTo()</code> などの 4Dクラスにビルトインされた関数。</li><li>ユーザー関数 (ユーザー<a href="#classes.html">クラス</a> において <a href="#FunctionClass.html_function">Function キーワード</a>を使って作成されたもの)。</li><li>フォーミュラ関数 (4Dフォーミュラを実行するもの)。</li></ul><h3><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E6%A6%82%E8%A6%81"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_%25E6%25A6%2582%25E8%25A6%2581"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>概要</h3><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#FunctionClass.html_apply"><strong>.apply</strong>() :any<br /><strong>.apply</strong>( <em>thisObj</em> : Object { ;<em>formulaParams</em> : Collection } ) : any</a><p>&nbsp;&nbsp;&nbsp;&nbsp;対象の <code>Formula</code>オブジェクトを実行し、その結果の値を返します</p></td></tr><tr><td><a href="#FunctionClass.html_call"><strong>.call</strong>() :any<br /><strong>.call</strong>( <em>thisObj</em> : Object { ;...<em>params</em> : any } ) : any</a><p>&nbsp;&nbsp;&nbsp;&nbsp;対象の <code>Formula</code>オブジェクトを実行し、その結果の値を返します</p></td></tr><tr><td><a href="#FunctionClass.html_source"><strong>.source</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;対象フォーミュラのテキスト型のソース式</p></td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="FunctionClass.html_formula"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_formula"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Formula</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v17 R6</td><td>名称変更 (New formula -&gt; Formula)</td></tr><tr><td>v17 R3</td><td>追加</td></tr></tbody></table></details><p><strong>Formula</strong> ( <em>formulaExp</em> : Expression ) :4D.Function</p><table><thead><tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr></thead><tbody><tr><td>formulaExp</td><td>式</td><td style="text-align:center">-&gt;</td><td>オブジェクトとして返されるフォーミュラ</td></tr><tr><td>戻り値</td><td>4D.Function</td><td style="text-align:center">&lt;-</td><td>フォーミュラを格納しているネイティブな Function オブジェクト</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E8%AA%AC%E6%98%8E"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_%25E8%25AA%25AC%25E6%2598%258E"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>Formula</code> コマンドは、 <em>formulaExp</em> の式に基づいた <code>4DFunction</code> オブジェクトを作成します。 <em>formulaExp</em>には単一の値のようにシンプルなものから、引数を持つプロジェクトメソッドのように複雑なものまで指定することができます。</p><p>フォーミュラがオブジェクトとして存在することで、コマンドやメソッドに対して引数 (計算された属性)として渡したり、"コンポーネントとホストデータベース間で共有"として宣言せずとも様々なコンポーネントから実行したりできるようになります。呼び出されたフォーミュラオブジェクトは、それを作成したデータベースあるいはコンポーネントのコンテキストにおいて評価されます。</p><p>返されたフォーミュラは以下の方法で呼び出すことが可能です:</p><ul><li><a href="#FunctionClass.html_call"><code>.call()</code></a>あるいは <a href="#FunctionClass.html_apply"><code>.apply()</code></a>関数</li><li>オブジェクト記法シンタックス (<a href="#FunctionClass.html_formula-%25E3%2582%25AA%25E3%2583%2596%25E3%2582%25B8%25E3%2582%25A7%25E3%2582%25AF%25E3%2583%2588">Formulaオブジェクト</a> 参照)</li></ul><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-number">1</span>+<span class="hljs-number">2</span>) <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"myFormula"</span>;<span class="hljs-variable">$f</span>)  <span class="hljs-comment">// フォーミュラを呼び出す 3つの方法</span> <span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-variable">$o</span>) <span class="hljs-comment">// 3 を返します</span> <span class="hljs-variable">$f</span>.<span class="hljs-function">apply</span>(<span class="hljs-variable">$o</span>) <span class="hljs-comment">// 3 を返します</span> <span class="hljs-variable">$o</span>.<span class="hljs-function">myFormula</span>() <span class="hljs-comment">// 3 を返します</span></code></pre><p>フォーミュラには <a href="#FunctionClass.html_%25E5%25BC%2595%25E6%2595%25B0%25E3%2581%25AE%25E5%258F%2597%25E3%2581%2591%25E6%25B8%25A1%25E3%2581%2597">引数</a> を渡すことができます (<a href="#FunctionClass.html_%25E4%25BE%258B%25E9%25A1%258C-4">例題4</a>参照)。</p><p>フォーミュラの実行対象となるオブジェクトを指定することができます (<a href="#FunctionClass.html_%25E4%25BE%258B%25E9%25A1%258C-5">例題5</a> 参照)。このオブジェクトのプロパティは、<code>This</code> コマンドでアクセス可能です。</p><p><em>formulaExp</em>がローカル変数を使用する場合、返されるフォーミュラオブジェクトの作成時にその値がそこにコピーされ保存されます。実行時、フォーミュラはそのローカル変数の現在値ではなく、コピーされた値を使用します。ローカル変数として配列を使用することはサポートされていない点に注意してください。</p><p><code>Formula</code> によって作成されたオブジェクトは、たとえばデータベースのフィールドや Blobドキュメントなどに保存可能です。</p><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E4%BE%8B%E9%A1%8C-1"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_%25E4%25BE%258B%25E9%25A1%258C-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 1</h4><p>単純なフォーミュラの例:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-number">1</span>+<span class="hljs-number">2</span>)<span class="hljs-keyword"> var</span> <span class="hljs-variable">$o </span>: Object <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"f"</span>;<span class="hljs-variable">$f</span>) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$o</span>.f() <span class="hljs-comment">// 3 を返します</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E4%BE%8B%E9%A1%8C-2"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_%25E4%25BE%258B%25E9%25A1%258C-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 2</h4><p>ローカル変数を使用するフォーミュラの例:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$value</span>:=<span class="hljs-number">10</span> <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"f"</span>;<span class="hljs-function">Formula</span>(<span class="hljs-variable">$value</span>)) <span class="hljs-variable">$value</span>:=<span class="hljs-number">20</span> <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$o</span>.f() <span class="hljs-comment">// 10 を返します</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E4%BE%8B%E9%A1%8C-3"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_%25E4%25BE%258B%25E9%25A1%258C-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 3</h4><p>引数を用いたシンプルなフォーミュラの例:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"f"</span>;<span class="hljs-function">Formula</span>(<span class="hljs-variable">$1</span>+<span class="hljs-variable">$2</span>)) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$o</span>.f(<span class="hljs-number">10</span>;<span class="hljs-number">20</span>) <span class="hljs-comment">// 30 を返します</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E4%BE%8B%E9%A1%8C-4"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_%25E4%25BE%258B%25E9%25A1%258C-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 4</h4><p>引数を用いたプロジェクトメソッドを使用する例:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"f"</span>;<span class="hljs-function">Formula</span>(myMethod)) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$o</span>.f(<span class="hljs-string">"param1"</span>;<span class="hljs-string">"param2"</span>) <span class="hljs-comment">// $result:=myMethod("param1";"param2") と同等です</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E4%BE%8B%E9%A1%8C-5"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_%25E4%25BE%258B%25E9%25A1%258C-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 5</h4><p><code>This</code> を使用する例:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"fullName"</span>;<span class="hljs-function">Formula</span>(<span class="hljs-literal">This</span>.firstName+<span class="hljs-string">" "</span>+<span class="hljs-literal">This</span>.lastName)) <span class="hljs-variable">$o</span>.firstName:=<span class="hljs-string">"John"</span> <span class="hljs-variable">$o</span>.lastName:=<span class="hljs-string">"Smith"</span> <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$o</span>.<span class="hljs-function">fullName</span>() <span class="hljs-comment">// "John Smith" を返します</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E4%BE%8B%E9%A1%8C-6"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_%25E4%25BE%258B%25E9%25A1%258C-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 6</h4><p>オブジェクト記法を使用してフォーミュラを呼び出す例:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$feta</span>; <span class="hljs-variable">$robot </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$calc </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$robot</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Robot"</span>;<span class="hljs-string">"price"</span>;<span class="hljs-number">543</span>;<span class="hljs-string">"quantity"</span>;<span class="hljs-number">2</span>) <span class="hljs-variable">$feta</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Feta"</span>;<span class="hljs-string">"price"</span>;<span class="hljs-number">12.5</span>;<span class="hljs-string">"quantity"</span>;<span class="hljs-number">5</span>) <span class="hljs-variable">$calc</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-literal">This</span>.total:=<span class="hljs-literal">This</span>.price*<span class="hljs-literal">This</span>.quantity)  <span class="hljs-comment">// フォーミュラをオブジェクトプロパティに設定します</span> <span class="hljs-variable">$feta</span>.calc:=<span class="hljs-variable">$calc</span> <span class="hljs-variable">$robot</span>.calc:=<span class="hljs-variable">$calc</span>  <span class="hljs-comment">// フォーミュラを呼び出します</span> <span class="hljs-variable">$feta</span>.<span class="hljs-function">calc</span>() <span class="hljs-comment">// $feta={name:Feta,price:12.5,quantity:5,total:62.5,calc:"[object Formula]"}</span> <span class="hljs-variable">$robot</span>.<span class="hljs-function">calc</span>() <span class="hljs-comment">// $robot={name:Robot,price:543,quantity:2,total:1086,calc:"[object Formula]"}</span></code></pre><h2><a aria-hidden="true" class="anchor" id="FunctionClass.html_formula-from-string"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_formula-from-string"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Formula from string</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v17 R6</td><td>名称変更 (New formula from string -&gt; Formula from string)</td></tr><tr><td>v17 R3</td><td>追加</td></tr></tbody></table></details><p><strong>Formula from string</strong>( <em>formulaString</em> :Text ) : 4D.Function</p><table><thead><tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr></thead><tbody><tr><td>formulaString</td><td>Text</td><td style="text-align:center">-&gt;</td><td>オブジェクトとして返されるフォーミュラ文字列</td></tr><tr><td>戻り値</td><td>4D.Function</td><td style="text-align:center">&lt;-</td><td>フォーミュラを格納しているネイティブなオブジェクト</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E8%AA%AC%E6%98%8E-1"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_%25E8%25AA%25AC%25E6%2598%258E-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>Formula from string</code> コマンドは、 <em>formulaString</em>に基づいた <code>4D Function</code> オブジェクトを作成します。 <em>formulaString</em>には単一の値のようにシンプルなものから、引数を持つプロジェクトメソッドのように複雑なものまで指定することができます。</p><p>このコマンドは <a href="#FunctionClass.html_formula"><code>Formula</code></a>に似ていますが、テキストに基づいたフォーミュラを扱う点が異なります。 多くの場合において、<code>Formula</code>コマンドの使用が推奨されます。 <code>Formula from string</code>コマンドは、元となるフォーミュラがテキストとして表現されている場合 (例: 外部の JSON ファイルに保存されていた場合など)にのみ使用されるべきです。 このコンテキストにおいては、トークンシンタックスの使用が強く推奨されます。</p><blockquote><p>ローカル変数の中身はコンパイル済みモードでは名前によるアクセスが不可能なため、<em>formulaString</em>引数内で使用することはできません。 <code>Formula from string</code>コマンドを使用してローカル変数にアクセスを試みた場合、エラー(-10737) が生成されます。</p></blockquote><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E4%BE%8B%E9%A1%8C"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_%25E4%25BE%258B%25E9%25A1%258C"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h4><p>以下のコードは、テキストフォーマットのフォーミュラを受け入れるダイアログを作成し、:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$textFormula </span>: Text<span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$textFormula</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"フォーミュラを入力してください"</span>)<span class="hljs-keyword"> If</span>(ok=<span class="hljs-number">1</span>)    <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula from string</span>(<span class="hljs-variable">$textFormula</span>)<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"結果 = "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>()))<span class="hljs-keyword"> End if</span></code></pre><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/API/formulaDialog.png" /></p><p>そのフォーミュラを実行します:</p><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/API/formulaAlert.png" /></p><h2><a aria-hidden="true" class="anchor" id="FunctionClass.html_apply"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_apply"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.apply()</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v17 R3</td><td>追加</td></tr></tbody></table></details><p><strong>.apply</strong>() : any<br /><strong>.apply</strong>( <em>thisObj</em> : Object { ;<em>formulaParams</em> : Collection } ) : any</p><table><thead><tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr></thead><tbody><tr><td>thisObj</td><td>Object</td><td style="text-align:center">-&gt;</td><td>フォーミュラ内で This コマンドによって返されるオブジェクト</td></tr><tr><td>formulaParams</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>フォーミュラが実行される際に $1...$n として渡される値のコレクション</td></tr><tr><td>戻り値</td><td>any</td><td style="text-align:center">&lt;-</td><td>フォーミュラの実行結果</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E8%AA%AC%E6%98%8E-2"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_%25E8%25AA%25AC%25E6%2598%258E-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.apply()</code> 関数は、 対象の <code>Formula</code>オブジェクトを実行し、その結果の値を返します。 <code>Formula</code> あるいは <code>Formulafrom string</code> コマンドで作成されたフォーミュラが使用可能です。</p><p><em>thisObj</em> には、フォーミュラ内で <code>This</code>として使用されるオブジェクトへの参照を渡すことができます。</p><p>任意の <em>formulaParams</em> 引数を渡すことで、フォーミュラ内で $1...$nの引数として使用されるコレクションを渡すこともできます。</p><p><code>.apply()</code> は <a href="#FunctionClass.html_call"><code>.call()</code></a>と似ていますが、引数をコレクションとして渡す点が異なります。 これは計算された結果を渡すのに便利です。</p><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E4%BE%8B%E9%A1%8C-1-1"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_%25E4%25BE%258B%25E9%25A1%258C-1-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 1</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-variable">$1</span>+<span class="hljs-variable">$2</span>+<span class="hljs-variable">$3</span>) <span class="hljs-variable">$c</span>:=<span class="hljs-function">New collection</span>(<span class="hljs-number">10</span>;<span class="hljs-number">20</span>;<span class="hljs-number">30</span>) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">apply</span>(<span class="hljs-literal">Null</span>;<span class="hljs-variable">$c</span>) <span class="hljs-comment">// 60 を返します</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E4%BE%8B%E9%A1%8C-2-1"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_%25E4%25BE%258B%25E9%25A1%258C-2-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 2</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$calc </span>: 4D.<span class="hljs-keyword">Function</span><span class="hljs-keyword"> var</span> <span class="hljs-variable">$feta</span>; <span class="hljs-variable">$robot </span>: Object <span class="hljs-variable">$robot</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Robot"</span>;<span class="hljs-string">"price"</span>;<span class="hljs-number">543</span>;<span class="hljs-string">"quantity"</span>;<span class="hljs-number">2</span>) <span class="hljs-variable">$feta</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Feta"</span>;<span class="hljs-string">"price"</span>;<span class="hljs-number">12.5</span>;<span class="hljs-string">"quantity"</span>;<span class="hljs-number">5</span>) <span class="hljs-variable">$calc</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-literal">This</span>.total:=<span class="hljs-literal">This</span>.price*<span class="hljs-literal">This</span>.quantity) <span class="hljs-variable">$calc</span>.<span class="hljs-function">apply</span>(<span class="hljs-variable">$feta</span>) <span class="hljs-comment">// $feta={name:Feta,price:12.5,quantity:5,total:62.5}</span> <span class="hljs-variable">$calc</span>.<span class="hljs-function">apply</span>(<span class="hljs-variable">$robot</span>) <span class="hljs-comment">// $robot={name:Robot,price:543,quantity:2,total:1086}</span></code></pre><h2><a aria-hidden="true" class="anchor" id="FunctionClass.html_call"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_call"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.call()</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v17 R3</td><td>追加</td></tr></tbody></table></details><p><strong>.call</strong>() : any<br /><strong>.call</strong>( <em>thisObj</em> : Object { ;...<em>params</em> : any } ) : any</p><table><thead><tr><th>引数</th><th>タイプ</th><th></th><th>説明</th></tr></thead><tbody><tr><td>thisObj</td><td>Object</td><td>-&gt;</td><td>フォーミュラ内で This コマンドによって返されるオブジェクト</td></tr><tr><td>params</td><td>any</td><td>-&gt;</td><td>フォーミュラが実行される際に $1...$n として渡される値</td></tr><tr><td>戻り値</td><td>any</td><td>&lt;-</td><td>フォーミュラの実行結果</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E8%AA%AC%E6%98%8E-3"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_%25E8%25AA%25AC%25E6%2598%258E-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.call()</code> 関数は、 対象の <code>Formula</code>オブジェクトを実行し、その結果の値を返します。 <code>Formula</code> あるいは <code>Formulafrom string</code> コマンドで作成されたフォーミュラが使用可能です。</p><p><em>thisObj</em> には、フォーミュラ内で <code>This</code>として使用されるオブジェクトへの参照を渡すことができます。</p><p>任意の <em>params</em> 引数を渡すことで、フォーミュラ内で <em>$1...$n</em>の引数として使用される値を渡すこともできます。</p><p><code>.call()</code> は <a href="#FunctionClass.html_apply"><code>.apply()</code></a>と似ていますが、引数を直接渡す点が異なります。</p><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E4%BE%8B%E9%A1%8C-1-2"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_%25E4%25BE%258B%25E9%25A1%258C-1-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 1</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$f </span>: 4D.<span class="hljs-keyword">Function</span> <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-function">Uppercase</span>(<span class="hljs-variable">$1</span>)) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-literal">Null</span>;<span class="hljs-string">"hello"</span>) <span class="hljs-comment">// "HELLO" を返します</span></code></pre><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E4%BE%8B%E9%A1%8C-2-2"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_%25E4%25BE%258B%25E9%25A1%258C-2-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 2</h4><pre><code class="hljs css language-4d"> <span class="hljs-variable">$o</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"value"</span>;<span class="hljs-number">50</span>) <span class="hljs-variable">$f</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-literal">This</span>.value*<span class="hljs-number">2</span>) <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$f</span>.<span class="hljs-function">call</span>(<span class="hljs-variable">$o</span>) <span class="hljs-comment">// 100 を返します</span></code></pre><h2><a aria-hidden="true" class="anchor" id="FunctionClass.html_source"></a><a aria-hidden="true" class="hash-link" href="#FunctionClass.html_source"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.source</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v18 R2</td><td>追加</td></tr></tbody></table></details><p><strong>.source</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E8%AA%AC%E6%98%8E-4"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_%25E8%25AA%25AC%25E6%2598%258E-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.source</code> プロパティは、 対象フォーミュラのテキスト型のソース式を格納します。</p><p>このプロパティは <strong>読み取り専用</strong> です。</p><h4><a aria-hidden="true" class="anchor" id="FunctionClass.html_%E4%BE%8B%E9%A1%8C-7"></a><a aria-hidden="true"class="hash-link" href="#FunctionClass.html_%25E4%25BE%258B%25E9%25A1%258C-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$of </span>: 4D.<span class="hljs-keyword">Function</span><span class="hljs-keyword"> var</span> <span class="hljs-variable">$tf </span>: Text <span class="hljs-variable">$of</span>:=<span class="hljs-function">Formula</span>(<span class="hljs-function">String</span>(Current time;HH MM AM PM)) <span class="hljs-variable">$tf</span>:=<span class="hljs-variable">$of</span>.source <span class="hljs-comment">//"String(Current time;HH MM AM PM)"</span></code></pre><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#FolderClass.html"><span class="arrow-prev">←</span><span>Folder</span></a><a class="docs-next button" href="#IMAPTransporterClass.html"><span>IMAPTransporter</span><span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#FunctionClass.html_formula">Formula</a></li><li><a href="#FunctionClass.html_formula-from-string">Formula fromstring</a></li><li><a href="#FunctionClass.html_apply">.apply()</a></li><li><a href="#FunctionClass.html_call">.call()</a></li><li><a href="#FunctionClass.html_source">.source</a></li></ul></nav></div></div></body></html>