<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="ja"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>DataStore · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="[データストア](/docs/Rx/ja/ORDA/dsmapping.html#datastore) とは、ORDA によって提供されるインターフェースオブジェクトです。データストアはデータベースへの参照とアクセスを提供します。 `Datastore` オブジェクトは以下のコマンドによって返されます:"name="description" /><meta content="ja" name="docsearch:language" /><meta content="DataStore · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="[データストア](/docs/Rx/ja/ORDA/dsmapping.html#datastore) とは、ORDA によって提供されるインターフェースオブジェクトです。データストアはデータベースへの参照とアクセスを提供します。 `Datastore` オブジェクトは以下のコマンドによって返されます:"property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#DataStoreClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">DataStore<a aria-hidden="true" class="anchor" id="DataStoreClass.html"></a></h1></header><article><div><p><span><a href="#DataStoreClass.html_datastore">データストア</a>とは、ORDA によって提供されるインターフェースオブジェクトです。データストアはデータベースへの参照とアクセスを提供します。<code>Datastore</code> オブジェクトは以下のコマンドによって返されます:</span></p><ul><li><span><a href="#DataStoreClass.html_ds">ds</a>:メインデータストアへのショートカット</span></li><li><span><a href="#DataStoreClass.html_open-datastore">Opendatastore</a>: リモートデータストアを開きます</span></li></ul><h3><span><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E6%A6%82%E8%A6%81"></a><a aria-hidden="true"class="hash-link" href="#DataStoreClass.html_%25E6%25A6%2582%25E8%25A6%2581"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>概要</span></h3><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#DataStoreClass.html_canceltransaction"><strong>.cancelTransaction()</strong></a><p>&nbsp;&nbsp;&nbsp;&nbsp;トランザクションをキャンセルします</p></td></tr><tr><td><a href="#DataStoreClass.html_dataclassname"><strong><em>.dataclassName</em></strong>: 4D.DataClass</a><p>&nbsp;&nbsp;&nbsp;&nbsp;データクラスの詳細が格納されています</p></td></tr><tr><td><a href="#DataStoreClass.html_encryptionstatus"><strong>.encryptionStatus()</strong>:Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;カレントデータファイルの暗号化状態を示すオブジェクトを返します</p></td></tr><tr><td><a href="#DataStoreClass.html_getinfo"><strong>.getInfo()</strong>:Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;データストアの情報を提供するオブジェクトを返します</p></td></tr><tr><td><a href="#DataStoreClass.html_getrequestlog"><strong>.getRequestLog()</strong>: Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;クライアント側のメモリに記録されている ORDAリクエストを返します</p></td></tr><tr><td><a href="#DataStoreClass.html_makeselectionsalterable"><strong>.makeSelectionsAlterable()</strong></a><p>&nbsp;&nbsp;&nbsp;&nbsp;カレントアプリケーションのデータストアにおいて、すべての新規エンティティセレクションをデフォルトで追加可能に設定します</p></td></tr><tr><td><a href="#DataStoreClass.html_providedatakey"><strong>.provideDataKey</strong>(<em>curPassPhrase</em> : Text ) : Object<br /><strong>.provideDataKey</strong>( <em>curDataKey</em> : Object ) :Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;データストアのカレントデータファイルのデータ暗号化キーを受け取り、暗号化されたデータと合致するかどうかチェックします</p></td></tr><tr><td><a href="#DataStoreClass.html_setadminprotection"><strong>.setAdminProtection</strong>(<em>status</em> : Boolean )</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<code>WebAdmin</code>セッションにおける <a href="#dataExplorer.html">データエクスプローラー</a> 含め、<a href="#DataStoreClass.html_http%25E3%2583%259D%25E3%2583%25BC%25E3%2583%2588">Web管理ポート</a>上でのデータアクセスを無効に設定することができます</p></td></tr><tr><td><a href="#DataStoreClass.html_startrequestlog"><strong>.startRequestLog</strong>()<br /><strong>.startRequestLog</strong>( <em>file</em> : 4D.File )<br /><strong>.startRequestLog</strong>( <em>reqNum</em> : Integer )</a><p>&nbsp;&nbsp;&nbsp;&nbsp;クライアント側で ORDAリクエストのログを開始します</p></td></tr><tr><td><a href="#DataStoreClass.html_starttransaction"><strong>.startTransaction()</strong></a><p>&nbsp;&nbsp;&nbsp;&nbsp;対象データストアに対応するデータベース上で、カレントプロセス内のトランザクションを開始します</p></td></tr><tr><td><a href="#DataStoreClass.html_stoprequestlog"><strong>.stopRequestLog()</strong></a><p>&nbsp;&nbsp;&nbsp;&nbsp;クライアント側の ORDAリクエストのログをすべて停止します</p></td></tr><tr><td><a href="#DataStoreClass.html_validatetransaction"><strong>.validateTransaction()</strong></a><p>&nbsp;&nbsp;&nbsp;&nbsp;トランザクションを受け入れます</p></td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="DataStoreClass.html_ds"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_ds"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>ds</span></h2><details><summary><span>履歴</span></summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v18</td><td>localID パラメーターをサポート</td></tr><tr><td>v17</td><td>追加</td></tr></tbody></table></details><p><span><strong>ds</strong> { ( <em>localID</em> : Text ) } :cs.DataStore</span></p><table><thead><tr><th>引数</th><th>タイプ</th><th></th><th>説明</th></tr></thead><tbody><tr><td>localID</td><td>Text</td><td>-&gt;</td><td>参照を取得したいリモートデータストアのローカルID</td></tr><tr><td>戻り値</td><td>cs.DataStore</td><td>&lt;-</td><td>データストア参照</td></tr></tbody></table><h4><span><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E8%AA%AC%E6%98%8E"></a><a aria-hidden="true"class="hash-link" href="#DataStoreClass.html_%25E8%25AA%25AC%25E6%2598%258E"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</span></h4><p><span><code>ds</code> コマンドは、 カレントの 4Dデータベース、または <em>localID</em>で指定したデータベースに合致するデータストアの参照を返します。</span></p><p><span><em>localID</em> を省略した (または空の文字列 "" を渡した)場合には、ローカル4Dデータベース (4D Server でリモートデータベースを開いている場合にはそのデータベース)に合致するデータストアの参照を返します。 データストアは自動的に開かれ、<code>ds</code>を介して直接利用することができます。</span></p><p><span>開かれているリモートデータストアのローカルIDを <em>localID</em>パラメーターに渡すと、その参照を取得できます。 このデータストアは、あらかじめカレントデータベース (ホストまたはコンポーネント)によって <a href="#DataStoreClass.html_open-datastore"><code>Opendatastore</code></a> コマンドで開かれている必要があります。このコマンドを使用したときにローカルIDが定義されます。</span></p><blockquote><p><span>ローカルIDのスコープは、当該データストアを開いたデータベースです。</span></p></blockquote><p><span><em>localID</em> に合致するデータストアが見つからない場合、コマンドは<strong>Null</strong> を返します。</span></p><p><span><code>cs.Datastore</code> が提供するオブジェクトは、<a href="#DataStoreClass.html_%25E5%25A4%2589%25E6%258F%259B%25E3%2581%25AE%25E3%2583%25AB%25E3%2583%25BC%25E3%2583%25AB">ORDAマッピングルール</a>に基づいて、ターゲットデータベースからマッピングされます。</span></p><h4><span><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-1"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 1</span></h4><p><span>4Dデータベースのメインデータストアを使用します:</span></p><pre><span><code class="hljs css language-4d"> <span class="hljs-variable">$result</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"firstName = :1"</span>;<span class="hljs-string">"S@"</span>)</code></span></pre><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-2"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 2</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$connectTo</span>; <span class="hljs-variable">$firstFrench</span>; <span class="hljs-variable">$firstForeign </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$frenchStudents</span>; <span class="hljs-variable">$foreignStudents </span>: cs.DataStore <span class="hljs-variable">$connectTo</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"type"</span>;<span class="hljs-string">"4D Server"</span>;<span class="hljs-string">"hostname"</span>;<span class="hljs-string">"192.168.18.11:8044"</span>) <span class="hljs-variable">$frenchStudents</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-variable">$connectTo</span>;<span class="hljs-string">"french"</span>) <span class="hljs-variable">$connectTo</span>.hostname:=<span class="hljs-string">"192.168.18.11:8050"</span> <span class="hljs-variable">$foreignStudents</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-variable">$connectTo</span>;<span class="hljs-string">"foreign"</span>)  <span class="hljs-comment">//...</span>  <span class="hljs-comment">//...</span> <span class="hljs-variable">$firstFrench</span>:=<span class="hljs-function">getFirst</span>(<span class="hljs-string">"french"</span>;<span class="hljs-string">"Students"</span>) <span class="hljs-variable">$firstForeign</span>:=<span class="hljs-function">getFirst</span>(<span class="hljs-string">"foreign"</span>;<span class="hljs-string">"Students"</span>)</code></pre><pre><code class="hljs css language-4d">  <span class="hljs-comment">// getFirst メソッド</span>  <span class="hljs-comment">// getFirst(localID;dataclass) -&gt; entity</span> #<span class="hljs-function">DECLARE</span>( <span class="hljs-variable">$localId </span>: Text; <span class="hljs-variable">$dataClassName </span>: Text ) -&gt; <span class="hljs-variable">$entity </span>: 4D.Entity <span class="hljs-variable">$0</span>:=ds(<span class="hljs-variable">$localId</span>)[<span class="hljs-variable">$dataClassName</span>].<span class="hljs-function">all</span>().<span class="hljs-function">first</span>()</code></pre><h2><a aria-hidden="true" class="anchor" id="DataStoreClass.html_open-datastore"></a><a aria-hidden="true"class="hash-link" href="#DataStoreClass.html_open-datastore"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Open datastore</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v18</td><td>追加</td></tr></tbody></table></details><p><strong>Open datastore</strong>( <em>connectionInfo</em> :Object ; <em>localID</em> : Text ) : cs.DataStore</p><table><thead><tr><th>引数</th><th>タイプ</th><th></th><th>説明</th></tr></thead><tbody><tr><td>connectionInfo</td><td>Object</td><td>-&gt;</td><td>リモートデータストアへの接続に使用する接続プロパティ</td></tr><tr><td>localID</td><td>Text</td><td>-&gt;</td><td>ローカルアプリケーション内で、開かれたデータストアに対して割り当てる ID (必須)</td></tr><tr><td>戻り値</td><td>cs.DataStore</td><td>&lt;-</td><td>データストアオブジェクト</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E8%AA%AC%E6%98%8E-1"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E8%25AA%25AC%25E6%2598%258E-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>Open datastore</code> コマンドは、 <em>connectionInfo</em>引数が指定する 4Dデータベースにアプリケーションを接続します 。戻り値は、<em>localID</em>ローカルエイリアスに紐づけられた <code>cs.DataStore</code> オブジェクトです。</p><p><em>connectionInfo</em> で指定する4Dデータベースはリモートデーターストアとして利用可能でなければなりません。つまり、以下の条件を満たしている必要があります:</p><ul><li>データベースの Webサーバーは、http または https が有効化された状態で開始されていなければなりません。</li><li>データベースの</li><li>データベースにおいて、少なくとも 1つのクライアントライセンスが利用可能でなければなりません。</li></ul><p>合致するデータベースが見つからない場合、<code>Open datastore</code> は<strong>Null</strong> を返します。</p><p><em>localID</em> 引数は、リモートデータストア上で開かれるセッションのローカルエイリアスです。<em>localID</em> 引数の ID がすでにアプリケーションに存在している場合、その ID が使用されています。そうでない場合、データストアオブジェクトが使用されたときに <em>localID</em>のセッションが新規に作成されます。</p><p><code>cs.Datastore</code> が提供するオブジェクトは、<a href="#DataStoreClass.html_%25E5%25A4%2589%25E6%258F%259B%25E3%2581%25AE%25E3%2583%25AB%25E3%2583%25BC%25E3%2583%25AB">ORDAマッピングルール</a>に基づいて、ターゲットデータベースからマッピングされます。</p><p>一旦セッションが開かれると、以下の 2行の宣言は同等のものとなり、同じデータストアオブジェクトへの参照を返します:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$myds</span>:=<span class="hljs-function">Open datastore</span>(connectionInfo;<span class="hljs-string">"myLocalId"</span>) <span class="hljs-variable">$myds2</span>:=ds(<span class="hljs-string">"myLocalId"</span>)  <span class="hljs-comment">//$myds と $myds2 は同一のものです</span></code></pre><p><em>connectionInfo</em> には、接続したいリモートデータストアの詳細を格納したオブジェクトを渡します。オブジェクトは以下のプロパティを格納することができます (<em>hostname</em>を除き、すべてのプロパティは任意です):</p><table><thead><tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>hostname</td><td>Text</td><td>リモートデータストアの名前または IPアドレス + ":" + ポート番号 (ポート番号は必須)</td></tr><tr><td>user</td><td>Text</td><td>ユーザー名</td></tr><tr><td>password</td><td>Text</td><td>ユーザーパスワード</td></tr><tr><td>idleTimeout</td><td>Longint</td><td>アクティビティがなかった場合に、セッションがタイムアウトするまでの時間 (分単位)。この時間を過ぎると、4Dによって自動的にセッションが閉じられます。 省略時のデフォルトは 60 (1時間) です。 60 (分)未満の値を指定することはできません (60 未満の値を渡した場合、タイムアウトは 60 (分) に設定されます)。詳細については、<a href="#DataStoreClass.html_%25E3%2582%25BB%25E3%2583%2583%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3%25E3%2581%25AE%25E7%25B5%2582%25E4%25BA%2586"><strong>セッションの終了</strong></a>を参照ください。</td></tr><tr><td>tls</td><td>Boolean</td><td>安全な接続を使用します(*)。 省略時のデフォルトは false です。可能なかぎり安全な接続を使用することが推奨されます。</td></tr><tr><td>type</td><td>Text</td><td>"4D Server" でなければなりません</td></tr></tbody></table><p>(*) tls が true だった場合、以下の条件が満たされていれば、HTTPSプロトコルが使用されます:</p><ul><li>リモートデータストアで HTTPS が有効化されている。</li><li>指定されたポート番号は、データベース設定で設定されている HTTPS ポートと合致している。</li><li>データベースに有効な証明書と非公開暗号鍵がインストールされている。 条件を満たさない場合、エラー "1610 - ホストxxx へのリモートリクエストに失敗しました" が生成されます。</li></ul><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-1-1"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-1-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 1</h4><p>user / password を指定せずにリモートデータストアに接続します:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$connectTo </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$remoteDS </span>: cs.DataStore <span class="hljs-variable">$connectTo</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"type"</span>;<span class="hljs-string">"4D Server"</span>;<span class="hljs-string">"hostname"</span>;<span class="hljs-string">"192.168.18.11:8044"</span>) <span class="hljs-variable">$remoteDS</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-variable">$connectTo</span>;<span class="hljs-string">"students"</span>)<span class="hljs-function"> ALERT</span>(<span class="hljs-string">"このリモートデータストアには "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$remoteDS</span>.Students.<span class="hljs-function">all</span>().length)+<span class="hljs-string">" 名の生徒が登録されています"</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-2-1"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-2-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 2</h4><p>user / password / timeout / tls を指定してリモートデータストアに接続します:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$connectTo </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$remoteDS </span>: cs.DataStore <span class="hljs-variable">$connectTo</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"type"</span>;<span class="hljs-string">"4D Server"</span>;<span class="hljs-string">"hostname"</span>;\<span class="hljs-string">"192.168.18.11:4443"</span>;\      <span class="hljs-string">"user"</span>;<span class="hljs-string">"marie"</span>;<span class="hljs-string">"password"</span>;<span class="hljs-variable">$pwd</span>;<span class="hljs-string">"idleTimeout"</span>;<span class="hljs-number">70</span>;<span class="hljs-string">"tls"</span>;<span class="hljs-literal">True</span>) <span class="hljs-variable">$remoteDS</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-variable">$connectTo</span>;<span class="hljs-string">"students"</span>)<span class="hljs-function"> ALERT</span>(<span class="hljs-string">"このリモートデータストアには "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$remoteDS</span>.Students.<span class="hljs-function">all</span>().length)+<span class="hljs-string">" 名の生徒が登録されています"</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-3"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 3</h4><p>複数のリモートデータストアと接続します:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$connectTo </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$frenchStudents</span>; <span class="hljs-variable">$foreignStudents </span>: cs.DataStore <span class="hljs-variable">$connectTo</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"hostname"</span>;<span class="hljs-string">"192.168.18.11:8044"</span>) <span class="hljs-variable">$frenchStudents</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-variable">$connectTo</span>;<span class="hljs-string">"french"</span>) <span class="hljs-variable">$connectTo</span>.hostname:=<span class="hljs-string">"192.168.18.11:8050"</span> <span class="hljs-variable">$foreignStudents</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-variable">$connectTo</span>;<span class="hljs-string">"foreign"</span>)<span class="hljs-function"> ALERT</span>(<span class="hljs-string">"フランスの生徒は "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$frenchStudents</span>.Students.<span class="hljs-function">all</span>().length)+<span class="hljs-string">" 名です"</span>)<span class="hljs-function"> ALERT</span>(<span class="hljs-string">"外国の生徒は "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$foreignStudents</span>.Students.<span class="hljs-function">all</span>().length)+<span class="hljs-string">" 名です"</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E3%82%A8%E3%83%A9%E3%83%BC%E7%AE%A1%E7%90%86"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E3%2582%25A8%25E3%2583%25A9%25E3%2583%25BC%25E7%25AE%25A1%25E7%2590%2586"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>エラー管理</h4><p>エラーが起きた場合、コマンドは <strong>Null</strong> を返します。リモートデータベースにアクセスできなかった場合 (アドレス違い、Webサーバーが開始されていない、http/httpsが有効化されていない、等)、エラー1610 "ホスト XXX へのリモートリクエストに失敗しました" が生成されます。 このエラーは<code>ON ERR CALL</code> で実装されたメソッドで割り込み可能です。</p><h2><a aria-hidden="true" class="anchor" id="DataStoreClass.html_dataclassname"></a><a aria-hidden="true"class="hash-link" href="#DataStoreClass.html_dataclassname"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a><em>.dataclassName</em></h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v17</td><td>追加</td></tr></tbody></table></details><p><strong><em>.dataclassName</em></strong> : 4D.DataClass</p><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E8%AA%AC%E6%98%8E-2"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E8%25AA%25AC%25E6%2598%258E-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p>データストアの各データクラスは <a href="#DataStoreClass.html_%25E3%2583%2587%25E3%2583%25BC%25E3%2582%25BF%25E3%2582%25B9%25E3%2583%2588%25E3%2582%25A2">DataStore オブジェクト</a> のプロパティとして利用可能です。 戻り値のオブジェクトにはデータクラスの詳細が格納されています。</p><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C"></a><a aria-hidden="true"class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$emp </span>: cs.Employee<span class="hljs-keyword"> var</span> <span class="hljs-variable">$sel </span>: cs.EmployeeSelection <span class="hljs-variable">$emp</span>:=ds.Employee <span class="hljs-comment">//$emp は Employeeデータクラスを格納します</span> <span class="hljs-variable">$sel</span>:=<span class="hljs-variable">$emp</span>.<span class="hljs-function">all</span>() <span class="hljs-comment">// 全従業員のエンティティセレクションを取得します</span>  <span class="hljs-comment">// あるいは以下のように直接書くことも可能です:</span> <span class="hljs-variable">$sel</span>:=ds.Employee.<span class="hljs-function">all</span>()</code></pre><h2><a aria-hidden="true" class="anchor" id="DataStoreClass.html_canceltransaction"></a><a aria-hidden="true"class="hash-link" href="#DataStoreClass.html_canceltransaction"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.cancelTransaction()</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v18</td><td>追加</td></tr></tbody></table></details><p><strong>.cancelTransaction()</strong> | 引数 | タイプ | | 説明 | | -- |--- |::| ----------------- | | | | | このコマンドは引数を必要としません |</p><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E8%AA%AC%E6%98%8E-3"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E8%25AA%25AC%25E6%2598%258E-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.cancelTransaction()</code>関数は、指定データストアのカレントプロセスにおいて、<a href="#DataStoreClass.html_starttransaction"><code>.startTransaction()</code></a>によって開かれた トランザクションをキャンセルします 。</p><p><code>.cancelTransaction()</code>関数は、トランザクション中におこなわれたデータ変更をすべてキャンセルします。</p><p>複数のトランザクションをネストすること (サブトランザクション) が可能です。メイントランザクションがキャンセルされると、サブトランザクションも (たとえ個々に<a href="#DataStoreClass.html_validatetransactions"><code>.validateTransaction()</code></a>関数で承認されていても) すべてキャンセルされます。</p><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-4"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h4><p><a href="#DataStoreClass.html_starttransaction"><code>.startTransaction()</code></a>関数の例題を参照ください。</p><h2><a aria-hidden="true" class="anchor" id="DataStoreClass.html_encryptionstatus"></a><a aria-hidden="true"class="hash-link" href="#DataStoreClass.html_encryptionstatus"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.encryptionStatus()</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v17 R5</td><td>追加</td></tr></tbody></table></details><p><strong>.encryptionStatus()</strong>: Object</p><table><thead><tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr></thead><tbody><tr><td>戻り値</td><td>Object</td><td style="text-align:center">&lt;-</td><td>カレントデータストアと、各テーブルの暗号化についての情報</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E8%AA%AC%E6%98%8E-4"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E8%25AA%25AC%25E6%2598%258E-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.encryptionStatus()</code> 関数は、カレントデータファイルの暗号化状態を示すオブジェクトを返します 。カレントデータファイルとはつまり、<code>ds</code>データストアのデータファイルです。 各テーブルの状態も提供されます。</p><blockquote><p>その他のデータファイルの暗号化状態を調べるには、<code>Data file encryption status</code>コマンドを使います。</p></blockquote><p><strong>戻り値</strong></p><p>戻り値のオブジェクトには、以下のプロパティが格納されています:</p><table><thead><tr><th>プロパティ</th><th></th><th></th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>isEncrypted</td><td></td><td></td><td>Boolean</td><td>データファイルが暗号化されていれば true</td></tr><tr><td>keyProvided</td><td></td><td></td><td>Boolean</td><td>暗号化されたデータファイルに合致する暗号化キーが提供されていれば true (*)</td></tr><tr><td>tables</td><td></td><td></td><td>Object</td><td>暗号化可能および暗号化されたテーブルと同じ数のプロパティを持つオブジェクト</td></tr><tr><td></td><td><em>tableName</em></td><td></td><td>Object</td><td>暗号化可能または暗号化されたテーブル</td></tr><tr><td></td><td></td><td>name</td><td>Text</td><td>テーブル名</td></tr><tr><td></td><td></td><td>num</td><td>Number</td><td>テーブル番号</td></tr><tr><td></td><td></td><td>isEncryptable</td><td>Boolean</td><td>ストラクチャーファイルにおいて、テーブルが暗号化可能と宣言されていれば true</td></tr><tr><td></td><td></td><td>isEncrypted</td><td>Boolean</td><td>データファイルにおいて、テーブルのレコードが暗号化されていれば true</td></tr></tbody></table><p>(*) 暗号化キーは、以下の手段のいずれかで提供されます:</p><ul><li><code>.provideDataKey()</code> コマンド</li><li>データストアを開く前に接続されていたデバイスのルート</li><li><code>Discover data key</code> コマンド</li></ul><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-5"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h4><p>カレントデータファイル内で暗号化されているテーブルの数を知りたい場合:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$status</span>:=dataStore.<span class="hljs-function">encryptionStatus</span>()<span class="hljs-keyword"> If</span>(<span class="hljs-variable">$status</span>.isEncrypted) <span class="hljs-comment">// データベースが暗号化されていれば</span><span class="hljs-function">    C_LONGINT</span>(<span class="hljs-variable">$vcount</span>)<span class="hljs-function">    C_TEXT</span>(<span class="hljs-variable">$tabName</span>)<span class="hljs-keyword">    For each</span>(<span class="hljs-variable">$tabName</span>;<span class="hljs-variable">$status</span>.tables)<span class="hljs-keyword">       If</span>(<span class="hljs-variable">$status</span>.tables[<span class="hljs-variable">$tabName</span>].isEncrypted)          <span class="hljs-variable">$vcount</span>:=<span class="hljs-variable">$vcount</span>+<span class="hljs-number">1</span><span class="hljs-keyword">       End if</span><span class="hljs-keyword">    End for each</span><span class="hljs-function">    ALERT</span>(<span class="hljs-string">"データベースには "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$vcount</span>)+<span class="hljs-string">" 件の暗号化されたテーブルが存在しています。"</span>)<span class="hljs-keyword"> Else</span><span class="hljs-function">    ALERT</span>(<span class="hljs-string">"このデータベースは暗号化されていません。"</span>)<span class="hljs-keyword"> End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="DataStoreClass.html_getinfo"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_getinfo"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getInfo()</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v17</td><td>追加</td></tr></tbody></table></details><p><strong>.getInfo()</strong>: Object</p><table><thead><tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr></thead><tbody><tr><td>戻り値</td><td>Object</td><td style="text-align:center">&lt;-</td><td>データストアのプロパティ</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E8%AA%AC%E6%98%8E-5"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E8%25AA%25AC%25E6%2598%258E-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.getInfo()</code> 関数は、 データストアの情報を提供するオブジェクトを返します。このメソッドは汎用的なコードを書くのに有用です。</p><p><strong>返されるオブジェクト</strong></p><table><thead><tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>type</td><td>string</td><td><ul><li>"4D": ds で利用可能なメインデータストア</li><li>"4D Server": Open datastore で開かれたリモートデータストア</li></ul></td></tr><tr><td>networked</td><td>boolean</td><td><ul><li>true: ネットワーク接続を介してアクセスされたデータストア</li><li>false: ネットワーク接続を介さずにアクセスしているデータストア (ローカルデータベース)</li></ul></td></tr><tr><td>localID</td><td>テキスト</td><td>マシン上のデータストアID。 これは、<code>Open datastore</code> コマンドで返されるlocalId 文字列です。 メインデータストアの場合は空の文字列 ("") です。</td></tr><tr><td>connection</td><td>object</td><td>リモートデータストア接続の情報を格納したオブジェクト (メインデータストアの場合は返されません)。 次のプロパティを含みます:<table><tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr><tr><td>hostname</td><td>テキスト</td><td>リモートデータストアの IPアドレスまたは名称 + ":" + ポート番号</td></tr><tr><td>tls</td><td>boolean</td><td>リモートデータストアとセキュア接続を利用している場合は true</td></tr><tr><td>idleTimeout</td><td>number</td><td>セッション非アクティブタイムアウト (分単位)。</td></tr><tr><td>user</td><td>テキスト</td><td>リモートデータストアにて認証されたユーザー</td></tr></table></td></tr></tbody></table><ul><li><code>.getInfo()</code> 関数が、4D Server またはシングルユーザー版 4D上で実行された場合、<code>networked</code> は false となります。</li><li><code>.getInfo()</code> 関数が、リモート版 4D上で実行された場合、<code>networked</code> は true となります。</li></ul><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-1-2"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-1-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 1</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$info </span>: Object <span class="hljs-variable">$info</span>:=ds.<span class="hljs-function">getInfo</span>() <span class="hljs-comment">// 4D Server または 4D 上で実行した場合</span>  <span class="hljs-comment">//{"type":"4D","networked":false,"localID":""}</span> <span class="hljs-variable">$info</span>:=ds.<span class="hljs-function">getInfo</span>() <span class="hljs-comment">// リモート版4D 上で実行した場合</span>  <span class="hljs-comment">//{"type":"4D","networked":true,"localID":""}</span></code></pre><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-2-2"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-2-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 2</h4><p>リモートデータストアの場合:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">  var</span> <span class="hljs-variable">$remoteDS </span>: cs.DataStore<span class="hljs-keyword">  var</span> <span class="hljs-variable">$info</span>; <span class="hljs-variable">$connectTo </span>: Object <span class="hljs-variable">$connectTo</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"hostname"</span>;<span class="hljs-string">"111.222.33.44:8044"</span>;<span class="hljs-string">"user"</span>;<span class="hljs-string">"marie"</span>;<span class="hljs-string">"password"</span>;<span class="hljs-string">"aaaa"</span>) <span class="hljs-variable">$remoteDS</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-variable">$connectTo</span>;<span class="hljs-string">"students"</span>) <span class="hljs-variable">$info</span>:=<span class="hljs-variable">$remoteDS</span>.<span class="hljs-function">getInfo</span>()  <span class="hljs-comment">//{"type":"4D Server",</span>  <span class="hljs-comment">//"localID":"students",</span>  <span class="hljs-comment">//"networked":true,</span>  <span class="hljs-comment">//"connection":{hostname:"111.222.33.44:8044","tls":false,"idleTimeout":2880,"user":"marie"}}</span></code></pre><h2><a aria-hidden="true" class="anchor" id="DataStoreClass.html_getrequestlog"></a><a aria-hidden="true"class="hash-link" href="#DataStoreClass.html_getrequestlog"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getRequestLog()</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v17 R6</td><td>追加</td></tr></tbody></table></details><p><strong>.getRequestLog()</strong> : Collection</p><table><thead><tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr></thead><tbody><tr><td>戻り値</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>オブジェクトのコレクション (要素毎に一つのリクエストを記述します)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E8%AA%AC%E6%98%8E-6"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E8%25AA%25AC%25E6%2598%258E-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.getRequestLog()</code> 関数は、 クライアント側のメモリに記録されているORDAリクエストを返します。 ORDAリクエストのログが、<a href="#DataStoreClass.html_startrequestlog"><code>.startRequestLog()</code></a>関数によって事前に有効化されている必要があります。</p><p>このメソッドはリモートの 4D で呼び出す必要があり、そうでない場合には空のコレクションを返します。これはクライアント/サーバー環境でのデバッグを想定して設計されています。</p><p><strong>戻り値</strong></p><p>スタックされたリクエストオブジェクトのコレクションが返されます。 直近のリクエストにはインデックス 0が振られています。</p><p>ORDAリクエストログのフォーマットの詳細は、<a href="#DataStoreClass.html_4385373"><strong>ORDAクライアントリクエスト</strong></a>の章を参照ください。</p><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-6"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h4><p><a href="#DataStoreClass.html_startrequestlog"><code>.startRequestLog()</code></a>の例題2を参照ください。</p><h2><a aria-hidden="true" class="anchor" id="DataStoreClass.html_isadminprotected"></a><a aria-hidden="true"class="hash-link" href="#DataStoreClass.html_isadminprotected"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.isAdminProtected()</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v18 R6</td><td>追加</td></tr></tbody></table></details><p><strong>.isAdminProtected()</strong> : Boolean</p><table><thead><tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr></thead><tbody><tr><td>戻り値</td><td>Boolean</td><td style="text-align:center">&lt;-</td><td>データエクスプローラーへのアクセスが無効に設定されているの場合は true、有効の場合は false (デフォルト)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E8%AA%AC%E6%98%8E-7"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E8%25AA%25AC%25E6%2598%258E-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.isAdminProtected()</code> 関数は、 現在のセッションにおいて <a href="#dataExplorer.html">データエクスプローラー</a> へのアクセスが無効に設定されているの場合は<code>true</code>を返します。</p><p><code>webAdmin</code>セッションにおいて、データエクスプローラーへのアクセスはデフォルトで有効となっていますが、管理者によるデータアクセスを禁止するため無効にすることもできます(<a href="#DataStoreClass.html_setadminprotection"><code>.setAdminProtection()</code></a>関数参照)。</p><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E5%8F%82%E7%85%A7"></a><a aria-hidden="true"class="hash-link" href="#DataStoreClass.html_%25E5%258F%2582%25E7%2585%25A7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>参照</h4><p><a href="#DataStoreClass.html_setadminprotection"><code>.setAdminProtection()</code></a></p><h2><a aria-hidden="true" class="anchor" id="DataStoreClass.html_makeselectionsalterable"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_makeselectionsalterable"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.makeSelectionsAlterable()</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v18 R5</td><td>追加</td></tr></tbody></table></details><p><strong>.makeSelectionsAlterable()</strong> | 引数 | タイプ | | 説明 || -- | --- |::| ----------------- | | | | | このコマンドは引数を必要としません |</p><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E8%AA%AC%E6%98%8E-8"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E8%25AA%25AC%25E6%2598%258E-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.makeSelectionsAlterable()</code> 関数は、カレントアプリケーションのデータストアにおいて、すべての新規エンティティセレクションをデフォルトで追加可能に設定します(<a href="#datastores.html">リモートデータストア</a> を含む)。 これはたとえば <code>OnStartup</code> データベースメソッドなどで、一度だけ使用することが想定されています。</p><p>このメソッドが呼ばれてない場合、新規エンティティセレクションはそれぞれの "親"の性質や作成方法に応じて、共有可能に設定される場合もあります (<a href="#DataStoreClass.html_%25E5%2585%25B1%25E6%259C%2589%25E5%258F%25AF%25E8%2583%25BD%25E8%25BF%25BD%25E5%258A%25A0%25E5%258F%25AF%25E8%2583%25BD%25E3%2581%25AA%25E3%2582%25A8%25E3%2583%25B3%25E3%2583%2586%25E3%2582%25A3%25E3%2583%2586%25E3%2582%25A3%25E3%2582%25BB%25E3%2583%25AC%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3">共有可能/追加可能なエンティティセレクション</a>参照)。</p><blockquote><p>この関数は、<code>OB Copy</code> または <a href="#DataStoreClass.html_copy"><code>.copy()</code></a> に <code>ckshared</code> オプションを明示的に使用して作成されたエンティティセレクションには適用されません。</p></blockquote><blockquote><p><strong>互換性に関する注記</strong>: このメソッドは 4D v18 R5より前のバージョンから変換されたプロジェクトで、<a href="#DataStoreClass.html_add">.add()</a> の呼び出しを使用しているものにおいてのみ使用してください。このコンテキストにおいては、<code>.makeSelectionsAlterable()</code>を使用することで、既存プロジェクト内で以前の 4D のふるまいを再現し、時間を節約できます。 逆に、4D v18 R5以降のバージョンで作成された新規プロジェクトにおいては、この関数の使用は<strong>推奨されていません</strong>。エンティティセレクションを共有可能にできないため、パフォーマンスとスケーラビリティの観点で妨げになるからです。</p></blockquote><h2><a aria-hidden="true" class="anchor" id="DataStoreClass.html_providedatakey"></a><a aria-hidden="true"class="hash-link" href="#DataStoreClass.html_providedatakey"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.provideDataKey()</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v17 R5</td><td>追加</td></tr></tbody></table></details><p><strong>.provideDataKey</strong>( <em>curPassPhrase</em> : Text) : Object<br /><strong>.provideDataKey</strong>( <em>curDataKey</em> : Object ) :Object</p><table><thead><tr><th>引数</th><th>タイプ</th><th></th><th>説明</th></tr></thead><tbody><tr><td>curPassPhrase</td><td>Text</td><td>-&gt;</td><td>カレントのパスフレーズ</td></tr><tr><td>curDataKey</td><td>Object</td><td>-&gt;</td><td>カレントのデータ暗号化キー</td></tr><tr><td>戻り値</td><td>Object</td><td>&lt;-</td><td>暗号化キーのチェックの結果</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E8%AA%AC%E6%98%8E-9"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E8%25AA%25AC%25E6%2598%258E-9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.provideDataKey()</code> 関数は、データストアのカレントデータファイルのデータ暗号化キーを受け取り、暗号化されたデータと合致するかどうかチェックします。この関数は、暗号化されたデータベースを開くときや、データファイルの再暗号化など暗号化キーが必要となる暗号化オペレーションを実行する際に使用します。</p><blockquote><ul><li><code>.provideDataKey()</code> 関数は暗号化されたデータベース内で呼び出される必要があります。暗号化されていないデータベース内で呼び出した場合、エラー2003 (暗号化キーはデータと合致しません) が返されます。データベースが暗号化されているかどうかを調べるには <code>Data file encryption status</code>コマンドを使用します。</li><li>リモートの 4D または暗号化されたリモートデータストアから、<code>.provideDataKey()</code>関数を呼び出すことはできません。</li></ul></blockquote><p><em>curPassPhrase</em> パラメーターを使用する場合は、データ暗号化キーの生成に使用した文字列を渡します。このパラメーターを使用した場合、暗号化キーが生成されます。</p><p><em>curDataKey</em> パラメーターを使用する場合は、データ暗号化キー (<em>encodedKey</em>プロパティ) を格納するオブジェクトを渡します。 このキーは、<code>New data key</code>コマンドで生成された可能性があります。</p><p>有効な暗号化キーが提供された場合、そのキーはメモリ内の <em>keyChain</em>に追加され、暗号化モードが有効になります:</p><ul><li>暗号化可能テーブルに対するデータ編集はすべて、ディスク上 (.4DD、.journal、 .4Dindx ファイル)で暗号化されます。</li><li>暗号化可能テーブルから読み出したすべてのデータは、メモリ内で復号化されます。</li></ul><p><strong>戻り値</strong></p><p>コマンドの実行結果は、戻り値のオブジェクトに格納されます:</p><table><thead><tr><th>プロパティ</th><th></th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>success</td><td></td><td>Boolean</td><td>提供された暗号化キーが暗号化データと合致すれば true、それ以外は false</td></tr><tr><td></td><td></td><td></td><td>以下のプロパティは、success が <em>FALSE</em> であった場合にのみ返されます。</td></tr><tr><td>status</td><td></td><td>Number</td><td>エラーコード (提供された暗号化キーが間違っていた場合には 4)</td></tr><tr><td>statusText</td><td></td><td>Text</td><td>エラーメッセージ</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>エラーのスタック。 最初のエラーに最も高いインデックスが割り当てられます。</td></tr><tr><td></td><td>[ ].componentSignature</td><td>Text</td><td>内部コンポーネント名</td></tr><tr><td></td><td>[ ].errCode</td><td>Number</td><td>エラー番号</td></tr><tr><td></td><td>[ ].message</td><td>Text</td><td>エラーメッセージ</td></tr></tbody></table><p><em>curPassphrase</em> および <em>curDataKey</em>のどちらの引数も渡されなかった場合、<code>.provideDataKey()</code> は<strong>null</strong> を返します (この場合エラーは生成されません)。</p><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-7"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$keyStatus </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$passphrase </span>: Text <span class="hljs-variable">$passphrase</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"パスフレーズを入力してください。"</span>)<span class="hljs-keyword"> If</span>(OK=<span class="hljs-number">1</span>)    <span class="hljs-variable">$keyStatus</span>:=ds.<span class="hljs-function">provideDataKey</span>(<span class="hljs-variable">$passphrase</span>)<span class="hljs-keyword">    If</span>(<span class="hljs-variable">$keyStatus</span>.success)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"提供された暗号化キーは有効です。"</span>)<span class="hljs-keyword">    Else</span><span class="hljs-function">       ALERT</span>(<span class="hljs-string">"提供された暗号化キーは無効です。暗号化データの編集はできません。"</span>)<span class="hljs-keyword">    End if</span><span class="hljs-keyword"> End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="DataStoreClass.html_setadminprotection"></a><a aria-hidden="true"class="hash-link" href="#DataStoreClass.html_setadminprotection"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.setAdminProtection()</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v18 R6</td><td>追加</td></tr></tbody></table></details><p><strong>.setAdminProtection</strong>( <em>status</em> : Boolean)</p><table><thead><tr><th>引数</th><th>タイプ</th><th></th><th>説明</th></tr></thead><tbody><tr><td>status</td><td>Boolean</td><td>-&gt;</td><td><code>webAdmin</code>ポート上で、データエクスプローラーによるデータアクセスを無効にするにはtrue、アクセスを有効にするには false (デフォルト)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E8%AA%AC%E6%98%8E-10"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E8%25AA%25AC%25E6%2598%258E-10"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.setAdminProtection()</code> 関数は、<code>WebAdmin</code>セッションにおける <a href="#dataExplorer.html">データエクスプローラー</a> 含め、<a href="#DataStoreClass.html_http%25E3%2583%259D%25E3%2583%25BC%25E3%2583%2588">Web管理ポート</a>上でのデータアクセスを無効に設定することができます。</p><p>この関数が呼び出されなかった場合のデフォルトでは、データエクスプローラーを使用した <code>WebAdmin</code>権限を持つセッションについて、Web管理ポート上のデータアクセスは常に許可されます。 環境によっては(たとえば、アプリケーションサーバーが第三者のマシン上でホストされている場合)、 管理者に対して <a href="#DataStoreClass.html_access-key">access key</a>設定を含むサーバー設定の編集は許可しても、データ閲覧はできないようにしたいかもしれません。</p><p>このような場合にこの関数を呼び出すことで、ユーザーセッションが <code>WebAdmin</code>権限を持っていても、マシンの Web管理ポート上でのデータエクスプローラーによるデータアクセスを無効にすることができます。この関数を実行するとデータファイルは即座に保護され、そのステータスがディスク上に保存されます:アプリケーションを再起動しても、データファイルは保護されたままです。</p><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-8"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h4><p>運用前に呼び出す <em>protectDataFile</em> プロジェクトメソッドを作成します:</p><pre><code class="hljs css language-4d"> ds.<span class="hljs-function">setAdminProtection</span>(<span class="hljs-literal">True</span>) <span class="hljs-comment">// データエクスプローラーによるデータアクセスを無効化します</span></code></pre><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E5%8F%82%E7%85%A7-1"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E5%258F%2582%25E7%2585%25A7-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>参照</h4><p><a href="#DataStoreClass.html_isadminprotected"><code>.isAdminProtected()</code></a></p><h2><a aria-hidden="true" class="anchor" id="DataStoreClass.html_startrequestlog"></a><a aria-hidden="true"class="hash-link" href="#DataStoreClass.html_startrequestlog"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.startRequestLog()</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v17 R6</td><td>追加</td></tr></tbody></table></details><p><strong>.startRequestLog</strong>()<br /><strong>.startRequestLog</strong>( <em>file</em> : 4D.File )<br /><strong>.startRequestLog</strong>( <em>reqNum</em> : Integer )</p><table><thead><tr><th>引数</th><th>タイプ</th><th></th><th>説明</th></tr></thead><tbody><tr><td>file</td><td>4D.File</td><td>-&gt;</td><td>File オブジェクト</td></tr><tr><td>reqNum</td><td>Integer</td><td>-&gt;</td><td>メモリ内に保管するリクエストの数</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E8%AA%AC%E6%98%8E-11"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E8%25AA%25AC%25E6%2598%258E-11"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.startRequestLog()</code> 関数は、 クライアント側でORDAリクエストのログを開始します。</p><p>このメソッドはリモート側の 4D で呼び出す必要があり、それ以外の場合には何もしません。これはクライアント/サーバー環境でのデバッグを想定して設計されています。</p><p>ORDA リクエストログは、渡した引数によってファイルまたはメモリに送ることができます:</p><ul><li><code>File</code> コマンドで作成された <em>file</em>オブジェクトを渡した場合、ログデータはオブジェクト (JSON フォーマット) のコレクションとしてこのファイルに書き込まれます。各オブジェクトは一つのリクエストを表します。<br />ファイルがまだ存在しない場合には、作成されます。 もしファイルが既に存在する場合、新しいログデータはそこに追加されていきます。メモリへのログ記録が既に始まっている状態で、 <code>.startRequestLog( )</code>が file引数付きで呼び出された場合、メモリに記録されていたログは停止され消去されます。</li></ul><blockquote><p>JSON 評価を実行するには、ファイルの終わりに手動で ] 文字を追加する必要があります。</p></blockquote><ul><li><p><em>reqNum</em> (倍長整数) 引数を渡した場合、メモリ内のログは (あれば)消去され、新しいログが初期化されます。 <em>reqNum</em>引数が指定する数にリクエスト数が到達するまでは、ログはメモリに保管され、到達した場合には古いエントリーから消去されていきます(FIFO スタック)。<br />ファイルへのログ記録が既に始まっている状態で、<code>.startRequestLog()</code> が reqNum引数付きで呼び出された場合、ファイルへのログは停止されます。</p></li><li><p>引数を何も渡さなかった場合、ログはメモリに記録されていきます。 前もって<code>.startRequestLog()</code> が<em>reqNum</em> 引数付きで 呼び出されていた場合(ただし <code>.stopRequestLog()</code>の前)、ログが次回消去されるかまたは<code>.stopRequestLog()</code>が呼び出されるまで、ログデータはメモリ内にスタックされます。</p></li></ul><p>ORDAリクエストログのフォーマットの詳細は、<a href="#DataStoreClass.html_4385373"><strong>ORDAクライアントリクエスト</strong></a>の章を参照ください。</p><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-1-3"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-1-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 1</h4><p>ORDA クライアントリクエストをファイルに記録し、ログシーケンス番号を使用します:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$file </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$e </span>: cs.PersonsEntity <span class="hljs-variable">$file</span>:=<span class="hljs-function">File</span>(<span class="hljs-string">"/LOGS/ORDARequests.txt"</span>) <span class="hljs-comment">// Logs フォルダー</span><span class="hljs-function"> SET DATABASE PARAMETER</span>(Client Log Recording;<span class="hljs-number">1</span>) <span class="hljs-comment">// グローバルログシーケンス番号をトリガーします</span> ds.<span class="hljs-function">startRequestLog</span>(<span class="hljs-variable">$file</span>) <span class="hljs-variable">$e</span>:=ds.Persons.<span class="hljs-function">get</span>(<span class="hljs-number">30001</span>) <span class="hljs-comment">// リクエストを送信します</span> ds.<span class="hljs-function">stopRequestLog</span>()<span class="hljs-function"> SET DATABASE PARAMETER</span>(Client Log Recording;<span class="hljs-number">0</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-2-3"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-2-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 2</h4><p>ORDA クライアントリクエストをメモリに記録します:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$es </span>: cs.PersonsSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$log </span>: Collection ds.<span class="hljs-function">startRequestLog</span>(<span class="hljs-number">3</span>) <span class="hljs-comment">// メモリにはリクエストを 3つまで保管します</span> <span class="hljs-variable">$es</span>:=ds.Persons.<span class="hljs-function">query</span>(<span class="hljs-string">"name=:1"</span>;<span class="hljs-string">"Marie"</span>) <span class="hljs-variable">$es</span>:=ds.Persons.<span class="hljs-function">query</span>(<span class="hljs-string">"name IN :1"</span>;<span class="hljs-function">New collection</span>(<span class="hljs-string">"Marie"</span>)) <span class="hljs-variable">$es</span>:=ds.Persons.<span class="hljs-function">query</span>(<span class="hljs-string">"name=:1"</span>;<span class="hljs-string">"So@"</span>) <span class="hljs-variable">$log</span>:=ds.<span class="hljs-function">getRequestLog</span>()<span class="hljs-function"> ALERT</span>(<span class="hljs-string">"The longest request lasted: "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$log</span>.<span class="hljs-function">max</span>(<span class="hljs-string">"duration"</span>))+<span class="hljs-string">" ms"</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="DataStoreClass.html_starttransaction"></a><a aria-hidden="true"class="hash-link" href="#DataStoreClass.html_starttransaction"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.startTransaction()</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v18</td><td>追加</td></tr></tbody></table></details><p><strong>.startTransaction()</strong> | 引数 | タイプ | | 説明 | | -- |--- | | ----------------- | | | | | このコマンドは引数を必要としません |</p><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E8%AA%AC%E6%98%8E-12"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E8%25AA%25AC%25E6%2598%258E-12"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.startTransaction()</code> 関数は、対象データストアに対応するデータベース上で、カレントプロセス内のトランザクションを開始します。トランザクションプロセス中にデータストアのエンティティに加えられた変更は、トランザクションが確定されるかキャンセルされるまで一時的に保管されたままになります。</p><blockquote><p>このメソッドがメインのデータストア (<code>ds</code> コマンドで返されるデータストア)で呼ばれた場合、トランザクションはメインのデータストアとそのデータベースで実行されるすべてのオペレーションに適用されます。これには、そこで実行されるORDA とクラシック言語も含まれます。</p></blockquote><p>複数のトランザクションをネストすること (サブトランザクション) が可能です。個々のトランザクションまたはサブトランザクションは、それぞれキャンセルするか確定される必要があります。メイントランザクションがキャンセルされると、サブトランザクションも(たとえ個々に<code>.validateTransaction()</code> 関数で承認されていても)すべてキャンセルされます。</p><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-9"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$connect</span>; <span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$person </span>: cs.PersonsEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$ds </span>: cs.DataStore<span class="hljs-keyword"> var</span> <span class="hljs-variable">$choice </span>: Text<span class="hljs-keyword"> var</span> <span class="hljs-variable">$error </span>: Boolean<span class="hljs-keyword"> Case of</span>    :(<span class="hljs-variable">$choice</span>=<span class="hljs-string">"local"</span>)       <span class="hljs-variable">$ds</span>:=ds    :(<span class="hljs-variable">$choice</span>=<span class="hljs-string">"remote"</span>)       <span class="hljs-variable">$connect</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"hostname"</span>;<span class="hljs-string">"111.222.3.4:8044"</span>)       <span class="hljs-variable">$ds</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-variable">$connect</span>;<span class="hljs-string">"myRemoteDS"</span>)<span class="hljs-keyword"> End case</span> <span class="hljs-variable">$ds</span>.<span class="hljs-function">startTransaction</span>() <span class="hljs-variable">$person</span>:=<span class="hljs-variable">$ds</span>.Persons.<span class="hljs-function">query</span>(<span class="hljs-string">"lastname=:1"</span>;<span class="hljs-string">"Peters"</span>).<span class="hljs-function">first</span>()<span class="hljs-keyword"> If</span>(<span class="hljs-variable">$person</span>#<span class="hljs-literal">Null</span>)    <span class="hljs-variable">$person</span>.lastname:=<span class="hljs-string">"Smith"</span>    <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$person</span>.<span class="hljs-function">save</span>()<span class="hljs-keyword"> End if</span> ... ...<span class="hljs-keyword"> If</span>(<span class="hljs-variable">$error</span>)    <span class="hljs-variable">$ds</span>.<span class="hljs-function">cancelTransaction</span>()<span class="hljs-keyword"> Else</span>    <span class="hljs-variable">$ds</span>.<span class="hljs-function">validateTransaction</span>()<span class="hljs-keyword"> End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="DataStoreClass.html_stoprequestlog"></a><a aria-hidden="true"class="hash-link" href="#DataStoreClass.html_stoprequestlog"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.stopRequestLog()</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v17 R6</td><td>追加</td></tr></tbody></table></details><p><strong>.stopRequestLog()</strong><br />| 引数 | タイプ | | 説明 | | -- | --- | | ----------------- | | | | |このコマンドは引数を必要としません |</p><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E8%AA%AC%E6%98%8E-13"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E8%25AA%25AC%25E6%2598%258E-13"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.stopRequestLog()</code> 関数は、 クライアント側のORDAリクエストのログをすべて停止します (ファイル・メモリとも)。これは、開かれたドキュメントを実際に閉じてディスクに保存するため、ファイルにログを取っている場合にとくに有用です。</p><p>このメソッドはリモート側の 4D で呼び出す必要があり、それ以外の場合には何もしません。これはクライアント/サーバー環境でのデバッグを想定して設計されています。</p><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-10"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-10"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h4><p><a href="#DataStoreClass.html_startrequestlog"><code>.startRequestLog()</code></a>の例題を参照ください。</p><h2><a aria-hidden="true" class="anchor" id="DataStoreClass.html_validatetransaction"></a><a aria-hidden="true"class="hash-link" href="#DataStoreClass.html_validatetransaction"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.validateTransaction()</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v18</td><td>追加</td></tr></tbody></table></details><p><strong>.validateTransaction()</strong><br />| 引数 | タイプ | | 説明 | | -- | --- | | ----------------- | | | | |このコマンドは引数を必要としません |</p><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E8%AA%AC%E6%98%8E-14"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E8%25AA%25AC%25E6%2598%258E-14"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.validateTransaction()</code> 関数は、対象データストアの対応するレベルで<a href="#DataStoreClass.html_starttransaction"><code>.startTransaction()</code></a>で開始された トランザクションを受け入れます 。</p><p>この関数は、トランザクション中におこなわれたデータストア上のデータの変更を保存します。</p><p>複数のトランザクションをネストすること (サブトランザクション) が可能です。メイントランザクションがキャンセルされると、サブトランザクションも (たとえ個々にこの関数で承認されていても)すべてキャンセルされます。</p><h4><a aria-hidden="true" class="anchor" id="DataStoreClass.html_%E4%BE%8B%E9%A1%8C-11"></a><a aria-hidden="true" class="hash-link" href="#DataStoreClass.html_%25E4%25BE%258B%25E9%25A1%258C-11"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h4><p><a href="#DataStoreClass.html_starttransaction"><code>.startTransaction()</code></a>の例題を参照ください。</p><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#DataClassAttributeClass.html"><span class="arrow-prev">←</span><span class="function-name-prevnext">DataClassAttribute</span></a><a class="docs-next button" href="#EmailObjectClass.html"><span>Email</span><span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#DataStoreClass.html_ds">ds</a></li><li><a href="#DataStoreClass.html_open-datastore">Opendatastore</a></li><li><a href="#DataStoreClass.html_dataclassname"><em>.dataclassName</em></a></li><li><a href="#DataStoreClass.html_canceltransaction">.cancelTransaction()</a></li><li><a href="#DataStoreClass.html_encryptionstatus">.encryptionStatus()</a></li><li><a href="#DataStoreClass.html_getinfo">.getInfo()</a></li><li><a href="#DataStoreClass.html_getrequestlog">.getRequestLog()</a></li><li><a href="#DataStoreClass.html_isadminprotected">.isAdminProtected()</a></li><li><a href="#DataStoreClass.html_makeselectionsalterable">.makeSelectionsAlterable()</a></li><li><a href="#DataStoreClass.html_providedatakey">.provideDataKey()</a></li><li><a href="#DataStoreClass.html_setadminprotection">.setAdminProtection()</a></li><li><a href="#DataStoreClass.html_startrequestlog">.startRequestLog()</a></li><li><a href="#DataStoreClass.html_starttransaction">.startTransaction()</a></li><li><a href="#DataStoreClass.html_stoprequestlog">.stopRequestLog()</a></li><li><a href="#DataStoreClass.html_validatetransaction">.validateTransaction()</a></li></ul></nav></div></div></body></html>