<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="ja"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>変換タグ · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="4Dでは、参照を 4D変数や式に挿入したり、様々な処理をソーステキスト (&quot;テンプレート&quot;) に対して実行したりするための変換タグのセットを用意しています。 これらのタグは、ソーステキストが実行されてアウトプットテキストが生成されたときに解釈されます。"name="description" /><meta content="ja" name="docsearch:language" /><meta content="変換タグ · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="4Dでは、参照を 4D変数や式に挿入したり、様々な処理をソーステキスト (&quot;テンプレート&quot;) に対して実行したりするための変換タグのセットを用意しています。 これらのタグは、ソーステキストが実行されてアウトプットテキストが生成されたときに解釈されます。"property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#tags.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">変換タグ<a aria-hidden="true" class="anchor" id="tags.html"></a></h1></header><article><div><p><span>4Dでは、参照を 4D変数や式に挿入したり、様々な処理をソーステキスト ("テンプレート")に対して実行したりするための変換タグのセットを用意しています。これらのタグは、ソーステキストが実行されてアウトプットテキストが生成されたときに解釈されます。</span></p><p><span>4D Webサーバーにおいて <a href="#templates.html">Web テンプレートページ</a>をビルドするにあたって、この原理が使用されます。</span></p><p><span>これらのタグは原則として HTMLコメント (<code>&lt;--#TagContents--&gt;</code>) として挿入します。 しかしながら、 <a href="#tags.html_4dtext-4dhtml-4deval-%25E3%2581%25AE%25E4%25BB%25A3%25E6%259B%25BF%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9">xml に準じた代替シンタックス</a> も一部利用可能です。</span></p><p><span>複数タイプのタグを混用することも可能です。 たとえば、以下のHTML構造は、問題なく実行可能です:</span></p><pre><span><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">HTML</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BODY</span>&gt;</span><span class="hljs-comment">&lt;!--#4DSCRIPT/PRE_PROCESS--&gt;</span>   (メソッド呼び出し)<span class="hljs-comment">&lt;!--#4DIF (myvar=1)--&gt;</span>   (If 条件)   <span class="hljs-comment">&lt;!--#4DINCLUDE banner1.html--&gt;</span>   (サブページ挿入)<span class="hljs-comment">&lt;!--#4DENDIF--&gt;</span>   (End if)<span class="hljs-comment">&lt;!--#4DIF (mtvar=2)--&gt;</span>   <span class="hljs-comment">&lt;!--#4DINCLUDE banner2.html--&gt;</span><span class="hljs-comment">&lt;!--#4DENDIF--&gt;</span><span class="hljs-comment">&lt;!--#4DLOOP [TABLE]--&gt;</span>   (カレントセレクションでのループ)<span class="hljs-comment">&lt;!--#4DIF ([TABLE]ValNum&gt;10)--&gt;</span>   (If [TABLE]ValNum&gt;10)   <span class="hljs-comment">&lt;!--#4DINCLUDE subpage.html--&gt;</span>   (サブページの挿入)<span class="hljs-comment">&lt;!--#4DELSE--&gt;</span>   (Else)   <span class="hljs-tag">&lt;<span class="hljs-name">B</span>&gt;</span>Value: <span class="hljs-comment">&lt;!--#4DTEXT [TABLE]ValNum--&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">B</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span>   (フィールド表示)<span class="hljs-comment">&lt;!--#4DENDIF--&gt;</span><span class="hljs-comment">&lt;!--#4DENDLOOP--&gt;</span>   (End for)<span class="hljs-tag">&lt;/<span class="hljs-name">BODY</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">HTML</span>&gt;</span></code></span></pre><h2><a aria-hidden="true" class="anchor" id="tags.html_%E3%82%BF%E3%82%B0%E5%88%A9%E7%94%A8%E3%81%AE%E5%8E%9F%E5%89%87"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E3%2582%25BF%25E3%2582%25B0%25E5%2588%25A9%25E7%2594%25A8%25E3%2581%25AE%25E5%258E%259F%25E5%2589%2587"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>タグ利用の原則</h2><h3><a aria-hidden="true" class="anchor" id="tags.html_%E8%A7%A3%E6%9E%90"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E8%25A7%25A3%25E6%259E%2590"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>解析</h3><p><em>テンプレート</em> ソースの解析は、2つのコンテキストでおこなわれます:</p><ul><li><p><code>PROCESS 4D TAGS</code> コマンド使用時: このコマンドは <em>テンプレート</em>に加えて任意の引数を受け入れ、処理の結果であるテキストを返します。</p></li><li><p>4D の統合された HTTPサーバー使用時: <code>WEB SEND FILE</code> (.htm, .html,.shtm, .shtml)、<code>WEB SEND BLOB</code> (text/html型 BLOB)、および<code>WEB SEND TEXT</code> コマンドによって <a href="#templates.html">テンプレートページ</a> を送信、あるいは URL で呼び出します。 URLで呼び出す場合、".htm" と ".html" で終わるページは最適化のため解析されません。 この場合にHTMLページを解析させるには、終わりを ".shtm" または ".shtml" とする必要があります (例: <a href="http://www.server.com/dir/page.shtm">http://www.server.com/dir/page.shtm</a>)。</p></li></ul><h3><a aria-hidden="true" class="anchor" id="tags.html_%E5%86%8D%E8%B5%B7%E7%9A%84%E5%87%A6%E7%90%86"></a><a aria-hidden="true"class="hash-link" href="#tags.html_%25E5%2586%258D%25E8%25B5%25B7%25E7%259A%2584%25E5%2587%25A6%25E7%2590%2586"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>再起的処理</h3><p>4Dタグは繰り返し解釈されます。4Dは常に変換の結果を解釈しようとし、新しい変換が起きた際にはそれに伴う新しい解釈が実行され、取得結果の変換が必要がなくなるまで繰り返されます。たとえば、以下のようなステートメントがあった場合:</p><pre><code class="hljs css language-html"><span class="hljs-comment">&lt;!--#4DHTML [Mail]Letter_type--&gt;</span></code></pre><p>もし <code>[Mail]Letter_type</code> テキストフィールド自体にもタグ(たとえば<code>&lt;!--#4DSCRIPT/m_Gender--&gt;</code>) が含まれていた場合、このタグは4DHTMLタグの解釈の後に、それに伴って評価されます。</p><p>この強力な原則は、テキスト変換に関連するほとんどの需要を満たすことができます。しかしながら、Webコンテキストにおいて、これは場合によって悪意のあるコードの侵入を許す可能性があるという点に注意が必要です。これを防ぐ方法については<a href="#tags.html_%25E6%2582%25AA%25E6%2584%258F%25E3%2581%2582%25E3%2582%258B%25E3%2582%25B3%25E3%2583%25BC%25E3%2583%2589%25E3%2581%25AE%25E4%25BE%25B5%25E5%2585%25A5%25E3%2582%2592%25E9%2598%25B2%25E6%25AD%25A2">悪意あるコードの侵入を防止</a> を参照ください。</p><h3><a aria-hidden="true" class="anchor" id="tags.html_%E3%83%88%E3%83%BC%E3%82%AF%E3%83%B3%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E8%AD%98%E5%88%A5%E5%AD%90"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E3%2583%2588%25E3%2583%25BC%25E3%2582%25AF%25E3%2583%25B3%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2597%25E3%2581%259F%25E8%25AD%2598%25E5%2588%25A5%25E5%25AD%2590"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>トークンを使用した識別子</h3><p>4Dのバージョンや言語設定に左右されずに、タグ経由の式の評価が正しくおこなわれることを確実にするため、バージョン間で名前が変わりうる要素(コマンド、テーブル、フィールド、定数) については、トークンシンタックスを使用することが推奨されます。たとえば、<code>Current time</code> コマンドを挿入するには、"<code>Currenttime:C178</code>"と入力します。</p><h3><a aria-hidden="true" class="anchor" id="tags.html_-%E3%82%92%E5%B0%8F%E6%95%B0%E7%82%B9%E3%81%A8%E3%81%97%E3%81%A6%E4%BD%BF%E7%94%A8"></a><a aria-hidden="true" class="hash-link" href="#tags.html_-%25E3%2582%2592%25E5%25B0%258F%25E6%2595%25B0%25E7%2582%25B9%25E3%2581%25A8%25E3%2581%2597%25E3%2581%25A6%25E4%25BD%25BF%25E7%2594%25A8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>"." を小数点として使用</h3><p><code>4DTEXT</code>、<code>4DHTML</code>、および <code>4DEVAL</code>の 4Dタグで数値表現を評価する際、4D は常にピリオド文字 (.) を小数点として使用します。 リージョン設定は無視されます。この機能により、4Dの言語設定とバージョンが異なっていてもメンテナンスが容易となり互換性が保たれます。</p><h2><a aria-hidden="true" class="anchor" id="tags.html_4dbase"></a><a aria-hidden="true" class="hash-link"href="#tags.html_4dbase"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4DBASE</h2><h4><a aria-hidden="true" class="anchor" id="tags.html_%E3%82%B7%E3%83%B3%E3%82%BF%E3%83%83%E3%82%AF%E3%82%B9---4dbase-folderpath--"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9---4dbase-folderpath--"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>シンタックス: <code>&lt;!--#4DBASE folderPath--&gt;</code></h4><p><code>&lt;!--#4DBASE --&gt;</code> タグは<code>&lt;!--#4DINCLUDE--&gt;</code> タグで使用されるワーキングディレクトリを指定します。</p><p>Webページ内で呼び出されると、<code>&lt;!--#4DBASE --&gt;</code>タグは同ページ内であとに続くすべての <code>&lt;!--#4DINCLUDE--&gt;</code>呼び出しのディレクトリを変更します (次の <code>&lt;!--#4DBASE --&gt;</code> があるまで)。組み込まれたファイル内で <code>&lt;!--#4DBASE--&gt;</code>フォルダーが変更されると、親のファイルから元となる値を取得します。</p><p><em>folderPath</em> 引数には現在のページに対する相対パスを指定し、パスは "/"で終わっていなければなりません。 また、指定フォルダーは Webフォルダー内になければなりません。</p><p>"WEBFOLDER" キーワードを渡すと、(そのページに対して相対の) デフォルトパスに戻されます。</p><p>以下のように、各呼び出しごとに相対パスを指定したコードは:</p><pre><code class="hljs css language-html"><span class="hljs-comment">&lt;!--#4DINCLUDE subpage.html--&gt;</span> <span class="hljs-comment">&lt;!--#4DINCLUDE folder/subpage1.html--&gt;</span><span class="hljs-comment">&lt;!--#4DINCLUDE folder/subpage2.html--&gt;</span><span class="hljs-comment">&lt;!--#4DINCLUDE folder/subpage3.html--&gt;</span><span class="hljs-comment">&lt;!--#4DINCLUDE ../folder/subpage.html--&gt;</span></code></pre><p>以下のコードと同一です:</p><pre><code class="hljs css language-html"><span class="hljs-comment">&lt;!--#4DINCLUDE subpage.html--&gt;</span> <span class="hljs-comment">&lt;!--#4DBASE folder/--&gt;</span><span class="hljs-comment">&lt;!--#4DINCLUDE subpage1.html--&gt;</span><span class="hljs-comment">&lt;!--#4DINCLUDE subpage2.html--&gt;</span><span class="hljs-comment">&lt;!--#4DINCLUDE subpage3.html--&gt;</span><span class="hljs-comment">&lt;!--#4DBASE ../folder/--&gt;</span><span class="hljs-comment">&lt;!--#4DINCLUDE subpage.html--&gt;</span><span class="hljs-comment">&lt;!--#4DBASE WEBFOLDER--&gt;</span></code></pre><p>たとえば、ホームページのディレクトリを設定する場合:</p><pre><code class="hljs css language-html">/* Index.html */<span class="hljs-comment">&lt;!--#4DIF LangFR=True--&gt;</span>    <span class="hljs-comment">&lt;!--#4DBASE FR/--&gt;</span><span class="hljs-comment">&lt;!--#4DELSE--&gt;</span>    <span class="hljs-comment">&lt;!--#4DBASE US/--&gt;</span><span class="hljs-comment">&lt;!--#4DENDIF--&gt;</span><span class="hljs-comment">&lt;!--#4DINCLUDE head.html--&gt;</span><span class="hljs-comment">&lt;!--#4DINCLUDE body.html--&gt;</span><span class="hljs-comment">&lt;!--#4DINCLUDE footer.html--&gt;</span></code></pre><p>上で組み込まれる "head.html" ファイル内でカレントフォルダーが <code>&lt;!--#4DBASE--&gt;</code> を使用して変更されても、"index.html" 内では変更されません:</p><pre><code class="hljs css language-html">/* Head.htm *//* ここでのワーキングディレクトリはインクルードされるファイルに対して相対的 (FR/ または US/) */<span class="hljs-comment">&lt;!--#4DBASE Styles/--&gt;</span><span class="hljs-comment">&lt;!--#4DINCLUDE main.css--&gt;</span><span class="hljs-comment">&lt;!--#4DINCLUDE product.css--&gt;</span><span class="hljs-comment">&lt;!--#4DBASE Scripts/--&gt;</span><span class="hljs-comment">&lt;!--#4DINCLUDE main.js--&gt;</span><span class="hljs-comment">&lt;!--#4DINCLUDE product.js--&gt;</span></code></pre><h2><a aria-hidden="true" class="anchor" id="tags.html_4dcode"></a><a aria-hidden="true" class="hash-link"href="#tags.html_4dcode"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4DCODE</h2><h4><a aria-hidden="true" class="anchor" id="tags.html_%E3%82%B7%E3%83%B3%E3%82%BF%E3%83%83%E3%82%AF%E3%82%B9---4dcode-codelines--"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9---4dcode-codelines--"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>シンタックス: <code>&lt;!--#4DCODE codeLines--&gt;</code></h4><p><code>4DCODE</code> タグを使用すると、複数行の4Dコードのブロックをテンプレートに挿入できます。</p><p>"<code>&lt;!--#4DCODE</code>"シークエンスとそれに続くスペース、CRまたはLF文字が検知されると、4D は次の"<code>--&gt;</code>"シークエンスまでのコードを解釈します。コードブロック自体はキャリッジリターンもラインフィードも、あるいはその両方も含むことができ、4Dによってシーケンシャルに解釈されます。</p><p>たとえば、以下のようにテンプレートに書くことができます:</p><pre><code class="hljs css language-html"><span class="hljs-comment">&lt;!--#4DCODE// パラメーターの初期化C_OBJECT:C1216($graphParameters)OB SET:C1220($graphParameters;"graphType";1)$graphType:=1//...ここにコードを書きますIf(OB Is defined:C1231($graphParameters;"graphType"))    $graphType:=OB GET:C1224($graphParameters;"graphType")    If($graphType=7)        $nbSeries:=1        If($nbValues&gt;8)            DELETE FROM ARRAY:C228 ($yValuesArrPtr{1}-&gt;;9;100000)            $nbValues:=8        End if    End ifEnd if--&gt;</span></code></pre><p>4DCODE タグの機能は以下の通りです:</p><ul><li><code>TRACE</code> コマンドがサポートされています。これは4Dデバッガーを起動するので、テンプレートコードをデバッグすることができます。</li><li>エラーは標準のエラーダイアログを表示します。これを使って、ユーザーはコードの実行を中止したりデバッグモードに入ったりすることができます。</li><li><code>&lt;!--#4DCODE</code> と <code>--&gt;</code>の間のテキストは改行され、どのような改行コードでも受け取ります (cr、lf、または crlf)。</li><li>テキストは <code>PROCESS 4D TAGS</code>を呼び出したデータベースのコンテキストにてトークナイズされます。 これは、たとえばプロジェクトメソッドの認識等において重要です。<a href="#allowProject.html">公開オプション: 4DタグとURL(4DACTION...)</a>メソッドプロパティは考慮されません。</li><li>テキストが常にEnglish-US設定であったとしても、4Dのバージョン間においてコマンドや定数名が改名されることによる問題を避けるため、コマンド名や定数名はトークンシンタックスを使用することが推奨されいます。</li></ul><blockquote><p>4DCODE タグがあらゆる 4Dランゲージコマンドおよびプロジェクトメソッドを呼び出せるという事実は、とくにデータベースがHTTP経由で使用可能な場合等に、セキュリティ上の問題になり得ます。しかしながら、タグはサーバー側のコードをテンプレートファイルから実行するため、タグそのものはセキュリティ上の問題になりません。このようなコンテキストにおいては、あらゆるWebサーバーと同様に、セキュリティは主にサーバーファイルへのリモートアクセスレベルにおいて管理されています。</p></blockquote><h2><a aria-hidden="true" class="anchor" id="tags.html_4deach-%E3%81%A8-4dendeach"></a><a aria-hidden="true"class="hash-link" href="#tags.html_4deach-%25E3%2581%25A8-4dendeach"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4DEACH と 4DENDEACH</h2><h4><a aria-hidden="true" class="anchor" id="tags.html_%E3%82%B7%E3%83%B3%E3%82%BF%E3%83%83%E3%82%AF%E3%82%B9---4deach-variable-in-expression-----4dendeach--"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9---4deach-variable-in-expression-----4dendeach--"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>シンタックス: <code>&lt;!--#4DEACH variable inexpression--&gt;</code> <code>&lt;!--#4DENDEACH--&gt;</code></h4><p><code>&lt;!--#4DEACH--&gt;</code> コメントは、<em>expression</em>に含まれるすべての要素に対して処理を繰り返します。 各要素は <em>variable</em> に代入され、その型は<em>expression</em> の型に依存します。</p><p><code>&lt;!--#4DEACH--&gt;</code> コメントは 3種類の <em>expression</em>を対象に反復処理をおこなうことができます:</p><ul><li><a href="#tags.html_--4deach-item-in-collection--">コレクション</a>:コレクションの各要素をループします</li><li><a href="#tags.html_--4deach-entity-in-entityselection--">エンティティセレクション</a>:エンティティセレクションの各エンティティをループします</li><li><a href="#tags.html_--4deach-property-in-object--">オブジェクト</a>:オブジェクトの各プロパティをループします</li></ul><p>ループの数は開始時に評価され、処理中に変化することはありません。ループ中に項目を追加・削除することは、繰り返しの不足・重複を引き起こすことがあるため、一般的には推奨されません。</p><h3><a aria-hidden="true" class="anchor" id="tags.html_--4deach-item-in-collection--"></a><a aria-hidden="true"class="hash-link" href="#tags.html_--4deach-item-in-collection--"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a><code>&lt;!--#4DEACH item in collection--&gt;</code></h3><p>このシンタックスは、コレクションの各要素を対象に反復処理をおこないます。 <code>&lt;!--#4DEACH--&gt;</code> と <code>&lt;!--#4DENDEACH--&gt;</code>の間に書かれたコードが、各コレクション要素について繰り返されます。</p><p><em>item</em> はコレクション要素と同じ型の変数です。</p><p>コレクションの <strong>要素はすべて同じ型</strong>でなくてはなりません。そうでない場合には、<em>item</em> 変数に別の型の値が代入されたときにエラーが生成されます。</p><p>ループの回数はコレクションの要素数に基づいています。 各繰り返しにおいて、<em>item</em>変数には、コレクションの合致する要素が自動的に代入されます。 このとき、以下の点に注意する必要があります:</p><ul><li><em>item</em> 変数がオブジェクト型あるいはコレクション型であった場合 (つまり<em>expression</em>がオブジェクトのコレクション、あるいはコレクションのコレクションであった場合)、この変数を変更すると自動的にコレクションの対応する要素も変更されます(オブジェクトとコレクションは同じ参照を共有しているからです)。 変数がスカラー型である場合、変数のみが変更されます。</li><li><em>item</em> 変数には、コレクションの先頭要素の型が設定されます。コレクション要素のどれか一つでも、変数と異なる型のものがあった場合、エラーが生成され、ループは停止します。</li><li>コレクションが Null値の要素を格納していたとき、<em>item</em> 変数の型が Null値をサポートしない型(倍長整数変数など) であった場合にはエラーが生成されます。</li></ul><h4><a aria-hidden="true" class="anchor" id="tags.html_%E4%BE%8B%E9%A1%8C-%E3%82%B9%E3%82%AB%E3%83%A9%E3%83%BC%E5%80%A4%E3%81%AE%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E4%25BE%258B%25E9%25A1%258C-%25E3%2582%25B9%25E3%2582%25AB%25E3%2583%25A9%25E3%2583%25BC%25E5%2580%25A4%25E3%2581%25AE%25E3%2582%25B3%25E3%2583%25AC%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題: スカラー値のコレクション</h4><p><em>getNames</em> は文字列のコレクションを返すメソッドです。 このメソッドは <a href="#allowProject.html">公開オプション: 4DタグとURL</a> が有効になっています。</p><pre><code class="hljs css language-html">    <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"table"</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Name<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>          <span class="hljs-comment">&lt;!--#4DEACH $name in getNames--&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-comment">&lt;!--#4DTEXT $name--&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>          <span class="hljs-comment">&lt;!--#4DENDEACH--&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span></code></pre><h4><a aria-hidden="true" class="anchor" id="tags.html_%E4%BE%8B%E9%A1%8C-%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E4%25BE%258B%25E9%25A1%258C-%25E3%2582%25AA%25E3%2583%2596%25E3%2582%25B8%25E3%2582%25A7%25E3%2582%25AF%25E3%2583%2588%25E3%2581%25AE%25E3%2582%25B3%25E3%2583%25AC%25E3%2582%25AF%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題: オブジェクトのコレクション</h4><p><em>getSalesPersons</em> はオブジェクトのコレクションを返すメソッドです。</p><pre><code class="hljs css language-html">    <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"table"</span>&gt;</span>             <span class="hljs-comment">&lt;!--#4DCODE             $salePersons:=getSalesPersons          --&gt;</span>                 <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>ID<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Firstname<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Lastname<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>          <span class="hljs-comment">&lt;!--#4DEACH $salesPerson in $salePersons--&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-comment">&lt;!--#4DTEXT $salesPerson.ID--&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-comment">&lt;!--#4DTEXT $salesPerson.firstname--&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-comment">&lt;!--#4DTEXT $salesPerson.lastname--&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>          <span class="hljs-comment">&lt;!--#4DENDEACH--&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span></code></pre><h3><a aria-hidden="true" class="anchor" id="tags.html_--4deach-entity-in-entityselection--"></a><a aria-hidden="true"class="hash-link" href="#tags.html_--4deach-entity-in-entityselection--"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a><code>&lt;!--#4DEACH entity inentitySelection--&gt;</code></h3><p>このシンタックスは、エンティティセレクションの各エンティティを対象に反復処理をおこないます。<code>&lt;!--#4DEACH --&gt;</code> と<code>&lt;!--#4DENDEACH--&gt;</code>の間に書かれたコードが、エンティティセレクションの各エンティティについて繰り返されます。</p><p><em>entity</em> は Entityクラスのオブジェクト変数です。</p><p>ループの回数はエンティティセレクション内のエンティティの数に基づきます。 各繰り返しにおいて、<em>entity</em>オブジェクト変数には、エンティティセレクションの合致するエンティティが自動的に代入されます。</p><h4><a aria-hidden="true" class="anchor" id="tags.html_%E4%BE%8B%E9%A1%8C-html-%E3%81%AE%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E4%25BE%258B%25E9%25A1%258C-html-%25E3%2581%25AE%25E3%2583%2586%25E3%2583%25BC%25E3%2583%2596%25E3%2583%25AB"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題: html のテーブル</h4><pre><code class="hljs css language-html">    <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"table"</span>&gt;</span>             <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>ID<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Name<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Total purchase<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>          <span class="hljs-comment">&lt;!--#4DEACH $customer in ds.Customers.all()--&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-comment">&lt;!--#4DTEXT $customer.ID--&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-comment">&lt;!--#4DTEXT $customer.name--&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><span class="hljs-comment">&lt;!--#4DTEXT String($customer.totalPurchase;"$###,##0")--&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">center</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>          <span class="hljs-comment">&lt;!--#4DENDEACH--&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span></code></pre><h4><a aria-hidden="true" class="anchor" id="tags.html_%E4%BE%8B%E9%A1%8C-process-4d-tags"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E4%25BE%258B%25E9%25A1%258C-process-4d-tags"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題: <code>PROCESS 4D TAGS</code></h4><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> customers : cs.CustomersSelection<span class="hljs-keyword">var</span> <span class="hljs-variable">$input</span>; <span class="hljs-variable">$output </span>: Textcustomers:=ds.Customers.<span class="hljs-function">all</span>()<span class="hljs-variable">$input</span>:=<span class="hljs-string">"&lt;!--#4DEACH $cust in customers--&gt;"</span> <span class="hljs-variable">$input</span>:=<span class="hljs-variable">$input</span>+<span class="hljs-string">"&lt;!--#4DTEXT $cust.name --&gt;"</span>+<span class="hljs-function">Char</span>(Carriage return)<span class="hljs-variable">$input</span>:=<span class="hljs-variable">$input</span>+<span class="hljs-string">"&lt;!--#4DENDEACH--&gt;"</span> <span class="hljs-function">PROCESS 4D TAGS</span>(<span class="hljs-variable">$input</span>; <span class="hljs-variable">$output</span>)<span class="hljs-function">TEXT TO DOCUMENT</span>(<span class="hljs-string">"customers.txt"</span>; <span class="hljs-variable">$output</span>)</code></pre><h3><a aria-hidden="true" class="anchor" id="tags.html_--4deach-property-in-object--"></a><a aria-hidden="true"class="hash-link" href="#tags.html_--4deach-property-in-object--"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a><code>&lt;!--#4DEACH property in object--&gt;</code></h3><p>このシンタックスは、オブジェクトの各プロパティを対象に反復処理をおこないます。 <code>&lt;!--#4DEACH--&gt;</code> と <code>&lt;!--#4DENDEACH--&gt;</code>の間に書かれたコードが、各オブジェクトプロパティについて繰り返されます。</p><p><em>property</em> は現在処理中のプロパティ名が自動代入されたテキスト変数です。</p><p>オブジェクトのプロパティは作成順に処理されていきます。ループ中、プロパティをオブジェクトに追加/削除することが可能ですが、その場合でも残りのループ回数は、オブジェクトの元のプロパティ数に基づいているため、変化しません。</p><h4><a aria-hidden="true" class="anchor" id="tags.html_%E4%BE%8B%E9%A1%8C-%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E4%25BE%258B%25E9%25A1%258C-%25E3%2582%25AA%25E3%2583%2596%25E3%2582%25B8%25E3%2582%25A7%25E3%2582%25AF%25E3%2583%2588%25E3%2581%25AE%25E3%2583%2597%25E3%2583%25AD%25E3%2583%2591%25E3%2583%2586%25E3%2582%25A3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題: オブジェクトのプロパティ</h4><p><em>getGamers</em> は、ゲームスコアを管理するために ("Mary"; 10; "Ann"; 20;"John"; 40) のようなオブジェクトを返すプロジェクトメソッドです。</p><pre><code class="hljs css language-html">    <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"table"</span>&gt;</span>              <span class="hljs-comment">&lt;!--#4DCODE           $gamers:=getGamers          --&gt;</span>                  <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Gamers<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Scores<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>          <span class="hljs-comment">&lt;!--#4DEACH $key in $gamers--&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span> &gt;</span><span class="hljs-comment">&lt;!--#4DTEXT $key--&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span> &gt;</span><span class="hljs-comment">&lt;!--#4DTEXT $gamers[$key]--&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>          <span class="hljs-comment">&lt;!--#4DENDEACH--&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span></code></pre><h2><a aria-hidden="true" class="anchor" id="tags.html_4deval"></a><a aria-hidden="true" class="hash-link"href="#tags.html_4deval"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4DEVAL</h2><h4><a aria-hidden="true" class="anchor" id="tags.html_%E3%82%B7%E3%83%B3%E3%82%BF%E3%83%83%E3%82%AF%E3%82%B9---4deval-expression--"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9---4deval-expression--"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>シンタックス: <code>&lt;!--#4DEVAL expression--&gt;</code></h4><h4><a aria-hidden="true" class="anchor" id="tags.html_%E4%BB%A3%E6%9B%BF%E3%82%B7%E3%83%B3%E3%82%BF%E3%83%83%E3%82%AF%E3%82%B9-4devalexpression"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E4%25BB%25A3%25E6%259B%25BF%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9-4devalexpression"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>代替シンタックス: <code>$4DEVAL(expression)</code></h4><p><code>4DEVAL</code> タグを使用すると、4Dの変数や式を評価できます。 <a href="#tags.html_4dhtml"><code>4DHTML</code></a>タグのように、<code>4DEVAL</code> タグはテキストを返す際にHTML特殊文字をエスケープしません。しかしながら、<a href="#tags.html_4dhtml"><code>4DHTML</code></a> や<a href="#tags.html_4dtext"><code>4DTEXT</code></a>と異なり、<code>4DEVAL</code> は有効な 4D宣言であればどれでも実行することができます(値を返さない代入や式も含まれます)。</p><p>たとえば、以下の様なコードを実行することができます:</p><pre><code class="hljs"> $input:="<span class="hljs-comment">&lt;!--#4DEVAL a:=42--&gt;</span>" // 代入 $input:=$input+"<span class="hljs-comment">&lt;!--#4DEVAL a+1--&gt;</span>" // 計算 PROCESS 4D TAGS($input;$output)  // $output = "43"</code></pre><p>解釈エラーの場合、"<code>&lt;!--#4DEVAL expr--&gt;: ## エラー #エラーコード</code>" というテキストが挿入されます。</p><blockquote><p>セキュリティ上の理由から、<a href="#tags.html_%25E6%2582%25AA%25E6%2584%258F%25E3%2581%2582%25E3%2582%258B%25E3%2582%25B3%25E3%2583%25BC%25E3%2583%2589%25E3%2581%25AE%25E4%25BE%25B5%25E5%2585%25A5%25E3%2582%2592%25E9%2598%25B2%25E6%25AD%25A2">悪意あるコードの侵入・挿入</a>を防ぐために、アプリケーション外から導入されたデータを処理するときには<a href="#tags.html_4dtext"><code>4DTEXT</code></a>タグの使用が推奨されます。</p></blockquote><h2><a aria-hidden="true" class="anchor" id="tags.html_4dhtml"></a><a aria-hidden="true" class="hash-link"href="#tags.html_4dhtml"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4DHTML</h2><h4><a aria-hidden="true" class="anchor" id="tags.html_%E3%82%B7%E3%83%B3%E3%82%BF%E3%83%83%E3%82%AF%E3%82%B9---4dhtml-expression--"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9---4dhtml-expression--"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>シンタックス: <code>&lt;!--#4DHTML expression--&gt;</code></h4><h4><a aria-hidden="true" class="anchor" id="tags.html_%E4%BB%A3%E6%9B%BF%E3%82%B7%E3%83%B3%E3%82%BF%E3%83%83%E3%82%AF%E3%82%B9-4dhtmlexpression"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E4%25BB%25A3%25E6%259B%25BF%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9-4dhtmlexpression"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>代替シンタックス: <code>$4DHTML(expression)</code></h4><p><code>4DTEXT</code> タグ同様、このタグを使用すると、4Dの変数や値を返す式を HTML式として挿入できます。一方 <code>4DTEXT</code> タグとは異なり、このタグはHTML特殊文字(例:"&gt;")をエスケープしません。</p><p>たとえば、4Dタグを使用して 4Dのテキスト変数 myvar を処理した結果は以下の様になります:</p><table><thead><tr><th>myvar の値</th><th>タグ</th><th>戻り値</th></tr></thead><tbody><tr><td><code>myvar:="&lt;B&gt;"</code></td><td><code>&lt;!--#4DTEXT myvar--&gt;</code></td><td><code>&amp;lt;B&amp;gt;</code></td></tr><tr><td><code>myvar:="&lt;B&gt;"</code></td><td><code>&lt;!--#4DHTML myvar--&gt;</code></td><td><code>&lt;B&gt;</code></td></tr></tbody></table><p>解釈エラーの場合、"<code>&lt;!--#4DHTML myvar--&gt;: ## エラー #エラーコード</code>" というテキストが挿入されます。</p><blockquote><p>セキュリティ上の理由から、<a href="#tags.html_%25E6%2582%25AA%25E6%2584%258F%25E3%2581%2582%25E3%2582%258B%25E3%2582%25B3%25E3%2583%25BC%25E3%2583%2589%25E3%2581%25AE%25E4%25BE%25B5%25E5%2585%25A5%25E3%2582%2592%25E9%2598%25B2%25E6%25AD%25A2">悪意あるコードの侵入・挿入</a>を防ぐために、アプリケーション外から導入されたデータを処理するときには<a href="#tags.html_4dtext"><code>4DTEXT</code></a>タグの使用が推奨されます。</p></blockquote><h2><a aria-hidden="true" class="anchor" id="tags.html_4dif-4delse-4delseif-%E3%81%A8-4dendif"></a><a aria-hidden="true"class="hash-link" href="#tags.html_4dif-4delse-4delseif-%25E3%2581%25A8-4dendif"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4DIF, 4DELSE, 4DELSEIF と 4DENDIF</h2><h4><a aria-hidden="true" class="anchor" id="tags.html_%E3%82%B7%E3%83%B3%E3%82%BF%E3%83%83%E3%82%AF%E3%82%B9---4dif-expression-----4delseif-expression2----4delseif-expressionn-----4delse-----4dendif--"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9---4dif-expression-----4delseif-expression2----4delseif-expressionn-----4delse-----4dendif--"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>シンタックス: <code>&lt;!--#4DIF expression--&gt;</code>{<code>&lt;!--#4DELSEIF expression2--&gt;...&lt;!--#4DELSEIFexpressionN--&gt;</code>} {<code>&lt;!--#4DELSE--&gt;</code>}<code>&lt;!--#4DENDIF--&gt;</code></h4><p><code>&lt;!--#4DELSEIF--&gt;</code> (任意),<code>&lt;!--#4DELSE--&gt;</code> (任意) および<code>&lt;!--#4DENDIF--&gt;</code>コメントと共に使用することで、<code>&lt;!--#4DIF expression--&gt;</code>コメントはコードの一部に条件分岐を実行させることを可能にします。</p><p><em>expression</em> はブール値を返す有効な 4D式です。式は括弧の中に記述され、4Dのシンタックスルールに準拠していなければなりません。</p><p><code>&lt;!--#4DIF expression--&gt;</code> ...<code>&lt;!--#4DENDIF--&gt;</code> は複数レベルでネストできます。 4Dと同じく、それぞれの<code>&lt;!--#4DIF expression--&gt;</code> には対応する<code>&lt;!--#4DENDIF--&gt;</code> がなければなりません。</p><p>解釈エラーの場合、<code>&lt;!--#4DIF --&gt;</code> と<code>&lt;!--#4DENDIF--&gt;</code>の間のコンテンツの代わりに、"<code>&lt;!--#4DIF expression--&gt;</code>:ブール式が必要です" というテキストが挿入されます。 同様に、<code>&lt;!--#4DIF --&gt;</code>が同じ数の <code>&lt;!--#4DENDIF--&gt;</code>で閉じられていない場合、<code>&lt;!--#4DIF --&gt;</code> と<code>&lt;!--#4DENDIF--&gt;</code> の間のコンテンツの代わりに"<code>&lt;!--#4DIF expression--&gt;</code>: 4DENDIFが必要です"というテキストが挿入されます。</p><p><code>&lt;!--#4DELSEIF--&gt;</code> タグを使用すると、数に制限なく条件をテストできます。最初に <code>true</code> と判定されたブロック内にあるコードだけが実行されます。 <code>true</code>ブロックがなく、<code>&lt;!--#4DELSE--&gt;</code> もない場合には、なにも実行されません。<code>&lt;!--#4DELSE--&gt;</code>タグは、最後の<code>&lt;!--#4DELSEIF--&gt;</code> の後に記述できます。 それまでの条件がすべて<code>false</code>の場合、<code>&lt;!--#4DELSE--&gt;</code>ブロックの文が実行されます。</p><p>以下の2つのコードは同等です。</p><p><code>4DELSE</code> のみを使用する場合:</p><pre><code class="hljs css language-html"><span class="hljs-comment">&lt;!--#4DIF Condition1--&gt;</span>  /* Condition1 が true の場合*/<span class="hljs-comment">&lt;!--#4DELSE--&gt;</span>    <span class="hljs-comment">&lt;!--#4DIF Condition2--&gt;</span>        /* Condition2 が true の場合*/    <span class="hljs-comment">&lt;!--#4DELSE--&gt;</span>        <span class="hljs-comment">&lt;!--#4DIF Condition3--&gt;</span>            /* Condition3 が true の場合 */        <span class="hljs-comment">&lt;!--#4DELSE--&gt;</span>            /*いずれの条件も true でない場合*/        <span class="hljs-comment">&lt;!--#4DENDIF--&gt;</span>    <span class="hljs-comment">&lt;!--#4DENDIF--&gt;</span><span class="hljs-comment">&lt;!--#4DENDIF--&gt;</span></code></pre><p>同じ内容を <code>4DELSEIF</code> タグを使用して記述した場合:</p><pre><code class="hljs"><span class="hljs-comment">&lt;!--#4DIF Condition1--&gt;</span>     /* Condition1 が true の場合*/<span class="hljs-comment">&lt;!--#4DELSEIF Condition2--&gt;</span>     /* Condition2 が true の場合*/<span class="hljs-comment">&lt;!--#4DELSEIF Condition3--&gt;</span>    /* Condition3 が true の場合 */<span class="hljs-comment">&lt;!--#4DELSE--&gt;</span>    /* いずれの条件も true でない場合*/<span class="hljs-comment">&lt;!--#4DENDIF--&gt;</span></code></pre><p>スタティックな HTMLページに書かれたこの例題のコードは、<code>vname#""</code>式の結果に応じ、異なるラベルを表示します:</p><pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">BODY</span>&gt;</span>...<span class="hljs-comment">&lt;!--#4DIF (vname#"")--&gt;</span>Names starting with <span class="hljs-comment">&lt;!--#4DTEXT vname--&gt;</span>.<span class="hljs-comment">&lt;!--#4DELSE--&gt;</span>No name has been found.<span class="hljs-comment">&lt;!--#4DENDIF--&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">BODY</span>&gt;</span></code></pre><p>この例題は接続したユーザーによって異なるページを返します:</p><pre><code class="hljs css language-html"><span class="hljs-comment">&lt;!--#4DIF LoggedIn=False--&gt;</span>    <span class="hljs-comment">&lt;!--#4DINCLUDE Login.htm --&gt;</span><span class="hljs-comment">&lt;!--#4DELSEIF User="Admin" --&gt;</span>    <span class="hljs-comment">&lt;!--#4DINCLUDE AdminPanel.htm --&gt;</span><span class="hljs-comment">&lt;!--#4DELSEIF User="Manager" --&gt;</span>    <span class="hljs-comment">&lt;!--#4DINCLUDE SalesDashboard.htm --&gt;</span><span class="hljs-comment">&lt;!--#4DELSE--&gt;</span>    <span class="hljs-comment">&lt;!--#4DINCLUDE ItemList.htm --&gt;</span><span class="hljs-comment">&lt;!--#4DENDIF--&gt;</span></code></pre><h2><a aria-hidden="true" class="anchor" id="tags.html_4dinclude"></a><a aria-hidden="true" class="hash-link"href="#tags.html_4dinclude"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4DINCLUDE</h2><h4><a aria-hidden="true" class="anchor" id="tags.html_%E3%82%B7%E3%83%B3%E3%82%BF%E3%83%83%E3%82%AF%E3%82%B9---4dinclude-path--"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9---4dinclude-path--"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>シンタックス: <code>&lt;!--#4DINCLUDE path--&gt;</code></h4><p>このタグは主に、ある (<em>path</em> で指定された) HTMLページを別のHTMLページに含めるためにデザインされました。 デフォルトで、HTMLページのボディー部、つまり<code>&lt;body&gt;</code> と<code>&lt;/body&gt;</code>タグの間の内容だけが統合されます (bodyタグは含まれません)。これにより、ヘッダーに含まれるメタタグ関連の衝突が回避されます。</p><p>しかし、指定された HTMLページ中に <code>&lt;body&gt;</code><code>&lt;/body&gt;</code> タグがない場合、ページ全体が統合されます。この場合、メタタグの整合性を管理するのは開発者の役割です。</p><p><code>&lt;!--#4DINCLUDE --&gt;</code> コメントは、テスト(<code>&lt;!--#4DIF--&gt;</code>) やループ(<code>&lt;!--#4DLOOP--&gt;</code>) と使用するととても便利です。条件に基づきあるいはランダムにバナーなどを挿入する便利な方法です。このタグを使用してページをインクルードするとき、拡張子にかかわらず、4Dは呼び出されたページを解析してから、内容を<code>4DINCLUDE</code> 呼び出し元のページに挿入します。</p><p><code>&lt;!--#4DINCLUDE --&gt;</code>コメントで挿入されたページは、URLで呼ばれたページや <code>WEB SEND FILE</code>コマンドで送信されたページと同じように、Webサーバーキャッシュにロードされます。</p><p><em>path</em> には、挿入するドキュメントのパスを記述します。 警告: <code>4DINCLUDE</code>を呼び出す場合、パスは解析される親ドキュメントを起点とした相対パスです。 フォルダ区切り文字にはスラッシュ (/)を使用し、レベルをさかのぼるには 2つのドット (..) を使用します (HTMLシンタックス)。 <code>PROCESS 4DTAGS</code> コマンドで <code>4DINCLUDE</code>タグを使用する場合のデフォルトフォルダーはプロジェクトフォルダーです。</p><blockquote><p><code>4DINCLUDE</code> タグで使用されるデフォルトフォルダーは <a href="#tags.html_4dbase"><code>&lt;!--#4DBASE --&gt;</code></a>タグを使って変更できます。</p></blockquote><p>ページ内で使用できる <code>&lt;!--#4DINCLUDE path--&gt;</code> 数に制限はありません。しかし <code>&lt;!--#4DINCLUDE path--&gt;</code> の呼び出しは 1レベルのみ有効です。つまり、たとえば <em>mydoc1.html</em> ページに <code>&lt;!--#4DINCLUDEmydoc2.html--&gt;</code> によって挿入される <em>mydoc2.html</em>がある場合、そのボディ内でさらに <code>&lt;!--#4DINCLUDE mydoc3.html--&gt;</code>を使うことはできません。 さらに、4Dはインクルードが再帰的かどうかを確認します。</p><p>エラーの場合、"<code>&lt;!--#4DINCLUDE path--&gt;</code> :ドキュメントを開けません" というテキストが挿入されます。</p><p>例:</p><pre><code class="hljs css language-html"><span class="hljs-comment">&lt;!--#4DINCLUDE subpage.html--&gt;</span><span class="hljs-comment">&lt;!--#4DINCLUDE folder/subpage.html--&gt;</span><span class="hljs-comment">&lt;!--#4DINCLUDE ../folder/subpage.html--&gt;</span></code></pre><h2><a aria-hidden="true" class="anchor" id="tags.html_4dloop-%E3%81%A8-4dendloop"></a><a aria-hidden="true"class="hash-link" href="#tags.html_4dloop-%25E3%2581%25A8-4dendloop"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4DLOOP と 4DENDLOOP</h2><h4><a aria-hidden="true" class="anchor" id="tags.html_%E3%82%B7%E3%83%B3%E3%82%BF%E3%83%83%E3%82%AF%E3%82%B9---4dloop-condition-----4dendloop--"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9---4dloop-condition-----4dendloop--"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>シンタックス: <code>&lt;!--#4DLOOP condition--&gt;</code><code>&lt;!--#4DENDLOOP--&gt;</code></h4><p>このコメントを使用して、条件を満たす間、コードの一部を繰り返すことができます。 繰り返し部のコードは<code>&lt;!--#4DLOOP--&gt;</code> と<code>&lt;!--#4DENDLOOP--&gt;</code> で挟まれます。</p><p><code>&lt;!--#4DLOOP condition--&gt;</code> ...<code>&lt;!--#4DENDLOOP--&gt;</code> ブロックはネストできます。 4Dと同じく、それぞれの<code>&lt;!--#4DLOOP condition--&gt;</code> には対応する<code>&lt;!--#4DENDLOOP--&gt;</code> がなければなりません。</p><p>5種類の条件を使用できます:</p><h3><a aria-hidden="true" class="anchor" id="tags.html_--4dloop-table--"></a><a aria-hidden="true" class="hash-link" href="#tags.html_--4dloop-table--"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a><code>&lt;!--#4DLOOP [table]--&gt;</code></h3><p>このシンタックスは、カレントプロセスのカレントセレクションに基づき、指定したテーブルのレコード毎にループします。カレントセレクションレコード毎に、2つのコメントの間のコードは繰り返されます。</p><blockquote><p>テーブルを条件として <code>4DLOOP</code> タグが使用されると、レコードが "読み取り専用"モードでロードされます。</p></blockquote><p>以下のコードは:</p><pre><code class="hljs css language-html"><span class="hljs-comment">&lt;!--#4DLOOP [People]--&gt;</span><span class="hljs-comment">&lt;!--#4DTEXT [People]Name--&gt;</span> <span class="hljs-comment">&lt;!--#4DTEXT [People]Surname--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-comment">&lt;!--#4DENDLOOP--&gt;</span></code></pre><p>4Dランゲージで表すと以下のとおりです:</p><pre><code class="hljs css language-4d"><span class="hljs-function"> FIRST RECORD</span>([People])<span class="hljs-keyword"> While</span>(<span class="hljs-function">Not</span>(<span class="hljs-function">End selec tion</span>([People])))    ...<span class="hljs-function">    NEXT RECORD</span>([People])<span class="hljs-keyword"> End while</span></code></pre><h3><a aria-hidden="true" class="anchor" id="tags.html_--4dloop-array--"></a><a aria-hidden="true" class="hash-link" href="#tags.html_--4dloop-array--"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a><code>&lt;!--#4DLOOP array--&gt;</code></h3><p>このシンタックスは、配列項目ごとにループします。2つのコメントの間のコードが繰り返されるたびに、配列のカレント項目がインクリメントされます。</p><blockquote><p>このシンタックスで二次元配列を使用することはできません。この場合には、代わりにメソッドを条件としたループをネストして使用します。</p></blockquote><p>以下のコードは:</p><pre><code class="hljs css language-html"><span class="hljs-comment">&lt;!--#4DLOOP arr_names--&gt;</span><span class="hljs-comment">&lt;!--#4DTEXT arr_names{arr_names}--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span><span class="hljs-comment">&lt;!--#4DENDLOOP--&gt;</span></code></pre><p>4Dランゲージで表すと以下のとおりです:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> For</span>(<span class="hljs-variable">$Elem</span>;<span class="hljs-number">1</span>;<span class="hljs-function">Size of array</span>(arr_names))    arr_names:=<span class="hljs-variable">$Elem</span>    ...<span class="hljs-keyword"> End for</span></code></pre><h3><a aria-hidden="true" class="anchor" id="tags.html_--4dloop-method--"></a><a aria-hidden="true" class="hash-link" href="#tags.html_--4dloop-method--"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a><code>&lt;!--#4DLOOP method--&gt;</code></h3><p>このシンタックスでは、メソッドが <code>true</code> を返す間ループがおこなわれます。メソッドは、倍長整数タイプの引数を受け取ります。 まずメソッドは引数 0 を渡されます。これは (必要に応じて)初期化ステージとして使用できます。その後、<code>true</code> が返されるまで 1, 2, 3と渡される引数値がインクリメントされます。</p><p>セキュリティのため、Webプロセス内では、<code>On Web Authentication</code>データベースメソッドが初期化ステージ (引数に0が渡されて実行される) の前に一度呼び出されます。認証に成功すると、初期化に進みます。</p><p>コンパイルのため、<code>C_BOOLEAN($0)</code> と <code>C_LONGINT($1)</code>が必ず宣言されていなければなりません。</p><p>以下のコードは:</p><pre><code class="hljs css language-html"><span class="hljs-comment">&lt;!--#4DLOOP my_method--&gt;</span><span class="hljs-comment">&lt;!--#4DTEXT var--&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">BR</span>&gt;</span> <span class="hljs-comment">&lt;!--#4DENDLOOP--&gt;</span></code></pre><p>4Dランゲージで表すと以下のとおりです:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> If</span>(AuthenticationWebOK)<span class="hljs-keyword">    If</span>(<span class="hljs-function">my_method</span>(<span class="hljs-number">0</span>))       <span class="hljs-variable">$counter</span>:=<span class="hljs-number">1</span><span class="hljs-keyword">       While</span>(<span class="hljs-function">my_method</span>(<span class="hljs-variable">$counter</span>))          ...          <span class="hljs-variable">$counter</span>:=<span class="hljs-variable">$counter</span>+<span class="hljs-number">1</span><span class="hljs-keyword">       End while</span><span class="hljs-keyword">    End if</span><span class="hljs-keyword"> End if</span></code></pre><p><code>my_method</code> は以下のようになります:</p><pre><code class="hljs css language-4d"><span class="hljs-function"> C_LONGINT</span>(<span class="hljs-variable">$1</span>)<span class="hljs-function"> C_BOOLEAN</span>(<span class="hljs-variable">$0</span>)<span class="hljs-keyword"> If</span>(<span class="hljs-variable">$1</span>=<span class="hljs-number">0</span>) <span class="hljs-comment">`Initialisation</span>    <span class="hljs-variable">$0</span>:=<span class="hljs-literal">True</span><span class="hljs-keyword"> Else</span><span class="hljs-keyword">    If</span>(<span class="hljs-variable">$1</span>&lt;<span class="hljs-number">50</span>)       ...<span class="hljs-keyword">       var</span>:=...       <span class="hljs-variable">$0</span>:=<span class="hljs-literal">True</span><span class="hljs-keyword">    Else</span>       <span class="hljs-variable">$0</span>:=<span class="hljs-literal">False</span> <span class="hljs-comment">`Stops the loop</span><span class="hljs-keyword">    End if</span><span class="hljs-keyword"> End if</span></code></pre><h3><a aria-hidden="true" class="anchor" id="tags.html_--4dloop-expression--"></a><a aria-hidden="true" class="hash-link" href="#tags.html_--4dloop-expression--"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a><code>&lt;!--#4DLOOP expression--&gt;</code></h3><p>このシンタックスでは、<code>4DLOOP</code> タグは <em>expression</em> に指定した式が<code>true</code> を返す間ループがおこなわれます。式は有効なブール式であればよく、無限ループを防ぐために、ループごとに評価される変数部分を含んでいる必要があります。</p><p>たとえば、以下のコードは:</p><pre><code class="hljs css language-html"><span class="hljs-comment">&lt;!--#4DEVAL $i:=0--&gt;</span><span class="hljs-comment">&lt;!--#4DLOOP ($i&lt;4)--&gt;</span><span class="hljs-comment">&lt;!--#4DEVAL $i--&gt;</span><span class="hljs-comment">&lt;!--#4DEVAL $i:=$i+1--&gt;</span><span class="hljs-comment">&lt;!--#4DENDLOOP--&gt;</span></code></pre><p>以下の結果を生成します:</p><pre><code class="hljs"><span class="hljs-number">0</span><span class="hljs-number">1</span><span class="hljs-number">2</span><span class="hljs-number">3</span></code></pre><h3><a aria-hidden="true" class="anchor" id="tags.html_--4dloop-pointerarray--"></a><a aria-hidden="true"class="hash-link" href="#tags.html_--4dloop-pointerarray--"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a><code>&lt;!--#4DLOOP pointerArray--&gt;</code></h3><p>この場合、<code>4DLOOP</code> タグは配列のときと同じように振るまいます:ポインターによって参照された配列の要素ごとにループを繰り返します。カレントの配列要素は、コードが繰り返される度に増加していきます。</p><p>このシンタックスは <code>PROCESS 4D TAGS</code>コマンドに対して配列ポインターを渡した場合に有用です。</p><p>例:</p><pre><code class="hljs css language-4d"><span class="hljs-function"> ARRAY TEXT</span>(<span class="hljs-variable">$array</span>;<span class="hljs-number">2</span>) <span class="hljs-variable">$array{1}</span>:=<span class="hljs-string">"hello"</span> <span class="hljs-variable">$array{2}</span>:=<span class="hljs-string">"world"</span> <span class="hljs-variable">$input</span>:=<span class="hljs-string">"&lt;!--#4DEVAL $1--&gt;"</span> <span class="hljs-variable">$input</span>:=<span class="hljs-variable">$input</span>+<span class="hljs-string">"&lt;!--#4DLOOP $2--&gt;"</span> <span class="hljs-variable">$input</span>:=<span class="hljs-variable">$input</span>+<span class="hljs-string">"&lt;!--#4DEVAL $2-&gt;{$2-&gt;}--&gt; "</span> <span class="hljs-variable">$input</span>:=<span class="hljs-variable">$input</span>+<span class="hljs-string">"&lt;!--#4DENDLOOP--&gt;"</span><span class="hljs-function"> PROCESS 4D TAGS</span>(<span class="hljs-variable">$input</span>;<span class="hljs-variable">$output</span>;<span class="hljs-string">"elements = "</span>;-&gt;<span class="hljs-variable">$array</span>)  <span class="hljs-comment">// $output = "elements = hello world "</span></code></pre><p>解釈エラーの場合、<code>&lt;!--#4DLOOP --&gt;</code> と<code>&lt;!--#4DENDLOOP--&gt;</code> の間のコンテンツの代わりに"<code>&lt;!--#4DLOOP expression--&gt;</code>: エラーの説明”というテキストが挿入されます。</p><p>以下のメッセージが表示されます:</p><ul><li>予期しない式のタイプ (標準のエラー);</li><li>テーブル名が正しくありません (テーブル名のエラー);</li><li>配列が必要です (変数が配列でないか、二次元配列が指定された);</li><li>メソッドが存在しません;</li><li>シンタックスエラー (メソッド実行時);</li><li>アクセス権エラー (テーブルやメソッドにアクセスする権限がない);</li><li>4DENDLOOP が必要です (<code>&lt;!--#4DLOOP --&gt;</code> が対応する<code>&lt;!--#4DENDLOOP--&gt;</code> で閉じられていない)。</li></ul><h2><a aria-hidden="true" class="anchor" id="tags.html_4dscript"></a><a aria-hidden="true" class="hash-link"href="#tags.html_4dscript"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4DSCRIPT/</h2><h4><a aria-hidden="true" class="anchor" id="tags.html_%E3%82%B7%E3%83%B3%E3%82%BF%E3%83%83%E3%82%AF%E3%82%B9---4dscriptmethodnamemyparam--"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9---4dscriptmethodnamemyparam--"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>シンタックス:<code>&lt;!--#4DSCRIPT/MethodName/MyParam--&gt;</code></h4><p><code>4DSCRIPT</code> タグは、テンプレートを処理する際に 4Dメソッドを実行することを可能にします。<code>&lt;!--#4DSCRIPT/MyMethod/MyParam--&gt;</code> タグがHTMLコメントとしてページに現れると、<code>MyMethod</code> メソッドが <code>$1</code> に<code>Param</code> を受け取って実行されます。</p><blockquote><p>タグが Webプロセスのコンテキストにおいて呼び出された場合、Webページがロードされると、4Dは <code>On WebAuthentication</code> データベースメソッドを (存在すれば) 呼び出します。 このメソッドが<code>true</code> を返すと、4Dはメソッドを実行します。</p></blockquote><p>メソッドは <code>$0</code> にテキストを返す必要があります。 文字列が文字コード 1(つまり、<code>Char(1)</code> のこと) から始まっていると、それは HTMLソースとして扱われます(<code>4DHTML</code> と同じ原則)。</p><p>たとえば、次のコメントをテンプレートWebページに挿入したとしましょう:<code>"今日の日付は&lt;!--#4DSCRIPT/MYMETH/MYPARAM--&gt;"</code> 。ページをロードする際、4Dは <code>On Web Authentication</code> データベースメソッドを(存在すれば) 呼び出し、そして <code>MYMETH</code> メソッドの <code>$1</code> に文字列“/MYPARAM” を引数として渡して呼び出します。 メソッドは <code>$0</code> にテキストを返します (たとえば“21/12/31”)。<code>"今日の日付は&lt;!--#4DSCRIPT/MYMETH/MYPARAM--&gt;”</code> というコメントの結果は ”今日の日付は21/12/31” となります。</p><p><code>MYMETH</code> メソッドは以下のとおりです:</p><pre><code class="hljs css language-4d">  <span class="hljs-comment">//MYMETH</span><span class="hljs-function"> C_TEXT</span>(<span class="hljs-variable">$0</span>;<span class="hljs-variable">$1</span>) <span class="hljs-comment">// これらのパラメーターは常に宣言する必要があります</span> <span class="hljs-variable">$0</span>:=<span class="hljs-function">String</span>(Current date)</code></pre><blockquote><p><code>4DSCRIPT</code> から呼び出されるメソッドは、インタフェース要素(<code>DIALOG</code>, <code>ALERT</code> など) を呼び出してはいけません。</p></blockquote><p>4Dはメソッドを見つけた順に実行するため、ドキュメントの後の方で参照される変数の値を設定するメソッドを呼び出すことも可能です。モードは関係ありません。テンプレートには必要なだけ<code>&lt;!--#4DSCRIPT...--&gt;</code>コメントを記述できます。</p><h2><a aria-hidden="true" class="anchor" id="tags.html_4dtext"></a><a aria-hidden="true" class="hash-link"href="#tags.html_4dtext"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4DTEXT</h2><h4><a aria-hidden="true" class="anchor" id="tags.html_%E3%82%B7%E3%83%B3%E3%82%BF%E3%83%83%E3%82%AF%E3%82%B9---4dtext-expression--"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9---4dtext-expression--"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>シンタックス: <code>&lt;!--#4DTEXT expression--&gt;</code></h4><h4><a aria-hidden="true" class="anchor" id="tags.html_%E4%BB%A3%E6%9B%BF%E3%82%B7%E3%83%B3%E3%82%BF%E3%83%83%E3%82%AF%E3%82%B9-4dtextexpression"></a><a aria-hidden="true" class="hash-link" href="#tags.html_%25E4%25BB%25A3%25E6%259B%25BF%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9-4dtextexpression"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>代替シンタックス: <code>$4DTEXT(expression)</code></h4><p>タグ <code>&lt;!--#4DTEXT VarName--&gt;</code> を使用して4D変数や値を返す式への参照を挿入できます。 たとえば、(HTMLページ内にて) 以下のように記述すると:</p><pre><code class="hljs css language-html"><span class="hljs-tag">&lt;<span class="hljs-name">P</span>&gt;</span><span class="hljs-comment">&lt;!--#4DTEXT vtSiteName--&gt;</span> へようこそ！<span class="hljs-tag">&lt;/<span class="hljs-name">P</span>&gt;</span></code></pre><p>4D変数 <code>vtSiteName</code> の値が HTMLページに送信時に挿入されます。値はテキストとして挿入されます。"&gt;"のようなHTMLの特殊文字は、自動的にエスケープされます。</p><p>4DTEXT タグを使用して、4D式も挿入できます。 たとえば、フィールドの値を直接挿入できるほか(<code>&lt;!--#4DTEXT [tableName]fieldName--&gt;</code>)、配列要素の値も挿入できますし (<code>&lt;!--#4DTEXT tabarr{1}--&gt;</code>)、値を返すメソッドも使用できます (<code>&lt;!--#4DTEXT mymethod--&gt;</code>)。式の変換には、変数の場合と同じルールが適用されます。 さらに、式は 4Dのシンタックスルールに適合していなければなりません。</p><blockquote><p>セキュリティ上の理由から、<a href="#tags.html_%25E6%2582%25AA%25E6%2584%258F%25E3%2581%2582%25E3%2582%258B%25E3%2582%25B3%25E3%2583%25BC%25E3%2583%2589%25E3%2581%25AE%25E4%25BE%25B5%25E5%2585%25A5%25E3%2582%2592%25E9%2598%25B2%25E6%25AD%25A2">悪意あるコードの侵入・挿入</a>を防ぐために、アプリケーション外から導入されたデータを処理するときには、このタグの使用が推奨されます。</p></blockquote><p>解釈エラーの場合、"<code>&lt;!--#4DTEXT myvar--&gt; : ## エラー #エラーコード</code>" というテキストが挿入されます。</p><ul><li>プロセス変数を使用する必要があります。</li><li>ピクチャーフィールドの内容を表示できます。 しかし、ピクチャー配列の要素を表示することはできません。</li><li>4D式を使用して、オブジェクトフィールドの中身を表示させることができます。 たとえば、次の様に記述します:<code>&lt;!--#4DTEXT OBGet:C1224([Rect]Desc;\"color\")--&gt;</code>.</li><li>通常はテキスト変数を使用します。 しかし、BLOB変数を使用することもできます。この場合、長さ情報なしのテキストBLOBを使用します。</li></ul><h2><a aria-hidden="true" class="anchor" id="tags.html_4dtext-4dhtml-4deval-%E3%81%AE%E4%BB%A3%E6%9B%BF%E3%82%B7%E3%83%B3%E3%82%BF%E3%83%83%E3%82%AF%E3%82%B9"></a><a aria-hidden="true" class="hash-link" href="#tags.html_4dtext-4dhtml-4deval-%25E3%2581%25AE%25E4%25BB%25A3%25E6%259B%25BF%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4dtext, 4dhtml, 4deval の代替シンタックス</h2><p>いくつかの既存の 4D変換タグは、$-ベースのシンタックスを使用して表現することができます:</p><h4><a aria-hidden="true" class="anchor" id="tags.html_4dtag-expression"></a><a aria-hidden="true" class="hash-link" href="#tags.html_4dtag-expression"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>$4dtag (expression)</h4><p>という表記を次の代わりに使用することができます:</p><h4><a aria-hidden="true" class="anchor" id="tags.html_--4dtag-expression--"></a><a aria-hidden="true" class="hash-link" href="#tags.html_--4dtag-expression--"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a><code>&lt;!--#4dtag expression--&gt;</code></h4><p>この代替シンタックスは、処理後の値を返すタグにおいてのみ使用可能です:</p><ul><li><a href="#tags.html_4dtext">4DTEXT</a></li><li><a href="#tags.html_4dhtml">4DHTML</a></li><li><a href="#tags.html_4deval">4DEVAL</a></li></ul><p>(その他のタグ、たとえば 4DIF や 4DSCRIPT などでは、通常のシンタックスを使用しなければなりません)。</p><p>たとえば:</p><pre><code class="hljs css language-html">$4DEVAL(UserName)</code></pre><p>は次の代わりになります:</p><pre><code class="hljs css language-html"><span class="hljs-comment">&lt;!--#4DEVAL(UserName)--&gt;</span></code></pre><p>このシンタックスの主な利点は、XML準拠のテンプレートが書けることです。 一部の4Dデベロッパーは、XML準拠のテンプレートを標準の XMLパーサーツールで作成・評価する必要があります。 "&lt;" 文字はXML属性値としては無効なため、ドキュメントのシンタックスを破らずに4Dタグの "<code>&lt;!----&gt;</code>" シンタックスを使用することはできませんでした。 その一方で、"&lt;"文字をエスケープしてしまうと、4Dがタグを正常に解釈できなくなってしまいます。</p><p>たとえば、以下のコードは属性値の最初の "&lt;" 文字のために XMLパースエラーを引き起こします:</p><pre><code class="hljs css language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">line</span> <span class="hljs-attr">x1</span>=<span class="hljs-string">"&lt;!--#4DEVAL $x--&gt;"</span> <span class="hljs-attr">y1</span>=<span class="hljs-string">"&lt;!--#4DEVAL $graphY1--&gt;"</span>/&gt;</span></code></pre><p>$シンタックスを使用すると、パーサーによって以下のコードが評価されます:</p><pre><code class="hljs css language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">line</span> <span class="hljs-attr">x1</span>=<span class="hljs-string">"$4DEVAL($x)"</span> <span class="hljs-attr">y1</span>=<span class="hljs-string">"$4DEVAL($graphY1)"</span>/&gt;</span></code></pre><p>ここで、<code>$4dtag</code> と <code>&lt;--#4dtag--&gt;</code>は厳密には同じではないという点に注意が必要です。<code>&lt;--#4dtag--&gt;</code>とは異なり、<code>$4dtag</code> は 4Dタグを <a href="#tags.html_%25E5%2586%258D%25E8%25B5%25B7%25E7%259A%2584%25E5%2587%25A6%25E7%2590%2586">繰り返し解釈</a> することはありません。 <code>$</code>タグは常に一度だけ解釈され、その結果は標準テキストとして読まれます。</p><p>この違いの理由は、悪意あるコードの侵入を防ぐためにあります。 <a href="#tags.html_%25E6%2582%25AA%25E6%2584%258F%25E3%2581%2582%25E3%2582%258B%25E3%2582%25B3%25E3%2583%25BC%25E3%2583%2589%25E3%2581%25AE%25E4%25BE%25B5%25E5%2585%25A5%25E3%2582%2592%25E9%2598%25B2%25E6%25AD%25A2">悪意あるコードの侵入を防止</a>の章で説明されているように、ユーザーテキストを使用する場合に不要なタグの再解釈を避けるには、<code>4DHTML</code>タグではなく <code>4DTEXT</code> タグの使用が強く推奨されます。<code>4DTEXT</code>を使用した場合、"&lt;" などの特殊記号はエスケープされるため、<code>&lt;!--#4dtagexpression--&gt;</code> シンタックスを使用している 4Dタグはすべて元の意味を失います。しかしながら、<code>4DTEXT</code> は <code>$</code>記号をエスケープしないため、悪意あるコードの侵入を防ぐために <code>$4dtag (expression)</code>シンタックスにおける再帰的処理はサポートしないことになりました。</p><p>以下の例では、使用されるシンタックスとタグによる処理の結果の違いを表しています:</p><pre><code class="hljs css language-4d">  <span class="hljs-comment">// 例 1</span> myName:=<span class="hljs-string">"&lt;!--#4DHTML QUIT 4D--&gt;"</span> <span class="hljs-comment">// 悪意あるコードの侵入</span> input:=<span class="hljs-string">"My name is: &lt;!--#4DHTML myName--&gt;"</span><span class="hljs-function"> PROCESS 4D TAGS</span>(input;output)  <span class="hljs-comment">// 4D は終了していまいます</span></code></pre><pre><code class="hljs css language-4d">  <span class="hljs-comment">// 例 2</span> myName:=<span class="hljs-string">"&lt;!--#4DHTML QUIT 4D--&gt;"</span> <span class="hljs-comment">// 悪意あるコードの侵入</span> input:=<span class="hljs-string">"My name is: &lt;!--#4DTEXT myName--&gt;"</span><span class="hljs-function"> PROCESS 4D TAGS</span>(input;output)  <span class="hljs-comment">// 結果は "My name is: &lt;!--#4DHTML QUIT 4D--&gt;"</span></code></pre><pre><code class="hljs css language-4d">  <span class="hljs-comment">// 例 3</span> myName:=<span class="hljs-string">"$4DEVAL(QUIT 4D)"</span> <span class="hljs-comment">// 悪意あるコードの侵入</span> input:=<span class="hljs-string">"My name is: &lt;!--#4DTEXT myName--&gt;"</span><span class="hljs-function"> PROCESS 4D TAGS</span>(input;output)  <span class="hljs-comment">// 結果は "My name is: $4DEVAL(QUIT 4D)"</span></code></pre><p><code>$4dtag</code> シンタックスは、引用符や括弧の開閉ペアをサポートしているという点に注意してください。たとえば、以下の (非現実的な) 文字列を評価しなければならない場合:</p><pre><code class="hljs">String(<span class="hljs-number">1</span>) + <span class="hljs-string">"<span class="hljs-subst">\"</span>(hello)<span class="hljs-subst">\"</span>"</span></code></pre><p>以下のように書くことができます:</p><pre><code class="hljs css language-4d"> input:=<span class="hljs-string">"$4DEVAL( String(1)+\"\\\"(hello)\\\"\")"</span><span class="hljs-function"> PROCESS 4D TAGS</span>(input;output) --&gt; 結果は: <span class="hljs-number">1</span><span class="hljs-string">"(hello)"</span></code></pre></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#debugLogFiles.html"><span class="arrow-prev">←</span><span>ログファイルの詳細</span></a><a class="docs-next button" href="#overview.html"><span>概要</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#tags.html_%25E3%2582%25BF%25E3%2582%25B0%25E5%2588%25A9%25E7%2594%25A8%25E3%2581%25AE%25E5%258E%259F%25E5%2589%2587">タグ利用の原則</a><ul class="toc-headings"><li><a href="#tags.html_%25E8%25A7%25A3%25E6%259E%2590">解析</a></li><li><a href="#tags.html_%25E5%2586%258D%25E8%25B5%25B7%25E7%259A%2584%25E5%2587%25A6%25E7%2590%2586">再起的処理</a></li><li><a href="#tags.html_%25E3%2583%2588%25E3%2583%25BC%25E3%2582%25AF%25E3%2583%25B3%25E3%2582%2592%25E4%25BD%25BF%25E7%2594%25A8%25E3%2581%2597%25E3%2581%259F%25E8%25AD%2598%25E5%2588%25A5%25E5%25AD%2590">トークンを使用した識別子</a></li><li><a href="#tags.html_-%25E3%2582%2592%25E5%25B0%258F%25E6%2595%25B0%25E7%2582%25B9%25E3%2581%25A8%25E3%2581%2597%25E3%2581%25A6%25E4%25BD%25BF%25E7%2594%25A8">"." を小数点として使用</a></li></ul></li><li><a href="#tags.html_4dbase">4DBASE</a></li><li><a href="#tags.html_4dcode">4DCODE</a></li><li><a href="#tags.html_4deach-%25E3%2581%25A8-4dendeach">4DEACH と4DENDEACH</a><ul class="toc-headings"><li><a href="#tags.html_--4deach-item-in-collection--"><code>&lt;!--#4DEACHitem in collection--&gt;</code></a></li><li><a href="#tags.html_--4deach-entity-in-entityselection--"><code>&lt;!--#4DEACHentity in entitySelection--&gt;</code></a></li><li><a href="#tags.html_--4deach-property-in-object--"><code>&lt;!--#4DEACHproperty in object--&gt;</code></a></li></ul></li><li><a href="#tags.html_4deval">4DEVAL</a></li><li><a href="#tags.html_4dhtml">4DHTML</a></li><li><a href="#tags.html_4dif-4delse-4delseif-%25E3%2581%25A8-4dendif">4DIF,4DELSE, 4DELSEIF と 4DENDIF</a></li><li><a href="#tags.html_4dinclude">4DINCLUDE</a></li><li><a href="#tags.html_4dloop-%25E3%2581%25A8-4dendloop">4DLOOP と4DENDLOOP</a><ul class="toc-headings"><li><a href="#tags.html_--4dloop-table--"><code>&lt;!--#4DLOOP[table]--&gt;</code></a></li><li><a href="#tags.html_--4dloop-array--"><code>&lt;!--#4DLOOParray--&gt;</code></a></li><li><a href="#tags.html_--4dloop-method--"><code>&lt;!--#4DLOOPmethod--&gt;</code></a></li><li><a href="#tags.html_--4dloop-expression--"><code>&lt;!--#4DLOOPexpression--&gt;</code></a></li><li><a href="#tags.html_--4dloop-pointerarray--"><code>&lt;!--#4DLOOPpointerArray--&gt;</code></a></li></ul></li><li><a href="#tags.html_4dscript">4DSCRIPT/</a></li><li><a href="#tags.html_4dtext">4DTEXT</a></li><li><a href="#tags.html_4dtext-4dhtml-4deval-%25E3%2581%25AE%25E4%25BB%25A3%25E6%259B%25BF%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9">4dtext, 4dhtml, 4deval の代替シンタックス</a></li></ul></nav></div></div></body></html>