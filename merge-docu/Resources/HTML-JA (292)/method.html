<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="ja"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>$method · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="このパラメーターは、返されたエンティティまたはエンティティセレクションに対して実行する処理を指定するのに使います。" name="description" /><meta content="ja" name="docsearch:language" /><meta content="$method · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="このパラメーターは、返されたエンティティまたはエンティティセレクションに対して実行する処理を指定するのに使います。"property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#%24method.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">$method<a aria-hidden="true" class="anchor" id="method.html"></a></h1></header><article><div><p><span>このパラメーターは、返されたエンティティまたはエンティティセレクションに対して実行する処理を指定するのに使います。</span></p><h2><span><a aria-hidden="true" class="anchor" id="method.html_%E4%BD%BF%E7%94%A8%E5%8F%AF%E8%83%BD%E3%81%AA%E3%82%B7%E3%83%B3%E3%82%BF%E3%83%83%E3%82%AF%E3%82%B9"></a><a aria-hidden="true" class="hash-link" href="#method.html_%25E4%25BD%25BF%25E7%2594%25A8%25E5%258F%25AF%25E8%2583%25BD%25E3%2581%25AA%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>使用可能なシンタックス</span></h2><table><thead><tr><th>シンタックス</th><th>例題</th><th>説明</th></tr></thead><tbody><tr><td><a href="#method.html_methoddelete"><strong>$method=delete</strong></a></td><td><code>POST /Employee?$filter="ID=11"&amp;$method=delete</code></td><td>エンティティまたはエンティティセレクションを削除します</td></tr><tr><td><a href="#method.html_methodentityset"><strong>$method=entityset</strong></a></td><td><code>GET /People/?$filter="ID&gt;320"&amp;$method=entityset&amp; $timeout=600</code></td><td>RESTリクエストで定義されたエンティティのコレクションに基づいて、4D Serverのキャッシュにエンティティセットを作成します</td></tr><tr><td><a href="#method.html_methodrelease"><strong>$method=release</strong></a></td><td><code>GET/Employee/$entityset/&lt;entitySetID&gt;?$method=release</code></td><td>4D Server のキャッシュからエンティティセットを削除します</td></tr><tr><td><a href="#method.html_methodsubentityset"><strong>$method=subentityset</strong></a></td><td><code>GET /Company(1)/staff?$expand=staff&amp;$method=subentityset&amp; $subOrderby=lastName ASC</code></td><td>RESTリクエストで定義されたリレートエンティティのコレクションに基づいて、エンティティセットを作成します</td></tr><tr><td><a href="#method.html_methodupdate"><strong>$method=update</strong></a></td><td><code>POST /Person/?$method=update</code></td><td>一つ以上のエンティティを更新または作成します</td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="method.html_methoddelete"></a><a aria-hidden="true" class="hash-link" href="#method.html_methoddelete"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>$method=delete</span></h2><p><span>エンティティまたは (RESTで作成された) エンティティセレクションを削除します</span></p><h3><span><a aria-hidden="true" class="anchor" id="method.html_%E8%AA%AC%E6%98%8E"></a><a aria-hidden="true" class="hash-link" href="#method.html_%25E8%25AA%25AC%25E6%2598%258E"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</span></h3><p><span><code>$method=delete</code>を使ってエンティティ、またはエンティティセレクションを削除します。 たとえば、<a href="#filter.html"><code>$filter</code></a>を使って定義したエンティティセレクションや、<a href="#method.html_dataclasskey"><code>{dataClass}({key})</code></a><em>(例</em>: /Employee(22)) のように直接特定したエンティティが対象です。</span></p><p><span><a href="#method.html_entitysetentitysetid"><code>$entityset/{entitySetID}</code></a>のようにエンティティセットを呼び出して、そこに含まれるエンティティを削除することもできます。</span></p><h2><span><a aria-hidden="true" class="anchor" id="method.html_%E4%BE%8B%E9%A1%8C"></a><a aria-hidden="true" class="hash-link" href="#method.html_%25E4%25BE%258B%25E9%25A1%258C"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</span></h2><p><span>キーが 22であるエンティティを削除するには、次の RESTリクエストが書けます:</span></p><p><span><code>POST/rest/Employee(22)/?$method=delete</code></span></p><p><span><a href="#filter.html"><code>$filter</code></a>を使ったクエリも可能です:</span></p><p><span><code>POST/rest/Employee?$filter="ID=11"&amp;$method=delete</code></span></p><p><span><a href="#method.html_entitysetentitysetid"><code>$entityset/{entitySetID}</code></a>で呼び出したエンティティセットを削除する場合は次のように書きます:</span></p><p><span><code>POST/rest/Employee/$entityset/73F46BE3A0734EAA9A33CA8B14433570?$method=delete</code></span></p><p><span>レスポンス:</span></p><pre><span><code class="hljs">{    <span class="hljs-attr">"ok"</span>: <span class="hljs-literal">true</span>}</code></span></pre><h2><a aria-hidden="true" class="anchor" id="method.html_methodentityset"></a><a aria-hidden="true" class="hash-link" href="#method.html_methodentityset"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>$method=entityset</h2><p>RESTリクエストで定義されたエンティティのコレクションに基づいて、4D Serverのキャッシュにエンティティセットを作成します</p><h3><a aria-hidden="true" class="anchor" id="method.html_%E8%AA%AC%E6%98%8E-1"></a><a aria-hidden="true" class="hash-link" href="#method.html_%25E8%25AA%25AC%25E6%2598%258E-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h3><p>RESTでエンティティのコレクションを作成した場合、これをエンティティセットとして 4D Serverのキャッシュに保存することができます。 エンティティセットには参照番号が付与されます。これを<code>$entityset/{entitySetID}</code> に渡すと、当該エンティティセットにアクセスできます。デフォルトで、エンティティセットは 2時間有効です。$timeout に値 (秒単位) を渡すことで、有効時間を変更できます。</p><p>エンティティセットを作成する際に、<code>$filter</code> や <code>$orderby</code>と同時に<code>$savedfilter</code> や <code>$savedorderby</code>も使用していた場合には、4D Serverのキャッシュからエンティティセットが削除されていても、同じ参照IDで再作成できます。</p><h3><a aria-hidden="true" class="anchor" id="method.html_%E4%BE%8B%E9%A1%8C-1"></a><a aria-hidden="true" class="hash-link" href="#method.html_%25E4%25BE%258B%25E9%25A1%258C-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h3><p>4D Server のキャッシュに2時間保存されるエンティティセットを作成するには、RESTリクエストの最後に<code>$method=entityset</code> を追加します:</p><p><code>GET/rest/People/?$filter="ID&gt;320"&amp;$method=entityset</code></p><p>保存時間が 10分のエンティティセットを作成するには、次のように <code>$timeout</code>に値を渡します:</p><p><code>GET/rest/People/?$filter="ID&gt;320"&amp;$method=entityset&amp;$timeout=600</code></p><p>フィルターや並べ替えの情報を保存するには、<code>$savedfilter</code> や<code>$savedorderby</code> に true を渡します。</p><blockquote><p>エンティティセットを作成する際には、<code>$skip</code> および<code>$top/$limit</code> は無視されます。</p></blockquote><p>エンティティセットを作成すると、返されるオブジェクトの先頭に <code>__ENTITYSET</code>という要素が追加され、エンティティセットにアクセスするための URI を提供します:</p><p><code>__ENTITYSET:"http://127.0.0.1:8081/rest/Employee/$entityset/9718A30BF61343C796345F3BE5B01CE7"</code></p><h2><a aria-hidden="true" class="anchor" id="method.html_methodrelease"></a><a aria-hidden="true" class="hash-link" href="#method.html_methodrelease"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>$method=release</h2><p>4D Server のキャッシュからエンティティセットを削除します。</p><h3><a aria-hidden="true" class="anchor" id="method.html_%E8%AA%AC%E6%98%8E-2"></a><a aria-hidden="true" class="hash-link" href="#method.html_%25E8%25AA%25AC%25E6%2598%258E-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h3><p><a href="#method.html_methodentityset"><code>$method=entityset</code></a>によって作成したエンティティセットを、4D Server のキャッシュから削除することができます。</p><h3><a aria-hidden="true" class="anchor" id="method.html_%E4%BE%8B%E9%A1%8C-2"></a><a aria-hidden="true" class="hash-link" href="#method.html_%25E4%25BE%258B%25E9%25A1%258C-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h3><p>既存のエンティティセットを削除します:</p><p><code>GET/rest/Employee/$entityset/4C51204DD8184B65AC7D79F09A077F24?$method=release</code></p><h4><a aria-hidden="true" class="anchor" id="method.html_%E3%83%AC%E3%82%B9%E3%83%9D%E3%83%B3%E3%82%B9"></a><a aria-hidden="true"class="hash-link" href="#method.html_%25E3%2583%25AC%25E3%2582%25B9%25E3%2583%259D%25E3%2583%25B3%25E3%2582%25B9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>レスポンス:</h4><p>リクエストが成功した場合のレスポンス:</p><pre><code class="hljs">{    <span class="hljs-string">"ok"</span>: <span class="hljs-literal">true</span>}エンティティセットが見つからなかった場合には、エラーが返されます{    <span class="hljs-string">"__ERROR"</span>: [        {             <span class="hljs-string">"message"</span>: <span class="hljs-string">"Error code: 1802\nEntitySet  \"</span><span class="hljs-number">4</span>C51204DD8184B65AC7D79F09A077F24\<span class="hljs-string">" cannot be found\ncomponent:  'dbmg'\ntask 22, name: 'HTTP connection handler'\n"</span>,            <span class="hljs-string">"componentSignature"</span>: <span class="hljs-string">"dbmg"</span>,            <span class="hljs-string">"errCode"</span>: <span class="hljs-number">1802</span>        }    ]}</code></pre><h2><a aria-hidden="true" class="anchor" id="method.html_methodsubentityset"></a><a aria-hidden="true" class="hash-link" href="#method.html_methodsubentityset"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>$method=subentityset</h2><p>RESTリクエストで定義されたリレートエンティティのコレクションに基づいて、4D Serverのキャッシュにエンティティセットを作成します</p><h3><a aria-hidden="true" class="anchor" id="method.html_%E8%AA%AC%E6%98%8E-3"></a><a aria-hidden="true" class="hash-link" href="#method.html_%25E8%25AA%25AC%25E6%2598%258E-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h3><p><code>$method=subentityset</code>を使うことで、RESTリクエストが定義されたリレーション属性によって返されるデータを並べ替えることができます。</p><p>データを並べ替えるには <code>$subOrderby</code> を使います。並べ替えの基準とする各属性について、並べ替え順を指定します。ASC ( asc) が昇順、DESC (desc) が降順です。デフォルトでは、データは昇順に並べ替えられます。</p><p>複数の属性を指定するには、カンマ区切りにします (<code>例</code>: $subOrderby="lastNamedesc, firstName asc")。</p><h3><a aria-hidden="true" class="anchor" id="method.html_%E4%BE%8B%E9%A1%8C-3"></a><a aria-hidden="true" class="hash-link" href="#method.html_%25E4%25BE%258B%25E9%25A1%258C-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h3><p>あるエンティティのリレートエンティティだけを取得したいとき、たとえば Company データクラスの staffリレーション名が Employee データクラスにリンクしている場合には、次の RESTリクエストが書けます:</p><p><code>GET/rest/Company(1)/staff?$expand=staff&amp;$method=subentityset&amp;$subOrderby=lastNameASC</code></p><h4><a aria-hidden="true" class="anchor" id="method.html_%E3%83%AC%E3%82%B9%E3%83%9D%E3%83%B3%E3%82%B9-1"></a><a aria-hidden="true"class="hash-link" href="#method.html_%25E3%2583%25AC%25E3%2582%25B9%25E3%2583%259D%25E3%2583%25B3%25E3%2582%25B9-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>レスポンス:</h4><pre><code class="hljs">{    <span class="hljs-attr">"__ENTITYSET"</span>: <span class="hljs-string">"/rest/Employee/$entityset/FF625844008E430B9862E5FD41C741AB"</span>,    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"Employee"</span>,    <span class="hljs-attr">"__COUNT"</span>: <span class="hljs-number">2</span>,    <span class="hljs-attr">"__SENT"</span>: <span class="hljs-number">2</span>,    <span class="hljs-attr">"__FIRST"</span>: <span class="hljs-number">0</span>,    <span class="hljs-attr">"__ENTITIES"</span>: [        {            <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"4"</span>,            <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">1</span>,            <span class="hljs-attr">"ID"</span>: <span class="hljs-number">4</span>,            <span class="hljs-attr">"firstName"</span>: <span class="hljs-string">"Linda"</span>,            <span class="hljs-attr">"lastName"</span>: <span class="hljs-string">"Jones"</span>,            <span class="hljs-attr">"birthday"</span>: <span class="hljs-string">"1970-10-05T14:23:00Z"</span>,            <span class="hljs-attr">"employer"</span>: {                <span class="hljs-attr">"__deferred"</span>: {                    <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"/rest/Company(1)"</span>,                    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"1"</span>                }            }        },        {            <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"1"</span>,            <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">3</span>,            <span class="hljs-attr">"ID"</span>: <span class="hljs-number">1</span>,            <span class="hljs-attr">"firstName"</span>: <span class="hljs-string">"John"</span>,            <span class="hljs-attr">"lastName"</span>: <span class="hljs-string">"Smith"</span>,            <span class="hljs-attr">"birthday"</span>: <span class="hljs-string">"1985-11-01T15:23:00Z"</span>,            <span class="hljs-attr">"employer"</span>: {                <span class="hljs-attr">"__deferred"</span>: {                    <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"/rest/Company(1)"</span>,                    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"1"</span>                }            }        }    ]}</code></pre><h2><a aria-hidden="true" class="anchor" id="method.html_methodupdate"></a><a aria-hidden="true" class="hash-link" href="#method.html_methodupdate"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>$method=update</h2><p>一つ以上のエンティティを更新または作成します</p><h3><a aria-hidden="true" class="anchor" id="method.html_%E8%AA%AC%E6%98%8E-4"></a><a aria-hidden="true" class="hash-link" href="#method.html_%25E8%25AA%25AC%25E6%2598%258E-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h3><p><code>$method=update</code> を使うと、一つの <strong>POST</strong>で一つ以上のエンティティを更新または作成することができます。エンティティの更新・作成をおこなうには、オブジェクトのプロパティ/値としてエンティティの属性/値を指定します (<em>例</em>:<code>{ lastName: "Smith" }</code>)。複数のエンティティを更新・作成するには、各エンティティに対応するオブジェクトをコレクションにまとめます。</p><p>いずれの場合も、リクエストのボディ (<strong>body</strong>) に<strong>POST</strong> データ <strong>body</strong> を格納します。</p><p>エンティティを更新するには、更新する属性だけでなく、<code>__KEY</code> および<code>__STAMP</code> パラメーターをオブジェクト内に指定しなくてはなりません。これらのパラメーターがない場合、<strong>POST</strong>のボディに格納したオブジェクトの値をもとに新規エンティティが追加されます。</p><p>エンティティをサーバーに保存すると同時にトリガーが実行されます。レスポンスにはすべてのデータが、サーバー上に存在するとおりに格納されます。</p><p><code>$atomic/$atonce</code>を使うと、エンティティを作成・更新するリクエストをトランザクション内で実行できます。データの検証でエラーが発生した場合に、一部のエンティティだけが処理されてしまうのを防げます。また、<code>$method=validate</code>を使うと、作成・更新の前にエンティティを検証することができます。</p><p>エンティティを追加または更新する際に問題が発生すると、その情報を格納したエラーが返されます。</p><blockquote><p>属性の型に関する注記:</p><ul><li><strong>日付</strong> は JavaScript 形式で表す必要があります:YYYY-MM-DDTHH:MM:SSZ (例: "2010-10-05T23:00:00Z")。日付属性のためだけに日付プロパティを指定した場合、タイムゾーンおよび時刻 (時間・分・秒) の情報は削除されます。この場合、レスポンスの形式 dd!mm!yyyy (例: 05!10!2013) を使って日付を送信することも可能です。</li><li><strong>ブール</strong> は true または false です。</li><li><code>$upload</code> を使ってアップロードしたファイルは、{ "ID":"D507BC03E613487E9B4C2F6A0512FE50"}のような形式で返されるオブジェクトを渡すことで、ピクチャー型やBLOB型の属性に適用できます。</li></ul></blockquote><h3><a aria-hidden="true" class="anchor" id="method.html_%E4%BE%8B%E9%A1%8C-4"></a><a aria-hidden="true" class="hash-link" href="#method.html_%25E4%25BE%258B%25E9%25A1%258C-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h3><p>特定のエンティティを更新するには、次のようなリクエストをします:</p><p><code>POST /rest/Person/?$method=update</code></p><p><strong>POST データ:</strong></p><pre><code class="hljs">{    <span class="hljs-attribute">__KEY</span>: <span class="hljs-string">"340"</span>,    __STAMP: <span class="hljs-number">2</span>,    firstName: <span class="hljs-string">"Pete"</span>,    lastName: <span class="hljs-string">"Miller"</span>}</code></pre><p>この場合、渡した firstName および lastName 属性だけが変更され、当該エンティティのその他の属性はそのままです(変更した属性に基づいて計算される属性を除く)。</p><p>エンティティを作成するには、次のように書きます:</p><p><code>POST /rest/Person/?$method=update</code></p><p><strong>POST データ:</strong></p><pre><code class="hljs">{     <span class="hljs-attribute">firstName</span>: <span class="hljs-string">"John"</span>,    lastName: <span class="hljs-string">"Smith"</span>}</code></pre><p>同じ URL を使って、複数のエンティティを作成・更新することもできます。その場合には、POSTデータに複数オブジェクトのコレクションを渡します:</p><p><code>POST /rest/Person/?$method=update</code></p><p><strong>POST データ:</strong></p><pre><code class="hljs">[{     <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"309"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">5</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-string">"309"</span>,    <span class="hljs-attr">"firstName"</span>: <span class="hljs-string">"Penelope"</span>,    <span class="hljs-attr">"lastName"</span>: <span class="hljs-string">"Miller"</span>}, {     <span class="hljs-attr">"firstName"</span>: <span class="hljs-string">"Ann"</span>,    <span class="hljs-attr">"lastName"</span>: <span class="hljs-string">"Jones"</span>}]</code></pre><p><strong>レスポンス:</strong></p><p>エンティティを追加・更新した場合、そのエンティティは変更後の内容で返されます。 たとえば、新規の Employeeエンティティを作成した場合、次のようなレスポンスが返されます:</p><pre><code class="hljs">{    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"622"</span>,     <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">1</span>,     <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"http://127.0.0.1:8081/rest/Employee(622)"</span>,     <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"!!2020-04-03!!"</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">622</span>,     <span class="hljs-attr">"firstName"</span>: <span class="hljs-string">"John"</span>,     <span class="hljs-attr">"firstName"</span>: <span class="hljs-string">"Smith"</span>}</code></pre><p>スタンプが正しくない場合には、次のようなエラーが返されます:</p><pre><code class="hljs">{    <span class="hljs-attr">"__STATUS"</span>: {        <span class="hljs-attr">"status"</span>: <span class="hljs-number">2</span>,        <span class="hljs-attr">"statusText"</span>: <span class="hljs-string">"Stamp has changed"</span>,        <span class="hljs-attr">"success"</span>: <span class="hljs-literal">false</span>    },    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"1"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">12</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"!!2020-03-31!!"</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"firstname"</span>: <span class="hljs-string">"Denise"</span>,    <span class="hljs-attr">"lastname"</span>: <span class="hljs-string">"O'Peters"</span>,    <span class="hljs-attr">"isWoman"</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">"numberOfKids"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"addressID"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"gender"</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">"imageAtt"</span>: {        <span class="hljs-attr">"__deferred"</span>: {            <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"/rest/Persons(1)/imageAtt?$imageformat=best&amp;$version=12&amp;$expand=imageAtt"</span>,            <span class="hljs-attr">"image"</span>: <span class="hljs-literal">true</span>        }    },    <span class="hljs-attr">"extra"</span>: {        <span class="hljs-attr">"num"</span>: <span class="hljs-number">1</span>,        <span class="hljs-attr">"alpha"</span>: <span class="hljs-string">"I am 1"</span>    },    <span class="hljs-attr">"address"</span>: {        <span class="hljs-attr">"__deferred"</span>: {            <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"/rest/Address(1)"</span>,            <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"1"</span>        }    },    <span class="hljs-attr">"__ERROR"</span>: [        {            <span class="hljs-attr">"message"</span>: <span class="hljs-string">"Given stamp does not match current one for record# 0 of table Persons"</span>,            <span class="hljs-attr">"componentSignature"</span>: <span class="hljs-string">"dbmg"</span>,            <span class="hljs-attr">"errCode"</span>: <span class="hljs-number">1263</span>        },        {            <span class="hljs-attr">"message"</span>: <span class="hljs-string">"Cannot save record 0 in table Persons of database remote_dataStore"</span>,            <span class="hljs-attr">"componentSignature"</span>: <span class="hljs-string">"dbmg"</span>,            <span class="hljs-attr">"errCode"</span>: <span class="hljs-number">1046</span>        },        {            <span class="hljs-attr">"message"</span>: <span class="hljs-string">"The entity# 1 in the \"Persons\" dataclass cannot be saved"</span>,            <span class="hljs-attr">"componentSignature"</span>: <span class="hljs-string">"dbmg"</span>,            <span class="hljs-attr">"errCode"</span>: <span class="hljs-number">1517</span>        }    ]}{}</code></pre></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#lock.html"><span class="arrow-prev">←</span><span>$lock</span></a><a class="docs-next button" href="#orderby.html"><span>$orderby</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#method.html_%25E4%25BD%25BF%25E7%2594%25A8%25E5%258F%25AF%25E8%2583%25BD%25E3%2581%25AA%25E3%2582%25B7%25E3%2583%25B3%25E3%2582%25BF%25E3%2583%2583%25E3%2582%25AF%25E3%2582%25B9">使用可能なシンタックス</a></li><li><a href="#method.html_methoddelete">$method=delete</a><ul class="toc-headings"><li><a href="#method.html_%25E8%25AA%25AC%25E6%2598%258E">説明</a></li></ul></li><li><a href="#method.html_%25E4%25BE%258B%25E9%25A1%258C">例題</a></li><li><a href="#method.html_methodentityset">$method=entityset</a><ul class="toc-headings"><li><a href="#method.html_%25E8%25AA%25AC%25E6%2598%258E-1">説明</a></li><li><a href="#method.html_%25E4%25BE%258B%25E9%25A1%258C-1">例題</a></li></ul></li><li><a href="#method.html_methodrelease">$method=release</a><ul class="toc-headings"><li><a href="#method.html_%25E8%25AA%25AC%25E6%2598%258E-2">説明</a></li><li><a href="#method.html_%25E4%25BE%258B%25E9%25A1%258C-2">例題</a></li></ul></li><li><a href="#method.html_methodsubentityset">$method=subentityset</a><ul class="toc-headings"><li><a href="#method.html_%25E8%25AA%25AC%25E6%2598%258E-3">説明</a></li><li><a href="#method.html_%25E4%25BE%258B%25E9%25A1%258C-3">例題</a></li></ul></li><li><a href="#method.html_methodupdate">$method=update</a><ul class="toc-headings"><li><a href="#method.html_%25E8%25AA%25AC%25E6%2598%258E-4">説明</a></li><li><a href="#method.html_%25E4%25BE%258B%25E9%25A1%258C-4">例題</a></li></ul></li></ul></nav></div></div></body></html>