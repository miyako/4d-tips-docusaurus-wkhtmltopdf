<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="ja"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>ZIPArchive · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="4D ZIP アーカイブは、一つ以上のファイルまたはフォルダーを格納している `File` または `Folder` オブジェクトで、元のサイズより小さくなるように圧縮されているものをいいます。 これらのアーカイブは &quot;.zip&quot; 拡張子を持つように作成され、ディスクスペースの確保や、サイズ制限があるメディア (例: メールまたはネットワークなど) 経由のファイル転送を容易にする用途に使用できます。"name="description" /><meta content="ja" name="docsearch:language" /><meta content="ZIPArchive · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="4D ZIP アーカイブは、一つ以上のファイルまたはフォルダーを格納している `File` または `Folder` オブジェクトで、元のサイズより小さくなるように圧縮されているものをいいます。 これらのアーカイブは &quot;.zip&quot; 拡張子を持つように作成され、ディスクスペースの確保や、サイズ制限があるメディア (例: メールまたはネットワークなど) 経由のファイル転送を容易にする用途に使用できます。"property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#ZipArchiveClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">ZIPArchive<a aria-hidden="true" class="anchor" id="ZipArchiveClass.html"></a></h1></header><article><div><p><span>4D ZIP アーカイブは、一つ以上のファイルまたはフォルダーを格納している <code>File</code>または <code>Folder</code> オブジェクトで、元のサイズより小さくなるように圧縮されているものをいいます。これらのアーカイブは ".zip" 拡張子を持つように作成され、ディスクスペースの確保や、サイズ制限があるメディア (例:メールまたはネットワークなど) 経由のファイル転送を容易にする用途に使用できます。</span></p><ul><li><span>4D ZIPアーカイブは <a href="#ZipArchiveClass.html_zip-create-archive">ZIP Create archive</a>コマンドで作成します。</span></li><li><span>4D <a href="#ZipFileClass.html"><code>ZIPFile</code></a>および <a href="#ZipFolderClass.html"><code>ZIPFolder</code></a>インスタンスは、<a href="#ZipArchiveClass.html_zip-read-archive">ZIP Readarchive</a> コマンドによって返されるオブジェクトの <a href="#ZipArchiveClass.html_root"><code>root</code></a> プロパティ(<code>ZIPFolder</code>) を通して利用可能です。</span></li></ul><h3><span><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_%E4%BE%8B%E9%A1%8C"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_%25E4%25BE%258B%25E9%25A1%258C"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</span></h3><p><span>ZIPFile オブジェクトを取得し、その中身を確認します:</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$path</span>; <span class="hljs-variable">$archive </span>: 4D.File<span class="hljs-keyword">var</span> <span class="hljs-variable">$zipFile </span>: 4D.ZipFile<span class="hljs-keyword">var</span> <span class="hljs-variable">$zipFolder </span>: 4D.ZipFolder<span class="hljs-keyword">var</span> <span class="hljs-variable">$txt </span>: Text<span class="hljs-variable">$path</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/Archive.zip"</span>)<span class="hljs-variable">$archive</span>:=<span class="hljs-function">ZIP Read archive</span>(<span class="hljs-variable">$path</span>)<span class="hljs-variable">$zipFolder</span>:=<span class="hljs-variable">$archive</span>.root <span class="hljs-comment">// 圧縮ファイルのルートフォルダーを保存します</span><span class="hljs-variable">$zipFile</span>:=<span class="hljs-variable">$zipFolder</span>.<span class="hljs-function">files</span>()[<span class="hljs-number">0</span>] <span class="hljs-comment">// 最初のファイルを読み取ります</span><span class="hljs-keyword">If</span>(<span class="hljs-variable">$zipFile</span>.extension=<span class="hljs-string">".txt"</span>)    <span class="hljs-variable">$txt</span>:=<span class="hljs-variable">$zipFile</span>.<span class="hljs-function">getText</span>()<span class="hljs-keyword">End if</span></code></span></pre><h3><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_%E6%A6%82%E8%A6%81"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_%25E6%25A6%2582%25E8%25A6%2581"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>概要</h3><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#ZipArchiveClass.html_root"><strong>.root</strong> :4D.ZipFolder</a><p>&nbsp;&nbsp;&nbsp;&nbsp;ZIPアーカイブのコンテンツにアクセスするためのバーチャルフォルダー</p></td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_zip-create-archive"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_zip-create-archive"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>ZIP Create archive</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v19 R3</td><td><code>ZIP Compression LZMA</code>, <code>ZIP CompressionXZ</code>, <code>.level</code> プロパティを追加</td></tr><tr><td>v18</td><td>追加</td></tr></tbody></table></details><p><strong>ZIP Create archive</strong> ( <em>fileToZip</em> :4D.File ; <em>destinationFile</em> : 4D.File ) : Object<br /><strong>ZIP Create archive</strong> ( <em>folderToZip</em> :4D.Folder ; <em>destinationFile</em> : 4D.File { ; <em>options</em>: Integer }) : Object<br /><strong>ZIP Create archive</strong> ( <em>zipStructure</em> :Object ; <em>destinationFile</em> : 4D.File ) : Object</p><table><thead><tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr></thead><tbody><tr><td>fileToZip</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>圧縮する File または Folder オブジェクト</td></tr><tr><td>folderToZip</td><td>4D.Folder</td><td style="text-align:center">-&gt;</td><td>圧縮する File または Folder オブジェクト</td></tr><tr><td>zipStructure</td><td>Object</td><td style="text-align:center">-&gt;</td><td>圧縮する File または Folder オブジェクト</td></tr><tr><td>destinationFile</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>アーカイブの保存先ファイル</td></tr><tr><td>options</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><em>folderToZip</em> オプション: <code>ZIP Without enclosingfolder</code> (外側のフォルダーを除外して ZIP圧縮をおこなう)</td></tr><tr><td>戻り値</td><td>Object</td><td style="text-align:center">&lt;-</td><td>ステータスオブジェクト</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_%E8%AA%AC%E6%98%8E"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_%25E8%25AA%25AC%25E6%2598%258E"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>ZIP Create archive</code> コマンドは、 圧縮された ZIPArchiveオブジェクトを作成し、その処理のステータスを返します。</p><p>第1引数として、4D.File、4D.Folder、あるいは zipStructureオブジェクトを渡すことができます。</p><ul><li><p><em>fileToZip</em>: 圧縮する <code>4D.File</code>オブジェクトを引数として渡します。</p></li><li><p><em>folderToZip</em>: 圧縮する <code>4D.Folder</code> を渡します。この場合、任意の <em>options</em> 引数を渡して、フォルダーのコンテンツのみを圧縮 (つまり、外側のフォルダを除外)することができます。 <code>ZIP Create archive</code>はデフォルトで、フォルダーとその中身を圧縮するので、展開処理をしたときにはフォルダーを再作成します。フォルダーの中身のみを解凍処理で復元するには、<em>options</em> 引数に <code>ZIP Withoutenclosing folder</code> 定数を渡します。</p></li><li><p><em>zipStructure</em>: ZIPArchive オブジェクトを表すオブジェクトを引数として渡します。以下のプロパティを利用して、このオブジェクトを定義することが可能です:</p></li></ul><table><thead><tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>compression</td><td>整数</td><td><ul><li><code>ZIP Compression standard</code>: Deflate圧縮 (デフォルト)</li><li><code>ZIP Compression LZMA</code>: LZMA圧縮</li><li><code>ZIP Compression XZ</code>: XZ圧縮</li><li><code>ZIP Compression none</code>: 圧縮なし</li></ul></td></tr><tr><td>level</td><td>Integer</td><td>圧縮レベル。 とりうる値: 1 - 10。 低い値ではファイルが大きくなり、高い値ではファイルが小さくなります。ただし、圧縮レベルはパフォーマンスに影響します。 デフォルト値 (省略時):<ul><li><code>ZIP Compression standard</code>: 6</li><li><code>ZIP Compression LZMA</code>: 4</li><li><code>ZIP Compression XZ</code>: 4</li></ul></td></tr><tr><td>encryption</td><td>整数</td><td>パスワードが設定されていた場合に使用する暗号化方法:<ul><li><code>ZIP Encryption AES128</code>: 128-bit キーを使った AESによる暗号化</li><li><code>ZIP Encryption AES192</code>: 192-bit キーを使った AESによる暗号化</li><li><code>ZIP Encryption AES256</code>: 256-bit キーを使った AES による暗号化(パスワードが設定されている場合のデフォルト)</li><li><code>ZIP Encryption none</code>: 暗号化なし(パスワードが設定されてない場合のデフォルト)</li></ul></td></tr><tr><td>password</td><td>Text</td><td>暗号化が必要な場合に使用するパスワード</td></tr><tr><td>files</td><td>Collection</td><td><ul><li><code>4D.File</code> または <code>4D.Folder</code>オブジェクトのコレクション</li><li>以下のプロパティを持ったオブジェクトのコレクション:</li><table><tr><td>プロパティ</td><td>タイプ</td><td>説明</td></tr><tr><td>source</td><td>4D.File または 4D.Folder</td><td>File または Folder</td></tr><tr><td>destination</td><td>テキスト</td><td>(任意) - アーカイブのコンテンツ構成を変更するための相対ファイルパス</td></tr><tr><td>option</td><td>number</td><td>(任意) - <code>ZIP Ignore invisible files</code> で非表示ファイルを無視、0を渡すと全ファイルを圧縮</td></tr></table></ul></td></tr><tr><td>callback</td><td>4D.Function</td><td>$1 に圧縮の進捗 (0 - 100) を受け取るコールバックフォーミュラ</td></tr></tbody></table><p><em>destinationFile</em> には、作成する ZIPアーカイブ (名前や位置など) を記述する<code>4D.File</code> オブジェクトを渡します。 作成したZIPアーカイブがあらゆるソフトウェアで自動的に処理されるようにするため、".zip" 拡張子の使用が推奨されます。</p><p>アーカイブが作成されると、<a href="#ZipArchiveClass.html_zip-read-archive">ZIP Read archive</a>を使用してアクセスすることができます。</p><p><strong>ステータスオブジェクト</strong></p><p>戻り値のステータスオブジェクトには、以下のプロパティが格納されています:</p><table><thead><tr><th>プロパティ</th><th>タイプ</th><th>説明</th></tr></thead><tbody><tr><td>statusText</td><td>Text</td><td>エラーメッセージ (あれば):<ul><li>ZIPアーカイブを開けません</li><li>ZIPアーカイブを作成できません</li><li>暗号化にはパスワードが必要です</li></ul></td></tr><tr><td>status</td><td>Integer</td><td>ステータスコード</td></tr><tr><td>success</td><td>Boolean</td><td>アーカイブが正常に作成された場合には true、それ以外は false</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_%E4%BE%8B%E9%A1%8C-1"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_%25E4%25BE%258B%25E9%25A1%258C-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 1</h4><p><code>4D.File</code> を圧縮します:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$file</span>; <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/file.zip"</span>) <span class="hljs-variable">$file</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/text.txt"</span>) <span class="hljs-variable">$status</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$file</span>;<span class="hljs-variable">$destination</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_%E4%BE%8B%E9%A1%8C-2"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_%25E4%25BE%258B%25E9%25A1%258C-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 2</h4><p>フォルダー自体は圧縮せずに <code>4D.Folder</code> の中身だけを圧縮します:</p><pre><code class="hljs css language-4D"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$folder </span>: 4D.Folder<span class="hljs-keyword"> var</span> <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/Images.zip"</span>) <span class="hljs-variable">$folder</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"MyDocs/Images"</span>) <span class="hljs-variable">$status</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$folder</span>;<span class="hljs-variable">$destination</span>;ZIP Without enclosing folder)</code></pre><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_%E4%BE%8B%E9%A1%8C-3"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_%25E4%25BE%258B%25E9%25A1%258C-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 3</h4><p>ZIPアーカイブの圧縮にパスワードと進捗バーを使います:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$zip</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> progID : Integer <span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/Archive.zip"</span>) <span class="hljs-variable">$zip</span>:=New object <span class="hljs-variable">$zip</span>.files:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"MyDocs/Resources"</span>).<span class="hljs-function">folders</span>() <span class="hljs-variable">$zip</span>.password:=<span class="hljs-string">"password"</span> <span class="hljs-variable">$zip</span>.callback:=<span class="hljs-function">Formula</span>(<span class="hljs-function">myFormulaCompressingMethod</span>(<span class="hljs-variable">$1</span>)) progID:=Progress New <span class="hljs-comment">// 4D Progress コンポーネントを使います</span> <span class="hljs-variable">$status</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$zip</span>;<span class="hljs-variable">$destination</span>)<span class="hljs-function"> Progress QUIT</span>(progID)</code></pre><p><code>myFormulaCompressingMethod</code>:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$1 </span>: Integer<span class="hljs-function"> Progress SET PROGRESS</span>(progID;<span class="hljs-function">Num</span>(<span class="hljs-variable">$1</span>/<span class="hljs-number">100</span>))</code></pre><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_%E4%BE%8B%E9%A1%8C-4"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_%25E4%25BE%258B%25E9%25A1%258C-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 4</h4><p><em>zipStructure</em>オブジェクトに、圧縮したいフォルダーとファイルを格納したコレクションを渡します:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$zip</span>;<span class="hljs-variable">$err </span>: Object <span class="hljs-variable">$zip</span>:=New object <span class="hljs-variable">$zip</span>.files:=New collection <span class="hljs-variable">$zip</span>.files.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"source"</span>;<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"Tests/text.txt"</span>))) <span class="hljs-variable">$zip</span>.files.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"source"</span>;<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"Tests/text2.txt"</span>))) <span class="hljs-variable">$zip</span>.files.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"source"</span>;<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"Images/image.png"</span>))) <span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"file.zip"</span>) <span class="hljs-variable">$err</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$zip</span>;<span class="hljs-variable">$destination</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_%E4%BE%8B%E9%A1%8C-5"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_%25E4%25BE%258B%25E9%25A1%258C-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題 5</h4><p>高い圧縮レベルの代替圧縮アルゴリズムを使用します:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword">var</span> <span class="hljs-variable">$zip</span>; <span class="hljs-variable">$err </span>: Object<span class="hljs-variable">$zip</span>:=New object<span class="hljs-variable">$zip</span>.files:=New collection<span class="hljs-variable">$zip</span>.files.<span class="hljs-function">push</span>(<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"images"</span>))<span class="hljs-variable">$zip</span>.compression:=ZIP Compression LZMA<span class="hljs-variable">$zip</span>.level:=<span class="hljs-number">7</span> <span class="hljs-comment">// デフォルト値は 4 です</span><span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"images.zip"</span>)<span class="hljs-variable">$err</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$zip</span>; <span class="hljs-variable">$destination</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_zip-read-archive"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_zip-read-archive"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>ZIP Read archive</h2><details><summary>履歴</summary><table><thead><tr><th>バージョン</th><th>内容</th></tr></thead><tbody><tr><td>v18</td><td>追加</td></tr></tbody></table></details><p><strong>ZIP Read archive</strong> ( <em>zipFile</em> : 4D.File {; <em>password</em> : Text }) : 4D.ZipArchive</p><table><thead><tr><th>引数</th><th>タイプ</th><th style="text-align:center"></th><th>説明</th></tr></thead><tbody><tr><td>zipFile</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>ZIPアーカイブファイル</td></tr><tr><td>password</td><td>Text</td><td style="text-align:center">-&gt;</td><td>ZIPアーカイブのパスワード (必要であれば)</td></tr><tr><td>戻り値</td><td>4D.ZipArchive</td><td style="text-align:center">&lt;-</td><td>アーカイブオブジェクト</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_%E8%AA%AC%E6%98%8E-1"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_%25E8%25AA%25AC%25E6%2598%258E-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>ZIP Read archive</code> コマンドは、 <em>zipFile</em>のコンテンツを取得し、<code>4D.ZipArchive</code> オブジェクト形式で返します。</p><blockquote><p>このコマンドは ZIPアーカイブを展開することはしません。その中身に関する情報を提供するのみです。アーカイブのコンテンツを取り出すには、<a href="#ZipArchiveClass.html_copyto">file.copyTo()</a> あるいは <a href="#ZipArchiveClass.html_copyto">folder.copyTo()</a> などの関数を使用します。</p></blockquote><p><em>zipFile</em> 引数として、圧縮された ZIPアーカイブを参照している<code>4D.File</code> オブジェクトを渡します。 ターゲットのアーカイブファイルは <code>ZIP Readarchive</code> が実行を終えるまで (全コンテンツ/参照が取得/解放されるまで)は開いた状態となり、その後自動的に閉じられます。</p><p><em>zipFile</em> 引数で指定した ZIPファイルがパスワードで保護されていた場合、任意の<em>password</em> 引数を渡してパスワードを提供する必要があります。パスワードが必要にも関わらず、コンテンツ読み出し時にパスワードが提示されなかった場合、エラーが生成されます。</p><p><strong>アーカイブオブジェクト</strong></p><p>戻り値の <code>4D.ZipArchive</code> オブジェクトは単一の <a href="#ZipArchiveClass.html_root"><code>root</code></a>プロパティを格納しており、その値は <code>4D.ZipFolder</code> オブジェクトです。 このフォルダーはZIPアーカイブの全コンテンツを表します。</p><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_%E4%BE%8B%E9%A1%8C-6"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_%25E4%25BE%258B%25E9%25A1%258C-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>例題</h4><p>ZIPFile オブジェクトを取得し、その中身を確認します:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$archive </span>: 4D.ZipArchive<span class="hljs-keyword"> var</span> <span class="hljs-variable">$path </span>: 4D.File <span class="hljs-variable">$path</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/Archive.zip"</span>) <span class="hljs-variable">$archive</span>:=<span class="hljs-function">ZIP Read archive</span>(<span class="hljs-variable">$path</span>)</code></pre><p>アーカイブ内のファイルとフォルダーの一覧を取得します:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$folders</span>:=<span class="hljs-variable">$archive</span>.root.<span class="hljs-function">folders</span>() <span class="hljs-variable">$files</span>:=<span class="hljs-variable">$archive</span>.root.<span class="hljs-function">files</span>()</code></pre><p>ファイルのコンテンツを、root フォルダーから取り出すことなく読み出します:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> If</span>(<span class="hljs-variable">$files</span>[<span class="hljs-variable">$i</span>].extension=<span class="hljs-string">".txt"</span>)    <span class="hljs-variable">$txt</span>:=<span class="hljs-variable">$files</span>[<span class="hljs-variable">$i</span>].<span class="hljs-function">getText</span>()<span class="hljs-keyword"> Else</span>    <span class="hljs-variable">$blob</span>:=<span class="hljs-variable">$files</span>[<span class="hljs-variable">$i</span>].<span class="hljs-function">getContent</span>()<span class="hljs-keyword"> End if</span></code></pre><p>root フォルダーから取り出します:</p><pre><code class="hljs css language-4d">  <span class="hljs-comment">// 特定のファイルを取得します</span> <span class="hljs-variable">$folderResult</span>:=<span class="hljs-variable">$files</span>[<span class="hljs-variable">$i</span>].<span class="hljs-function">copyTo</span>(<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"MyDocs"</span>))  <span class="hljs-comment">// すべてのファイルを取得します</span> <span class="hljs-variable">$folderResult</span>:=<span class="hljs-variable">$archive</span>.root.<span class="hljs-function">copyTo</span>(<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"MyDocs"</span>))</code></pre><h2><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_root"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_root"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.root</h2><p><strong>.root</strong> : 4D.ZipFolder</p><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_%E8%AA%AC%E6%98%8E-2"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_%25E8%25AA%25AC%25E6%2598%258E-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>説明</h4><p><code>.root</code> プロパティは、ZIPアーカイブのコンテンツにアクセスするためのバーチャルフォルダーを格納します。</p><p><code>root</code> フォルダーとそのコンテンツは、<a href="#ZipFileClass.html">ZipFile</a> および <a href="#ZipFolderClass.html">ZipFolder</a> の関数とプロパティを使用することで操作可能です。</p><p>このプロパティは <strong>読み取り専用</strong> です。</p><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#WebServerClass.html"><span class="arrow-prev">←</span><span class="function-name-prevnext">WebServer</span></a><a class="docs-next button" href="#ZipFileClass.html"><span>ZIPFile</span><span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#ZipArchiveClass.html_zip-create-archive">ZIP Createarchive</a></li><li><a href="#ZipArchiveClass.html_zip-read-archive">ZIP Readarchive</a></li><li><a href="#ZipArchiveClass.html_root">.root</a></li></ul></nav></div></div></body></html>