<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="ja"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>バリアント · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="バリアント型は、サポートしている型の任意のデータを受け取ることができる変数型です。 一般的には、返したり受け取ったりする値の型が未定である汎用的なコードを書くためにこの変数型が使用されます。 これは、たとえばオブジェクトの属性を扱うようなコードがそれに該当します。"name="description" /><meta content="ja" name="docsearch:language" /><meta content="バリアント · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="バリアント型は、サポートしている型の任意のデータを受け取ることができる変数型です。 一般的には、返したり受け取ったりする値の型が未定である汎用的なコードを書くためにこの変数型が使用されます。 これは、たとえばオブジェクトの属性を扱うようなコードがそれに該当します。"property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#dt_variant.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">バリアント<a aria-hidden="true" class="anchor" id="variant.html"></a></h1></header><article><div><p><span>バリアント型は、サポートしている型の任意のデータを受け取ることができる変数型です。一般的には、返したり受け取ったりする値の型が未定である汎用的なコードを書くためにこの変数型が使用されます。これは、たとえばオブジェクトの属性を扱うようなコードがそれに該当します。</span></p><p><span>バリアント型の変数は以下のデータタイプの値を格納することができます:</span></p><ul><li><span>BLOB</span></li><li><span>ブール</span></li><li><span>コレクション</span></li><li><span>日付</span></li><li><span>倍長整数</span></li><li><span>オブジェクト</span></li><li><span>ピクチャー</span></li><li><span>ポインター</span></li><li><span>実数</span></li><li><span>テキスト</span></li><li><span>時間</span></li><li><span>null</span></li><li><span>未定義</span></li></ul><blockquote><p><span>バリアント型変数に配列を格納することはできません。</span></p></blockquote><p><span>インタープリターモード、コンパイルモードのどちらにおいても、一つのバリアント型変数に異なる型のコンテンツを代入することができます。固定されている型の変数とは異なり、バリアント型変数の中身は変数自身の型 (つまり、バリアント型) と同一ではありません。たとえば:</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-function">C_VARIANT</span>(<span class="hljs-variable">$variant</span>)<span class="hljs-variable">$variant</span>:=<span class="hljs-string">"hello world"</span><span class="hljs-variable">$vtype</span>:=<span class="hljs-function">Type</span>(<span class="hljs-variable">$variant</span>) <span class="hljs-comment">// 12 (Is variant)</span><span class="hljs-variable">$vtypeVal</span>:=<span class="hljs-function">Value type</span>(<span class="hljs-variable">$variant</span>) <span class="hljs-comment">// 2 (Is text)</span><span class="hljs-variable">$variant</span>:=<span class="hljs-number">42</span><span class="hljs-variable">$vtype</span>:=<span class="hljs-function">Type</span>(<span class="hljs-variable">$variant</span>) <span class="hljs-comment">// 12 (Is variant)</span><span class="hljs-variable">$vtypeVal</span>:=<span class="hljs-function">Value type</span>(<span class="hljs-variable">$variant</span>) <span class="hljs-comment">// 1 (Is real)</span></code></span></pre><p>変数が期待されるところであれば、どこでもバリアント型変数を使用することができます。ただし、変数の中身のデータ型は予期される型でなくてはなりません。また、バリアント型変数を使う場合、その時点で変数に格納されている値のみが実質的に使われます。 たとえば:</p><pre><code class="hljs css language-4d"><span class="hljs-function">C_VARIANT</span>(<span class="hljs-variable">$v</span>)<span class="hljs-variable">$v</span>:=<span class="hljs-string">"hello world"</span><span class="hljs-variable">$v2</span>:=<span class="hljs-variable">$v </span><span class="hljs-comment">// バリアント型変数を、型未指定の変数に代入します</span><span class="hljs-variable">$t</span>:=<span class="hljs-function">Type</span>(<span class="hljs-variable">$v</span>) <span class="hljs-comment">// 12 (Is variant) 代入元の変数はバリアント型ですが</span><span class="hljs-variable">$t2</span>:=<span class="hljs-function">Type</span>(<span class="hljs-variable">$v2</span>) <span class="hljs-comment">// 2 (Is text) 代入先の変数はテキスト型です</span></code></pre><p>バリアント型は、様々なタイプになりうるメソッドの引数 ($0, $1,...) を宣言するのに使用できます。この場合、引数の値の型の確認作業が必要になります:</p><pre><code class="hljs css language-4d"><span class="hljs-function">C_VARIANT</span>(<span class="hljs-variable">$1</span>)<span class="hljs-keyword">Case of</span>: (<span class="hljs-function">Value type</span>(<span class="hljs-variable">$1</span>)=Is longint)...: (<span class="hljs-function">Value type</span>(<span class="hljs-variable">$1</span>)=Is text)...<span class="hljs-keyword">End case</span></code></pre><blockquote><p>バリアント型変数が必要ではない場合 (つまりデータタイプが分かっている場合)、型が固定された変数を使用することが推奨されます。固定型変数の方がパフォーマンスやコードの可読性も良く、予期せぬデータタイプを見過ごしてしまうようなバグを防げるため、コンパイラーにも優しいといえます。</p></blockquote></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#time.html"><span class="arrow-prev">←</span><span>時間</span></a><a class="docs-next button" href="#variables.html"><span>変数</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"></nav></div></div></body></html>