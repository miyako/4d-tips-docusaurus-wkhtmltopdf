<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="en"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Compact Page · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="You use this page to access the data file compacting functions."name="description" /><meta content="en" name="docsearch:language" /><meta content="Compact Page · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="You use this page to access the data file compacting functions."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#compact.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">CompactPage<a aria-hidden="true" class="anchor" id="compact.html"></a></h1></header><article><div><p><span>You use this page to access the data file compactingfunctions.</span></p><h2><span><a aria-hidden="true" class="anchor" id="compact.html_why-compact-your-files"></a><a aria-hidden="true"class="hash-link" href="#compact.html_why-compact-your-files"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Why compact your files?</span></h2><p><span>Compacting files meets two types of needs:</span></p><ul><li><p><span><strong>Reducing size and optimization of files</strong>:Files may contain unused spaces (“holes”). In fact, when you deleterecords, the space that they occupied previously in the filebecomes empty. 4D reuses these empty spaces whenever possible, butsince data size is variable, successive deletions or modificationswill inevitably generate unusable space for the program. The samegoes when a large quantity of data has just been deleted: the emptyspaces remain unassigned in the file. The ratio between the size ofthe data file and the space actually used for the data is theoccupation rate of the data. A rate that is too low can lead, inaddition to a waste of space, to the deterioration of databaseperformance. Compacting can be used to reorganize and optimizestorage of the data in order to remove the “holes”. The“Information” area summarizes the data concerning the fragmentationof the file and suggests operations to be carried out. The <a href="#compact.html_data">Data</a> tab on the “Information” page of theMSC indicates the fragmentation of the current datafile.</span></p></li><li><p><span><strong>Complete updating of data</strong> by applying thecurrent formatting set in the structure file. This is useful whendata from the same table were stored in different formats, forexample after a change in the database structure.</span></p></li></ul><blockquote><p><span>Compacting is only available in maintenance mode. If youattempt to carry out this operation in standard mode, a warningdialog box will inform you that the application will be closed andrestarted in maintenance mode. You can compact a data file that isnot opened by the application (see <a href="#compact.html_compact-records-and-indexes">Compact records andindexes</a> below).</span></p></blockquote><h2><span><a aria-hidden="true" class="anchor" id="compact.html_standard-compacting"></a><a aria-hidden="true" class="hash-link" href="#compact.html_standard-compacting"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Standard compacting</span></h2><p><span>To directly begin the compacting of the data file, clickon the compacting button in the MSC window.</span></p><p><span><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/MSC/MSC_compact.png" /></span></p><blockquote><p><span>Since compacting involves the duplication of the originalfile, the button is disabled when there is not adequate spaceavailable on the disk containing the file.</span></p></blockquote><p><span>This operation compacts the main file as well as any indexfiles. 4D copies the original files and puts them in a folder named<strong>Replaced Files (Compacting)</strong>, which is created nextto the original file. If you have carried out several compactingoperations, a new folder is created each time. It will be named“Replaced Files (Compacting)_1”, “Replaced Files (Compacting)_2”,and so on. You can modify the folder where the original files aresaved using the advanced mode.</span></p><p><span>When the operation is completed, the compacted filesautomatically replace the original files. The application isimmediately operational without any furthermanipulation.</span></p><blockquote><p><span>When the database is encrypted, compacting includesdecryption and encryption steps and thus, requires the current dataencryption key. If no valid data key has already been provided, adialog box requesting the passphrase or the data key isdisplayed.</span></p></blockquote><p><span><strong>Warning:</strong> Each compacting operationinvolves the duplication of the original file which increases thesize of the application folder. It is important to take this intoaccount (especially under macOS where 4D applications appear aspackages) so that the size of the application does not increaseexcessively. Manually removing the copies of the original fileinside the package can be useful in order to keep the package sizedown.</span></p><h2><span><a aria-hidden="true" class="anchor" id="compact.html_open-log-file"></a><a aria-hidden="true" class="hash-link" href="#compact.html_open-log-file"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Open log file</span></h2><p><span>After compacting is completed, 4D generates a log file inthe Logs folder of the project. This file allows you to view allthe operations carried out. It is created in XML format and named:<em>ApplicationName</em><em>_Compact_Log_yyyy-mm-ddhh-mm-ss.xml</em>" where:</span></p><ul><li><span><em>ApplicationName</em> is the name of the project filewithout any extension, for example "Invoices",</span></li><li><span><em>yyyy-mm-dd hh-mm-ss</em> is the timestamp of thefile, based upon the local system time when the maintenanceoperation was started, for example "2019-02-1115-20-45".</span></li></ul><p><span>When you click on the <strong>Open log file</strong>button, 4D displays the most recent log file in the default browserof the machine.</span></p><h2><span><a aria-hidden="true" class="anchor" id="compact.html_advanced-mode"></a><a aria-hidden="true" class="hash-link" href="#compact.html_advanced-mode"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Advanced mode</span></h2><p><span>The Compact page contains an <strong>Advanced&gt;</strong>button, which can be used to access an options page for compactingdata file.</span></p><h3><span><a aria-hidden="true" class="anchor" id="compact.html_compact-records-and-indexes"></a><a aria-hidden="true" class="hash-link" href="#compact.html_compact-records-and-indexes"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Compact records and indexes</span></h3><p><span>The <strong>Compact records and indexes</strong> areadisplays the pathname of the current data file as well as a<strong>[...]</strong> button that can be used to specify anotherdata file. When you click on this button, a standard Open documentdialog box is displayed so that you can designate the data file tobe compacted. You must select a data file that is compatible withthe open structure file. Once this dialog box has been validated,the pathname of the file to be compacted is indicated in thewindow.</span></p><p><span>The second <strong>[...]</strong> button can be used tospecify another location for the original files to be saved beforethe compacting operation. This option can be used more particularlywhen compacting voluminous files while using differentdisks.</span></p><h3><span><a aria-hidden="true" class="anchor" id="compact.html_force-updating-of-the-records"></a><a aria-hidden="true" class="hash-link" href="#compact.html_force-updating-of-the-records"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Force updating of the records</span></h3><p><span>When this option is checked, 4D rewrites every record foreach table during the compacting operation, according to itsdescription in the structure. If this option is not checked, 4Djust reorganizes the data storage on disk. This option is useful inthe following cases:</span></p><ul><li><p><span>When field types are changed in the application structureafter data were entered. For example, you may have changed aLongint field to a Real type. 4D even allows changes between twovery different types (with risks of data loss), for instance a Realfield can be changed to Text and vice versa. In this case, 4D doesnot convert data already entered retroactively; data is convertedonly when records are loaded and then saved. This option forces alldata to be converted.</span></p></li><li><p><span>When an external storage option for Text, Picture or BLOBdata has been changed after data were entered. This can happen whendatabases are converted from a version prior to v13. As is the casewith the retyping described above, 4D does not convert data alreadyentered retroactively. To do this, you can force records to beupdated in order to apply the new storage mode to records that havealready been entered.</span></p></li><li><p><span>When tables or fields were deleted. In this case,compacting with updating of records recovers the space of theseremoved data and thus reduces file size.</span></p></li></ul><blockquote><p><span>All the indexes are updated when this option isselected.</span></p></blockquote><h3><span><a aria-hidden="true" class="anchor" id="compact.html_compact-address-table"></a><a aria-hidden="true"class="hash-link" href="#compact.html_compact-address-table"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Compact address table</span></h3><p><span>(option only active when preceding option ischecked)</span></p><p><span>This option completely rebuilds the address table for therecords during compacting. This optimizes the size of the addresstable and is mainly used for databases where large volumes of datawere created and then deleted. In other cases, optimization is nota decisive factor.</span></p><p><span>Note that this option substantially slows compacting andinvalidates any sets saved using the <code>SAVE SET</code> command.Moreover, we strongly recommend deleting saved sets in this casebecause their use can lead to selections of incorrectdata.</span></p><blockquote><ul><li><span>Compacting takes records of tables that have been putinto the Trash into account. If there are a large number of recordsin the Trash, this can be an additional factor that may slow downthe operation.</span></li><li><span>Using this option makes the address table, and thus thedatabase, incompatible with the current journal file (if there isone). It will be saved automatically and a new journal file willhave to be created the next time the application islaunched.</span></li><li><span>You can decide if the address table needs to be compactedby comparing the total number of records and the address table sizein the <a href="#information.html">Information</a> page of theMSC.</span></li></ul></blockquote></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#backup.html"><span class="arrow-prev">←</span> <span>BackupPage</span></a><a class="docs-next button" href="#rollback.html"><span>Rollback Page</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#compact.html_why-compact-your-files">Why compact yourfiles?</a></li><li><a href="#compact.html_standard-compacting">Standardcompacting</a></li><li><a href="#compact.html_open-log-file">Open log file</a></li><li><a href="#compact.html_advanced-mode">Advanced mode</a><ul class="toc-headings"><li><a href="#compact.html_compact-records-and-indexes">Compactrecords and indexes</a></li><li><a href="#compact.html_force-updating-of-the-records">Forceupdating of the records</a></li><li><a href="#compact.html_compact-address-table">Compact addresstable</a></li></ul></li></ul></nav></div></div></body></html>