<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="en"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Formulas and Functions · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="## Using formulas" name="description" /><meta content="en" name="docsearch:language" /><meta content="Formulas and Functions · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="## Using formulas" property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#formulas.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">Formulas andFunctions<a aria-hidden="true" class="anchor" id="formulas.html"></a></h1></header><article><div><h2><span><a aria-hidden="true" class="anchor" id="formulas.html_using-formulas"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_using-formulas"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Using formulas</span></h2><p><span>A spreadsheet formula is an expression that calculates thevalue of a cell.</span></p><h3><span><a aria-hidden="true" class="anchor" id="formulas.html_entering-formulas"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_entering-formulas"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Entering formulas</span></h3><p><span>To enter a formula in a 4D View Pro area:</span></p><ol><li><span>Select the cell into which you will enter the formula orfunction.</span></li><li><span>Enter = (the equal sign).</span></li><li><span>Type the formula and hit the <strong>Enter</strong>key.</span></li></ol><p><span>When writing a formula, you can use differentshortcuts:</span></p><ul><li><span>click on a cell to enter its reference in theformula:</span></li></ul><p><span><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/formulas.PNG" /></span></p><ul><li><span>type the first letter of a function to enter. A pop-upmenu listing the available functions and references appears,allowing you to select the desired elements:</span></li></ul><p><span><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/formula2.PNG" /></span></p><p><span>You can also create named formulas that can be called viatheir name. To do so, enter these formulas using the <a href="#formulas.html_vp-add-formula-name">VP ADD FORMULA NAME</a>command.</span></p><h3><span><a aria-hidden="true" class="anchor" id="formulas.html_operators-and-operands"></a><a aria-hidden="true"class="hash-link" href="#formulas.html_operators-and-operands"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Operators and Operands</span></h3><p><span>All formulas have operands and operators:</span></p><ul><li><span><strong>Operators</strong>: see <a href="#formulas.html_values-and-operators">Values and operators</a>below.</span></li><li><span><strong>Operands</strong> include severalcategories:</span><ul><li><span><a href="#formulas.html_values-and-operators">values</a>(5 data types are supported)</span></li><li><span><a href="#formulas.html_cell-references">references toother cells</a> (relative, absolute, mixed or by name)</span></li><li><span><a href="#formulas.html_using-functions">standardspreadsheet functions</a></span></li><li><span><a href="#formulas.html_4d-functions">4D functions</a>based upon 4D formulas and providing access to 4D variables,fields, methods, commands, or expressions.</span></li></ul></li></ul><h2><span><a aria-hidden="true" class="anchor" id="formulas.html_values-and-operators"></a><a aria-hidden="true"class="hash-link" href="#formulas.html_values-and-operators"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Values and operators</span></h2><p><span>4D View Pro supports five types of data. For each datatype, specific literal values and operators aresupported.</span></p><table><thead><tr><th>Data types</th><th>Values</th><th>Operators</th></tr></thead><tbody><tr><td><a href="#number.html">Number</a></td><td>1.2<br />1.2 E3<br />1.2E-3<br />10.3x</td><td>+ (addition)<br />- (subtraction)<br />* (multiplication)<br />/ (division)<br />^ (exponent, the number of times to multiply a number byitself)<br />% (percentage -- divide the number before the operator by onehundred)</td></tr><tr><td><a href="#date.html">Date</a></td><td>10/24/2017</td><td>+ (date + number of days -&gt; date)<br />+ (date + time -&gt; date + time of day)<br />- (date - number of days -&gt; date)<br />- (date - date -&gt; number of days between the two)</td></tr><tr><td><a href="#time.html">Time</a></td><td>10:12:10</td><td>Duration operators:<p>+ (addition)<br />- (subtraction)<br />* (duration * number -&gt; duration)<br />/ (duration / number -&gt; duration)</p></td></tr><tr><td><a href="#string.html">String</a></td><td>'Sophie' or "Sophie"</td><td>&amp; (concatenation)</td></tr><tr><td><a href="#boolean.html">Boolean</a></td><td>TRUE or FALSE</td><td>-</td></tr></tbody></table><h3><span><a aria-hidden="true" class="anchor" id="formulas.html_comparison-operators"></a><a aria-hidden="true"class="hash-link" href="#formulas.html_comparison-operators"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Comparison operators</span></h3><p><span>The following operators can be used with two operands ofthe same type:</span></p><table><thead><tr><th>Operator</th><th>Comparison</th></tr></thead><tbody><tr><td>=</td><td>equal to</td></tr><tr><td>&lt;&gt;</td><td>different than</td></tr><tr><td>&gt;</td><td>greater than</td></tr><tr><td>&lt;</td><td>less than</td></tr><tr><td>&gt;=</td><td>greater than or equal to</td></tr><tr><td>&lt;=</td><td>less than or equal to</td></tr></tbody></table><h3><span><a aria-hidden="true" class="anchor" id="formulas.html_operator-precedence"></a><a aria-hidden="true"class="hash-link" href="#formulas.html_operator-precedence"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Operator precedence</span></h3><p><span>List of operators from most to least important:</span></p><table><thead><tr><th>Operator</th><th>Description</th></tr></thead><tbody><tr><td>()</td><td>Parenthesis (for grouping)</td></tr><tr><td>-</td><td>Negate</td></tr><tr><td>+</td><td>Plus</td></tr><tr><td>%</td><td>Percent</td></tr><tr><td>^</td><td>Exponent</td></tr><tr><td>* and /</td><td>Multiply and divide</td></tr><tr><td>+ and -</td><td>Add and Subtract</td></tr><tr><td>&amp;</td><td>Concatenate</td></tr><tr><td>= &gt; &lt; &gt;= &lt;= &lt;&gt;</td><td>Compare</td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="formulas.html_cell-references"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_cell-references"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Cell references</span></h2><p><span>Formulas often refer to other cells by cell addresses. Youcan copy these formulas into other cells. For example, thefollowing formula, entered in cell C8, adds the values in the twocells above it and displays the result.</span></p><pre><span><code class="hljs"><span class="hljs-section">= C6 + C7</span></code></span></pre><p>This formula refers to cells C6 and C7. That is, 4D View Pro isinstructed to refer to these other cells for values to use in theformula.</p><p>When you copy or move these formulas to new locations, each celladdress in that formula will either change or stay the same,depending on how it is typed.</p><ul><li>A reference that changes is called a <strong>relativereference</strong>, and refers to a cell by how far left/right andup/down it is from the cell with the formula.</li><li>A reference that always points to a particular cell is calledan <strong>absolute reference</strong>.</li><li>You can also create a mixed reference which always points to afixed row or column.</li></ul><h3><a aria-hidden="true" class="anchor" id="formulas.html_reference-notation"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_reference-notation"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Reference Notation</h3><p>If you use only cell coordinates, for example, <code>C5</code>,4D View Pro interprets the reference as relative. You may make thereference an absolute reference by putting a dollar sign in frontof the letter and the number, as in <code>$C$5</code>.</p><p>You can mix absolute and relative references by inserting adollar sign in front of the letter or the number alone, forexample, <code>$C5</code> or <code>C$5</code>. A mixed referenceallows you to specify either the row or the column as absolute,while allowing the other portion of the address to referrelatively.</p><p>A convenient, fast and accurate way to specify an absolutereference is to name the cell and use that name in place of thecell address. A reference to a named cell is always absolute. Youcan create or modify named cells or named cell ranges using the<a href="#formulas.html_vp-add-range-name"><code>VP ADD RANGENAME</code></a> method.</p><p>The following table shows the effect of the differentnotations:</p><table><thead><tr><th>Example</th><th>Type of reference</th><th>Description</th></tr></thead><tbody><tr><td>C5</td><td>Relative</td><td>Reference is to the relative location of cell C5, depending onthe location of the cell in which the reference is first used</td></tr><tr><td>$C$5</td><td>Absolute</td><td>Reference is absolute. Will always refer to cell C5 no matterwhere it is used.</td></tr><tr><td>$C5</td><td>Mixed</td><td>Reference is always to column C, but the row reference isrelative to the location of the cell in which the reference isfirst used.</td></tr><tr><td>C$5</td><td>Mixed</td><td>Reference is always to row 5, but the column reference isrelative to the location of the cell in which the reference isfirst used</td></tr><tr><td>Cell name</td><td>Absolute</td><td>Reference is absolute. Will always refer to the <a href="#formulas.html_vp-add-range-name">named cell or range</a> nomatter where the reference is used.</td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="formulas.html_built-in-functions"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_built-in-functions"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Built-in functions</h2><p>Spreadsheet functions are preset formulas used to calculate cellvalues. When you type the first letter of the function to enter, apop-up menu listing the available functions and references appears,allowing you to select the desired elements:</p><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/vpFormula2.PNG" /></p><p>See <a href="#FormulaFunctions.html"><strong>SpreadJS's extentedlist of functions</strong></a> for details and examples.</p><h2><a aria-hidden="true" class="anchor" id="formulas.html_4d-functions"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_4d-functions"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4D functions</h2><p>4D View Pro allows you to define and call <strong>4D customfunctions</strong>, which execute <a href="#FunctionClass.html">4Dformulas</a>. Using 4D custom functions extends the possibilitiesof your 4D View Pro documents and allows powerful interactions withthe 4D database.</p><p>4D custom functions provide access, from within your 4D View Proformulas, to:</p><ul><li>4D process variables,</li><li>fields,</li><li>project methods,</li><li>4D language commands,</li><li>or any valid 4D expression.</li></ul><p>4D custom functions can receive <a href="#formulas.html_parameters">parameters</a> from the 4D View Proarea, and return values.</p><p>You declare all your functions using the <a href="#formulas.html_vp-set-custom-functions"><code>VP SET CUSTOMFUNCTIONS</code></a> method. Examples:</p><pre><code class="hljs css language-4d">o:=New object<span class="hljs-comment">//Name of the function in 4D View Pro: "DRIVERS_LICENCE"</span><span class="hljs-variable">$o</span>.DRIVERS_LICENCE:=New object<span class="hljs-comment">//process variable</span><span class="hljs-variable">$o</span>.DRIVERS_LICENCE.formula:=<span class="hljs-function">Formula</span>(DriverLicence)<span class="hljs-comment">//table field</span><span class="hljs-variable">$o</span>.DRIVERS_LICENCE.formula:=<span class="hljs-function">Formula</span>([Users]DriverLicence)<span class="hljs-comment">//project method</span><span class="hljs-variable">$o</span>.DRIVERS_LICENCE.formula:=<span class="hljs-function">Formula</span>(DriverLicenceState)<span class="hljs-comment">//4D command</span><span class="hljs-variable">$o</span>.DRIVERS_LICENCE:=<span class="hljs-function">Formula</span>(<span class="hljs-function">Choose</span>(DriverLicence; <span class="hljs-string">"Obtained"</span>; <span class="hljs-string">"Failed"</span>))<span class="hljs-comment">//4D expression and parameter</span><span class="hljs-variable">$o</span>.DRIVERS_LICENCE.formula:=<span class="hljs-function">Formula</span>(ds.Users.<span class="hljs-function">get</span>(<span class="hljs-variable">$1</span>).DriverLicence)<span class="hljs-variable">$o</span>.DRIVERS_LICENCE.parameters:=New collection<span class="hljs-variable">$o</span>.DRIVERS_LICENCE.parameters.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>; <span class="hljs-string">"ID"</span>; <span class="hljs-string">"type"</span>; Is longint))</code></pre><blockquote><p><strong>See also</strong> <a href="https://blog.4d.com/4d-view-pro-use-4d-formulas-in-your-spreadsheet/">4D View Pro: Use 4D formulas in your spreadsheet (blogpost)</a></p></blockquote><h3><a aria-hidden="true" class="anchor" id="formulas.html_hello-world-example"></a><a aria-hidden="true"class="hash-link" href="#formulas.html_hello-world-example"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Hello World example</h3><p>We want to print "Hello World" in a 4D View Pro area cell usinga 4D project method:</p><ol><li>Create a "myMethod" project method with the followingcode:</li></ol><pre><code class="hljs css language-4d"> #DECLARE-&gt;<span class="hljs-variable">$hw Text</span> <span class="hljs-variable">$hw</span>:=<span class="hljs-string">"Hello World"</span></code></pre><ol start="2"><li>Execute the following code before opening any form thatcontains a 4D View Pro area:</li></ol><pre><code class="hljs css language-4d"><span class="hljs-keyword">  Case of</span>    :(Form event code=On Load)<span class="hljs-keyword">       var</span> <span class="hljs-variable">$o </span>: Object       <span class="hljs-variable">$o</span>:=New object  <span class="hljs-comment">// Define "vpHello" function from the "myMethod" method</span>       <span class="hljs-variable">$o</span>.vpHello:=New object       <span class="hljs-variable">$o</span>.vpHello.formula:=<span class="hljs-function">Formula</span>(myMethod)<span class="hljs-function">       VP SET CUSTOM FUNCTIONS</span>(<span class="hljs-string">"ViewProArea"</span>;<span class="hljs-variable">$o</span>)<span class="hljs-keyword"> End case</span></code></pre><ol start="3"><li><p>Edit the content of a cell in a 4D View Pro area and type:</p><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/vpProjMeth1.PNG" /></p><p>"myMethod" is then called by 4D and the cell displays:</p><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/vpProjMeth2.PNG" /></p></li></ol><h3><a aria-hidden="true" class="anchor" id="formulas.html_parameters"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_parameters"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Parameters</h3><p>Parameters can be passed to 4D functions that call projectmethods using the following syntax:</p><pre><code class="hljs">=METHODNAME(param1,param2,...,paramN)</code></pre><p>These parameters are received in <em>methodName</em> in $1,$2...$N.</p><p>Note that the ( ) are mandatory, even if no parameters arepassed:</p><pre><code class="hljs">=METHODWITHOUTNAME()</code></pre><p>You can declare the name, type, and number of parameters throughthe <em>parameters</em> collection of the function you declaredusing the <a href="#formulas.html_vp-set-custom-functions">VP SETCUSTOM FUNCTIONS</a> method. Optionally, you can control the numberof parameters passed by the user through <em>minParams</em> and<em>maxParams</em> properties.</p><p>For more information on supported incoming parameter types,please refer to the <a href="#formulas.html_vp-set-custom-functions">VP SET CUSTOMFUNCTIONS</a> method description.</p><blockquote><p>If you do not declare parameters, values can be sequentiallypassed to methods (they will be received in $1, $2...) and theirtype will be automatically converted. Dates in <em>jstype</em> willbe passed as <a href="#object.html">object</a> in 4D code with twoproperties:</p><table><thead><tr><th>Property</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>value</td><td>Date</td><td>Date value</td></tr><tr><td>time</td><td>Real</td><td>Time in seconds</td></tr></tbody></table></blockquote><p>4D project methods can also return values in the 4D View Procell formula via $0. The following data types are supported forreturned parameters:</p><ul><li><p><a href="#string.html">text</a> (converted to string in 4D ViewPro)</p></li><li><p><a href="#number.html">real</a>/<a href="#number.html">longint</a> (converted to number in 4D View Pro)</p></li><li><p><a href="#date.html">date</a> (converted to JS Date type in 4DView Pro - hour, minute, sec = 0)</p></li><li><p><a href="#time.html">time</a> (converted to JS Date type in 4DView Pro - date in base date, i.e. 12/30/1899)</p></li><li><p><a href="#boolean.html">boolean</a> (converted to bool in 4DView Pro)</p></li><li><p><a href="#picture.html">picture</a> (jpg,png,gif,bmp,svg othertypes converted into png) creates a URI(data:image/png;base64,xxxx) and then used as the background in 4DView Pro in the cell where the formula is executed</p></li><li><p><a href="#object.html">object</a> with the following twoproperties (allowing passing a date and time):</p><table><thead><tr><th>Property</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>value</td><td>Date</td><td>Date value</td></tr><tr><td>time</td><td>Real</td><td>Time in seconds</td></tr></tbody></table></li></ul><p>If the 4D method returns nothing, an empty string isautomatically returned.</p><p>An error is returned in the 4D View Pro cell if:</p><ul><li>the 4D method returns another type other than those listedabove,</li><li>an error occurred during 4D method execution (when user clickson "abort" button).</li></ul><h4><a aria-hidden="true" class="anchor" id="formulas.html_example"></a><a aria-hidden="true" class="hash-link"href="#formulas.html_example"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Example</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$o </span>: Object<span class="hljs-variable">$o</span>.BIRTH_INFORMATION:=New object<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.formula:=<span class="hljs-function">Formula</span>(BirthInformation)<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.parameters:=New collection<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.parameters.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"First name"</span>;<span class="hljs-string">"type"</span>;Is text))<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.parameters.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Birthday"</span>;<span class="hljs-string">"type"</span>;Is date))<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.parameters.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"name"</span>;<span class="hljs-string">"Time of birth"</span>;<span class="hljs-string">"type"</span>;Is time))<span class="hljs-variable">$o</span>.BIRTH_INFORMATION.summary:=<span class="hljs-string">"Returns a formatted string from given information"</span><span class="hljs-function">VP SET CUSTOM FUNCTIONS</span>(<span class="hljs-string">"ViewProArea"</span>; <span class="hljs-variable">$o</span>)</code></pre><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/params.PNG" /></p><h2><a aria-hidden="true" class="anchor" id="formulas.html_compatibility"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_compatibility"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Compatibility</h2><p>Alternate solutions are available to declare fields or methodsas functions in your 4D View Pro areas. These solutions aremaintained for compatibility reasons and can be used in specificcases. However, using the <a href="#formulas.html_vp-set-custom-functions"><code>VP SET CUSTOMFUNCTIONS</code></a> method is recommended.</p><h3><a aria-hidden="true" class="anchor" id="formulas.html_referencing-fields-using-the-virtual-structure"></a><a aria-hidden="true"class="hash-link" href="#formulas.html_referencing-fields-using-the-virtual-structure"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Referencing fields using the virtual structure</h3><p>4D View Pro allows you to reference 4D fields using the virtualstructure of the database, i.e. declared through the <a href="https://doc.4d.com/4dv19/help/command/en/page601.html"><code>SETTABLE TITLES</code></a> and/or <a href="https://doc.4d.com/4dv19/help/command/en/page602.html"><code>SETFIELD TITLES</code></a> commands with the * parameter. Thisalternate solution could be useful if your application alreadyrelies on a virtual structure (otherwise, <a href="#formulas.html_4d-functions">using <code>VP SET CUSTOMFUNCTIONS</code></a> is recommended).</p><blockquote><p><strong>WARNING:</strong> You cannot use the virtual structureand <code>VP SET CUSTOM FUNCTIONS</code> simultaneously. As soon as<code>VP SET CUSTOM FUNCTIONS</code> is called, the functions basedupon <code>SET TABLE TITLES</code> and <code>SET FIELDTITLES</code> commands are ignored in the 4D View Pro area.</p></blockquote><h4><a aria-hidden="true" class="anchor" id="formulas.html_requirements"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_requirements"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Requirements</h4><ul><li>The field must belong to the virtual structure of the database,i.e. it must be declared through the <a href="https://doc.4d.com/4dv19/help/command/en/page601.html"><code>SETTABLE TITLES</code></a> and/or <a href="https://doc.4d.com/4dv19/help/command/en/page602.html"><code>SETFIELD TITLES</code></a> commands with the * parameter (seeexample),</li><li>Table and field names must be ECMA compliant (see <a href="#formulas.html_sec-7.6">ECMA Script standard</a>),</li><li>The field type must be supported by 4D View Pro (seeabove).</li></ul><p>An error is returned in the 4D View Pro cell if the formulacalls a field which is not compliant.</p><h4><a aria-hidden="true" class="anchor" id="formulas.html_calling-a-virtual-field-in-a-formula"></a><a aria-hidden="true"class="hash-link" href="#formulas.html_calling-a-virtual-field-in-a-formula"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Calling a virtual field in a formula</h4><p>To insert a reference to a virtual field in a formula, enter thefield with the following syntax:</p><pre><code class="hljs"><span class="hljs-function"><span class="hljs-title">TABLENAME_FIELDNAME</span><span class="hljs-params">()</span></span></code></pre><p>For example, if you declared the "Name" field of the "People"table in the virtual structure, you can call the followingfunctions:</p><pre><code class="hljs">=PEOPLE_NAME()=<span class="hljs-built_in">LEN</span>(PEOPLE_NAME())</code></pre><blockquote><p>If a field has the same name as a [4D method], it takes priorityover the method.</p></blockquote><h4><a aria-hidden="true" class="anchor" id="formulas.html_example-1"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_example-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Example</h4><p>We want to print the name of a person in a 4D View Pro area cellusing a 4D virtual field:</p><ol><li>Create an "Employee" table with a "L_Name" field:</li></ol><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/vpFieldMeth1.PNG" /></p><ol start="2"><li><p>Execute the following code to initialize a virtualstructure:</p><pre><code class="hljs css language-4d"><span class="hljs-function">ARRAY TEXT</span>(<span class="hljs-variable">$tableTitles</span>;<span class="hljs-number">1</span>)<span class="hljs-function">ARRAY LONGINT</span>(<span class="hljs-variable">$tableNum</span>;<span class="hljs-number">1</span>)<span class="hljs-variable">$tableTitles{1}</span>:=<span class="hljs-string">"Emp"</span><span class="hljs-variable">$tableNum{1}</span>:=<span class="hljs-number">2</span><span class="hljs-function">SET TABLE TITLES</span>(<span class="hljs-variable">$tableTitles</span>;<span class="hljs-variable">$tableNum</span>;*) <span class="hljs-function">ARRAY TEXT</span>(<span class="hljs-variable">$fieldTitles</span>;<span class="hljs-number">1</span>)<span class="hljs-function">ARRAY LONGINT</span>(<span class="hljs-variable">$fieldNum</span>;<span class="hljs-number">1</span>)<span class="hljs-variable">$fieldTitles{1}</span>:=<span class="hljs-string">"Name"</span><span class="hljs-variable">$fieldNum{1}</span>:=<span class="hljs-number">2</span> <span class="hljs-comment">//last name</span><span class="hljs-function">SET FIELD TITLES</span>([Employee];<span class="hljs-variable">$fieldTitles</span>;<span class="hljs-variable">$fieldNum</span>;*)</code></pre></li><li><p>Edit the content of a cell in the 4D View Pro area and enter"=e":</p></li></ol><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/vpFieldMeth2.PNG" /></p><ol start="4"><li>Select EMP_NAME (use the Tab key) and enter the closing ).</li></ol><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/vpFieldMeth3.PNG" /></p><ol start="5"><li>Validate the field to display the name of the currentemployee:</li></ol><p><img alt="" src="https://developer.4d.com/docs/Rx/assets/en/ViewPro/vpFieldMeth4.PNG" /></p><blockquote><p>The [Employee] table must have a current record.</p></blockquote><h3><a aria-hidden="true" class="anchor" id="formulas.html_declaring-allowed-methods"></a><a aria-hidden="true"class="hash-link" href="#formulas.html_declaring-allowed-methods"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Declaring allowed methods</h3><p>You can call directly 4D project methods from within your 4DView Pro formulas. For security reasons, you must declareexplicitly methods that can be called by the user with the <a href="#formulas.html_vp-set-allowed-methods">VP SET ALLOWED METHODS</a>method.</p><h4><a aria-hidden="true" class="anchor" id="formulas.html_requirements-1"></a><a aria-hidden="true" class="hash-link" href="#formulas.html_requirements-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Requirements</h4><p>To be called in a 4D View Pro formula, a project method mustbe:</p><ul><li><strong>Allowed</strong>: it was explicitly declared using the<a href="#formulas.html_vp-set-allowed-methods">VP SET ALLOWEDMETHODS</a> method.</li><li><strong>Runnable</strong>: it belongs to the host project or aloaded component with the "Shared by components and host project"option enabled (see <a href="#formulas.html_sharing-of-project-methods">Sharing of projectmethods</a>).</li><li><strong>Not in conflict</strong> with an existing 4D View Prospreadsheet function: if you call a project method with the samename as a 4D View Pro built-in function, the function iscalled.</li></ul><blockquote><p>If neither the <a href="#formulas.html_vp-set-custom-functions">VP SET CUSTOMFUNCTIONS</a> nor the <a href="#formulas.html_vp-set-allowed-methods">VP SET ALLOWED METHODS</a>method has been executed during the session, 4D View Pro customfunctions rely on allowed methods defined by 4D's generic <code>SETALLOWED METHODS</code> command. In this case, the project methodnames must comply with JavaScript Identifier Grammar (see <a href="#formulas.html_sec-7.6">ECMA Script standard</a>). The globalfiltering option in the Settings dialog box (see <em>DataAccess</em>) is ignored in all cases.</p></blockquote></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#configuring.html"><span class="arrow-prev">←</span><span>Configuring 4D View Pro Areas</span></a><a class="docs-next button" href="#method-list.html"><span>MethodList</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#formulas.html_using-formulas">Using formulas</a><ul class="toc-headings"><li><a href="#formulas.html_entering-formulas">Enteringformulas</a></li><li><a href="#formulas.html_operators-and-operands">Operators andOperands</a></li></ul></li><li><a href="#formulas.html_values-and-operators">Values andoperators</a><ul class="toc-headings"><li><a href="#formulas.html_comparison-operators">Comparisonoperators</a></li><li><a href="#formulas.html_operator-precedence">Operatorprecedence</a></li></ul></li><li><a href="#formulas.html_cell-references">Cell references</a><ul class="toc-headings"><li><a href="#formulas.html_reference-notation">ReferenceNotation</a></li></ul></li><li><a href="#formulas.html_built-in-functions">Built-infunctions</a></li><li><a href="#formulas.html_4d-functions">4D functions</a><ul class="toc-headings"><li><a href="#formulas.html_hello-world-example">Hello Worldexample</a></li><li><a href="#formulas.html_parameters">Parameters</a></li></ul></li><li><a href="#formulas.html_compatibility">Compatibility</a><ul class="toc-headings"><li><a href="#formulas.html_referencing-fields-using-the-virtual-structure">Referencingfields using the virtual structure</a></li><li><a href="#formulas.html_declaring-allowed-methods">Declaringallowed methods</a></li></ul></li></ul></nav></div></div></body></html>