<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="en"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Error handling · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="Error handling is the process of anticipating and responding to errors that might occur in your application. 4D provides a comprehensive support for catching and reporting errors at runtime, as well as for investigating their conditions."name="description" /><meta content="en" name="docsearch:language" /><meta content="Error handling · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="Error handling is the process of anticipating and responding to errors that might occur in your application. 4D provides a comprehensive support for catching and reporting errors at runtime, as well as for investigating their conditions."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#error-handling.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">Errorhandling<a aria-hidden="true" class="anchor" id="error-handling.html"></a></h1></header><article><div><p><span>Error handling is the process of anticipating andresponding to errors that might occur in your application. 4Dprovides a comprehensive support for catching and reporting errorsat runtime, as well as for investigating theirconditions.</span></p><p><span>Error handling meets two main needs:</span></p><ul><li><span>finding out and fixing potential errors and bugs in yourcode during the development phase,</span></li><li><span>catching and recovering from unexpected errors indeployed applications; in particular, you can replace system errordialogs (disk full, missing file, etc.) with you owninterface.</span></li></ul><blockquote><p><span>It is highly recommended to install an error-handlingmethod on 4D Server, for all code running on the server. Thismethod would avoid unexpected dialog boxes to be displayed on theserver machine, and could log errors in a dedicated file forfurther analyses.</span></p></blockquote><h2><span><a aria-hidden="true" class="anchor" id="error-handling.html_error-or-status"></a><a aria-hidden="true"class="hash-link" href="#error-handling.html_error-or-status"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Error or status</span></h2><p><span>Many 4D class functions, such as<code>entity.save()</code> or <code>transporter.send()</code>,return a <em>status</em> object. This object is used to store"predictable" errors in the runtime context, e.g. invalid password,locked entity, etc., that do not stop program execution. Thiscategory of errors can be handled by regular code.</span></p><p><span>Other "unpredictable" errors include disk write error,network failure, or in general any unexpected interruption. Thiscategory of errors generates exceptions and needs to be handledthrough an error-handling method.</span></p><h2><span><a aria-hidden="true" class="anchor" id="error-handling.html_installing-an-error-handling-method"></a><a aria-hidden="true"class="hash-link" href="#error-handling.html_installing-an-error-handling-method"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Installing an error-handling method</span></h2><p><span>In 4D, all errors can be caught and handled in a specificproject method, the <strong>error-handling</strong> (or<strong>error-catching</strong>) method.</span></p><p><span>This project method is installed for the current processand will be automatically called for any error that occurs in theprocess, in interpreted or compiled mode. To <em>install</em> thisproject method, you just need to call the <code>ON ERR CALL</code>command with the project method name as parameter. Forexample:</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-function">ON ERR CALL</span>(<span class="hljs-string">"IO_ERRORS"</span>) <span class="hljs-comment">//Installs the error-handling method</span></code></span></pre><p>To stop catching errors and give back hand to 4D, call <code>ONERR CALL</code> with an empty string:</p><pre><code class="hljs css language-4d"><span class="hljs-function">ON ERR CALL</span>(<span class="hljs-string">""</span>) <span class="hljs-comment">//gives back control to 4D</span></code></pre><p>The <code>Method called on error</code> command allows you toknow the name of the method installed by <code>ON ERR CALL</code>for the current process. It is particularly useful in the contextof generic code because it enables you to temporarily change andthen restore the error-catching method:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$methCurrent</span>:=Method called on error<span class="hljs-function"> ON ERR CALL</span>(<span class="hljs-string">"NewMethod"</span>)  <span class="hljs-comment">//If the document cannot be opened, an error is generated</span> <span class="hljs-variable">$ref</span>:=<span class="hljs-function">Open document</span>(<span class="hljs-string">"MyDocument"</span>)  <span class="hljs-comment">//Reinstallation of previous method</span><span class="hljs-function"> ON ERR CALL</span>(<span class="hljs-variable">$methCurrent</span>)</code></pre><h3><a aria-hidden="true" class="anchor" id="error-handling.html_scope-and-components"></a><a aria-hidden="true" class="hash-link" href="#error-handling.html_scope-and-components"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Scope and components</h3><p>You can define a single error-catching method for the wholeapplication or different methods per application module. However,only one method can be installed per process.</p><p>An error-handling method installed by the <code>ON ERRCALL</code> command only applies to the running application. In thecase of an error generated by a <strong>component</strong>, the<code>ON ERR CALL</code> error-handling method of the hostapplication is not called, and vice versa.</p><h3><a aria-hidden="true" class="anchor" id="error-handling.html_handling-errors-within-the-method"></a><a aria-hidden="true"class="hash-link" href="#error-handling.html_handling-errors-within-the-method"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Handling errors within the method</h3><p>Within the custom error method, you have access to severalpieces of information that will help you identifying the error:</p><ul><li><p>dedicated system variables(*):</p><ul><li><code>Error</code> (longint): error code</li><li><code>Error method</code> (text): name of the method thattriggered the error</li><li><code>Error line</code> (longint): line number in the methodthat triggered the error</li><li><code>Error formula</code> (text): formula of the 4D code (rawtext) which is at the origin of the error.</li></ul></li></ul><p>(*) 4D automatically maintains a number of variables called<strong>system variables</strong>, meeting different needs. See the<em>4D Language Reference manual</em>.</p><ul><li>the <code>GET LAST ERROR STACK</code> command that returnsinformation about the current stack of errors of the 4Dapplication.</li><li>the <code>Get call chain</code> command that returns acollection of objects describing each step of the method call chainwithin the current process.</li></ul><h4><a aria-hidden="true" class="anchor" id="error-handling.html_example"></a><a aria-hidden="true" class="hash-link" href="#error-handling.html_example"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Example</h4><p>Here is a simple error-handling system:</p><pre><code class="hljs css language-4d"><span class="hljs-comment">//installing the error handling method</span><span class="hljs-function"> ON ERR CALL</span>(<span class="hljs-string">"errorMethod"</span>) <span class="hljs-comment">//... executing code</span><span class="hljs-function"> ON ERR CALL</span>(<span class="hljs-string">""</span>) <span class="hljs-comment">//giving control back to 4D</span></code></pre><pre><code class="hljs css language-4d"><span class="hljs-comment">// errorMethod project method</span><span class="hljs-keyword"> If</span>(Error#<span class="hljs-number">1006</span>) <span class="hljs-comment">//this is not a user interruption</span><span class="hljs-function">    ALERT</span>(<span class="hljs-string">"The error "</span>+<span class="hljs-function">String</span>(Error)+<span class="hljs-string">" occurred"</span>. The code in question is: \<span class="hljs-string">""</span>+Error formula+<span class="hljs-string">"\""</span>)<span class="hljs-keyword"> End if</span></code></pre><h3><a aria-hidden="true" class="anchor" id="error-handling.html_using-an-empty-error-handling-method"></a><a aria-hidden="true"class="hash-link" href="#error-handling.html_using-an-empty-error-handling-method"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Using an empty error-handling method</h3><p>If you mainly want the standard error dialog box to be hidden,you can install an empty error-handling method. The<code>Error</code> system variable can be tested in any method,i.e. outside of the error-handling method:</p><pre><code class="hljs css language-4d"><span class="hljs-function">ON ERR CALL</span>(<span class="hljs-string">"emptyMethod"</span>) <span class="hljs-comment">//emptyMethod exists but is empty</span><span class="hljs-variable">$doc</span>:=<span class="hljs-function">Open document</span>( <span class="hljs-string">"myFile.txt"</span>)<span class="hljs-keyword">If</span> (Error=<span class="hljs-number">-43</span>)<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"File not found."</span>)<span class="hljs-keyword">End if</span><span class="hljs-function">ON ERR CALL</span>(<span class="hljs-string">""</span>)</code></pre></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#looping.html"><span class="arrow-prev">←</span> <span>Loopingstructures</span></a><a class="docs-next button" href="#interpreted-compiled.html"><span>Interpreted and Compiledmodes</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#error-handling.html_error-or-status">Error orstatus</a></li><li><a href="#error-handling.html_installing-an-error-handling-method">Installingan error-handling method</a><ul class="toc-headings"><li><a href="#error-handling.html_scope-and-components">Scope andcomponents</a></li><li><a href="#error-handling.html_handling-errors-within-the-method">Handlingerrors within the method</a></li><li><a href="#error-handling.html_using-an-empty-error-handling-method">Usingan empty error-handling method</a></li></ul></li></ul></nav></div></div></body></html>