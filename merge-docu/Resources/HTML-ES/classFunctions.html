<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="es"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Llamar a las funciones de clase ORDA · 4DDocumentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="Puede llamar a [funciones de clase de modelos de datos](/docs/Rx/es/ORDA/ordaClasses.html) definidas para el modelo de datos ORDA a través de sus peticiones REST, para poder beneficiarse de la API expuesta de la aplicación 4D objetivo."name="description" /><meta content="es" name="docsearch:language" /><meta content="Llamar a las funciones de clase ORDA · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="Puede llamar a [funciones de clase de modelos de datos](/docs/Rx/es/ORDA/ordaClasses.html) definidas para el modelo de datos ORDA a través de sus peticiones REST, para poder beneficiarse de la API expuesta de la aplicación 4D objetivo."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#ClassFunctions.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">Llamar a lasfunciones de clase ORDA<a aria-hidden="true" class="anchor" id="classFunctions.html"></a></h1></header><article><div><p><span>Puede llamar a <a href="#ordaClasses.html">funciones declase de modelos de datos</a> definidas para el modelo de datosORDA a través de sus peticiones REST, para poder beneficiarse de laAPI expuesta de la aplicación 4D objetivo.</span></p><p><span>Las funciones se llaman simplemente en peticiones POST enla interfaz ORDA apropiada, sin (). Por ejemplo, si ha definido unafunción <code>getCity()</code> en la dataclass City, podríallamarla utilizando la siguiente petición:</span></p><p><span><code>/rest/City/getCity</code></span></p><p><span>con los datos en el cuerpo de la petición POST:<code>["Aguada"]</code></span></p><p><span>En el lenguaje 4D, esta llamada equivale a:</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-variable">$city</span>:=ds.City.<span class="hljs-function">getCity</span>(<span class="hljs-string">"Aguada"</span>)</code></span></pre><blockquote><p>Sólo las funciones con la palabra clave <code>exposed</code>pueden ser llamadas directamente desde las peticiones REST. Ver lasección <a href="#classFunctions.html_exposed-vs-non-exposed-functions">Funcionesexpuestas vs. no expuestas</a>.</p></blockquote><h2><a aria-hidden="true" class="anchor" id="classFunctions.html_llamadas-de-las-funciones"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_llamadas-de-las-funciones"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Llamadas de las funciones</h2><p>Las funciones deben llamarse siempre utilizando peticiones<strong>POST</strong> (una petición GET recibirá un error).</p><p>Las funciones son llamadas en el objeto correspondiente en elalmacén de datos del servidor.</p><table><thead><tr><th>Función de clase</th><th>Sintaxis</th></tr></thead><tbody><tr><td><a href="#classFunctions.html_datastore-class">datastoreclass</a></td><td><code>/rest/$catalog/DataStoreClassFunction</code></td></tr><tr><td><a href="#classFunctions.html_dataclass-class">dataclassclass</a></td><td><code>/rest/{dataClass}/DataClassClassFunction</code></td></tr><tr><td><a href="#classFunctions.html_entityselection-class">entitySelectionclass</a></td><td><code>/rest/{dataClass}/EntitySelectionClassFunction</code></td></tr><tr><td></td><td><code>/rest/{dataClass}/EntitySelectionClassFunction/$entityset/entitySetNumber</code></td></tr><tr><td></td><td><code>/rest/{dataClass}/EntitySelectionClassFunction/$filter</code></td></tr><tr><td></td><td><code>/rest/{dataClass}/EntitySelectionClassFunction/$orderby</code></td></tr><tr><td><a href="#classFunctions.html_entity-class">entityclass</a></td><td><code>/rest/{dataClass}(key)/EntityClassFunction/</code></td></tr></tbody></table><blockquote><p><code>/rest/{dataClass}/Function</code> puede utilizarse parallamar a una función de dataclass o de selección de entidades(<code>/rest/{dataClass}</code> devuelve todas las entidades de laDataClass como una selección de entidades).<br />La función se busca primero en la clase de selección de entidades.Si no se encuentra, se busca en la dataclass. En otras palabras, siuna función con el mismo nombre se define tanto en la claseDataClass como en la clase EntitySelection, la función de clase deDataClass nunca se ejecutará.</p></blockquote><blockquote><p>Todo el código 4D llamado desde las peticiones REST <strong>debeser hilo seguro</strong> si el proyecto se ejecuta en modocompilado, porque el Servidor REST siempre utiliza procesosapropiativos en este caso (el valor de la propiedad <a href="#classFunctions.html_enabling-the-preemptive-mode-for-the-web-server"><em>Utilizar proceso apropiativo</em></a> es ignorado por elServidor REST).</p></blockquote><h2><a aria-hidden="true" class="anchor" id="classFunctions.html_par%C3%A1metros"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_par%25C3%25A1metros"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Parámetros</h2><p>Puede enviar los parámetros a las funciones definidas en lasclases usuarios ORDA. Del lado del servidor, se recibirán en lasfunciones de clase en los parámetros normales $1, $2, etc.</p><p>Se aplican las siguientes reglas:</p><ul><li>Los parámetros deben pasarse en el <strong>cuerpo de lapetición POST</strong></li><li>Los parámetros deben estar incluidos en una colección (formatoJSON)</li><li>Todos los tipos de datos escalares soportados en lascolecciones JSON pueden ser pasados como parámetros.</li><li>La selección de entidades y la entidad se pueden pasar comoparámetros. El objeto JSON debe contener atributos específicosutilizados por el servidor REST para asignar datos a los objetosORDA correspondientes: __DATACLASS, __ENTITY, __ENTITIES,__DATASET.</li></ul><p>Ver <a href="#classFunctions.html_request-receiving-an-entity-as-parameter">esteejemplo</a> y <a href="#classFunctions.html_request-receiving-an-entity-selection-as-parameter">este ejemplo</a>.</p><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_par%C3%A1metro-de-valor-escalar"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_par%25C3%25A1metro-de-valor-escalar"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Parámetro de valor escalar</h3><p>El(los) parámetros deben estar simplemente incluirse en unacolección definida en el cuerpo. Por ejemplo, con una función dedataclass <code>getCities()</code> que recibe parámetros de tipotexto: <code>/rest/City/getCities</code></p><p><strong>Parámetros en el cuerpo:</strong> ["Aguada","Paris"]</p><p>Todos los tipos de datos JSON son soportados en los parámetros,incluidos los punteros JSON. Las fechas se pueden pasar comocadenas en formato de fecha ISO 8601 (por ejemplo,"2020-08-22T22:00:000Z").</p><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_par%C3%A1metro-de-entidad"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_par%25C3%25A1metro-de-entidad"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Parámetro de entidad</h3><p>Las entidades pasadas en los parámetros son referenciadas en elservidor a través de su llave (<em>es decir,</em> propiedad __KEY).Si el parámetro llave se omite en una petición, una nueva entidadse carga en memoria del servidor. También puede pasar valores paratodos los atributos de la entidad. Estos valores se utilizaránautomáticamente para la entidad manejada en el servidor.</p><blockquote><p>Si la petición envía los valores de atributo modificados parauna entidad existente en el servidor, la función de modelo de datosORDA llamada se ejecutará automáticamente en el servidor con losvalores modificados. Esta funcionalidad le permite, por ejemplo,verificar el resultado de una operación en una entidad, trasaplicar todas las reglas de negocio, desde la aplicación cliente. Acontinuación, puede decidir guardar o no la entidad en elservidor.</p></blockquote><table><thead><tr><th>Propiedades</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>Atributos de la entidad</td><td>mixto</td><td>Opcional - Valores a modificar</td></tr><tr><td>__DATACLASS</td><td>Cadena</td><td>Obligatorio - Indica la Dataclass de la entidad</td></tr><tr><td>__ENTITY</td><td>Booleano</td><td>Obligatorio - True para indicar al servidor que el parámetro esuna entidad</td></tr><tr><td>__KEY</td><td>mixto (mismo tipo que la llave primaria)</td><td>Opcional - llave primaria de la entidad</td></tr></tbody></table><ul><li>Si no se proporciona __KEY, se crea una nueva entidad en elservidor con los atributos dados.</li><li>Si se proporciona __KEY, la entidad correspondiente a __KEY secarga en el servidor con los atributos dados</li></ul><p>Ver los ejemplos de <a href="#classFunctions.html_creating-an-entity">creación</a> o de<a href="#classFunctions.html_updating-an-entity">actualización</a>de las entidades.</p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_par%C3%A1metro-de-entidad-asociado"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_par%25C3%25A1metro-de-entidad-asociado"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Parámetro de entidad asociado</h4><p>Las mismas propiedades que para un <a href="#classFunctions.html_entity-parameter">parámetro de entidad</a>.Además, la entidad relacionada debe existir y ser referenciada por__KEY, que contiene su llave primaria.</p><p>Ver los ejemplos para <a href="#classFunctions.html_creating-an-entity-with-a-related-entity">creación</a>o <a href="#classFunctions.html_updating-an-entity-with-a-related-entity">actualización</a>de las entidades con las entidades relacionadas.</p><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_par%C3%A1metro-de-selecci%C3%B3n-de-entidad"></a><a aria-hidden="true"class="hash-link" href="#classFunctions.html_par%25C3%25A1metro-de-selecci%25C3%25B3n-de-entidad"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Parámetro de selección de entidad</h3><p>La selección de entidades debe haber sido definida previamenteutilizando <a href="#classFunctions.html_methodentityset">$method=entityset</a>.</p><blockquote><p>Si la petición envía una selección de entidades modificada alservidor, la función del modelo de datos ORDA llamada se ejecutaráautomáticamente en el servidor con la selección de entidadesmodificada.</p></blockquote><table><thead><tr><th>Propiedades</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>Atributos de la entidad</td><td>mixto</td><td>Opcional - Valores a modificar</td></tr><tr><td>__DATASET</td><td>Cadena</td><td>Obligatorio - entitySetID (UUID) de la selección deentidades</td></tr><tr><td>__ENTITIES</td><td>Booleano</td><td>Obligatorio - True para indicar al servidor que el parámetro esuna selección de entidades</td></tr></tbody></table><p>Ver ejemplo para <a href="#classFunctions.html_receiving-an-entity-selection-as-parameter">recibiruna selección de entidades</a>.</p><h2><a aria-hidden="true" class="anchor" id="classFunctions.html_ejemplos-de-peticiones"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_ejemplos-de-peticiones"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplos de peticiones</h2><p>Esta base de datos se expone como un almacén de datos remoto enlocalhost (puerto 8111):</p><p><img alt="alt-text" src="https://developer.4d.com/docs/Rx/assets/en/REST/ordastructure.png" /></p><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utilizar-una-funci%C3%B3n-de-clase-de-datastore"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_utilizar-una-funci%25C3%25B3n-de-clase-de-datastore"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utilizar una función de clase de datastore</h3><p>La clase de <code>DataStore</code> US_Cities ofrece una API:</p><pre><code class="hljs">// DataStore <span class="hljs-class"><span class="hljs-keyword">class</span></span><span class="hljs-class"><span class="hljs-keyword">Class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">DataStoreImplementation</span></span>exposed <span class="hljs-function"><span class="hljs-keyword">Function</span> <span class="hljs-title">getName</span>(</span>)    <span class="hljs-number">$0</span>:=<span class="hljs-string">"US cities and zip codes manager"</span> </code></pre><p>A continuación, puede ejecutar esta petición:</p><p><strong>POST</strong><code>127.0.0.1:8111/rest/$catalog/getName</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_resultado"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_resultado"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><pre><code class="hljs">{<span class="hljs-attr">"result"</span>: <span class="hljs-string">"US cities and zip codes manager"</span> }</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utilizar-una-funci%C3%B3n-de-clase-de-dataclass"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_utilizar-una-funci%25C3%25B3n-de-clase-de-dataclass"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utilizar una función de clase de dataclass</h3><p>La clase de Dataclass <code>City</code> ofrece una PI quedevuelve una entidad de ciudad a partir del nombre pasado enparámetro:</p><pre><code class="hljs"><span class="hljs-comment">// City class</span><span class="hljs-keyword">Class extends</span> DataClass<span class="hljs-function">exposed Function getCity</span>()<span class="hljs-keyword">    var</span> <span class="hljs-variable">$0 </span>: cs.CityEntity<span class="hljs-keyword">    var</span> <span class="hljs-variable">$1</span>,<span class="hljs-variable">$nameParam </span>: text    <span class="hljs-variable">$nameParam</span>:=<span class="hljs-variable">$1</span>    <span class="hljs-variable">$0</span>:=<span class="hljs-literal">This</span>.<span class="hljs-function">query</span>(<span class="hljs-string">"name = :1"</span>;<span class="hljs-variable">$nameParam</span>).<span class="hljs-function">first</span>()</code></pre><p>A continuación, puede ejecutar esta petición:</p><p><strong>POST</strong><code>127.0.0.1:8111/rest/City/getCity</code></p><p>Petición: ["Aguada"]</p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_resultado-1"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_resultado-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><p>El resultado es una entidad:</p><pre><code class="hljs">{    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"City"</span>,    <span class="hljs-attr">"__DATACLASS"</span>: <span class="hljs-string">"City"</span>,    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"1"</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"2020-03-09T08:03:19.923Z"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"name"</span>: <span class="hljs-string">"Aguada"</span>,    <span class="hljs-attr">"countyFIPS"</span>: <span class="hljs-number">72003</span>,    <span class="hljs-attr">"county"</span>: {        <span class="hljs-attr">"__deferred"</span>: {            <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"/rest/County(72003)"</span>,            <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"72003"</span>         }    },    <span class="hljs-attr">"zips"</span>: {        <span class="hljs-attr">"__deferred"</span>: {            <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"/rest/City(1)/zips?$expand=zips"</span>         }    }}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utilizar-una-funci%C3%B3n-de-clase-de-una-entidad"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_utilizar-una-funci%25C3%25B3n-de-clase-de-una-entidad"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utilizar una función de clase de una entidad</h3><p>La clase de entidad <code>CityEntity</code> ofrece una API:</p><pre><code class="hljs">// CityEntity <span class="hljs-class"><span class="hljs-keyword">class</span></span><span class="hljs-class"><span class="hljs-keyword">Class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Entity</span></span>exposed <span class="hljs-function"><span class="hljs-keyword">Function</span> <span class="hljs-title">getPopulation</span>(</span>)    <span class="hljs-number">$0</span>:=This.zips.sum(<span class="hljs-string">"population"</span>)</code></pre><p>A continuación, puede ejecutar esta petición:</p><p><strong>POST</strong><code>127.0.0.1:8111/rest/City(2)/getPopulation</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_resultado-2"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_resultado-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: <span class="hljs-number">48814</span>}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utilizar-una-funci%C3%B3n-clase-entityselection"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_utilizar-una-funci%25C3%25B3n-clase-entityselection"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utilizar una función clase entitySelection</h3><p>La clase de selección de entidad <code>CityEntity</code> ofreceuna API:</p><pre><code class="hljs">// CitySelection <span class="hljs-class"><span class="hljs-keyword">class</span></span><span class="hljs-class"><span class="hljs-keyword">Class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EntitySelection</span></span>exposed <span class="hljs-function"><span class="hljs-keyword">Function</span> <span class="hljs-title">getPopulation</span>(</span>)    <span class="hljs-number">$0</span>:=This.zips.sum(<span class="hljs-string">"population"</span>)</code></pre><p>A continuación, puede ejecutar esta petición:</p><p><strong>POST</strong><code>127.0.0.1:8111/rest/City/getPopulation/?$filter="ID&lt;3"</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_resultado-3"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_resultado-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: <span class="hljs-number">87256</span>}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utilizar-una-funci%C3%B3n-de-clase-de-selecci%C3%B3n-de-entidades-y-un-conjunto-de-entidades"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_utilizar-una-funci%25C3%25B3n-de-clase-de-selecci%25C3%25B3n-de-entidades-y-un-conjunto-de-entidades"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utilizar una función de clase de selección de entidades yun conjunto de entidades</h3><p>La clase <code>StudentsSelection</code> tine una función<code>getAgeAverage</code>:</p><pre><code class="hljs"><span class="hljs-comment">// StudentsSelection Class</span><span class="hljs-keyword">Class extends</span> EntitySelectionexposed<span class="hljs-keyword"> Function</span> getAgeAverage<span class="hljs-function">    C_LONGINT</span>(<span class="hljs-variable">$sum</span>;<span class="hljs-variable">$0</span>)<span class="hljs-function">    C_OBJECT</span>(<span class="hljs-variable">$s</span>)    <span class="hljs-variable">$sum</span>:=<span class="hljs-number">0</span><span class="hljs-keyword">    For each</span> (<span class="hljs-variable">$s</span>;<span class="hljs-literal">This</span>)        <span class="hljs-variable">$sum</span>:=<span class="hljs-variable">$sum</span>+<span class="hljs-variable">$s</span>.<span class="hljs-function">age</span>()<span class="hljs-keyword">    End for each</span>     <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$sum</span>/<span class="hljs-literal">This</span>.length</code></pre><p>Una vez que haya creado un conjunto de entidades, puede ejecutaresta petición:</p><p><strong>POST</strong><code>127.0.0.1:8044/rest/Students/getAgeAverage/$entityset/17E83633FFB54ECDBF947E5C620BB532</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_resultado-4"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_resultado-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: <span class="hljs-number">34</span>}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utilizar-una-funci%C3%B3n-de-clase-de-selecci%C3%B3n-de-entidades-y-unorderby"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_utilizar-una-funci%25C3%25B3n-de-clase-de-selecci%25C3%25B3n-de-entidades-y-unorderby"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utilizar una función de clase de selección de entidades yunorderBy</h3><p>La clase <code>StudentsSelection</code> tiene una función<code>getLastSummary</code>:</p><pre><code class="hljs"><span class="hljs-comment">// StudentsSelection Class</span><span class="hljs-keyword">Class extends</span> EntitySelectionexposed<span class="hljs-keyword"> Function</span> getLastSummary<span class="hljs-function">    C_TEXT</span>(<span class="hljs-variable">$0</span>)<span class="hljs-function">    C_OBJECT</span>(<span class="hljs-variable">$last</span>)    <span class="hljs-variable">$last</span>:=<span class="hljs-literal">This</span>.<span class="hljs-function">last</span>()    <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$last</span>.firstname+<span class="hljs-string">" - "</span>+<span class="hljs-variable">$last</span>.lastname+<span class="hljs-string">" is ... "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$last</span>.<span class="hljs-function">age</span>())</code></pre><p>A continuación, puede ejecutar esta petición:</p><p><strong>POST</strong><code>127.0.0.1:8044/rest/Students/getLastSummary/$entityset/?$filter="lastname=b@"&amp;$orderby="lastname"</code></p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_resultado-5"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_resultado-5"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: <span class="hljs-string">"Wilbert - Bull is ... 21"</span> }</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utilizar-una-entidad-que-se-crear%C3%A1-en-el-servidor"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_utilizar-una-entidad-que-se-crear%25C3%25A1-en-el-servidor"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utilizar una entidad que se creará en el servidor</h3><p>La clase de Dataclass <code>Students</code> tiene la función<code>pushData()</code> que recibe una entidad que contiene losdatos del cliente. El método <code>checkData()</code> efectúaalgunos controles. Si son válidos, la entidad se guarda y sedevuelve.</p><pre><code class="hljs"><span class="hljs-comment">// Students Class</span><span class="hljs-keyword">Class extends</span> DataClassexposed<span class="hljs-keyword"> Function</span> pushData<span class="hljs-keyword">    var</span> <span class="hljs-variable">$1</span>, <span class="hljs-variable">$entity</span>, <span class="hljs-variable">$status</span>, <span class="hljs-variable">$0 </span>: Object    <span class="hljs-variable">$entity</span>:=<span class="hljs-variable">$1</span>    <span class="hljs-variable">$status</span>:=<span class="hljs-function">checkData</span>(<span class="hljs-variable">$entity</span>) <span class="hljs-comment">// $status es un objeto con una propiedad booleana "success"</span>    <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$status</span><span class="hljs-keyword">    If</span> (<span class="hljs-variable">$status</span>.success)        <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$entity</span>.<span class="hljs-function">save</span>()<span class="hljs-keyword">       If</span> (<span class="hljs-variable">$status</span>.success)           <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$entity</span><span class="hljs-keyword">      End if</span><span class="hljs-keyword">     End if</span></code></pre><p>Lance esta petición:</p><p><strong>POST</strong><code>http://127.0.0.1:8044/rest/Students/pushData</code></p><p>Cuerpo de la petición:</p><pre><code class="hljs">[{<span class="hljs-attr">"__DATACLASS"</span>:<span class="hljs-string">"Students"</span>,<span class="hljs-attr">"__ENTITY"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"firstname"</span>:<span class="hljs-string">"Ann"</span>,<span class="hljs-attr">"lastname"</span>:<span class="hljs-string">"Brown"</span> }]</code></pre><p>Como ninguna <code>__KEY</code> es dada, una nueva entidadStudents está cargada en el servidor <strong>con los atributos delcliente</strong>. Como la función <code>pushData()</code> ejecutauna acción <code>save()</code>, la nueva entidad es creada.</p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_resultado-6"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_resultado-6"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><pre><code class="hljs">{    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__DATACLASS"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"55"</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"2020-06-16T10:54:41.805Z"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">55</span>,    <span class="hljs-attr">"firstname"</span>: <span class="hljs-string">"Ann"</span>,    <span class="hljs-attr">"lastname"</span>: <span class="hljs-string">"BROWN"</span>,    <span class="hljs-attr">"schoolID"</span>: <span class="hljs-literal">null</span>,    <span class="hljs-attr">"school"</span>: <span class="hljs-literal">null</span>}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utilizar-una-entidad-a-actualizar-en-el-servidor"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_utilizar-una-entidad-a-actualizar-en-el-servidor"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utilizar una entidad a actualizar en el servidor</h3><p>Igual que el anterior pero con el atributo __KEY</p><p>Lance esta petición:</p><p><strong>POST:</strong><code>http://127.0.0.1:8044/rest/Students/pushData</code></p><p>Cuerpo de la petición:</p><pre><code class="hljs">[{<span class="hljs-attr">"__DATACLASS"</span>:<span class="hljs-string">"Students"</span>,<span class="hljs-attr">"__ENTITY"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"lastname"</span>:<span class="hljs-string">"Brownie"</span>,<span class="hljs-attr">"__KEY"</span>:<span class="hljs-number">55</span>}]</code></pre><p>Como <code>__KEY</code> es dada, la entidad Students estácargada con llave primaria 55 <strong>con el valor lastnamerecibido por el cliente</strong>. Como la función ejecuta unaacción <code>save()</code>, la nueva entidad es actualizada.</p><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_resultado-7"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_resultado-7"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><pre><code class="hljs">{    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__DATACLASS"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"55"</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"2020-06-16T11:10:21.679Z"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">3</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">55</span>,    <span class="hljs-attr">"firstname"</span>: <span class="hljs-string">"Ann"</span>,    <span class="hljs-attr">"lastname"</span>: <span class="hljs-string">"BROWNIE"</span>,    <span class="hljs-attr">"schoolID"</span>: <span class="hljs-literal">null</span>,    <span class="hljs-attr">"school"</span>: <span class="hljs-literal">null</span> }</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_crear-una-entidad-con-una-entidad-relacionada"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_crear-una-entidad-con-una-entidad-relacionada"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Crear una entidad con una entidad relacionada</h3><p>En este ejemplo, creamos una nueva entidad Students con laentidad Schools con la llave primaria 2.</p><p>Lance esta petición:</p><p><strong>POST:</strong><code>http://127.0.0.1:8044/rest/Students/pushData</code></p><p>Cuerpo de la petición:</p><pre><code class="hljs">[{<span class="hljs-attr">"__DATACLASS"</span>:<span class="hljs-string">"Students"</span>,<span class="hljs-attr">"__ENTITY"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"firstname"</span>:<span class="hljs-string">"John"</span>,<span class="hljs-attr">"lastname"</span>:<span class="hljs-string">"Smith"</span>,<span class="hljs-attr">"school"</span>:{<span class="hljs-attr">"__KEY"</span>:<span class="hljs-number">2</span>}}]</code></pre><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_resultado-8"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_resultado-8"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><pre><code class="hljs">{    <span class="hljs-attr">"__entityModel"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__DATACLASS"</span>: <span class="hljs-string">"Students"</span>,    <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"56"</span>,    <span class="hljs-attr">"__TIMESTAMP"</span>: <span class="hljs-string">"2020-06-16T11:16:47.601Z"</span>,    <span class="hljs-attr">"__STAMP"</span>: <span class="hljs-number">1</span>,    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">56</span>,    <span class="hljs-attr">"firstname"</span>: <span class="hljs-string">"John"</span>,    <span class="hljs-attr">"lastname"</span>: <span class="hljs-string">"SMITH"</span>,    <span class="hljs-attr">"schoolID"</span>: <span class="hljs-number">2</span>,       <span class="hljs-attr">"school"</span>: {        <span class="hljs-attr">"__deferred"</span>: {            <span class="hljs-attr">"uri"</span>: <span class="hljs-string">"/rest/Schools(2)"</span>,            <span class="hljs-attr">"__KEY"</span>: <span class="hljs-string">"2"</span>         }    }}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_actualizar-una-entidad-con-una-entidad-relacionada"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_actualizar-una-entidad-con-una-entidad-relacionada"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Actualizar una entidad con una entidad relacionada</h3><p>En este ejemplo, asociamos una escuela existente a una entidadStudents. La clase <code>StudentsEntity</code> tiene una API:</p><pre><code class="hljs"><span class="hljs-comment">// StudentsEntity class</span><span class="hljs-keyword">Class extends</span> Entity<span class="hljs-function">exposed Function putToSchool</span>()<span class="hljs-keyword">    var</span> <span class="hljs-variable">$1</span>, <span class="hljs-variable">$school </span>, <span class="hljs-variable">$0</span>, <span class="hljs-variable">$status </span>: Object        <span class="hljs-comment">//$1 es una entidad Schools</span>    <span class="hljs-variable">$school</span>:=<span class="hljs-variable">$1</span>        <span class="hljs-comment">//Asocia la entidad relacionada "school" con la entidad actual "Students"</span>    <span class="hljs-literal">This</span>.school:=<span class="hljs-variable">$school</span>    <span class="hljs-variable">$status</span>:=<span class="hljs-literal">This</span>.<span class="hljs-function">save</span>()    <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$status</span></code></pre><p>Se ejecuta esta petición, llamada en una entidad Students:<strong>POST</strong><code>http://127.0.0.1:8044/rest/Students(1)/putToSchool</code>Cuerpo de la petición:</p><pre><code class="hljs">[{<span class="hljs-attr">"__DATACLASS"</span>:<span class="hljs-string">"Schools"</span>,<span class="hljs-attr">"__ENTITY"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"__KEY"</span>:<span class="hljs-number">2</span>}]</code></pre><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_resultado-9"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_resultado-9"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: {        <span class="hljs-attr">"success"</span>: <span class="hljs-literal">true</span>    }}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_recibir-una-selecci%C3%B3n-de-entidades-como-par%C3%A1metro"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_recibir-una-selecci%25C3%25B3n-de-entidades-como-par%25C3%25A1metro"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Recibir una selección de entidades como parámetro</h3><p>En la clase de Dataclass <code>Students</code>, la función<code>setFinalExam()</code> actualiza una selección de entidadrecibida ($1). En realidad, actualiza el atributo<em>finalExam</em> con el valor recibido ($2). Devuelve las llavesprimarias de las entidades actualizadas.</p><pre><code class="hljs"><span class="hljs-comment">// Students class</span><span class="hljs-keyword">Class extends</span> DataClass<span class="hljs-function">exposed Function setFinalExam</span>()<span class="hljs-keyword">    var</span> <span class="hljs-variable">$1</span>, <span class="hljs-variable">$es</span>, <span class="hljs-variable">$student</span>, <span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">    var</span> <span class="hljs-variable">$2</span>, <span class="hljs-variable">$examResult </span>: Text<span class="hljs-keyword">    var</span> <span class="hljs-variable">$keys</span>, <span class="hljs-variable">$0 </span>: Collection      <span class="hljs-comment">//Entity selection</span>    <span class="hljs-variable">$es</span>:=<span class="hljs-variable">$1</span>    <span class="hljs-variable">$examResult</span>:=<span class="hljs-variable">$2</span>    <span class="hljs-variable">$keys</span>:=<span class="hljs-function">New collection</span>()      <span class="hljs-comment">//Bucle en la selección de entidades</span><span class="hljs-keyword">    For each</span> (<span class="hljs-variable">$student</span>;<span class="hljs-variable">$es</span>)        <span class="hljs-variable">$student</span>.finalExam:=<span class="hljs-variable">$examResult</span>        <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$student</span>.<span class="hljs-function">save</span>()<span class="hljs-keyword">        If</span> (<span class="hljs-variable">$status</span>.success)            <span class="hljs-variable">$keys</span>.<span class="hljs-function">push</span>(<span class="hljs-variable">$student</span>.ID)<span class="hljs-keyword">        End if</span><span class="hljs-keyword">     End for each</span>     <span class="hljs-variable">$0</span>:=<span class="hljs-variable">$keys</span></code></pre><p>Un conjunto de entidades se crea primero con esta petición:</p><p><code>http://127.0.0.1:8044/rest/Students/?$filter="ID&lt;3"&amp;$method=entityset</code></p><p>A continuación, puede ejecutar esta petición:</p><p><strong>POST</strong><code>http://127.0.0.1:8044/rest/Students/setFinalExam</code></p><p>Cuerpo de la petición:</p><pre><code class="hljs">[{<span class="hljs-attr">"__ENTITIES"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">"__DATASET"</span>:<span class="hljs-string">"9B9C053A111E4A288E9C1E48965FE671"</span> },<span class="hljs-string">"Passed"</span> ]</code></pre><h4><a aria-hidden="true" class="anchor" id="classFunctions.html_resultado-10"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_resultado-10"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><p>Se han actualizado las entidades con llaves primarias 1 y 2.</p><pre><code class="hljs">{    <span class="hljs-attr">"result"</span>: [        <span class="hljs-number">1</span>,        <span class="hljs-number">2</span>    ]}</code></pre><h3><a aria-hidden="true" class="anchor" id="classFunctions.html_utilizar-una-selecci%C3%B3n-de-entidades-actualizada-en-el-cliente"></a><a aria-hidden="true" class="hash-link" href="#classFunctions.html_utilizar-una-selecci%25C3%25B3n-de-entidades-actualizada-en-el-cliente"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utilizar una selección de entidades actualizada en elcliente</h3><p>Utilizando la función <code>getAgeAverage()</code> <a href="#classFunctions.html_using-an-entityselection-class-function-and-an-entityset">definida anteriormente</a>.</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$remoteDS</span>, <span class="hljs-variable">$newStudent</span>, <span class="hljs-variable">$students </span>: Object<span class="hljs-keyword">var</span> <span class="hljs-variable">$ageAverage </span>: Integer<span class="hljs-variable">$remoteDS</span>:=<span class="hljs-function">Open datastore</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"hostname"</span>;<span class="hljs-string">"127.0.0.1:8044"</span>);<span class="hljs-string">"students"</span>)<span class="hljs-comment">// $newStudent es una entidad "student" a procesar</span><span class="hljs-variable">$newStudent</span>:=...<span class="hljs-variable">$students</span>:=<span class="hljs-variable">$remoteDS</span>.Students.<span class="hljs-function">query</span>(<span class="hljs-string">"school.name = :1"</span>;<span class="hljs-string">"Math school"</span>)<span class="hljs-comment">// Hemos añadido una entidad a la selección de entidades $students en el cliente</span><span class="hljs-variable">$students</span>.<span class="hljs-function">add</span>(<span class="hljs-variable">$newStudent</span>) <span class="hljs-comment">// Llamamos a una función en la clase StudentsSelection que devuelve la edad media de los estudiantes en la selección de entidades</span><span class="hljs-comment">// La función se utiliza en el servidor en la selección de la entidad $students actualizada, que incluye el estudiante añadido por el cliente</span><span class="hljs-variable">$ageAverage</span>:=<span class="hljs-variable">$students</span>.<span class="hljs-function">getAgeAverage</span>()</code></pre></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#manData.html"><span class="arrow-prev">←</span><span>Manipulación de datos</span></a><a class="docs-next button"href="#REST_requests.html"><span>Acerca de las peticionesREST</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#classFunctions.html_llamadas-de-las-funciones">Llamadas de lasfunciones</a></li><li><a href="#classFunctions.html_par%25C3%25A1metros">Parámetros</a><ul class="toc-headings"><li><a href="#classFunctions.html_par%25C3%25A1metro-de-valor-escalar">Parámetrode valor escalar</a></li><li><a href="#classFunctions.html_par%25C3%25A1metro-de-entidad">Parámetro deentidad</a></li><li><a href="#classFunctions.html_par%25C3%25A1metro-de-selecci%25C3%25B3n-de-entidad">Parámetro de selección de entidad</a></li></ul></li><li><a href="#classFunctions.html_ejemplos-de-peticiones">Ejemplosde peticiones</a><ul class="toc-headings"><li><a href="#classFunctions.html_utilizar-una-funci%25C3%25B3n-de-clase-de-datastore">Utilizar una función de clase de datastore</a></li><li><a href="#classFunctions.html_utilizar-una-funci%25C3%25B3n-de-clase-de-dataclass">Utilizar una función de clase de dataclass</a></li><li><a href="#classFunctions.html_utilizar-una-funci%25C3%25B3n-de-clase-de-una-entidad">Utilizar una función de clase de una entidad</a></li><li><a href="#classFunctions.html_utilizar-una-funci%25C3%25B3n-clase-entityselection">Utilizar una función clase entitySelection</a></li><li><a href="#classFunctions.html_utilizar-una-funci%25C3%25B3n-de-clase-de-selecci%25C3%25B3n-de-entidades-y-un-conjunto-de-entidades">Utilizar una función de clase de selección de entidades y unconjunto de entidades</a></li><li><a href="#classFunctions.html_utilizar-una-funci%25C3%25B3n-de-clase-de-selecci%25C3%25B3n-de-entidades-y-unorderby">Utilizar una función de clase de selección de entidades yunorderBy</a></li><li><a href="#classFunctions.html_utilizar-una-entidad-que-se-crear%25C3%25A1-en-el-servidor">Utilizar una entidad que se creará en el servidor</a></li><li><a href="#classFunctions.html_utilizar-una-entidad-a-actualizar-en-el-servidor">Utilizar una entidad a actualizar en el servidor</a></li><li><a href="#classFunctions.html_crear-una-entidad-con-una-entidad-relacionada">Crear una entidad con una entidad relacionada</a></li><li><a href="#classFunctions.html_actualizar-una-entidad-con-una-entidad-relacionada">Actualizar una entidad con una entidad relacionada</a></li><li><a href="#classFunctions.html_recibir-una-selecci%25C3%25B3n-de-entidades-como-par%25C3%25A1metro">Recibir una selección de entidades como parámetro</a></li><li><a href="#classFunctions.html_utilizar-una-selecci%25C3%25B3n-de-entidades-actualizada-en-el-cliente">Utilizar una selección de entidades actualizada en elcliente</a></li></ul></li></ul></nav></div></div></body></html>