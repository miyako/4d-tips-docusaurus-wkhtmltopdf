<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="es"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>IMAPTransporter · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="La clase `IMAPTransporter` permite recuperar mensajes de un servidor de mensajería IMAP."name="description" /><meta content="es" name="docsearch:language" /><meta content="IMAPTransporter · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="La clase `IMAPTransporter` permite recuperar mensajes de un servidor de mensajería IMAP."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#IMAPTransporterClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">IMAPTransporter<a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html"></a></h1></header><article><div><p><span>La clase <code>IMAPTransporter</code> permite recuperarmensajes de un servidor de mensajería IMAP.</span></p><h3><span><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_objeto-imap-transporter"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_objeto-imap-transporter"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Objeto IMAP Transporter</span></h3><p><span>Los objetos IMAP Transporter se instancian con el comando<a href="#IMAPTransporterClass.html_imap-new-transporter">IMAP Newtransporter</a>. Ofrecen las siguientes propiedades yfunciones:</span></p><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#IMAPTransporterClass.html_acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong>:Boolean</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>True</strong> si se permite a 4Destablecer una conexión no cifrada</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_addflags"><strong>.addFlags</strong>(<em>msgIDs</em> : Collection ; <em>keywords</em> : Object ) :Object<br /><strong>.addFlags</strong>( <em>msgIDs</em> : Text ;<em>keywords</em> : Object ) : Object<br /><strong>.addFlags</strong>( <em>msgIDs</em> : Longint ;<em>keywords</em> : Object ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;añade banderas a los <code>msgIDs</code>para las <code>keywords</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_append"><strong>.append</strong>(<em>mailObj</em> : Object ; <em>destinationBox</em> : Text ;<em>options</em> : Object ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;añade el objeto <code>mailObj</code> ala caja <code>destinationBox</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_authenticationmode"><strong>.authenticationMode</strong>:Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;el modo de autenticación utilizado paraabrir la sesión en el servidor de correo</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_checkconnection"><strong>.checkConnection()</strong>: Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp; comprueba la conexión utilizando lainformación almacenada en el objeto transporter</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_checkconnectiondelay"><strong>.checkConnectionDelay</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;duración máxima (en segundos) permitidaantes de verificar la conexión al servidor</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_connectiontimeout"><strong>.connectionTimeOut</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;el tiempo máximo de espera (en segundos)permitido para establecer una conexión con el servidor</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_copy"><strong>.copy</strong>(<em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) :Object<br /><strong>.copy</strong>( <em>allMsgs</em> : Integer ;<em>destinationBox</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;copia los mensajes definidos en<em>msgsIDs</em> o <em>allMsgs</em> en la <em>destinationBox</em>en el servidor IMAP</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_createbox"><strong>.createBox</strong>(<em>name</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;crea un buzón con el <code>name</code>pasado</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_delete"><strong>.delete</strong>(<em>msgsIDs</em> : Collection ) : Object<br /><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;asocia el marcador "deleted" a losmensajes designados por <code>msgsIDs</code> o<code>allMsgs</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_deletebox"><strong>.deleteBox</strong>(<em>name</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;elimina definitivamente el buzón llamado<code>name</code> en el servidor IMAP</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_expunge"><strong>.expunge()</strong> :Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;elimina todos los mensajes con elmarcador "deleted" del servidor de correo IMAP.</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getboxinfo"><strong>.getBoxInfo</strong>({ <em>name</em> : Text }) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;devuelve un objeto <code>boxInfo</code>correspondiente al buzón de recepción actual o al buzón llamado<em>name</em></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getboxlist"><strong>.getBoxList</strong>({ <em>parameters</em> : Object } ) : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;devuelve una colección de bandejas deentrada que describe todas las bandejas de entrada disponibles</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getdelimiter"><strong>.getDelimiter()</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;devuelve el carácter utilizado paradelimitar los niveles de jerarquía en el nombre del buzón</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getmail"><strong>.getMail</strong>(<em>msgNumber</em>: Integer { ; <em>options</em> : Object } ) :Object<br /><strong>.getMail</strong>( <em>msgID</em>: Text { ;<em>options</em> : Object } ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;devuelve el objeto <code>Email</code>correspondiente al <em>msgNumber</em> o <em>msgID</em> en el buzóndesignado por <code>IMAP_transporter</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getmails"><strong>.getMails</strong>(<em>ids</em> : Collection { ; <em>options</em> : Object } ) :Object<br /><strong>.getMails</strong>( <em>startMsg</em> : Integer ;<em>endMsg</em> : Integer { ; <em>options</em> : Object } ) :Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;devuelve un objeto que contiene unacolección de objetos <code>Email</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_getmimeasblob"><strong>.getMIMEAsBlob</strong>(<em>msgNumber</em> : Integer { ; <em>updateSeen</em> : Boolean } ): Blob<br /><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ;<em>updateSeen</em> : Boolean } ) : Blob</a><p>&nbsp;&nbsp;&nbsp;&nbsp;devuelve un BLOB con el contenido MIMEdel mensaje correspondiente al <em>msgNumber</em> o <em>msgID</em>en el buzón designado por el <code>IMAP_transporter</code></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_host"><strong>.host</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;el nombre o la dirección IP del servidorlocal</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_logfile"><strong>.logFile</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;la ruta del archivo de registroextendido definido (si existe) para la conexión de correo</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_move"><strong>.move</strong>(<em>msgsIDs</em> : Collection ; <em>destinationBox</em> : Text ) :Object<br /><strong>.move</strong>( <em>allMsgs</em> : Integer ;<em>destinationBox</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;mueve los mensajes definidos en<em>msgsIDs</em> o <em>allMsgs</em> a la <em>destinationBox</em>enel servidor IMAP</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_numtoid"><strong>.numToID</strong>(<em>startMsg</em> : Integer ; <em>endMsg</em> : Integer ) :Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;convierte los números de secuencia enIDs únicos IMAP para los mensajes en el rango secuencial designadopor <em>startMsg</em> y <em>endMsg</em></p></td></tr><tr><td><a href="#IMAPTransporterClass.html_removeflags"><strong>.removeFlags</strong>(<em>msgIDs</em> : Collection ; <em>keywords</em> : Object ) :Object<br /><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ;<em>keywords</em> : Object ) : Object<br /><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ;<em>keywords</em> : Object ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;elimina las banderas de los<code>msgIDs&lt;</code> para las <code>keywords</code>definidas</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_renamebox"><strong>.renameBox</strong>(<em>currentName</em> : Text ; <em>newName</em> : Text ) :Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;cambia el nombre de un buzón en elservidor IMAP</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_port"><strong>.port</strong> :Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp; el número de puerto utilizado para lastransacciones de correo</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_searchmails"><strong>.searchMails</strong>(<em>searchCriteria</em> : Text ) : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp;busca los mensajes que coincidan con el<em>searchCriteria</em> en el buzón actual</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_selectbox"><strong>.selectBox</strong>(<em>name</em> : Text { ; <em>state</em> : Integer } ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;selecciona el buzón <em>name</em> comoel buzón actual</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_subscribe"><strong>.subscribe</strong>(<em>name</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;permite añadir o eliminar el buzónespecificado del conjunto de buzones "suscritos" en el servidorIMAP</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_unsubscribe"><strong>.unsubscribe</strong>(<em>name</em> : Text ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp;elimina un buzón de un conjunto debuzones suscritos</p></td></tr><tr><td><a href="#IMAPTransporterClass.html_user"><strong>.user</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; el nombre de usuario utilizado para laautenticación en el servidor de correo</p></td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_imap-new-transporter"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_imap-new-transporter"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>IMAP New transporter</span></h2><details><summary><span>Histórico</span></summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R4</td><td>Añadidos</td></tr></tbody></table></details><p><span><strong>IMAP New transporter</strong>( <em>server</em> :Object ) : 4D.IMAPTransporter</span></p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>server</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Información del servidor de correo</td></tr><tr><td>Resultado</td><td>4D.IMAPTransporter</td><td style="text-align:center">&lt;-</td><td><a href="#IMAPTransporterClass.html_imap-transporter-object">Objeto IMAPTransporter</a></td></tr></tbody></table><h4><span><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</span></h4><p><span>El comando <code>IMAP New transporter</code> configura unanueva conexión IMAP según el parámetro <em>server</em> y devuelveun nuevo objeto <em>transporter</em>. El objeto transportadordevuelto se utilizará normalmente para recibir correoselectrónicos.</span></p><p><span>En el parámetro <em>server</em>, pase un objeto quecontenga las siguientes propiedades:</span></p><table><thead><tr><th><em>server</em></th><th>Valor por defecto (si se omite)</th></tr></thead><tbody><tr><td><a href="#IMAPTransporterClass.html_acceptunsecureconnection"><strong>.acceptUnsecureConnection</strong>:Boolean</a><p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>True</strong> si se permite a 4Destablecer una conexión no cifrada</p></td><td>False</td></tr><tr><td>.<strong>accessTokenOAuth2</strong>: Text<br />.<strong>accessTokenOAuth2</strong>: Object<p>Cadena de texto u objeto token que representan las credencialesde autorización OAuth 2. Sólo se utiliza con OAUTH2<code>authenticationMode</code>. Si se utiliza<code>accessTokenOAuth2</code> pero se omite<code>authenticationMode</code>, se utiliza el protocolo OAuth 2(si el servidor lo permite). No se devuelve en el objeto<em><a href="#IMAPTransporterClass.html_imap-transporter-object">IMAPtransporter</a></em>.</p></td><td>ninguno</td></tr><tr><td><a href="#IMAPTransporterClass.html_authenticationmode"><strong>.authenticationMode</strong>:Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;el modo de autenticación utilizado paraabrir la sesión en el servidor de correo</p></td><td>se utiliza el modo de autenticación más seguro soportado por elservidor</td></tr><tr><td><a href="#IMAPTransporterClass.html_checkconnectiondelay"><strong>.checkConnectionDelay</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;duración máxima (en segundos) permitidaantes de verificar la conexión al servidor</p></td><td>300</td></tr><tr><td><a href="#IMAPTransporterClass.html_connectiontimeout"><strong>.connectionTimeOut</strong>: Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp;el tiempo máximo de espera (en segundos)permitido para establecer una conexión con el servidor</p></td><td>30</td></tr><tr><td><a href="#IMAPTransporterClass.html_host"><strong>.host</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;el nombre o la dirección IP del servidorlocal</p></td><td><em>obligatorio</em></td></tr><tr><td><a href="#IMAPTransporterClass.html_logfile"><strong>.logFile</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;la ruta del archivo de registroextendido definido (si existe) para la conexión de correo</p></td><td>ninguno</td></tr><tr><td>.<strong>password</strong> : Text<p>Contraseña del usuario para la autenticación en el servidor. Nose devuelve en el objeto <em><a href="#IMAPTransporterClass.html_imap-transporter-object">IMAPtransporter</a></em>.</p></td><td>ninguno</td></tr><tr><td><a href="#IMAPTransporterClass.html_port"><strong>.port</strong> :Integer</a><p>&nbsp;&nbsp;&nbsp;&nbsp; el número de puerto utilizado para lastransacciones de correo</p></td><td>993</td></tr><tr><td><a href="#IMAPTransporterClass.html_user"><strong>.user</strong> : Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; el nombre de usuario utilizado para laautenticación en el servidor de correo</p></td><td>ninguno</td></tr></tbody></table><blockquote><p><span><strong>Atención</strong>: asegúrese de que el tiempo deespera definido sea menor que el tiempo de espera del servidor, delo contrario el tiempo de espera del cliente seráinútil.</span></p></blockquote><h4><span><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_resultado"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_resultado"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</span></h4><p><span>La función devuelve un <a href="#IMAPTransporterClass.html_imap-transporter-object"><strong>IMAPtransporter</strong></a>. Todas las propiedades devueltas son<strong>de sólo lectura</strong>.</span></p><blockquote><p><span>La conexión IMAP se cierra automáticamente cuando sedestruye el objeto transportador.</span></p></blockquote><h4><span><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</span></h4><pre><span><code class="hljs css language-4d"><span class="hljs-variable">$server</span>:=New object<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span><span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span><span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span><span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span><span class="hljs-variable">$server</span>.logFile:=<span class="hljs-string">"LogTest.txt"</span> <span class="hljs-comment">//log a guardar en la carpeta Logs</span><span class="hljs-keyword">var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">checkConnection</span>()<span class="hljs-keyword">If</span>(<span class="hljs-function">Not</span>(<span class="hljs-variable">$status</span>.success))<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"An error occurred: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">End if</span></code></span></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_4dimaptransporternew"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_4dimaptransporternew"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4D.IMAPTransporter.new()</h2><p><strong>4D.IMAPTransporter.new</strong>( <em>server</em> :Object ) : 4D.IMAPTransporter</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>server</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Información del servidor de correo</td></tr><tr><td>Resultado</td><td>4D.IMAPTransporter</td><td style="text-align:center">&lt;-</td><td><a href="#IMAPTransporterClass.html_imap-transporter-object">Objeto IMAPTransporter</a></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-1"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>4D.IMAPTransporter.new()</code> crea y devuelveun nuevo objeto del tipo <code>4D.IMAPTransporter</code>. Esidéntico al comando <a href="#IMAPTransporterClass.html_imap-new-transporter"><code>IMAP Newtransporter</code></a> (acceso directo).</p><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_acceptunsecureconnection"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_acceptunsecureconnection"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.acceptUnsecureConnection</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17 R4</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.acceptUnsecureConnection</strong>: Boolean</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-2"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La propiedad <code>.acceptUnsecureConnection</code> contiene<strong>True</strong> si se permite a 4D establecer una conexión nocifrada cuando la conexión cifrada no es posible.</p><p>Contiene <strong>False</strong> si no se permiten las conexionesno cifradas, en cuyo caso se devuelve un error cuando no es posiblela conexión cifrada.</p><p>Los puertos seguros disponibles son:</p><ul><li><p>SMTP</p><ul><li>465: SMTPS</li><li>587 o 25: SMTP con actualización STARTTLS si lo soporta elservidor.</li></ul></li><li><p>IMAP</p><ul><li>143: Puerto IMAP no encriptado</li><li>993: IMAP con actualización STARTTLS si lo soporta elservidor</li></ul></li><li><p>POP3</p><ul><li>110: Puerto POP3 no encriptado</li><li>995: POP3 con actualización STARTTLS si lo soporta elservidor.</li></ul></li></ul><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_addflags"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_addflags"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.addFlags()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R6</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.addFlags</strong>( <em>msgIDs</em> : Collection ;<em>keywords</em> : Object ) : Object<br /><strong>.addFlags</strong>( <em>msgIDs</em> : Text ;<em>keywords</em> : Object ) : Object<br /><strong>.addFlags</strong>( <em>msgIDs</em> : Longint ;<em>keywords</em> : Object ) : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>msgIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de cadenas: identificadores únicos de mensajes(texto)<br />Texto: ID único de un mensaje<br />Longint (IMAP all): todos los mensajes del buzón seleccionado</td></tr><tr><td>keywords</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Banderas de palabras claves a añadir</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación addFlags</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-3"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.addFlags()</code> añade banderas a los<code>msgIDs</code> para las <code>keywords</code>.</p><p>En el parámetro <code>msgIDs</code>, puede pasar:</p><ul><li><p>una <em>collection</em> contiene los identificadores únicos demensajes específicos, o</p></li><li><p>el ID único (<em>texte</em>) de un solo mensaje o</p></li><li><p>la siguiente constante (<em>longint</em>) para todos losmensajes del buzón seleccionado:</p><table><thead><tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr></thead><tbody><tr><td>IMAP all</td><td>1</td><td>Seleccionar todos los mensajes del buzón seleccionado</td></tr></tbody></table></li></ul><p>El parámetro <code>keywords</code> le permite pasar un objetocon valores de palabras clave para las banderas específicas que seañadirán a <code>msgIDs</code>. Puede pasar cualquiera de lassiguientes palabras claves:</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>$draft</td><td>Booleano</td><td>True para añadir el marcador "draft" al mensaje</td></tr><tr><td>$seen</td><td>Booleano</td><td>True para añadir el marcador "seen" al mensaje</td></tr><tr><td>$flagged</td><td>Booleano</td><td>True para añadir el marcador "flagged" al mensaje</td></tr><tr><td>$answered</td><td>Booleano</td><td>True para añadir el marcador "answered" al mensaje</td></tr><tr><td>$deleted</td><td>Booleano</td><td>True para añadir el marcador "deleted" al mensaje</td></tr></tbody></table><blockquote><ul><li>Los valores falsos se ignoran.</li><li>La interpretación de los indicadores de palabras claves puedevariar según el cliente de correo.</li></ul></blockquote><p><strong>Objeto devuelto</strong></p><p>La función devuelve un objeto que describe el estado IMAP:</p><table><thead><tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr><tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último errordevuelto en la pila de errores de 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuestadel servidor IMAP)</td></tr><tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr><tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-1"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span><span class="hljs-comment">// Crear transportador</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-comment">// Seleccionar buzón de correo</span><span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-comment">// Marcar todos los mensajes de INBOX como leídos/vistos</span><span class="hljs-variable">$flags</span>:=New object<span class="hljs-variable">$flags</span>[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">addFlags</span>(IMAP all;<span class="hljs-variable">$flags</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_append"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_append"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.append()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R6</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.append</strong>( <em>mailObj</em> : Object ;<em>destinationBox</em> : Text ; <em>options</em> : Object ) :Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>mailObj</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Objeto Email</td></tr><tr><td>destinationBox</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Buzón para recibir el objeto Email</td></tr><tr><td>options</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Objeto que contiene información del charset</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-4"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.append()</code> añade el objeto<code>mailObj</code> a la caja <code>destinationBox</code>.</p><p>En el parámetro <code>mailObj</code>, pase un objeto Email. Enel parámetro <code>mailObj</code>, pase un objeto Email. La función<code>.append()</code> soporta los marcadores de palabras clave enel atributo <code>keywords</code> de los objetos email.</p><p>El parámetro opcional <code>destinationBox</code> permite pasarel nombre del buzón donde se añadirá el objeto<code>mailObj</code>. Si se omite, se utiliza el buzón actual.</p><p>En el parámetro opcional <code>options</code>, puede pasar unobjeto para definir el charset y la codificación para partesespecíficas del correo electrónico. Propiedades disponibles:</p><table><thead><tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>headerCharset</td><td>Texto</td><td>Charset y codificación utilizados para las siguientes partesdel correo electrónico: asunto, nombres de archivos adjuntos yatributo(s) del nombre del correo electrónico. Valores posibles:ver la tabla de charsets posibles a continuación</td></tr><tr><td>bodyCharset</td><td>Texto</td><td>Charset y codificación utilizados para el contenido html y eltexto del cuerpo del correo electrónico. Valores posibles: ver latabla de charsets posibles a continuación</td></tr></tbody></table><p>Charsets posibles:</p><table><thead><tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr></thead><tbody><tr><td>mail mode ISO2022JP</td><td>US-ASCII_ISO-2022-JP_UTF8_QP</td><td><ul><li>headerCharset: US-ASCII si es posible, japonés (ISO-2022-JP)&amp; Quoted-printable si es posible, de lo contrario UTF-8 &amp;Quoted-printable</li><li>bodyCharset: US-ASCII si es posible, japonés (ISO-2022-JP) y 7bits si es posible, de lo contrario UTF-8 &amp;Quoted-printable</li></ul></td></tr><tr><td>mail mode ISO88591</td><td>ISO-8859-1</td><td><ul><li>headerCharset: ISO-8859-1 &amp; Quoted-printable</li><li>bodyCharset: ISO-8859-1 &amp; 8-bit</li></ul></td></tr><tr><td>mail mode UTF8</td><td>US-ASCII_UTF8_QP</td><td>headerCharset &amp; bodyCharset: US-ASCII si es posible, de locontrario UTF-8 &amp; Quoted-printable (<strong>valor pordefecto</strong>)</td></tr><tr><td>mail mode UTF8 in base64</td><td>US-ASCII_UTF8_B64</td><td>headerCharset &amp; bodyCharset: US-ASCII si es posible, de locontrario UTF-8 &amp; base64</td></tr></tbody></table><p><strong>Objeto devuelto</strong></p><p>La función devuelve un objeto que describe el estado IMAP:</p><table><thead><tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr><tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último errordevuelto en la pila de errores de 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuestadel servidor IMAP)</td></tr><tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr><tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-2"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><p>Para guardar un correo electrónico en el buzón deborradores:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$settings</span>; <span class="hljs-variable">$status</span>; <span class="hljs-variable">$msg</span>; <span class="hljs-variable">$imap</span>: Object<span class="hljs-variable">$settings</span>:=<span class="hljs-function">New object</span>(<span class="hljs-string">"host"</span>; <span class="hljs-string">"domain.com"</span>; <span class="hljs-string">"user"</span>; <span class="hljs-string">"xxxx"</span>; <span class="hljs-string">"password"</span>; <span class="hljs-string">"xxxx"</span>; <span class="hljs-string">"port"</span>; <span class="hljs-number">993</span>)<span class="hljs-variable">$imap</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$settings</span>)<span class="hljs-variable">$msg</span>:=New object<span class="hljs-variable">$msg</span>.from:=<span class="hljs-string">"xxxx@domain.com"</span><span class="hljs-variable">$msg</span>.subject:=<span class="hljs-string">"Lorem Ipsum"</span><span class="hljs-variable">$msg</span>.textBody:=<span class="hljs-string">"Lorem ipsum dolor sit amet, consectetur adipiscing elit."</span><span class="hljs-variable">$msg</span>.keywords:=New object<span class="hljs-variable">$msg</span>.keywords[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span><span class="hljs-comment">//marcar el mensaje como leído</span><span class="hljs-variable">$msg</span>.keywords[<span class="hljs-string">"$draft"</span>]:=<span class="hljs-literal">True</span><span class="hljs-comment">//marcar el mensaje como borrador</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$imap</span>.<span class="hljs-function">append</span>(<span class="hljs-variable">$msg</span>; <span class="hljs-string">"Drafts"</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_authenticationmode"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_authenticationmode"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.authenticationMode</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17 R4</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.authenticationMode</strong>: Text</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-5"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La propiedad <code>.authenticationMode</code> contiene el modode autenticación utilizado para abrir la sesión en el servidor decorreo.</p><p>Por defecto, se utiliza el modo más seguro soportado por elservidor.</p><p>Los valores posibles son:</p><table><thead><tr><th>Valor</th><th>Constantes</th><th>Comentario</th></tr></thead><tbody><tr><td>CRAM-MD5</td><td><code>IMAP authentication CRAM MD5</code></td><td>Autenticación utilizando el protocolo CRAM-MD5</td></tr><tr><td>LOGIN</td><td><code>IMAP authentication login</code></td><td>Autenticación utilizando el protocolo LOGIN</td></tr><tr><td>OAUTH2</td><td><code>IMAP authentication OAUTH2</code></td><td>Autenticación utilizando el protocolo OAuth2</td></tr><tr><td>PLAIN</td><td><code>IMAP authentication plain</code></td><td>Autenticación utilizando el protocolo PLAIN</td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_checkconnection"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_checkconnection"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.checkConnection()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17 R4</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.checkConnection()</strong> : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la conexión del objeto transportador</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-6"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.checkConnection()</code> comprueba la conexiónutilizando la información almacenada en el objeto transporter,recrea la conexión si es necesario y devuelve el estado. Estafunción permite verificar que los valores proporcionados por elusuario son válidos y coherentes.</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_objeto-devuelto"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_objeto-devuelto"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Objeto devuelto</h4><p>La función envía una solicitud al servidor de correo y devuelveun objeto que describe el estado del correo. Este objeto puedecontener las siguientes propiedades:</p><table><thead><tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td></td><td>booleano</td><td>True si la verificación es exitosa, False en casocontrario</td></tr><tr><td>status</td><td></td><td>number</td><td>(sólo SMTP) Código de estado devuelto por el servidor de correo(0 en caso de un problema no relacionado con el procesamiento delcorreo)</td></tr><tr><td>statusText</td><td></td><td>texto</td><td>Mensaje de estado devuelto por el servidor de correo, o últimoerror devuelto en la pila de errores de 4D</td></tr><tr><td>errors</td><td></td><td>colección</td><td>Pila de errores 4D (no se devuelve si se recibe una respuestadel servidor de correo)</td></tr><tr><td></td><td>[ ].errCode</td><td>number</td><td>Código de error 4D</td></tr><tr><td></td><td>[ ].message</td><td>texto</td><td>Descripción del error 4D</td></tr><tr><td></td><td>[ ].componentSignature</td><td>texto</td><td>Firma del componente interno que ha devuelto el error</td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_checkconnectiondelay"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_checkconnectiondelay"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.checkConnectionDelay</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R4</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.checkConnectionDelay</strong> : Integer</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-7"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La propiedad <code>.checkConnectionDelay</code> contiene laduración máxima (en segundos) permitida antes de verificar laconexión al servidor. Si se supera este tiempo entre dos llamadasal método, se comprobará la conexión con el servidor. Por defecto,si la propiedad no se ha definido en el objeto <em>server&lt;</em>,el valor es de 300.</p><blockquote><p><strong>Atención</strong>: asegúrese de que el tiempo de esperadefinido sea menor que el tiempo de espera del servidor, de locontrario el tiempo de espera del cliente será inútil.</p></blockquote><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_connectiontimeout"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_connectiontimeout"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.connectionTimeOut</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17 R5</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.connectionTimeOut</strong> : Integer</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-8"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La propiedad <code>.connectionTimeOut</code> contiene el tiempomáximo de espera (en segundos) permitido para establecer unaconexión con el servidor. Por defecto, si la propiedad no se hadefinido en el objeto servidor (utilizado para crear el objetotransportador con <code>SMTP New transporter</code>, <code>POP3 Newtransporter</code>, o <code>IMAP New transporter</code>), el valores 30.</p><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_copy"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_copy"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.copy()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R5</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.copy</strong>( <em>msgsIDs</em> : Collection ;<em>destinationBox</em> : Text ) : Object<br /><strong>.copy</strong>( <em>allMsgs</em> : Integer ;<em>destinationBox</em> : Text ) : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de identificadores únicos de mensajes (cadenas)</td></tr><tr><td>allMsgs</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code>: todos los mensajes del buzónseleccionado</td></tr><tr><td>destinationBox</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Buzón para recibir mensajes copiados</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación de copia</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-9"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.copy()</code> copia los mensajes definidos en<em>msgsIDs</em> o <em>allMsgs</em> en la <em>destinationBox</em>en el servidor IMAP.</p><p>Puede pasar:</p><ul><li>en el parámetro <em>msgsIDs</em>, una colección contiene losIDs únicos de los mensajes específicos a copiar, o</li><li>en el parámetro <em>allMsgs</em>, la constante <code>IMAPall</code> (entero) para copiar todos los mensajes del buzónseleccionado.</li></ul><p>El parámetro <em>destinationBox</em> permite pasar un valortexto con el nombre del buzón donde se colocarán las copias de losmensajes.</p><p><strong>Objeto devuelto</strong></p><p>La función devuelve un objeto que describe el estado IMAP:</p><table><thead><tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr><tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último errordevuelto en la pila de errores de 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuestadel servidor IMAP)</td></tr><tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr><tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-1-1"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-1-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 1</h4><p>Para copiar una selección de mensajes:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//seleccionar buzón</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)  <span class="hljs-comment">//obtener la colección de IDs únicos de los mensajes</span> <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"4D new feature:\""</span>)  <span class="hljs-comment">// copiar los mensajes encontrados en el buzón "documents"</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">copy</span>(<span class="hljs-variable">$mailIds</span>;<span class="hljs-string">"documents"</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-2-1"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-2-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 2</h4><p>Para copiar todos los mensajes del buzón actual:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//seleccionar buzón</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)  <span class="hljs-comment">// copiar los mensajes encontrados en el buzón "documents"</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">copy</span>(IMAP all;<span class="hljs-string">"documents"</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_createbox"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_createbox"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.createBox()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v19</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.createBox</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del nuevo buzón</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación de creación del buzón</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-10"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-10"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.createBox()</code> crea un buzón con el<code>name</code> pasado. Si el carácter separador de jerarquía delservidor IMAP aparece en otra parte del nombre del buzón, elservidor IMAP creará todos los nombre padre necesarios para crearel buzón dado.</p><p>En otras palabras, un intento de crear "Projects/IMAP/Doc" en unservidor en el que "/" es el carácter separador de jerarquíacreará:</p><ul><li>Sólo el buzón "Doc" si "Projects" &amp; "IMAP" ya existen.</li><li>Los buzones "IMAP" &amp; "Doc" si sólo existe "Projects".</li><li>Los buzones "Projects" &amp; "IMAP" &amp; "Doc", si noexisten.</li></ul><p>En el parámetro <code>name</code>, pasa el nombre del nuevobuzón.</p><p><strong>Objeto devuelto</strong></p><p>La función devuelve un objeto que describe el estado IMAP:</p><table><thead><tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr><tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último errordevuelto en la pila de errores de 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuestadel servidor IMAP)</td></tr><tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr><tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-3"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><p>Para crear un nuevo buzón "Invoices":</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw </span>: text<span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">If</span>(OK=<span class="hljs-number">1</span>)<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">createBox</span>(<span class="hljs-string">"Invoices"</span>)<span class="hljs-keyword">If</span> (<span class="hljs-variable">$status</span>.success)<span class="hljs-function">ALERT</span>(<span class="hljs-string">"Mailbox creation successful!"</span>)<span class="hljs-keyword">Else</span><span class="hljs-function">ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">End if</span><span class="hljs-keyword">End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_delete"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_delete"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.delete()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R5</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.delete</strong>( <em>msgsIDs</em> : Collection ) :Object<br /><strong>.delete</strong>( <em>allMsgs</em> : Integer ) : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de identificadores únicos de mensajes (cadenas)</td></tr><tr><td>allMsgs</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code>: todos los mensajes del buzónseleccionado</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación de eliminación</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-11"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-11"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.delete()</code> asocia el marcador "deleted" alos mensajes designados por <code>msgsIDs</code> o<code>allMsgs</code>.</p><p>Puede pasar:</p><ul><li>en el parámetro <code>msgsIDs</code>, una colección contienelos IDs únicos de los mensajes específicos a eliminar, o</li><li>en el parámetro <code>allMsgs</code>, la constante <code>IMAPall</code> (entero) para eliminar todos los mensajes del buzónseleccionado.</li></ul><p>La ejecución de esta función no elimina realmente los mensajes.Los mensajes con la bandera "delete" pueden seguir siendoencontrados por la función <a href="#IMAPTransporterClass.html_searchmails">.searchMails()</a>. Losmensajes marcados se eliminan del servidor IMAP con la función<a href="#IMAPTransporterClass.html_expunge"><code>.expunge()</code></a> oal seleccionar otro buzón o cuando se destruye el objeto <a href="#IMAPTransporterClass.html_imap-transporter-object">transporter</a>(creado con <a href="#IMAPTransporterClass.html_imap-new-transporter">IMAP Newtransporter</a>).</p><p><strong>Objeto devuelto</strong></p><p>La función devuelve un objeto que describe el estado IMAP:</p><table><thead><tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr><tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último errordevuelto en la pila de errores de 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuestadel servidor IMAP)</td></tr><tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr><tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-1-2"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-1-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 1</h4><p>Para eliminar una selección de mensajes:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//seleccionar buzón</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)  <span class="hljs-comment">//obtener la colección de IDs únicos de los mensajes</span> <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"Reports\""</span>)  <span class="hljs-comment">// Borrar los mensajes seleccionados</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$mailIds</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-2-2"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-2-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 2</h4><p>Para eliminar todos los mensajes del buzón actual:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//seleccionar buzón</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Junk Email"</span>)  <span class="hljs-comment">// Borrar los mensajes seleccionados en el buzón actual</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(IMAP all)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_deletebox"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_deletebox"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.deleteBox()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v19</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.deleteBox</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del buzón a eliminar</td></tr></tbody></table><p>|Result|Object|&lt;-|Estado de la operación de eliminación delbuzón|</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-12"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-12"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.deleteBox()</code> elimina definitivamente elbuzón llamado <code>name</code> en el servidor IMAP. Intentareliminar un INBOX o un buzón que no existe generará un error.</p><p>En el parámetro <code>name</code>, pase el nombre del buzón aeliminar.</p><blockquote><ul><li>La función no puede eliminar un buzón que tiene buzones hijossi el buzón padre tiene el atributo "\Noselect".</li><li>Todos los mensajes del buzón eliminado también seborrarán.</li><li>La posibilidad de eliminar un buzón depende del servidor decorreo.</li></ul></blockquote><p><strong>Objeto devuelto</strong></p><p>La función devuelve un objeto que describe el estado IMAP:</p><table><thead><tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr><tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último errordevuelto en la pila de errores de 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuestadel servidor IMAP)</td></tr><tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr><tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-4"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><p>Para eliminar el buzón secundario "Nova Orion Industries" delinterior del buzón "Bills":</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-comment">// eliminar buzón</span><span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Nova Orion Industries"</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">deleteBox</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">If</span> (<span class="hljs-variable">$status</span>.success)<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Mailbox deletion successful!"</span>)<span class="hljs-keyword">    Else</span><span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">    End if</span><span class="hljs-keyword">End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_expunge"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_expunge"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.expunge()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R6</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.expunge()</strong> : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación expunge</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-13"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-13"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.expunge()</code> elimina todos los mensajescon el marcador "deleted" del servidor de correo IMAP. El marcador"deleted" puede establecerse con los métodos <a href="#IMAPTransporterClass.html_delete"><code>.delete()</code></a> o<a href="#IMAPTransporterClass.html_addflags"><code>.addFlags()</code></a>.</p><p><strong>Objeto devuelto</strong></p><p>La función devuelve un objeto que describe el estado IMAP:</p><table><thead><tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr><tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último errordevuelto en la pila de errores de 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuestadel servidor IMAP)</td></tr><tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr><tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-5"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword">var</span> <span class="hljs-variable">$ids </span>: Collection<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span><span class="hljs-comment">// Crear transportador</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-comment">// Seleccionar buzón</span><span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-comment">// Buscar y eliminar todos los mensajes vistos en INBOX</span><span class="hljs-variable">$ids</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"SEEN"</span>)<span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$ids</span>)<span class="hljs-comment">// Purgar todos los mensajes marcados como borrados</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">expunge</span>()</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getboxinfo"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getboxinfo"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getBoxInfo()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R5</td><td><em>name&lt;</em> es opcional</td></tr></tbody></table><p>|v18 R4|Added|</p></details><p><strong>.getBoxInfo</strong>( { <em>name</em> : Text }) :Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del buzón</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>objeto boxInfo</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-14"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-14"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.getBoxInfo()</code> devuelve un objeto<code>boxInfo</code> correspondiente al buzón de recepción actual oal buzón llamado <em>name</em>. Esta función devuelve la mismainformación que <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>sin cambiar el buzón actual.</p><p>En el parámetro opcional <em>name</em>, pase el nombre del buzóna acceder. El nombre representa una jerarquía inequívoca deizquierda a derecha, con niveles separados por un carácterdelimitador específico. El delimitador se puede recuperar con lafunción <a href="#IMAPTransporterClass.html_getdelimiter"><code>.getDelimiter()</code></a>.</p><p>Si el buzón <em>name</em> no es seleccionable o no existe, lafunción genera un error y devuelve <strong>null</strong>.</p><p><strong>Objeto devuelto</strong></p><p>El objeto <code>boxInfo</code> devuelto contiene las siguientespropiedades:</p><table><thead><tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>name</td><td>texto</td><td>Nombre del buzón</td></tr><tr><td>mailCount</td><td>number</td><td>Número de mensajes en el buzón</td></tr><tr><td>mailRecent</td><td>number</td><td>Número de mensajes con el marcador "reciente" (que indica losmensajes nuevos)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-6"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>) <span class="hljs-variable">$info</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxInfo</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-function"> ALERT</span>(<span class="hljs-string">"INBOX contains "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$info</span>.mailRecent)+<span class="hljs-string">" recent emails."</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getboxlist"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getboxlist"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getBoxList()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R4</td><td>Añadidos</td></tr><tr><td>v19</td><td>Adición parámetro <code>isSubscribed</code></td></tr></tbody></table></details><p><strong>.getBoxList</strong>( { <em>parameters</em> : Object } ): Collection</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>parameters</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Objeto de parámetro</td></tr><tr><td>Resultado</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Colección de objetos mailbox</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-15"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-15"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.getBoxList()</code> devuelve una colección debandejas de entrada que describe todas las bandejas de entradadisponibles. Esta función permite gestionar localmente la lista demensajes localizados en el servidor de correo IMAP.</p><p>En el parámetro opcional <code>parameters</code>, pase un objetoque contenga valores para filtrar los buzones devueltos. Puedepasar:</p><table><thead><tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>isSubscribed</td><td>Booleano</td><td><ul><li><strong>True</strong> para devolver sólo los buzonessuscritos</li><li><strong>False</strong> para devolver todos los buzonesdisponibles</li></ul></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_resultado-1"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_resultado-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><p>Cada objeto de la colección devuelta contiene las siguientespropiedades:</p><table><thead><tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>[].name</td><td>texto</td><td>Nombre del buzón</td></tr><tr><td>[].selectable</td><td>booleano</td><td>Indica si los derechos de acceso permiten o no seleccionar elbuzón:<ul><li>true - el buzón puede ser seleccionado</li><li>false - el buzón no puede ser seleccionado</li></ul></td></tr><tr><td>[].inferior</td><td>booleano</td><td>Indica si los derechos de acceso permiten o no crear unajerarquía inferior en el buzón:<ul><li>true - se puede crear un nivel inferior</li><li>false - no se puede crear un nivel inferior</li></ul></td></tr><tr><td>[].interesting</td><td>booleano</td><td>Indica si el buzón ha sido marcado como "interesante" por elservidor:<ul><li>true - El buzón ha sido marcado como "interesante" por elservidor. Por ejemplo, puede contener mensajes nuevos.</li><li>false - El buzón no ha sido marcado como "interesante" por elservidor.</li></ul></td></tr></tbody></table><p>Si la cuenta no contiene buzones, se devuelve una colecciónvacía.</p><blockquote><ul><li>Si no hay ninguna conexión abierta, <code>.getBoxList()</code>abrirá una conexión.</li><li>Si la conexión no se ha utilizado desde el retraso de conexióndesignado (ver <code>IMAP New transporter</code>), se llamaautomáticamente a la función <code>.checkConnection( )</code>.</li></ul></blockquote><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-7"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>) <span class="hljs-variable">$boxList</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxList</span>()<span class="hljs-keyword"> For each</span>(<span class="hljs-variable">$box</span>;<span class="hljs-variable">$boxList</span>)<span class="hljs-keyword">    If</span>(<span class="hljs-variable">$box</span>.interesting)       <span class="hljs-variable">$split</span>:=<span class="hljs-function">Split string</span>(<span class="hljs-variable">$box</span>.name;<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>())<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"New emails are available in the box: "</span>+<span class="hljs-variable">$split</span>[<span class="hljs-variable">$split</span>.length<span class="hljs-number">-1</span>])<span class="hljs-keyword">    End if</span><span class="hljs-keyword"> End for each</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getdelimiter"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getdelimiter"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getDelimiter()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R4</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.getDelimiter()</strong> : Text</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>Texto</td><td style="text-align:center">&lt;-</td><td>Caracter delimitador de jerarquía</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-16"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-16"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.getDelimiter()</code> devuelve el carácterutilizado para delimitar los niveles de jerarquía en el nombre delbuzón.</p><p>El delimitador es un carácter que puede utilizarse para:</p><ul><li>crear buzones de nivel inferior</li><li>buscar más arriba o más abajo en la jerarquía del buzón</li></ul><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_resultado-2"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_resultado-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><p>Caracter delimitador del nombre del buzón.</p><blockquote><ul><li>Si no hay ninguna conexión abierta, <code>getDelimiter()</code>abrirá una conexión.</li><li>Si la conexión no se ha utilizado desde el <a href="#IMAPTransporterClass.html_checkconnectiondelay">retraso deconexión</a> designado, la función <a href="#IMAPTransporterClass.html_checkconnection"><code>.checkConnection()</code></a>se llama automáticamente.</li></ul></blockquote><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-8"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>) <span class="hljs-variable">$boxList</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getBoxList</span>()<span class="hljs-keyword"> For each</span>(<span class="hljs-variable">$box</span>;<span class="hljs-variable">$boxList</span>)<span class="hljs-keyword">    If</span>(<span class="hljs-variable">$box</span>.interesting)       <span class="hljs-variable">$split</span>:=<span class="hljs-function">Split string</span>(<span class="hljs-variable">$box</span>.name;<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>())<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"New emails are available in the box: "</span>+<span class="hljs-variable">$split</span>[<span class="hljs-variable">$split</span>.length<span class="hljs-number">-1</span>])<span class="hljs-keyword">    End if</span><span class="hljs-keyword"> End for each</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getmail"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getmail"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getMail()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R4</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.getMail</strong>( <em>msgNumber</em>: Integer { ;<em>options</em> : Object } ) : Object<br /><strong>.getMail</strong>( <em>msgID</em>: Text { ;<em>options</em> : Object } ) : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>msgNumber</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Número de secuencia del mensaje</td></tr><tr><td>msgID</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>ID único del mensaje</td></tr><tr><td>options</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Instrucciones sobre el manejo de mensajes</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td><a href="#IMAPTransporterClass.html_email-object">ObjetoEmail</a></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-17"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-17"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.getMail()</code> devuelve el objeto<code>Email</code> correspondiente al <em>msgNumber</em> o<em>msgID</em> en el buzón designado por<code>IMAP_transporter</code>. Esta función permite recuperar lainformación sobre el email.</p><p>En el primer parámetro, puede pasar:</p><ul><li><em>msgNumber</em>, un valor <em>integer</em> indicando elnúmero de secuencia del mensaje a recuperar o</li><li><em>msgID</em>, un valor <em>text</em> indicando el ID únicodel mensaje a recuperar.</li></ul><p>El parámetro opcional <em>options</em> permite pasar un objetoque define las instrucciones adicionales para la gestión delmensaje. Las siguientes propiedades están disponibles:</p><table><thead><tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>updateSeen</td><td>booleano</td><td>Si True, el mensaje se marca como "visto" en el buzón. Si esFalse, el mensaje no se marca como "visto". Valor por defecto:True</td></tr><tr><td>withBody</td><td>booleano</td><td>Pase True para devolver el cuerpo del mensaje. Si es False,sólo se devuelve el encabezado del mensaje. Valor por defecto:True</td></tr></tbody></table><blockquote><ul><li>La función genera un error y devuelve <strong>Null</strong> si<em>msgID</em> designa un mensaje inexistente,</li><li>Si no se selecciona ningún buzón con la función <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>,se genera un error,</li><li>Si no hay ninguna conexión abierta, <code>.getMail()</code>abrirá una conexión con el último buzón especificado por <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>.</li></ul></blockquote><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_resultado-3"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_resultado-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><p><code>.getMail()</code> devuelve un <a href="#IMAPTransporterClass.html_objet-email"><code>objetEmail</code></a> con las propiedades IMAP adicionales siguientes:<em>id</em>, <em>receivedAt</em> y <em>size</em>.</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-9"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><p>Quiere obtener el mensaje con ID = 1:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$info</span>; <span class="hljs-variable">$mail</span>; <span class="hljs-variable">$boxInfo </span>: Variant<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>  <span class="hljs-comment">//crear transportador</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//seleccionar buzón</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)  <span class="hljs-comment">//obtener el objeto Email con ID 1</span> <span class="hljs-variable">$mail</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMail</span>(<span class="hljs-number">1</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getmails"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getmails"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getMails()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R5</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.getMails</strong>( <em>ids</em> : Collection { ;<em>options</em> : Object } ) : Object<br /><strong>.getMails</strong>( <em>startMsg</em> : Integer ;<em>endMsg</em> : Integer { ; <em>options</em> : Object } ) :Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>ids</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de identificadores de mensajes</td></tr><tr><td>startMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Número de secuencia del primer mensaje</td></tr><tr><td>endMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Número de secuencia del último mensaje</td></tr><tr><td>options</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Instrucciones sobre el manejo de mensajes</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Objeto que contiene:<br /><ul><li>una colección de <a href="#IMAPTransporterClass.html_email-object">objetos Email</a> y</li><li>una colección de identificadores o números para los mensajesque faltan, si los hay</li></ul></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-18"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-18"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.getMails()</code> devuelve un objeto quecontiene una colección de objetos <code>Email</code>.</p><p><strong>Primera sintaxis:</strong></p><p><strong><em>.getMails( ids { ; options } ) -&gt;result</em></strong></p><p>La primera sintaxis permite recuperar los mensajes en función desus identificadores.</p><p>En el parámetro <em>ids</em>, pase una colección de IDs para losmensajes a devolver. Puede obtener los IDs con <a href="#IMAPTransporterClass.html_getmail"><code>.getMail()</code></a>.</p><p>El parámetro opcional <em>options</em> permite definir laspartes de los mensajes a devolver. Consulte la tabla<strong>Opciones</strong> a continuación para obtener unadescripción de las propiedades disponibles.</p><p><strong>Segunda sintaxis:</strong></p><p><strong><em>.getMails( startMsg ; endMsg { ; options } ) -&gt;result</em></strong></p><p>La segunda sintaxis permite recuperar los mensajes en función deun rango secuencial. Los valores pasados representan la posición delos mensajes en el buzón.</p><p>En el parámetro <em>startMsg</em>, pase un valor <em>entero</em>correspondiente al número del primer mensaje en un rangosecuencial. Si se pasa un número negativo (<em>startMsg</em> &lt;=0), se utilizará el primer mensaje del buzón como inicio de lasecuencia.</p><p>En el parámetro <em>endMsg</em>, pase un valor <em>entero</em>correspondiente al número del último mensaje a incluir en un rangosecuencial. Si se pasa un número negativo (<em>endMsg</em> &lt;=0), se utilizará el último mensaje del buzón como fin desecuencia.</p><p>El parámetro opcional <em>options</em> permite definir laspartes de los mensajes a devolver.</p><p><strong>Opciones</strong></p><table><thead><tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>updateSeen</td><td>Booleano</td><td>Si True, los mensajes especificados se marcan como "vistos" enel buzón. Si False, los mensajes no se marcan como "vistos". Valorpor defecto: True</td></tr><tr><td>withBody</td><td>Booleano</td><td>Pase True para devolver el cuerpo de los mensajes específicos.Si False, sólo se devuelve los encabezados de los mensajes. Valorpor defecto: True</td></tr></tbody></table><blockquote><ul><li>Si no se selecciona ningún buzón con el comando <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>,se genera un error.</li><li>Si no hay ninguna conexión abierta, <code>.getMails()</code>abrirá una conexión con el último buzón especificado por <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>.</li></ul></blockquote><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_resultado-4"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_resultado-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><p><code>.getMails()</code> devuelve un objeto que contiene lassiguientes colecciones:</p><table><thead><tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>lista</td><td>Collection</td><td>Colección de objetos <a href="#IMAPTransporterClass.html_email-object"><code>Email</code></a>.Si no se encuentran objetos Email, se devuelve una colecciónvacía.</td></tr><tr><td>notFound</td><td>Collection</td><td>Colección de:<br /><ul><li>primera sintaxis - IDs de mensajes pasados previamente que noexisten</li><li>segunda sintaxis - números de secuencia de los mensajes entrestartMsg y endMsg que no existen</li></ul>Se devuelve una colección vacía si se encuentran todos losmensajes.</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-10"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-10"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><p>Quiere recuperar los 20 correos electrónicos más recientes sincambiar el estado "visto":</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>,<span class="hljs-variable">$boxInfo</span>,<span class="hljs-variable">$result </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>  <span class="hljs-comment">//crear transportador</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//seleccionar buzón</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-keyword">  If</span>(<span class="hljs-variable">$boxInfo</span>.mailCount&gt;<span class="hljs-number">0</span>)        <span class="hljs-comment">// recuperar los encabezados de los últimos 20 mensajes sin marcarlos como leídos</span>    <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMails</span>(<span class="hljs-variable">$boxInfo</span>.mailCount<span class="hljs-number">-20</span>;<span class="hljs-variable">$boxInfo</span>.mailCount;\<span class="hljs-function">        New object</span>(<span class="hljs-string">"withBody"</span>;<span class="hljs-literal">False</span>;<span class="hljs-string">"updateSeen"</span>;<span class="hljs-literal">False</span>))<span class="hljs-keyword">    For each</span>(<span class="hljs-variable">$mail</span>;<span class="hljs-variable">$result</span>.list)        <span class="hljs-comment">// ...</span><span class="hljs-keyword">    End for each</span><span class="hljs-keyword"> End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_getmimeasblob"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_getmimeasblob"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getMIMEAsBlob()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R4</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.getMIMEAsBlob</strong>( <em>msgNumber</em> : Integer {; <em>updateSeen</em> : Boolean } ) : Blob<br /><strong>.getMIMEAsBlob</strong>( <em>msgID</em> : Text { ;<em>updateSeen</em> : Boolean } ) : Blob</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>msgNumber</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Número de secuencia del mensaje</td></tr><tr><td>msgID</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>ID único del mensaje</td></tr><tr><td>updateSeen</td><td>Booleano</td><td style="text-align:center">-&gt;</td><td>Si True, el mensaje se marca como "visto" en el buzón. SiFalse, el mensaje se deja igual.</td></tr><tr><td>Resultado</td><td>BLOB</td><td style="text-align:center">&lt;-</td><td>Blob de la cadena MIME devuelta por el servidor de correo</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-19"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-19"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.getMIMEAsBlob()</code> devuelve un BLOB con elcontenido MIME del mensaje correspondiente al <em>msgNumber</em> o<em>msgID</em> en el buzón designado por el<code>IMAP_transporter</code>.</p><p>En el primer parámetro, puede pasar:</p><ul><li><em>msgNumber</em>, un valor <em>integer</em> indicando elnúmero de secuencia del mensaje a recuperar o</li><li><em>msgID</em>, un valor <em>text</em> indicando el ID únicodel mensaje a recuperar.</li></ul><p>El parámetro opcional <em>updateSeen</em> permite indicar si elmensaje está marcado como "visto" en el buzón. Puede pasar:</p><ul><li><strong>True</strong> - para marcar el mensaje como "visto"(indicando que el mensaje ha sido leído)</li><li><strong>False</strong> - para dejar intacto el estado "visto"del mensaje &gt; * La función devuelve un BLOB vacío si<em>msgNumber</em> o msgID* designa un mensaje inexistente, &gt; *Si no se selecciona ningún buzón con el comando <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>,se genera un error, &gt; * Si no hay ninguna conexión abierta,<code>.getMIMEAsBlob()</code> abrirá una conexión con el últimobuzón especificado por <code>.selectBox()</code>.</li></ul><blockquote><ul><li>La función devuelve un BLOB vacío si <em>msgNumber</em> omsgID* designa un mensaje inexistente,</li><li>Si no se selecciona ningún buzón con el comando <a href="#IMAPTransporterClass.html_selectbox"><code>.selectBox()</code></a>,se genera un error,</li><li>Si no hay ninguna conexión abierta,<code>.getMIMEAsBlob()</code> abrirá una conexión con el últimobuzón especificado por <code>.selectBox()</code>.</li></ul></blockquote><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_resultado-5"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_resultado-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><p><code>.getMIMEAsBlob()</code> devuelve un <code>BLOB</code> quepuede almacenarse en una base de datos o convertirse en un objeto<a href="#IMAPTransporterClass.html_email-object"><code>Email</code></a>con el comando <code>MAIL Convert from MIME</code>.</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-11"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-11"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$boxInfo </span>: Variant<span class="hljs-keyword"> var</span> <span class="hljs-variable">$blob </span>: Blob<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span>  <span class="hljs-comment">//crear transportador</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//seleccionar buzón</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"Inbox"</span>)  <span class="hljs-comment">//obtener BLOB</span> <span class="hljs-variable">$blob</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getMIMEAsBlob</span>(<span class="hljs-number">1</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_host"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_host"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.host</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17 R5</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.host</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-20"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-20"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La propiedad <code>.host</code> contiene el nombre o ladirección IP del servidor local. Se utiliza para las transaccionesde correo (SMTP, POP3, IMAP).</p><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_logfile"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_logfile"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.logFile</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17 R5</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.logFile</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-21"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-21"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La propiedad <code>.logFile</code> contiene la ruta del archivode registro extendido definido (si existe) para la conexión decorreo. Puede ser relativo (a la carpeta actual Logs) oabsoluto.</p><p>A diferencia de los archivos de registro clásicos (habilitadosmediante el comando <code>SET DATABASE PARAMETER</code>), losarchivos de registro extendidos almacenan el contenido MIME detodos los correos enviados y no tienen ningún límite de tamaño.Para más información sobre los archivos de registro extendidos,consulte:</p><ul><li><strong>Conexiones SMTP</strong> - <a href="#IMAPTransporterClass.html_4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DSMTPLog.txt</a></li><li>**Conexiones POP3 ** - <a href="#IMAPTransporterClass.html_4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DSMTPLog.txt</a></li><li><strong>Conexiones IMAP</strong> - <a href="#IMAPTransporterClass.html_4dsmtplogtxt-4dpop3logtxt-and-4dimaplogtxt">4DIMAPLog.txt</a></li></ul><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_move"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_move"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.move()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R5</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.move</strong>( <em>msgsIDs</em> : Collection ;<em>destinationBox</em> : Text ) : Object<br /><strong>.move</strong>( <em>allMsgs</em> : Integer ;<em>destinationBox</em> : Text ) : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>msgsIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de identificadores únicos de mensajes (cadenas)</td></tr><tr><td>allMsgs</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>IMAP all</code>: todos los mensajes del buzónseleccionado</td></tr><tr><td>destinationBox</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Buzón para recibir los mensajes desplazados</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación de desplazamiento</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-22"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-22"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>move()</code> mueve los mensajes definidos en<em>msgsIDs</em> o <em>allMsgs</em> a la <em>destinationBox</em>enel servidor IMAP.</p><p>Puede pasar:</p><ul><li>en el parámetro <em>msgsIDs</em>, una colección contiene losIDs únicos de los mensajes específicos a mover, o</li><li>en el parámetro <em>allMsgs</em>, la constante <code>IMAPall</code> (entero) para mover todos los mensajes del buzónseleccionado.</li></ul><p>El parámetro <em>destinationBox</em> permite pasar un valortexto con el nombre del buzón donde los mensajes serándesplazados.</p><blockquote><p>Esta función sólo la soportan los servidores IMAP que cumplencon el RFC <a href="https://tools.ietf.org/html/rfc8474">8474</a>.</p></blockquote><p><strong>Objeto devuelto</strong></p><p>La función devuelve un objeto que describe el estado IMAP:</p><table><thead><tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr><tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último errordevuelto en la pila de errores de 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuestadel servidor IMAP)</td></tr><tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr><tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-1-3"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-1-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 1</h4><p>Para mover una selección de mensajes:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$mailIds </span>: Collection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//seleccionar buzón</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)  <span class="hljs-comment">//obtener la colección de IDs únicos de los mensajes</span> <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">searchMails</span>(<span class="hljs-string">"subject \"4D new feature:\""</span>)  <span class="hljs-comment">// Mover los mensajes encontrados del buzón actual al buzón "documents"</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">move</span>(<span class="hljs-variable">$mailIds</span>;<span class="hljs-string">"documents"</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-2-3"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-2-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 2</h4><p>Para mover todos los mensajes del buzón actual:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//seleccionar buzón</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)  <span class="hljs-comment">// mover todos los mensajes del buzón actual al buzón "documents"</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">move</span>(IMAP all;<span class="hljs-string">"documents"</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_numtoid"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_numtoid"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.numToID()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R5</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.numToID</strong>( <em>startMsg</em> : Integer ;<em>endMsg</em> : Integer ) : Collection</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>startMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Número de secuencia del primer mensaje</td></tr><tr><td>endMsg</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Número de secuencia del último mensaje</td></tr><tr><td>Resultado</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Colección de identificadores de mensajes únicos</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-23"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-23"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.numToID()</code> convierte los números desecuencia en IDs únicos IMAP para los mensajes en el rangosecuencial designado por <em>startMsg</em> y <em>endMsg</em> en elbuzón actualmente seleccionado.</p><p>En el parámetro <em>startMsg</em>, pase un valor enterocorrespondiente al número del primer mensaje en un rangosecuencial. Si se pasa un número negativo (<em>startMsg</em> &lt;=0), se utilizará el primer mensaje del buzón como inicio de lasecuencia.</p><p>En el parámetro <em>endMsg</em>, pase un valor enterocorrespondiente al número del último mensaje a incluir en un rangosecuencial. Si se pasa un número negativo (<em>endMsg</em> &lt;=0), se utilizará el último mensaje del buzón como fin desecuencia.</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_resultado-6"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_resultado-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resultado</h4><p>La función devuelve una colección de cadenas (IDs únicos).</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-12"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-12"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter<span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$mailIds </span>: Collection <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Obligatorio</span> <span class="hljs-variable">$server</span>.port:=<span class="hljs-number">993</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span> <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>)  <span class="hljs-comment">//seleccionar buzón</span> <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"inbox"</span>)  <span class="hljs-comment">//obtener los ID de los 5 últimos mensajes recibidos</span> <span class="hljs-variable">$mailIds</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">numToID</span>((<span class="hljs-variable">$boxInfo</span>.mailCount<span class="hljs-number">-5</span>);<span class="hljs-variable">$boxInfo</span>.mailCount)  <span class="hljs-comment">//eliminar los mensajes del buzón actual</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">delete</span>(<span class="hljs-variable">$mailIds</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_removeflags"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_removeflags"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.removeFlags()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R6</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.removeFlags</strong>( <em>msgIDs</em> : Collection ;<em>keywords</em> : Object ) : Object<br /><strong>.removeFlags</strong>( <em>msgIDs</em> : Text ;<em>keywords</em> : Object ) : Object<br /><strong>.removeFlags</strong>( <em>msgIDs</em> : Longint ;<em>keywords</em> : Object ) : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>msgIDs</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de cadenas: identificadores únicos de mensajes(texto)<br />Texto: ID único de un mensaje<br />Longint (IMAP all): todos los mensajes del buzón seleccionado</td></tr><tr><td>keywords</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Banderas de palabras claves a eliminar</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación removeFlags</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-24"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-24"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.removeFlags()</code> elimina las banderas delos <code>msgIDs&lt;</code> para las <code>keywords</code>definidas.</p><p>En el parámetro <code>msgIDs</code>, puede pasar:</p><ul><li><p>una <em>collection</em> contiene los identificadores únicos demensajes específicos, o</p></li><li><p>el ID único (<em>texte</em>) de un solo mensaje o</p></li><li><p>la siguiente constante (<em>longint</em>) para todos losmensajes del buzón seleccionado:</p><table><thead><tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr></thead><tbody><tr><td>IMAP all</td><td>1</td><td>Seleccionar todos los mensajes del buzón seleccionado</td></tr></tbody></table></li></ul><p>El parámetro <code>keywords</code> le permite pasar un objetocon valores de palabras clave para las banderas específicas aeliminar de los <code>msgIDs</code>. Puede pasar cualquiera de lassiguientes palabras claves:</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>$draft</td><td>Booleano</td><td>True para eliminar el marcador "draft" del mensaje</td></tr><tr><td>$seen</td><td>Booleano</td><td>True para eliminar el marcador "seen" del mensaje</td></tr><tr><td>$flagged</td><td>Booleano</td><td>True para eliminar el marcador "flagged" del mensaje</td></tr><tr><td>$answered</td><td>Booleano</td><td>True para eliminar el marcador "answered" del mensaje</td></tr><tr><td>$deleted</td><td>Booleano</td><td>True para eliminar el marcador "deleted" del mensaje</td></tr></tbody></table><p>Note que los valores falsos se ignoran.</p><p><strong>Objeto devuelto</strong></p><p>La función devuelve un objeto que describe el estado IMAP:</p><table><thead><tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr><tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último errordevuelto en la pila de errores de 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuestadel servidor IMAP)</td></tr><tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr><tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-13"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-13"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>;<span class="hljs-variable">$transporter</span>;<span class="hljs-variable">$boxInfo</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.port:=<span class="hljs-number">993</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"4d@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-string">"xxxxx"</span><span class="hljs-comment">// Crear transportador</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-comment">// Seleccionar buzón</span><span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)<span class="hljs-comment">// Marcar todos los mensajes de INBOX como no vistos</span><span class="hljs-variable">$flags</span>:=New object<span class="hljs-variable">$flags</span>[<span class="hljs-string">"$seen"</span>]:=<span class="hljs-literal">True</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">removeFlags</span>(IMAP all;<span class="hljs-variable">$flags</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_renamebox"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_renamebox"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.renameBox()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v19</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.renameBox</strong>( <em>currentName</em> : Text ;<em>newName</em> : Text ) : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>currentName</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del nuevo actual</td></tr><tr><td>newName</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nuevo nombre del buzón</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación renombrar</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-25"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-25"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.renameBox()</code> cambia el nombre de unbuzón en el servidor IMAP. Si se intenta renombrar un buzón desdeun nombre de buzón que no existe o a un nombre de buzón que yaexiste, se generará un error.</p><p>En el parámetro <code>currentName</code>, pase el nombre delbuzón a renombrar.</p><p>Pase el nuevo nombre del buzón en el parámetro<code>newName</code>.</p><p><strong>Objeto devuelto</strong></p><p>La función devuelve un objeto que describe el estado IMAP:</p><table><thead><tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr><tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último errordevuelto en la pila de errores de 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuestadel servidor IMAP)</td></tr><tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr><tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-14"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-14"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><p>Para cambiar el nombre de su buzón de "Invoices" a "Bills":</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw </span>: text<span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-comment">// renombrar buzón</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">renameBox</span>(<span class="hljs-string">"Invoices"</span>; <span class="hljs-string">"Bills"</span>)<span class="hljs-keyword">If</span> (<span class="hljs-variable">$status</span>.success)<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox renaming successful!"</span>)<span class="hljs-keyword">   Else</span><span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End if</span><span class="hljs-keyword">End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_port"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_port"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.port</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17 R4</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.port</strong> : Integer</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-26"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-26"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La propiedad <code>.port</code> contiene el número de puertoutilizado para las transacciones de correo. Por defecto, si lapropiedad <em>port</em> no se ha definido en el objeto<em>server</em> (utilizado para crear el objeto transportador con<code>SMTP New transporter</code>, <code>POP3 Newtransporter</code>, <code>IMAP New transporter</code>), el puertoutilizado es:</p><ul><li><strong>SMTP</strong> - 587</li><li><strong>POP3</strong> - 995</li><li><strong>IMAP</strong> - 993</li></ul><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_searchmails"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_searchmails"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.searchMails()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R5</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.searchMails</strong>( <em>searchCriteria</em> : Text ): Collection</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>searchCriteria</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Criterio de búsqueda</td></tr><tr><td>Resultado</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Colección de números de mensajes</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-27"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-27"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><blockquote><p>Esta función se basa en la especificación del <a href="https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol">protocoloIMAP</a>.</p></blockquote><p>La función <code>.searchMails()</code> busca los mensajes quecoincidan con el <em>searchCriteria</em> en el buzón actual. Elparámetro <em>searchCriteria</em> contiene una o varias palabrasclave de búsqueda.</p><p><em>searchCriteria</em> es un parámetro texto que enumera una ovarias llaves de búsqueda (ver <a href="#IMAPTransporterClass.html_authorized-search-keys">llaves-de-búsqueda-autorizadas</a>más abajo) asociadas o no a valores a buscar. Una llave de búsquedapuede ser uno o varios elementos. Por ejemplo:</p><pre><code class="hljs"><span class="hljs-attr">SearchKey1</span> = FLAGGED<span class="hljs-attr">SearchKey2</span> = NOT FLAGGED<span class="hljs-attr">SearchKey3</span> = FLAGGED DRAFT</code></pre><blockquote><p>Las coincidencias no suelen diferenciar entre mayúsculas yminúsculas</p></blockquote><ul><li>Si el <em>searchCriteria</em> es una cadena null, la búsquedaserá equivalente a un "seleccionar todo".</li><li>Si <em>searchCriteria</em> incluye varias llaves de búsqueda,el resultado es la intersección (función AND) de todos los mensajesque coinciden con esas llaves.</li></ul><pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = FLAGGED FROM <span class="hljs-string">"SMITH"</span></code></pre><p>... devuelve todos los mensajes con el marcador \Flagged ANDactivado y enviados por Smith.</p><ul><li>Puede utilizar los operadores <strong>OR</strong> o<strong>NOT</strong> de la siguiente manera:</li></ul><pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = OR SEEN FLAGGED</code></pre><p>... devuelve todos los mensajes con el marcador \Seen O\Flagged</p><pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = NOT SEEN</code></pre><p>... devuelve todos los mensajes con el marcador \Seen.</p><pre><code class="hljs">searchCriteria = <span class="hljs-keyword">HEADER</span> CONTENT<span class="hljs-params">-TYPE</span> <span class="hljs-string">"MIXED"</span> <span class="hljs-literal">NOT</span> <span class="hljs-keyword">HEADER</span> CONTENT<span class="hljs-params">-TYPE</span> <span class="hljs-string">"TEXT"</span><span class="hljs-params">...</span></code></pre><p>... devuelve los mensajes cuyo encabezado content-type contiene"Mixed" y no contiene "Text".</p><pre><code class="hljs">searchCriteria = <span class="hljs-keyword">HEADER</span> CONTENT-<span class="hljs-keyword">TYPE</span> "E" <span class="hljs-keyword">NOT</span> SUBJECT "o" <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">HEADER</span> CONTENT-<span class="hljs-keyword">TYPE</span> "MIXED"</code></pre><p>... devuelve los mensajes cuyo encabezado content-type contiene" e " y cuyo encabezado Subject no contiene " o " y cuyo encabezadocontent-type no es " Mixed ".</p><p>En cuanto a los dos últimos ejemplos, observe que el resultadode la búsqueda es diferente cuando se eliminan los paréntesis de laprimera lista de llaves de búsqueda.</p><ul><li>El parámetro <em>searchCriteria</em> puede incluiropcionalmente la instrucción [CHARSET]. Esta instrucción consisteen la palabra "CHARSET" seguida de un conjunto de caracteresdefinido [CHARSET] (US ASCII, ISO-8859). Indica el conjunto decaracteres de la cadena <em>searchCriteria</em>. Por lo tanto, debeconvertir la cadena <em>searchCriteria</em> en el conjunto decaracteres especificado si utiliza la instrucción [CHARSET] (verlos comandos <code>CONVERT FROM TEXT</code> o <code>Convert totext</code>). Por defecto, 4D codifica la cadena de criteriossearchCriteria en Quotable Printable si contiene los caracteresextendidos.</li></ul><pre><code class="hljs"><span class="hljs-attr">searchCriteria</span> = CHARSET <span class="hljs-string">"ISO-8859"</span> BODY <span class="hljs-string">"Help"</span></code></pre><p>... significa que los criterios de búsqueda utilizan el conjuntode caracteres iso-8859 y el servidor tendrá que convertir loscriterios de búsqueda antes de buscar, si es necesario.</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_tipos-de-valores-de-b%C3%BAsqueda"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_tipos-de-valores-de-b%25C3%25BAsqueda"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Tipos de valores de búsqueda</h4><p>Las claves de búsqueda pueden solicitar el valor a buscar:</p><ul><li><p><strong>Valores de tipo fecha</strong>: los valores de tipofecha se colocan en cadenas con el siguiente formato:<em>date-day+"-"+date-month+"-"+date-year</em> donde date-dayindica la fecha del día del mes (2 caracteres como máximo),date-month indica el mes(Jan/Feb/Mar/Apr/May/Jun/Jul/Aug/Sep/Oct/Dec) y date-year indica elaño (4 dígitos). Ejemplo: <code>searchCriteria = SENTBEFORE1-Feb-2020</code> (una fecha no suele necesitar comillas, ya que nocontiene caracteres especiales)</p></li><li><p><strong>Valores de tipo cadena</strong>: la cadena puedecontener cualquier caracter y debe ir entre comillas. Si la cadenano contiene ningún caracter especial, como el espacio, por ejemplo,no es necesario colocarla entre comillas. Al colocar entre comillasestas cadenas se garantiza que su valor se interpretarácorrectamente. Ejemplo: <code>criterios de búsqueda = FROM"SMITH"</code> Para todas las llaves de búsqueda que utilizancadenas, un mensaje coincide con la llave si la cadena es unasubcadena del campo. Las coincidencias no diferencian entremayúsculas y minúsculas.</p></li><li><p><strong>Search-keys with a flag value</strong>: the flag mayaccept one or several keywords (including standard flags),separated by spaces. Example: <code>searchCriteria = HEADERCONTENT-TYPE "MIXED"</code></p></li><li><p><strong>Marcadores</strong>: los valores de tipo marcador(flags) aceptan una o varias palabras claves (incluyendo marcadoresestándar) separados por espacios. Ejemplo: <code>searchCriteria =KEYWORD \Flagged \Draft</code></p></li><li><p><strong>Conjunto de mensajes</strong>: identifica un conjunto demensajes. En el caso de los números de secuencia de los mensajes,se trata de números consecutivos desde el 1 hasta el número totalde mensajes en el buzón. Los números son separados por coma; un dospuntos (:) delimita entre dos números inclusive. Ejemplos:<code>2,4:7,9,12:*</code> es <code>2,4,5,6,7,9,12,13,14,15</code>para un buzón con 15 mensajes. <code>searchCriteria = 1:5ANSWERED</code> busca en la selección de mensajes 1 a 5, losmensajes que tienen el marcador \Answered. <code>searchCriteria=2,4 ANSWERED</code> busca en la selección de mensajes (números demensaje 2 y 4) los mensajes que tienen el marcador \Answered.</p></li></ul><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_teclas-de-b%C3%BAsqueda-disponibles"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_teclas-de-b%25C3%25BAsqueda-disponibles"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Teclas de búsqueda disponibles</h4><p><strong>ALL</strong>: todos los mensajes del buzón.<br /><strong>ANSWERED</strong>: mensajes con el marcador\Answered.<br /><strong>UNANSWERED</strong>: mensajes que no tienen el marcador\Answered.<br /><strong>DELETED</strong>: mensajes con el marcador \Deleted.<br /><strong>UNDELETED</strong>: mensajes que no tienen el marcador\Deleted.<br /><strong>DRAFT</strong>: mensajes con el marcador \Draft.<br /><strong>UNDRAFT</strong>: mensajes que no tienen el marcador\Draft.<br /><strong>FLAGGED</strong>: mensajes con el marcador \Flagged.<br /><strong>UNFLAGGED</strong>: mensajes que no tienen el marcador\Flagged.<br /><strong>RECENT</strong>: mensajes que tienen el marcador\Recent.<br /><strong>OLD</strong>: mensajes que no tienen el marcador\Recent.<br /><strong>SEEN</strong>: mensajes que tienen el marcador \Seen.<br /><strong>UNSEEN</strong>: Mensajes que no tienen el marcador\Seen.<br /><strong>NEW</strong>: mensajes que tienen el marcador \Recent perono el marcador \Seen. Esto es equivalente a "(RECENTUNSEEN)".<br />***KEYWORD ***flag******: mensajes con el conjunto de palabrasclave especificado.<br />***UNKEYWORD ***flag******: mensajes que no tienen la palabra claveespecificada.<br />***BEFORE ***date******: mensajes cuya fecha interna es anterior ala fecha especificada.<br />***ON ***date******: mensajes cuya fecha interna está dentro de lafecha especificada.<br />***SINCE ***date******: mensajes cuya fecha interna está dentro oes posterior a la fecha especificada.<br />***SENTBEFORE ***date******: mensajes cuyo encabezado Date esanterior a la fecha especificada.<br />***SENTON ***date******: mensajes cuyo encabezado Date está dentrode la fecha especificada.<br />***SENTSINCE ***date******: mensajes cuyo encabezado Date estádentro o es posterior a la fecha especificada.<br />***TO ***string******: mensajes que contienen la cadenaespecificada en el encabezado TO.<br />***FROM ***string******: mensajes que contienen la cadenaespecificada en el encabezado FROM.<br />***CC ***string******: mensajes que contienen la cadenaespecificada en en el encabezado CC.<br />***BCC ***string******: mensajes que contienen la cadenaespecificada en en el encabezado BCC.<br />***SUBJECT ***string******: mensajes que contienen la cadenaespecificada en en el encabezado Asunto.<br />***BODY ***string******: mensajes que contienen la cadenaespecificada en el cuerpo del mensaje.<br />***TEXT ***string******: mensajes que contienen la cadenaespecificada en el encabezado o en el cuerpo del mensaje.<br />***HEADER <em>field-name</em> ***string******: mensajes que tienenun encabezado con el field-name especificado y que contienen lacadena especificada en el field-body.<br />***UID ***message-UID******: mensajes con identificadores únicoscorrespondientes al conjunto de identificadores únicosespecificado.<br />***LARGER ***n******: mensajes con un tamaño superior al número debytes especificado.<br />***SMALLER ***n******: mensajes con un tamaño inferior al número debytes especificado.<br />***NOT ***search-key******: mensajes que no coinciden con alcriterio de búsqueda especificado.<br />***OR <em>search-key1</em> ***search-key2******: mensajes quecoinciden con cualquiera de las dos criterios de búsqueda.</p><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_selectbox"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_selectbox"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.selectBox()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18 R4</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.selectBox</strong>( <em>name</em> : Text { ;<em>state</em> : Integer } ) : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del buzón</td></tr><tr><td>state</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Estado de acceso al buzón</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>objeto boxInfo</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-28"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-28"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.selectBox()</code> selecciona el buzón<em>name</em> como el buzón actual. Esta función permite recuperarla información sobre el buzón.</p><blockquote><p>Para obtener la información de un buzón sin cambiar el buzónactual, utilice <a href="#IMAPTransporterClass.html_getboxinfo"><code>.getBoxInfo()</code></a>.</p></blockquote><p>En el parámetro <em>name</em>, pase el nombre del buzón aacceder. El nombre representa una jerarquía inequívoca de izquierdaa derecha, con niveles separados por un carácter delimitadorespecífico. El delimitador se puede recuperar con la función<a href="#IMAPTransporterClass.html_getdelimiter"><code>.getDelimiter()</code></a>.</p><p>El parámetro opcional <em>state</em> define el tipo de acceso albuzón. Los valores posibles son:</p><table><thead><tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr></thead><tbody><tr><td>IMAP read only state</td><td>1</td><td>Se accede al buzón seleccionado con privilegios de sólolectura. Los mensajes con la bandera "reciente" (que indica que sonnuevos) no se modifican.</td></tr><tr><td>IMAP read write state</td><td>0</td><td>Se accede al buzón seleccionado con privilegios de lectura yescritura. Los mensajes se consideran "vistos" y pierden la bandera"reciente" (que indica que son mensajes nuevos). (Valor pordefecto)</td></tr></tbody></table><blockquote><ul><li>La función genera un error y devuelve <strong>Null</strong> si<em>name</em> designa un buzón inexistente.</li><li>Si no hay ninguna conexión abierta, <code>.selectBox()</code>abrirá una conexión.</li><li>Si la conexión no se ha utilizado desde el retraso de conexióndesignado (ver <code>IMAP New transporter</code>), se llamaautomáticamente a la función <a href="#IMAPTransporterClass.html_checkconnection"><code>.checkConnection()</code></a>.</li></ul></blockquote><p><strong>Objeto devuelto</strong></p><p>El objeto <code>boxInfo</code> devuelto contiene las siguientespropiedades:</p><table><thead><tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>name</td><td>Texto</td><td>Nombre del buzón</td></tr><tr><td>mailCount</td><td>number</td><td>Número de mensajes en el buzón</td></tr><tr><td>mailRecent</td><td>number</td><td>Número de mensajes con la bandera "recent"</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-15"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-15"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$server</span>; <span class="hljs-variable">$boxinfo </span>: Object <span class="hljs-variable">$server</span>:=New object <span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"imap.gmail.com"</span> <span class="hljs-comment">//Mandatory</span> <span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"4d@gmail.com"</span> <span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"XXXXXXXX"</span><span class="hljs-keyword"> var</span> <span class="hljs-variable">$transporter </span>: 4D.IMAPTransporter <span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$server</span>) <span class="hljs-variable">$boxInfo</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">selectBox</span>(<span class="hljs-string">"INBOX"</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_subscribe"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_subscribe"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.subscribe()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v19</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.subscribe</strong>( <em>name</em> : Text ) : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del buzón</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación subscribe</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-29"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-29"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.subscribe()</code> permite añadir o eliminarel buzón especificado del conjunto de buzones "suscritos" en elservidor IMAP. De este modo, puede optar por acotar una gran listade buzones disponibles suscribiéndose a los que habitualmenteconsulta.</p><p>En el parámetro <code>name</code>, pase el nombre del buzón aañadir (suscribir) a sus buzones "suscritos".</p><p><strong>Objeto devuelto</strong></p><p>La función devuelve un objeto que describe el estado IMAP:</p><table><thead><tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr><tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último errordevuelto en la pila de errores de 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuestadel servidor IMAP)</td></tr><tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr><tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-16"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-16"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><p>Para suscribirse al buzón "Atlas Corp" en la jerarquía"Bills":</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Atlas Corp"</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">subscribe</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">If</span> (<span class="hljs-variable">$status</span>.success)<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox subscription successful!"</span>)<span class="hljs-keyword">   Else</span><span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">   End if</span><span class="hljs-keyword">End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_unsubscribe"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_unsubscribe"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.unsubscribe()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v19</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.unsubscribe</strong>( <em>name</em> : Text ) :Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre del buzón</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Estado de la operación unsubscribe</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-30"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-30"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.unsubscribe()</code> elimina un buzón de unconjunto de buzones suscritos. Esto le permite reducir el número debuzones que suele ver.</p><p>En el parámetro <code>name</code>, pase el nombre del buzón aeliminar (darse de baja) de sus buzones activos.</p><p><strong>Objeto devuelto</strong></p><p>La función devuelve un objeto que describe el estado IMAP:</p><table><thead><tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td></td><td>Booleano</td><td>True si la operación tiene éxito, False en caso contrario</td></tr><tr><td>statusText</td><td></td><td>Texto</td><td>Mensaje de estado devuelto por el servidor IMAP, o último errordevuelto en la pila de errores de 4D</td></tr><tr><td>errors</td><td></td><td>Collection</td><td>Pila de errores 4D (no se devuelve si se recibe una respuestadel servidor IMAP)</td></tr><tr><td></td><td>[].errcode</td><td>Número</td><td>Código de error 4D</td></tr><tr><td></td><td>[].message</td><td>Texto</td><td>Descripción del error 4D</td></tr><tr><td></td><td>[].componentSignature</td><td>Texto</td><td>Firma del componente interno que ha devuelto el error</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_ejemplo-17"></a><a aria-hidden="true"class="hash-link" href="#IMAPTransporterClass.html_ejemplo-17"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><p>Para desuscribirse del buzón "Atlas Corp" en la jerarquía"Bills":</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$pw</span>; <span class="hljs-variable">$name </span>: text<span class="hljs-keyword">var</span> <span class="hljs-variable">$options</span>; <span class="hljs-variable">$transporter</span>; <span class="hljs-variable">$status </span>: object<span class="hljs-variable">$options</span>:=New object<span class="hljs-variable">$pw</span>:=<span class="hljs-function">Request</span>(<span class="hljs-string">"Please enter your password:"</span>)<span class="hljs-keyword">If</span>(OK=<span class="hljs-number">1</span>) <span class="hljs-variable">$options</span>.host:=<span class="hljs-string">"imap.gmail.com"</span><span class="hljs-variable">$options</span>.user:=<span class="hljs-string">"test@gmail.com"</span><span class="hljs-variable">$options</span>.password:=<span class="hljs-variable">$pw</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">IMAP New transporter</span>(<span class="hljs-variable">$options</span>)<span class="hljs-variable">$name</span>:=<span class="hljs-string">"Bills"</span>+<span class="hljs-variable">$transporter</span>.<span class="hljs-function">getDelimiter</span>()+<span class="hljs-string">"Atlas Corp"</span><span class="hljs-variable">$status</span>:=<span class="hljs-variable">$transporter</span>.<span class="hljs-function">unsubscribe</span>(<span class="hljs-variable">$name</span>)<span class="hljs-keyword">If</span> (<span class="hljs-variable">$status</span>.success)<span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Mailbox unsubscription successful!"</span>)<span class="hljs-keyword">   Else</span><span class="hljs-function">   ALERT</span>(<span class="hljs-string">"Error: "</span>+<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword">   End if</span><span class="hljs-keyword">End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_user"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_user"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.user</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17 R4</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.user</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="IMAPTransporterClass.html_descripci%C3%B3n-31"></a><a aria-hidden="true" class="hash-link" href="#IMAPTransporterClass.html_descripci%25C3%25B3n-31"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La propiedad <code>.user</code> contiene el nombre de usuarioutilizado para la autenticación en el servidor de correo.</p><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#FunctionClass.html"><span class="arrow-prev">←</span><span>Formula</span></a><a class="docs-next button" href="#MailAttachmentClass.html"><span class="function-name-prevnext">MailAttachment</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#IMAPTransporterClass.html_imap-new-transporter">IMAPNew transporter</a></li><li><a href="#IMAPTransporterClass.html_4dimaptransporternew">4D.IMAPTransporter.new()</a></li><li><a href="#IMAPTransporterClass.html_acceptunsecureconnection">.acceptUnsecureConnection</a></li><li><a href="#IMAPTransporterClass.html_addflags">.addFlags()</a></li><li><a href="#IMAPTransporterClass.html_append">.append()</a></li><li><a href="#IMAPTransporterClass.html_authenticationmode">.authenticationMode</a></li><li><a href="#IMAPTransporterClass.html_checkconnection">.checkConnection()</a></li><li><a href="#IMAPTransporterClass.html_checkconnectiondelay">.checkConnectionDelay</a></li><li><a href="#IMAPTransporterClass.html_connectiontimeout">.connectionTimeOut</a></li><li><a href="#IMAPTransporterClass.html_copy">.copy()</a></li><li><a href="#IMAPTransporterClass.html_createbox">.createBox()</a></li><li><a href="#IMAPTransporterClass.html_delete">.delete()</a></li><li><a href="#IMAPTransporterClass.html_deletebox">.deleteBox()</a></li><li><a href="#IMAPTransporterClass.html_expunge">.expunge()</a></li><li><a href="#IMAPTransporterClass.html_getboxinfo">.getBoxInfo()</a></li><li><a href="#IMAPTransporterClass.html_getboxlist">.getBoxList()</a></li><li><a href="#IMAPTransporterClass.html_getdelimiter">.getDelimiter()</a></li><li><a href="#IMAPTransporterClass.html_getmail">.getMail()</a></li><li><a href="#IMAPTransporterClass.html_getmails">.getMails()</a></li><li><a href="#IMAPTransporterClass.html_getmimeasblob">.getMIMEAsBlob()</a></li><li><a href="#IMAPTransporterClass.html_host">.host</a></li><li><a href="#IMAPTransporterClass.html_logfile">.logFile</a></li><li><a href="#IMAPTransporterClass.html_move">.move()</a></li><li><a href="#IMAPTransporterClass.html_numtoid">.numToID()</a></li><li><a href="#IMAPTransporterClass.html_removeflags">.removeFlags()</a></li><li><a href="#IMAPTransporterClass.html_renamebox">.renameBox()</a></li><li><a href="#IMAPTransporterClass.html_port">.port</a></li><li><a href="#IMAPTransporterClass.html_searchmails">.searchMails()</a></li><li><a href="#IMAPTransporterClass.html_selectbox">.selectBox()</a></li><li><a href="#IMAPTransporterClass.html_subscribe">.subscribe()</a></li><li><a href="#IMAPTransporterClass.html_unsubscribe">.unsubscribe()</a></li><li><a href="#IMAPTransporterClass.html_user">.user</a></li></ul></nav></div></div></body></html>