<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="es"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Entity · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="Una [entidad](/docs/Rx/es/ORDA/dsmapping.html#entity) es una instancia de una [Dataclass](/docs/Rx/es/ORDA/dsmapping.html#dataclass), como un registro de la tabla que coincide con la dataclass en su datastore asociado. Contiene los mismos atributos que la clase de datos, así como los valores de los datos y las propiedades y funciones específicas."name="description" /><meta content="es" name="docsearch:language" /><meta content="Entity · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="Una [entidad](/docs/Rx/es/ORDA/dsmapping.html#entity) es una instancia de una [Dataclass](/docs/Rx/es/ORDA/dsmapping.html#dataclass), como un registro de la tabla que coincide con la dataclass en su datastore asociado. Contiene los mismos atributos que la clase de datos, así como los valores de los datos y las propiedades y funciones específicas."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#EntityClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">Entity<a aria-hidden="true" class="anchor" id="EntityClass.html"></a></h1></header><article><div><p><span>Una <a href="#EntityClass.html_entity">entidad</a> es unainstancia de una <a href="#EntityClass.html_dataclass">Dataclass</a>, como un registro de latabla que coincide con la dataclass en su datastore asociado.Contiene los mismos atributos que la clase de datos, así como losvalores de los datos y las propiedades y funcionesespecíficas.</span></p><h3><span><a aria-hidden="true" class="anchor" id="EntityClass.html_resumen"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_resumen"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resumen</span></h3><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#EntityClass.html_attributename"><strong><em>.attributeName</em></strong>: any</a><p>&nbsp;&nbsp;&nbsp;&nbsp; almacena el valor del atributo para laentidad</p></td></tr><tr><td><a href="#EntityClass.html_clone"><strong>.clone()</strong> :4D.Entity</a><p>&nbsp;&nbsp;&nbsp;&nbsp; crea en memoria una nueva entidad quehace referencia al mismo registro que la entidad original</p></td></tr><tr><td><a href="#EntityClass.html_diff"><strong>.diff</strong>(<em>entityToCompare</em> : 4D.Entity { ;<em>attributesToCompare</em> : Collection } ) : Collection</a><p>&nbsp;&nbsp;&nbsp;&nbsp; compara el contenido de dos entidades ydevuelve sus diferencias</p></td></tr><tr><td><a href="#EntityClass.html_drop"><strong>.drop</strong>({<em>mode</em> : Integer} ) : Object</a><p>&nbsp;&nbsp;&nbsp;&nbsp; elimina los datos contenidos en laentidad del datastore</p></td></tr><tr><td><a href="#EntityClass.html_first"><strong>.first()</strong>:4D.Entity</a><p>&nbsp;&nbsp;&nbsp;&nbsp; devuelve una referencia a la entidad enprimera posición de la selección de entidades a la que pertenece laentidad</p></td></tr><tr><td><a href="#EntityClass.html_fromobject"><strong>.fromObject</strong>(<em>filler</em> : Object )</a><p>&nbsp;&nbsp;&nbsp;&nbsp; llena una entidad con el contenido<em>filler</em>.</p></td></tr></tbody></table><blockquote><p><span>Esta función modifica la entidad original.</span></p></blockquote><p><span>El mapeo entre el objeto y la entidad se realiza sobre losnombres de los atributos:</span></p><ul><li><span>Si una propiedad del objeto no existe en la dataclass, seignora.</span></li><li><span>Los tipos de datos deben ser equivalentes. Si hay unadiferencia de tipo entre el objeto y la dataclass, 4D intentaconvertir los datos siempre que sea posible (ver <a href="#EntityClass.html_converting-data-types"><code>Convertir tipos dedatos</code></a>), de lo contrario el atributo se deja sintocar.</span></li><li><span>La llave primaria puede darse tal cual o con unapropiedad "__KEY" (llenada con el valor de la llave primaria). Sino existe ya en la dataclass, la entidad se crea con el valor dadocuando se llama a <a href="#EntityClass.html_save">.save()</a>. Sino se da la llave primaria, se crea la entidad y se asigna el valorde la llave primaria con respecto a las reglas de la base de datos.El autoincremento sólo se calcula si la llave primaria esnula.</span></li></ul><p><span><em>filler</em> puede manejar una entidad relacionada bajolas siguientes condiciones:</span></p><ul><li><span><em>filler</em> contiene la propia llave foránea,o</span></li><li><span><em>filler</em> contiene un objeto de propiedad con elmismo nombre que la entidad relacionada, que contiene una únicapropiedad denominada "__KEY".</span></li><li><span>si la entidad relacionada no existe, seignora.</span></li></ul><h4><span><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</span></h4><p><span>Con el siguiente objeto $o:</span></p><pre><span><code class="hljs css language-4d">{    <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Mary"</span>,    <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Smith"</span>,    <span class="hljs-string">"salary"</span>: <span class="hljs-number">36500</span>,    <span class="hljs-string">"birthDate"</span>: <span class="hljs-string">"1958-10-27T00:00:00.000Z"</span>,    <span class="hljs-string">"woman"</span>: true,    <span class="hljs-string">"managerID"</span>: <span class="hljs-number">411</span>,<span class="hljs-comment">// relatedEntity dada con PK</span>    <span class="hljs-string">"employerID"</span>: <span class="hljs-number">20</span> <span class="hljs-comment">// relatedEntity dada con PK</span>}</code></span></pre><p>El siguiente código creará una entidad con entidadesrelacionadas con el gerente y el empleador.</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$o </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$entity </span>: cs.EmpEntity <span class="hljs-variable">$entity</span>:=ds.Emp.<span class="hljs-function">new</span>() <span class="hljs-variable">$entity</span>.<span class="hljs-function">fromObject</span>(<span class="hljs-variable">$o</span>) <span class="hljs-variable">$entity</span>.<span class="hljs-function">save</span>()</code></pre><p>También puede utilizar una entidad relacionada dada comoobjeto:</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Marie"</span>,    <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Lechat"</span>,    <span class="hljs-string">"salary"</span>: <span class="hljs-number">68400</span>,    <span class="hljs-string">"birthDate"</span>: <span class="hljs-string">"1971-09-03T00:00:00.000Z"</span>,    <span class="hljs-string">"woman"</span>: false,    <span class="hljs-string">"employer"</span>: {<span class="hljs-comment">// relatedEntity dada como un objeto</span>        <span class="hljs-string">"__KEY"</span>: <span class="hljs-string">"21"</span>    },    <span class="hljs-string">"manager"</span>: {<span class="hljs-comment">// relatedEntity dada como un objeto</span>        <span class="hljs-string">"__KEY"</span>: <span class="hljs-string">"411"</span>    }}</code></pre><pre><code class="hljs">                                             |</code></pre><p>| <a href="#EntityClass.html_getdataclass"><strong>.getDataClass()</strong> :4D.DataClass</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp; devuelve la clase de datos de laentidad | | <a href="#EntityClass.html_getkey"><strong>.getKey</strong>( {<em>mode</em> : Integer } ) : Text<br /><strong>.getKey</strong>( { <em>mode</em> : Integer } ) :Integer</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp; devuelve el valor de la llave primaria| | <a href="#EntityClass.html_getremotecontextattributes">Devuelve:</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp; | | <a href="#EntityClass.html_getselection"><strong>.getSelection()</strong>:4D.EntitySelection</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp; devuelve la selección de entidades a laque pertenece la entidad | | <a href="#EntityClass.html_getstamp"><strong>.getStamp()</strong> :Integer</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp; devuelve el valor actual del sello dela entidad | | <a href="#EntityClass.html_indexof"><strong>.indexOf</strong>( {<em>entitySelection</em> : 4D.EntitySelection } ) : Integer</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp; devuelve la posición de la entidad enuna selección de entidades | | <a href="#EntityClass.html_isnew"><strong>.isNew()</strong> :Boolean</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp; devuelve True si la entidad a la que seaplica acaba de ser creada y aún no ha sido guardada en eldatastore | | <a href="#EntityClass.html_last"><strong>.last()</strong> :4D.Entity</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp; | | <a href="#EntityClass.html_lock"><strong>.lock</strong>( { <em>mode</em> :Integer } ) : Object</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp;pone un bloqueo pesimista en el registroreferenciado por la entidad | | <a href="#EntityClass.html_next"><strong>.next()</strong> :4D.Entity</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp; devuelve una referencia a la siguienteentidad en la selección de entidades a la que pertenece la entidad| | <a href="#EntityClass.html_previous"><strong>.previous()</strong> :4D.Entity</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp; devuelve una referencia a la entidadanterior en la selección de entidades a la que pertenece la entidad| | <a href="#EntityClass.html_reload"><strong>.reload()</strong> :Object</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp;recarga el contenido de la entidad enmemoria | | <a href="#EntityClass.html_save"><strong>.save</strong>( { <em>mode</em> :Integer } ) : Object</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp; guarda los cambios realizados en laentidad | | <a href="#EntityClass.html_toobject"><strong>.toObject</strong>() :Object<br /><strong>.toObject</strong>( <em>filterString</em> : Text { ;<em>options</em> : Integer} ) : Object<br /><strong>.toObject</strong>( <em>filterCol</em> : Collection { ;<em>options</em> : Integer } ) : Object</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp; devuelve un objeto que ha sidoconstruido a partir de la entidad | | <a href="#EntityClass.html_touched"><strong>.touched()</strong> :Boolean</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp; comprueba si un atributo de la entidadha sido modificado o no desde que la entidad fue cargada en memoriao guardada | | <a href="#EntityClass.html_touchedattributes"><strong>.touchedAttributes()</strong>: Collection</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp; devuelve los nombres de los atributosque han sido modificados desde que la entidad fue cargada enmemoria | | <a href="#EntityClass.html_unlock"><strong>.unlock()</strong> :Object</a></p><p>&nbsp;&nbsp;&nbsp;&nbsp; elimina el bloqueo pesimista delregistro que coincide con la entidad |</p><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_attributename"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_attributename"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.<em>attributeName</em></h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong><em>.attributeName</em></strong> : any</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>Todo atributo de la dataclass está disponible como una propiedadde una entidad, que almacena el valor del atributo para laentidad.</p><blockquote><p>Los atributos dataclass también se pueden alcanzar utilizando lasintaxis alternativa con [ ].</p></blockquote><p>El tipo de valor del atributo depende del tipo <a href="#EntityClass.html_kind">kind</a> de atributo (relación oalmacenamiento):</p><ul><li>Si el tipo de <em>attributeName</em> es<strong>storage</strong>: <code>.attributeName</code> devuelve unvalor del mismo tipo que <em>attributeName</em>.</li><li>Si el tipo de <em>attributeName</em> es<strong>relatedEntity</strong>: <code>.attributeName</code>devuelve la entidad relacionada. Los valores de la entidadrelacionada están disponibles directamente a través de laspropiedades en cascada, por ejemplo"myEntity.employer.employees[0].lastname".</li><li>Si el tipo de <em>attributeName</em> es<strong>relatedEntities</strong>: <code>.attributeName</code>devuelve una nueva entity selection de entidades relacionadas. Seeliminan los duplicados (se devuelve una entity selectiondesordenada).</li></ul><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$myEntity </span>: cs.EmployeeEntity <span class="hljs-variable">$myEntity</span>:=ds.Employee.<span class="hljs-function">new</span>() <span class="hljs-comment">//Crear una nueva entidad</span> <span class="hljs-variable">$myEntity</span>.name:=<span class="hljs-string">"Dupont"</span> <span class="hljs-comment">// asignar 'Dupont' al atributo 'name'</span> <span class="hljs-variable">$myEntity</span>.firstname:=<span class="hljs-string">"John"</span> <span class="hljs-comment">//asignar 'John' al atributo 'firstname'</span> <span class="hljs-variable">$myEntity</span>.<span class="hljs-function">save</span>() <span class="hljs-comment">//guardar la entidad</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_clone"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_clone"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.clone()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.clone()</strong> : 4D.Entity</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>4D.Entity</td><td style="text-align:center">&lt;-</td><td>Nueva entidad que hace referencia al registro</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-1"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.clone()</code> crea en memoria una nuevaentidad que hace referencia al mismo registro que la entidadoriginal. Esta función permite actualizar las entidades porseparado.</p><blockquote><p>Tenga en cuenta que toda modificación realizada a las entidadesse guardará en el registro referenciado sólo cuando se ejecute lafunción <a href="#EntityClass.html_save"><code>.save()</code></a>.</p></blockquote><p>Esta función sólo puede utilizarse con entidades ya guardadas enla base de datos. No se puede llamar a una entidad recién creada(para la que <a href="#EntityClass.html_isnew"><code>.isNew()</code></a> devuelve<strong>True</strong>).</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-2"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$emp</span>; <span class="hljs-variable">$empCloned </span>: cs.EmployeeEntity <span class="hljs-variable">$emp</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">672</span>) <span class="hljs-variable">$empCloned</span>:=<span class="hljs-variable">$emp</span>.<span class="hljs-function">clone</span>() <span class="hljs-variable">$emp</span>.lastName:=<span class="hljs-string">"Smith"</span> <span class="hljs-comment">//Las actualizaciones realizadas en $emp no se realizan en $empCloned</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_diff"></a><a aria-hidden="true" class="hash-link"href="#EntityClass.html_diff"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.diff()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.diff</strong>( <em>entityToCompare</em> : 4D.Entity { ;<em>attributesToCompare</em> : Collection } ) : Collection</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>entityToCompare</td><td>4D.Entity</td><td style="text-align:center">-&gt;</td><td>Entidad a comparar con la entidad original</td></tr><tr><td>attributesToCompare</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Nombre de los atributos a comparar</td></tr><tr><td>Resultado</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Diferencias entre las entidades</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-2"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.diff()</code> compara el contenido de dosentidades y devuelve sus diferencias.</p><p>En <em>entityToCompare</em>, pase la entidad a comparar con laentidad original.</p><p>En <em>attributesToCompare</em>, puede designar atributosespecíficos para comparar. Si se suministra, la comparación serealiza sólo en los atributos especificados. Si no se suministra,se devuelven todas las diferencias entre las entidades.</p><p>Las diferencias se devuelven como una colección de objetos cuyaspropiedades son:</p><table><thead><tr><th>Nombre de propiedad</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>attributeName</td><td>Cadena</td><td>Nombre del atributo</td></tr><tr><td>value</td><td>cualquiera - Depende del tipo de atributo</td><td>Valor del atributo en la entidad</td></tr><tr><td>otherValue</td><td>cualquiera - Depende del tipo de atributo</td><td>Valor del atributo en <em>entityToCompare</em></td></tr></tbody></table><p>Sólo se incluyen en la colección los atributos con valoresdiferentes. Si no se encuentran diferencias, <code>.diff()</code>devuelve una colección vacía.</p><p>La función se aplica a las propiedades cuyo <a href="#EntityClass.html_kind">kind</a> es <strong>storage</strong> o<strong>relatedEntity</strong>. En caso de que se haya actualizadouna entidad relacionada (es decir, la llave foránea), el nombre dela entidad relacionada y su nombre de llave primaria se devuelvencomo propiedades <em>attributeName</em> (<em>value</em> y<em>otherValue</em> están vacíos para el nombre de la entidadrelacionada).</p><p>Si una de las entidades comparadas es <strong>Null</strong>, seproduce un error.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-1-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-1-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 1</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$diff1</span>; <span class="hljs-variable">$diff2 </span>: Collection employee:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"ID=1001"</span>).<span class="hljs-function">first</span>() <span class="hljs-variable">$clone</span>:=employee.<span class="hljs-function">clone</span>() employee.firstName:=<span class="hljs-string">"MARIE"</span> employee.lastName:=<span class="hljs-string">"SOPHIE"</span> employee.salary:=<span class="hljs-number">500</span> <span class="hljs-variable">$diff1</span>:=<span class="hljs-variable">$clone</span>.<span class="hljs-function">diff</span>(employee) <span class="hljs-comment">// Se devuelven todas las diferencias</span> <span class="hljs-variable">$diff2</span>:=<span class="hljs-variable">$clone</span>.<span class="hljs-function">diff</span>(employee;New collection<span class="hljs-string">"firstName"</span>;<span class="hljs-string">"lastName"</span>))  <span class="hljs-comment">// Sólo se devuelven las diferencias en el firstName y lastName</span></code></pre><p>$diff1:</p><pre><code class="hljs css language-4d">[    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"firstName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Natasha"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"MARIE"</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"lastName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Locke"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"SOPHIE"</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"salary"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-number">66600</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-number">500</span>    }]<span class="hljs-variable">$diff2</span>:[    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"firstName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Natasha"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"MARIE"</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"lastName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Locke"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"SOPHIE"</span>    }]</code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-2-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-2-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 2</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> vCompareResult1; vCompareResult2; vCompareResult3; <span class="hljs-variable">$attributesToInspect </span>: Collection vCompareResult1:=New collection vCompareResult2:=New collection vCompareResult3:=New collection <span class="hljs-variable">$attributesToInspect</span>:=New collection <span class="hljs-variable">$e1</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">636</span>) <span class="hljs-variable">$e2</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">636</span>) <span class="hljs-variable">$e1</span>.firstName:=<span class="hljs-variable">$e1</span>.firstName+<span class="hljs-string">" update"</span> <span class="hljs-variable">$e1</span>.lastName:=<span class="hljs-variable">$e1</span>.lastName+<span class="hljs-string">" update"</span> <span class="hljs-variable">$c</span>:=ds.Company.<span class="hljs-function">get</span>(<span class="hljs-number">117</span>) <span class="hljs-variable">$e1</span>.employer:=<span class="hljs-variable">$c</span> <span class="hljs-variable">$e2</span>.salary:=<span class="hljs-number">100</span> <span class="hljs-variable">$attributesToInspect</span>.<span class="hljs-function">push</span>(<span class="hljs-string">"firstName"</span>) <span class="hljs-variable">$attributesToInspect</span>.<span class="hljs-function">push</span>(<span class="hljs-string">"lastName"</span>) vCompareResult1:=<span class="hljs-variable">$e1</span>.<span class="hljs-function">diff</span>(<span class="hljs-variable">$e2</span>) vCompareResult2:=<span class="hljs-variable">$e1</span>.<span class="hljs-function">diff</span>(<span class="hljs-variable">$e2</span>;<span class="hljs-variable">$attributesToInspect</span>) vCompareResult3:=<span class="hljs-variable">$e1</span>.<span class="hljs-function">diff</span>(<span class="hljs-variable">$e2</span>;<span class="hljs-variable">$e1</span>.<span class="hljs-function">touchedAttributes</span>())</code></pre><p>vCompareResult1 (se devuelven todas las diferencias):</p><pre><code class="hljs css language-4d">[    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"firstName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Karla update"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"Karla"</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"lastName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Marrero update"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"Marrero"</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"salary"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-number">33500</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-number">100</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"employerID"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-number">117</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-number">118</span>    },  {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"employer"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"[object Entity]"</span>,<span class="hljs-comment">// Entity 117 from Company</span>        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"[object Entity]"</span><span class="hljs-comment">// Entity 118 from Company</span>    }]</code></pre><p>vCompareResult2 (sólo se devuelven las diferencias en$attributesToInspect)</p><pre><code class="hljs css language-4d">[    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"firstName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Karla update"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"Karla"</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"lastName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Marrero update"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"Marrero"</span>    }]</code></pre><p>vCompareResult3 (sólo se devuelven las diferencias en atributostocados $e1)</p><pre><code class="hljs css language-4d">[    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"firstName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Karla update"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"Karla"</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"lastName"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"Marrero update"</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"Marrero"</span>    },    {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"employerID"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-number">117</span>,        <span class="hljs-string">"otherValue"</span>: <span class="hljs-number">118</span>    },     {        <span class="hljs-string">"attributeName"</span>: <span class="hljs-string">"employer"</span>,        <span class="hljs-string">"value"</span>: <span class="hljs-string">"[object Entity]"</span>,<span class="hljs-comment">// Entity 117 from Company</span>        <span class="hljs-string">"otherValue"</span>: <span class="hljs-string">"[object Entity]"</span><span class="hljs-comment">// Entity 118 from Company</span>    }]</code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_drop"></a><a aria-hidden="true" class="hash-link"href="#EntityClass.html_drop"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.drop()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.drop</strong>( {<em>mode</em> : Integer} ) : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>mode</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>dk force drop if stamp changed</code>: activa el soltarincluso si el sello ha cambiado</td></tr><tr><td>Resultado</td><td>Object</td><td style="text-align:center">&lt;-</td><td>Resultado de la operación soltar</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-3"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.drop()</code> elimina los datos contenidos enla entidad del datastore, de la tabla relacionada con su Dataclass.Tenga en cuenta que la entidad permanece en la memoria.</p><p>En una aplicación multiusuario o multiproceso, la función<code>.drop()</code> se ejecuta bajo un mecanismo de <a href="#EntityClass.html_entity-locking">"bloqueo optimista"</a>, en elque un sello de bloqueo interno se incrementa automáticamente cadavez que se guarda el registro.</p><p>Por defecto, si se omite el parámetro <em>mode</em>, la funcióndevolverá un error (ver más abajo) si la misma entidad fuemodificada (es decir, el sello ha cambiado) por otro proceso ousuario en el ínterin.</p><p>De lo contrario, puede pasar la opción <code>dk force drop ifstamp changed</code> en el parámetro <em>mode</em>: en este caso,la entidad se abandona aunque el sello haya cambiado (y la llaveprimaria siga siendo la misma).</p><p><strong>Resultado</strong></p><p>El objeto devuelto por <code>.drop( )</code> contiene lassiguientes propiedades:</p><table><thead><tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td></td><td>boolean</td><td>true si la acción de soltar tiene éxito, false en casocontrario.</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible sólo en caso deerror:</em></strong></td></tr><tr><td>status(*)</td><td></td><td>number</td><td>Código de error, ver abajo</td></tr><tr><td>statusText(*)</td><td></td><td>text</td><td>Descripción del error, ver abajo</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible sólo en caso de error de bloqueopesimista:</em></strong></td></tr><tr><td>LockKindText</td><td></td><td>text</td><td>"Locked by record"</td></tr><tr><td>lockInfo</td><td></td><td>object</td><td>Información sobre el origen del bloqueo</td></tr><tr><td></td><td>task_id</td><td>number</td><td>Id del proceso</td></tr><tr><td></td><td>user_name</td><td>text</td><td>Nombre de usuario de la sesión en la máquina</td></tr><tr><td></td><td>user4d_alias</td><td>text</td><td>Alias de usuario si está definido por <code>SET USERALIAS</code>, si no, nombre de usuario en el directorio 4D</td></tr><tr><td></td><td>host_name</td><td>text</td><td>Nombre de la máquina</td></tr><tr><td></td><td>task_name</td><td>text</td><td>Nombre del proceso</td></tr><tr><td></td><td>client_version</td><td>text</td><td></td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible sólo en caso de error grave (un errorgrave puede ser intentar duplicar una llave primaria, discolleno...):</em></strong></td></tr><tr><td>errors</td><td></td><td>collection of objects</td><td></td></tr><tr><td></td><td>message</td><td>text</td><td>Mensaje de error</td></tr><tr><td></td><td>component signature</td><td>text</td><td>firma del componente interno (por ejemplo, "dmbg" significa elcomponente de la base)</td></tr><tr><td></td><td>errCode</td><td>number</td><td>Código de error</td></tr></tbody></table><p>(*) Los siguientes valores pueden ser devueltos en laspropiedadese <em>status</em> y <em>statusText</em> del objeto<em>Result</em> en caso de error:</p><table><thead><tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr></thead><tbody><tr><td><code>dk status entity does not exist anymore</code></td><td>5</td><td>La entidad ya no existe en los datos. Este error puede ocurriren los siguientes casos:<br /><ul><li>la entidad ha sido abandonada (el sello ha cambiado y elespacio de memoria está ahora libre)</li><li>la entidad ha sido eliminada y sustituida por otra con otrallave primaria (el sello ha cambiado y una nueva entidad utilizaahora el espacio de memoria). Cuando se utiliza entity.drop( ),este error puede ser devuelto cuando se utiliza la opción dk forcedrop if stamp changed. Cuando se utiliza entity.lock( ), este errorpuede ser devuelto cuando se utiliza la opción dk reload if stampchanged</li><p><strong>statusText asociado</strong>: "La entidad ya noexiste"</p></ul></td></tr><tr><td><code>dk status locked</code></td><td>3</td><td>La entidad está bloqueada por un bloqueo pesimista.<br /><strong>statusText asociado</strong>: "Ya está bloqueado"</td></tr><tr><td><code>dk status serious error</code></td><td>4</td><td>Un error grave es un error de base de datos de bajo nivel (porejemplo, una llave duplicada), un error de hardware, etc.<br /><strong>statusText asociado</strong>: "Otro error"</td></tr><tr><td><code>dk status stamp has changed</code></td><td>2</td><td>El valor del sello interno de la entidad no coincide con el dela entidad almacenada en los datos (bloqueo optimista).<br /><ul><li>con <code>.save( )</code>: error sólo si no se utiliza laopción <code>dk auto merge</code></li><li>con <code>.drop( )</code>: error sólo si no se utiliza laopción <code>dk force drop if stamp changed</code></li><li>con <code>.lock( )</code>: error sólo si no se utiliza laopción <code>dk reload if stamp changed</code></li><li>**statusText asociado **: "El sello ha cambiado"</li></ul></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-1-2"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-1-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 1</h4><p>Ejemplo sin la opción <code>dk force drop if stampchanged</code>:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName=:1"</span>;<span class="hljs-string">"Smith"</span>) <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>.<span class="hljs-function">first</span>() <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">drop</span>()<span class="hljs-keyword"> Case of</span>    :(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"You have dropped "</span>+<span class="hljs-variable">$employee</span>.firstName+<span class="hljs-string">" "</span>+<span class="hljs-variable">$employee</span>.lastName) <span class="hljs-comment">//La entidad soltada permanece en la memoria</span>    :(<span class="hljs-variable">$status</span>.status=dk status stamp has changed)<span class="hljs-function">       ALERT</span>(<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End case</span></code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-2-2"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-2-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 2</h4><p>Ejemplo con la opción <code>dk force drop if stampchanged</code>:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName=:1"</span>;<span class="hljs-string">"Smith"</span>) <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>.<span class="hljs-function">first</span>() <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">drop</span>(dk force drop if stamp changed)<span class="hljs-keyword"> Case of</span>    :(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"You have dropped "</span>+<span class="hljs-variable">$employee</span>.firstName+<span class="hljs-string">" "</span>+<span class="hljs-variable">$employee</span>.lastName) <span class="hljs-comment">//La entidad soltada permanece en la memoria</span>    :(<span class="hljs-variable">$status</span>.status=dk status entity does not exist anymore)<span class="hljs-function">       ALERT</span>(<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End case</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_first"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_first"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.first()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.first()</strong>: 4D.Entity</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>4D.Entity</td><td style="text-align:center">&lt;-</td><td>Referencia a la primera entidad de una selección de entidades(Null si no se encuentra)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-4"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.first()</code> devuelve una referencia a laentidad en primera posición de la selección de entidades a la quepertenece la entidad.</p><p>Si la entidad no pertenece a ninguna selección de entidadesexistente (es decir, <a href="#EntityClass.html_getselection">.getSelection( )</a> devuelveNull), la función devuelve un valor Null.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-3"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee</span>; <span class="hljs-variable">$firstEmployee </span>: cs.EmployeeEntity <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName = :1"</span>;<span class="hljs-string">"H@"</span>) <span class="hljs-comment">//Esta selección de entidades contiene 3 entidades</span> <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>[<span class="hljs-number">2</span>] <span class="hljs-variable">$firstEmployee</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">first</span>() <span class="hljs-comment">//$firstEmployee es la primera entidad de la selección de entidades $employees</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_fromobject"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_fromobject"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.fromObject()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.fromObject</strong>( <em>filler</em> : Object )</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>filler</td><td>Object</td><td style="text-align:center">-&gt;</td><td>Objeto a partir del cual se llena la entidad</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-5"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.fromObject()</code> llena una entidad con elcontenido <em>filler</em>.</p><blockquote><p>Esta función modifica la entidad original.</p></blockquote><p>El mapeo entre el objeto y la entidad se realiza sobre losnombres de los atributos:</p><ul><li>Si una propiedad del objeto no existe en la dataclass, seignora.</li><li>Los tipos de datos deben ser equivalentes. Si hay unadiferencia de tipo entre el objeto y la dataclass, 4D intentaconvertir los datos siempre que sea posible (ver <a href="#EntityClass.html_converting-data-types"><code>Convertir tipos dedatos</code></a>), de lo contrario el atributo se deja sintocar.</li><li>La llave primaria puede darse tal cual o con una propiedad"__KEY" (llenada con el valor de la llave primaria). Si no existeya en la dataclass, la entidad se crea con el valor dado cuando sellama a <a href="#EntityClass.html_save">.save()</a>. Si no se dala llave primaria, se crea la entidad y se asigna el valor de lallave primaria con respecto a las reglas de la base de datos. Elautoincremento sólo se calcula si la llave primaria es nula.</li></ul><p><em>filler</em> puede manejar una entidad relacionada bajo lassiguientes condiciones:</p><ul><li><em>filler</em> contiene la propia llave foránea, o</li><li><em>filler</em> contiene un objeto de propiedad con el mismonombre que la entidad relacionada, que contiene una única propiedaddenominada "__KEY".</li><li>si la entidad relacionada no existe, se ignora.</li></ul><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-4"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><p>Con el siguiente objeto $o:</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Mary"</span>,    <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Smith"</span>,    <span class="hljs-string">"salary"</span>: <span class="hljs-number">36500</span>,    <span class="hljs-string">"birthDate"</span>: <span class="hljs-string">"1958-10-27T00:00:00.000Z"</span>,    <span class="hljs-string">"woman"</span>: true,    <span class="hljs-string">"managerID"</span>: <span class="hljs-number">411</span>,<span class="hljs-comment">// relatedEntity dada con PK</span>    <span class="hljs-string">"employerID"</span>: <span class="hljs-number">20</span> <span class="hljs-comment">// relatedEntity dada con PK</span>}</code></pre><p>El siguiente código creará una entidad con entidadesrelacionadas con el gerente y el empleador.</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$o </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$entity </span>: cs.EmpEntity <span class="hljs-variable">$entity</span>:=ds.Emp.<span class="hljs-function">new</span>() <span class="hljs-variable">$entity</span>.<span class="hljs-function">fromObject</span>(<span class="hljs-variable">$o</span>) <span class="hljs-variable">$entity</span>.<span class="hljs-function">save</span>()</code></pre><p>También puede utilizar una entidad relacionada dada comoobjeto:</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Marie"</span>,    <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Lechat"</span>,    <span class="hljs-string">"salary"</span>: <span class="hljs-number">68400</span>,    <span class="hljs-string">"birthDate"</span>: <span class="hljs-string">"1971-09-03T00:00:00.000Z"</span>,    <span class="hljs-string">"woman"</span>: false,    <span class="hljs-string">"employer"</span>: {<span class="hljs-comment">// relatedEntity dada como un objeto</span>        <span class="hljs-string">"__KEY"</span>: <span class="hljs-string">"21"</span>    },    <span class="hljs-string">"manager"</span>: {<span class="hljs-comment">// relatedEntity dada como un objeto</span>        <span class="hljs-string">"__KEY"</span>: <span class="hljs-string">"411"</span>    }}</code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_getdataclass"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_getdataclass"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getDataClass()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17 R5</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.getDataClass()</strong> : 4D.DataClass</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>4D.DataClass</td><td style="text-align:center">&lt;-</td><td>Objeto DataClass al que pertenece la entidad</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-6"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.getDataClass()</code> devuelve la clase dedatos de la entidad. Esta función es útil al escribir códigogenérico.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-5"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-5"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><p>El siguiente código genérico duplica cualquier entidad:</p><pre><code class="hljs css language-4d">  <span class="hljs-comment">//método duplicate_entity </span>  <span class="hljs-comment">//duplicate_entity($entity) </span> #<span class="hljs-function">DECLARE</span>(<span class="hljs-variable">$entity </span>: 4D.Entity)<span class="hljs-keyword">   var</span> <span class="hljs-variable">$entityNew </span>: 4D.Entity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$entityNew</span>:=<span class="hljs-variable">$entity</span>.<span class="hljs-function">getDataClass</span>().<span class="hljs-function">new</span>() <span class="hljs-comment">//crea una nueva entidad en la dataclass padre </span> <span class="hljs-variable">$entityNew</span>.<span class="hljs-function">fromObject</span>(<span class="hljs-variable">$entity</span>.<span class="hljs-function">toObject</span>()) <span class="hljs-comment">//obtiene todos los atributos</span> <span class="hljs-variable">$entityNew</span>[<span class="hljs-variable">$entity</span>.<span class="hljs-function">getDataClass</span>().<span class="hljs-function">getInfo</span>().primaryKey]:=<span class="hljs-literal">Null</span> <span class="hljs-comment">//restablece la llave primaria</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$entityNew</span>.<span class="hljs-function">save</span>() <span class="hljs-comment">//guarda la entidad duplicada</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_getkey"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_getkey"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getKey()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.getKey</strong>( { <em>mode</em> : Integer } ) :Text<br /><strong>.getKey</strong>( { <em>mode</em> : Integer } ) :Integer</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>mode</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>dk key as string</code>: la llave primaria se devuelvecomo una cadena, sin importar el tipo de llave primaria</td></tr><tr><td>Resultado</td><td>Text</td><td style="text-align:center">&lt;-</td><td>Valor de la llave primaria de texto de la entidad</td></tr><tr><td>Resultado</td><td>Integer</td><td style="text-align:center">&lt;-</td><td>Valor de la llave primaria numérica de la entidad</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-7"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.getKey()</code> devuelve el valor de la llaveprimaria.</p><p>Las llaves primarias pueden ser números (enteros) o cadenas.Puede "forzar" que el valor de la llave primaria devuelto sea unacadena, sin importar el tipo de llave primaria real, pasando laopción <code>dk key as string</code> en el parámetro<em>mode</em>.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-6"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-6"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName=:1"</span>;<span class="hljs-string">"Smith"</span>) <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>[<span class="hljs-number">0</span>]<span class="hljs-function"> ALERT</span>(<span class="hljs-string">"The primary key is "</span>+<span class="hljs-variable">$employee</span>.<span class="hljs-function">getKey</span>(dk key as string))</code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_getremotecontextattributes"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_getremotecontextattributes"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getRemoteContextAttributes()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v19R5</td><td>Añadidos</td></tr></tbody></table></details><p>Devuelve:</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th></th><th>Descripción</th></tr></thead><tbody><tr><td>result</td><td>Texto</td><td>&lt;-</td><td>Atributos de contexto vinculados a la entidad, separados poruna coma</td></tr></tbody></table><blockquote><p><strong>Modo avanzado:</strong> esta función está pensada paralos desarrolladores que necesitan personalizar las funcionalidadespor defecto de ORDA para configuraciones específicas. En la mayoríade los casos, no será necesario utilizarla.</p></blockquote><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-8"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>Devuelve:</p><p>Extracción de todas las propiedades de una <code>Entidadrelacionada</code>:</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-7"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-7"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-comment">```4d</span><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object</code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ver-tambi%C3%A9n"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_ver-tambi%25C3%25A9n"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ver también</h4><p>Devuelve:</p><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_getselection"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_getselection"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getSelection()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.getSelection()</strong>: 4D.EntitySelection</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>4D.EntitySelection</td><td style="text-align:center">&lt;-</td><td>Entity selection a la que pertenece la entidad (nula si no seencuentra)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-9"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-9"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.getSelection()</code> devuelve la selección deentidades a la que pertenece la entidad.</p><p>Si la entidad no pertenece a una selección de entidades, lafunción devuelve Null.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-8"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-8"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$emp </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees</span>; <span class="hljs-variable">$employees2 </span>: cs.EmployeeSelection <span class="hljs-variable">$emp</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">672</span>) <span class="hljs-comment">// Esta entidad no pertenece a ninguna selección de entidades</span> <span class="hljs-variable">$employees</span>:=<span class="hljs-variable">$emp</span>.<span class="hljs-function">getSelection</span>() <span class="hljs-comment">// $employees es Null</span> <span class="hljs-variable">$employees2</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName=:1"</span>;<span class="hljs-string">"Smith"</span>) <span class="hljs-comment">//Esta selección de entidades contiene 6 entidades</span> <span class="hljs-variable">$emp</span>:=<span class="hljs-variable">$employees2</span>[<span class="hljs-number">0</span>]  <span class="hljs-comment">// Esta entidad pertenece a una selección de entidades</span><span class="hljs-function"> ALERT</span>(<span class="hljs-string">"La entity selection contiene "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$emp</span>.<span class="hljs-function">getSelection</span>().length)+<span class="hljs-string">" entidades"</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_getstamp"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_getstamp"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getStamp()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.getStamp()</strong> : Integer</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>Integer</td><td style="text-align:center">&lt;-</td><td>Sello de la entidad (0 si la entidad acaba de ser creada)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-10"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-10"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.getStamp()</code> devuelve el valor actual delsello de la entidad.</p><p>El sello interno se incrementa automáticamente en 4D cada vezque se guarda la entidad. Gestiona los accesos y modificacionesconcurrentes de los usuarios a las mismas entidades (ver <a href="#EntityClass.html_entity-locking"><strong>Bloqueo deentidades</strong></a>).</p><blockquote><p>Para una entidad nueva (nunca guardada), la función devuelve 0.Para saber si una entidad acaba de ser creada, se recomiendautilizar <a href="#EntityClass.html_isnew">.isNew()</a>.</p></blockquote><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-9"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-9"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$entity </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$stamp </span>: Integer <span class="hljs-variable">$entity</span>:=ds.Employee.<span class="hljs-function">new</span>() <span class="hljs-variable">$entity</span>.lastname:=<span class="hljs-string">"Smith"</span> <span class="hljs-variable">$entity</span>.<span class="hljs-function">save</span>() <span class="hljs-variable">$stamp</span>:=<span class="hljs-variable">$entity</span>.<span class="hljs-function">getStamp</span>() <span class="hljs-comment">//$stamp=1</span> <span class="hljs-variable">$entity</span>.lastname:=<span class="hljs-string">"Wesson"</span> <span class="hljs-variable">$entity</span>.<span class="hljs-function">save</span>() <span class="hljs-variable">$stamp</span>:=<span class="hljs-variable">$entity</span>.<span class="hljs-function">getStamp</span>() <span class="hljs-comment">//$stamp=2</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_indexof"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_indexof"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.indexOf()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.indexOf</strong>( { <em>entitySelection</em> :4D.EntitySelection } ) : Integer</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>entitySelection</td><td>4D.EntitySelection</td><td style="text-align:center">-&gt;</td><td>La posición de la entidad se da en función de esta selección deentidades</td></tr><tr><td>Resultado</td><td>Integer</td><td style="text-align:center">&lt;-</td><td>Posición de la entidad en una selección de entidades</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-11"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-11"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.indexOf()</code> devuelve la posición de laentidad en una selección de entidades.</p><p>Por defecto, si se omite el parámetro <em>entitySelection</em>,la función devuelve la posición de la entidad dentro de su propiaselección de entidades. En caso contrario, devuelve la posición dela entidad dentro de la <em>entitySelection</em> especificada.</p><p>El valor resultante se incluye entre 0 y la longitud de laselección de entidades -1.</p><ul><li>Si la entidad no tiene una selección de entidad o no pertenecea <em>entidadSelección</em>, la función devuelve -1.</li><li>Si <em>entitySelection</em> es Null o no pertenece a la mismaclase de datos que la entidad, se produce un error.</li></ul><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-10"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-10"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName = :1"</span>;<span class="hljs-string">"H@"</span>) <span class="hljs-comment">//Esta entity selection contiene 3 entidades</span> <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>[<span class="hljs-number">1</span>] <span class="hljs-comment">//Esta entidad pertenece a una entity selection</span><span class="hljs-function"> ALERT</span>(<span class="hljs-string">"El índice de la entidad en su propia selección de entidades es "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$employee</span>.<span class="hljs-function">indexOf</span>())) <span class="hljs-comment">//1</span> <span class="hljs-variable">$employee</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">725</span>) <span class="hljs-comment">//Esta entidad no pertenece a una selección de entidades</span><span class="hljs-function"> ALERT</span>(<span class="hljs-string">"El índice de la entidad es "</span>+<span class="hljs-function">String</span>(<span class="hljs-variable">$employee</span>.<span class="hljs-function">indexOf</span>())) <span class="hljs-comment">// -1</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_isnew"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_isnew"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.isNew()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.isNew()</strong> : Boolean</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>Booleano</td><td style="text-align:center">&lt;-</td><td>True si la entidad acaba de ser creada y aún no se ha guardado.En caso contrario, False.</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-12"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-12"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.isNew()</code> devuelve True si la entidad ala que se aplica acaba de ser creada y aún no ha sido guardada enel datastore. En caso contrario, devuelve False.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-11"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-11"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$emp </span>: cs.EmployeeEntity <span class="hljs-variable">$emp</span>:=ds.Employee.<span class="hljs-function">new</span>()<span class="hljs-keyword"> If</span>(<span class="hljs-variable">$emp</span>.<span class="hljs-function">isNew</span>())<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"This is a new entity"</span>)<span class="hljs-keyword"> End if</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_last"></a><a aria-hidden="true" class="hash-link"href="#EntityClass.html_last"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.last()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.last()</strong> : 4D.Entity</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>4D.Entity</td><td style="text-align:center">&lt;-</td><td>Referencia a la última entidad de una selección de entidades(Null si no se encuentra)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-13"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-13"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.last()</code> devuelve una referencia a laentidad en la última posición de la selección de entidades a la quepertenece la entidad.</p><p>Si la entidad no pertenece a ninguna selección de entidadesexistente (es decir, <a href="#EntityClass.html_getselection">.getSelection( )</a> devuelveNull), la función devuelve un valor Null.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-12"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-12"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee</span>; <span class="hljs-variable">$lastEmployee </span>: cs.EmployeeEntity <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName = :1"</span>;<span class="hljs-string">"H@"</span>) <span class="hljs-comment">//Esta selección de entidades contiene 3 entidades</span> <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>[<span class="hljs-number">0</span>] <span class="hljs-variable">$lastEmployee</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">last</span>() <span class="hljs-comment">//$lastEmployee es la última entidad de la selección de entidades $employees</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_lock"></a><a aria-hidden="true" class="hash-link"href="#EntityClass.html_lock"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.lock()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.lock</strong>( { <em>mode</em> : Integer } ) :Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>mode</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>dk reload if stamp changed</code>: recargar antes debloquear si el sello ha cambiado</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Resultado de la operación de bloqueo</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-14"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-14"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.lock()</code> pone un bloqueo pesimista en elregistro referenciado por la entidad. El <a href="#EntityClass.html_entity-locking">bloqueo se establece</a> para unregistro y todas las referencias de la entidad en el procesoactual.</p><p>Otros procesos verán este registro como bloqueado (la propiedad<code>result.success</code> contendrá False si intentan bloquear lamisma entidad usando esta función). Sólo las funciones ejecutadasen la sesión de "bloqueo" pueden editar y guardar los atributos dela entidad. La entidad puede ser cargada como de sólo lectura porotras sesiones, pero no podrán introducir y guardar valores.</p><p>El objeto devuelto por &lt;<code>.unlock()&lt;</code> contienela siguiente propiedad:</p><ul><li>cuando la función <a href="#EntityClass.html_unlock"><code>unlock()</code></a> se llama enuna entidad correspondiente en el mismo proceso</li><li>automáticamente, cuando ya no es referenciado por ningunaentidad en la memoria. Por ejemplo, si el bloqueo se pone sólo enuna referencia local de una entidad, la entidad se desbloqueacuando la función termina. Mientras haya referencias a la entidaden la memoria, el registro permanece bloqueado.</li></ul><blockquote><p>Una entidad también puede ser <a href="../REST/$lock.md">bloqueada por una sesión REST</a>, en cuyo casosólo puede ser desbloqueada por la sesión.</p></blockquote><p>Por defecto, si se omite el parámetro <em>mode</em>, la funcióndevolverá un error (ver más abajo) si la misma entidad fuemodificada (es decir, el sello ha cambiado) por otro proceso ousuario en el ínterin.</p><p>De lo contrario, puede pasar la opción <code>dk reload if stampchanged</code> en el parámetro <em>mode</em>: en este caso, no sedevuelve error y la entidad se recarga cuando el sello cambia (sila entidad aún existe y la llave primaria sigue siendo lamisma).</p><p><strong>Resultado</strong></p><p>El objeto devuelto por <code>.lock( )</code> contiene lassiguientes propiedades:</p><table><thead><tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td></td><td>boolean</td><td>true si la acción de bloqueo tiene éxito (o si la entidad yaestá bloqueada en el proceso actual), false en caso contrario.</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible sólo si se utiliza la opción <code>dkreload if stamp changed</code>:</em></strong></td></tr><tr><td><strong>wasReloaded</strong></td><td></td><td>boolean</td><td>true si la entidad fue recargada con éxito, false en casocontrario.</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible sólo en caso deerror:</em></strong></td></tr><tr><td>status(*)</td><td></td><td>number</td><td>Código de error, ver abajo</td></tr><tr><td>statusText(*)</td><td></td><td>text</td><td>Descripción del error, ver abajo</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible sólo en caso de error de bloqueopesimista:</em></strong></td></tr><tr><td>lockKindText</td><td></td><td>text</td><td>"Locked by record" si está bloqueado por un proceso 4D, "Lockedby session" si está bloqueado por una sesión REST</td></tr><tr><td>lockInfo</td><td></td><td>object</td><td>Información sobre el origen del bloqueo. Las propiedadesdevueltas dependen del origen del bloqueo (proceso 4D o sesiónREST).</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible sólo para un bloqueo por proceso4D:</em></strong></td></tr><tr><td></td><td>task_id</td><td>number</td><td>ID del Proceso</td></tr><tr><td></td><td>user_name</td><td>text</td><td>Nombre de usuario de la sesión en la máquina</td></tr><tr><td></td><td>user4d_alias</td><td>texto</td><td>Nombre o alias del usuario 4D</td></tr><tr><td></td><td>user4d_id</td><td>number</td><td>ID del usuario en el directorio de la base de datos 4D</td></tr><tr><td></td><td>host_name</td><td>text</td><td>Nombre de la máquina</td></tr><tr><td></td><td>task_name</td><td>text</td><td>Nombre del proceso</td></tr><tr><td></td><td>client_version</td><td>texto</td><td>Versión del cliente</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible sólo para un bloqueo por sesiónREST:</em></strong></td></tr><tr><td></td><td>host</td><td>text</td><td>URL que bloqueó la entidad (por ejemplo, "<a href="http://www.myserver.com">www.myserver.com</a>")</td></tr><tr><td></td><td>IPAddr</td><td>text</td><td>Dirección IP del bloqueo (por ejemplo: "127.0.0.1")</td></tr><tr><td></td><td>userAgent</td><td>texto</td><td>userAgent del origin del bloqueo (ej: "Mozilla/5.0 (Macintosh;Intel Mac OS X 10_15_3) AppleWebKit/537.36 (KHTML, like Gecko)Chrome/96.0.4664.110 Safari/537.36")</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible sólo en caso de errorgrave</em></strong> (la llave primaria ya existe, el disco estálleno...):</td></tr><tr><td>errors</td><td></td><td>collection of objects</td><td></td></tr><tr><td></td><td>message</td><td>texto</td><td>Mensaje de error</td></tr><tr><td></td><td>component signature</td><td>texto</td><td>firma del componente interno (por ejemplo, "dmbg" significa elcomponente de la base)</td></tr><tr><td></td><td>errCode</td><td>number</td><td>Código de error</td></tr></tbody></table><p>(*) Los siguientes valores pueden ser devueltos en laspropiedades <em>status</em> y <em>statusText</em> del objeto<em>Result</em> en caso de error:</p><table><thead><tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr></thead><tbody><tr><td><code>dk status entity does not exist anymore</code></td><td>5</td><td>La entidad ya no existe en los datos. Este error puede ocurriren los siguientes casos:<ul><li>la entidad ha sido abandonada (el sello ha cambiado y elespacio de memoria está ahora libre)</li><li>la entidad ha sido eliminada y sustituida por otra con otrallave primaria (el sello ha cambiado y una nueva entidad utilizaahora el espacio de memoria). Cuando se utiliza <code>.drop()</code>, este error puede devolverse cuando se utiliza la opción<code>dk force drop if stamp changed</code>. Cuando se utiliza<code>.lock( )</code>, este error puede ser devuelto cuando seutiliza la opción <code>dk reload if stamp changed</code></li><br /><strong>statusText asociado</strong>: "La entidad ya noexiste"</ul></td></tr><tr><td><code>dk status locked</code></td><td>3</td><td>La entidad está bloqueada por un bloqueo pesimista.<p><strong>statusText asociado</strong>: "Ya bloqueado"</p></td></tr><tr><td><code>dk status serious error</code></td><td>4</td><td>Un error grave es un error de base de datos de bajo nivel (porejemplo, una llave duplicada), un error de hardware, etc.<p><strong>statusText asociado</strong>: "Otro error"</p></td></tr><tr><td><code>dk status stamp has changed</code></td><td>2</td><td>El valor del sello interno de la entidad no coincide con el dela entidad almacenada en los datos (bloqueo optimista).<ul><li>con <code>.save( )</code>: error sólo si no se utiliza laopción <code>dk auto merge</code></li><li>con <code>.drop( )</code>: error sólo si no se utiliza laopción <code>dk force drop if stamp changed</code></li><li>con <code>.lock( )</code>: error sólo si no se utiliza laopción <code>dk reload if stamp changed</code></li><br /><strong>statusText asociado</strong>: "El sello ha cambiado"</ul></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-1-3"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-1-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 1</h4><p>Ejemplo con error:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$employee</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">716</span>) <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">lock</span>()<span class="hljs-keyword"> Case of</span>    :(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"You have locked "</span>+<span class="hljs-variable">$employee</span>.firstName+<span class="hljs-string">" "</span>+<span class="hljs-variable">$employee</span>.lastName)    :(<span class="hljs-variable">$status</span>.status=dk status stamp has changed)<span class="hljs-function">       ALERT</span>(<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End case</span></code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-2-3"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-2-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 2</h4><p>Ejemplo con la opción <code>dk reload if stampchanged</code>:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$employee</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">717</span>) <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">lock</span>(dk reload if stamp changed)<span class="hljs-keyword"> Case of</span>    :(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"You have locked "</span>+<span class="hljs-variable">$employee</span>.firstName+<span class="hljs-string">" "</span>+<span class="hljs-variable">$employee</span>.lastName)    :(<span class="hljs-variable">$status</span>.status=dk status entity does not exist anymore)<span class="hljs-function">       ALERT</span>(<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End case</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_next"></a><a aria-hidden="true" class="hash-link"href="#EntityClass.html_next"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.next()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.next()</strong> : 4D.Entity</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>4D.Entity</td><td style="text-align:center">&lt;-</td><td>Referencia a la siguiente entidad en la selección de entidades(Null si no se encuentra)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-15"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-15"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.next()</code> devuelve una referencia a lasiguiente entidad en la selección de entidades a la que pertenecela entidad.</p><p>Si la entidad no pertenece a ninguna selección de entidadesexistente (es decir, <a href="#EntityClass.html_getselection">.getSelection()</a> devuelveNull), la función devuelve un valor Null.</p><p>Si no hay una entidad siguiente válida en la selección deentidades (es decir, se encuentra en la última entidad de laselección), la función devuelve Null. Si la siguiente entidad hasido descartada, la función devuelve la siguiente entidad válida (yeventualmente Null).</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-13"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-13"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee</span>; <span class="hljs-variable">$nextEmployee </span>: cs.EmployeeEntity <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName = :1"</span>;<span class="hljs-string">"H@"</span>) <span class="hljs-comment">//Esta selección de entidades contiene 3 entidades</span> <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>[<span class="hljs-number">0</span>] <span class="hljs-variable">$nextEmployee</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">next</span>() <span class="hljs-comment">//$nextEmployee es la segunda entidad de la selección de entidades $employees</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_previous"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_previous"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.previous()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.previous()</strong> : 4D.Entity</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>4D.Entity</td><td style="text-align:center">&lt;-</td><td>Referencia a la entidad anterior en la selección de entidades(Null si no se encuentra)</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-16"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-16"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.previous()</code> devuelve una referencia a laentidad anterior en la selección de entidades a la que pertenece laentidad.</p><p>Si la entidad no pertenece a ninguna selección de entidadesexistente (es decir, <a href="#EntityClass.html_getselection">.getSelection()</a> devuelveNull), la función devuelve un valor Null.</p><p>Si no hay una entidad anterior válida en la selección deentidades (es decir, se encuentra en la primera entidad de laselección), la función devuelve Null. Si la entidad anterior hasido soltada, la función devuelve la entidad válida anterior (yeventualmente Null).</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-14"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-14"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee</span>; <span class="hljs-variable">$previousEmployee </span>: cs.EmployeeEntity <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName = :1"</span>;<span class="hljs-string">"H@"</span>) <span class="hljs-comment">//Esta selección de entidades contiene 3 entidades</span> <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>[<span class="hljs-number">1</span>] <span class="hljs-variable">$previousEmployee</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">previous</span>() <span class="hljs-comment">//$previousEmployee es la primera entidad de la selección de entidades $employees</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_reload-"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_reload-"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.reload( )</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.reload()</strong> : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Objeto de estado</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-17"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-17"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.reload()</code> recarga el contenido de laentidad en memoria, según la información almacenada en la tablarelacionada con la dataclass en el datastore. La recarga se realizasólo si la entidad sigue existiendo con la misma llaveprimaria.</p><p><strong>Resultado</strong></p><p>El objeto devuelto por <code>.reload( )</code> contiene lassiguientes propiedades:</p><table><thead><tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td>boolean</td><td>True si la acción de recargar tiene éxito, False en casocontrario.<p><strong><em>Disponible sólo en caso de error</em></strong>:</p></td></tr><tr><td>status(*)</td><td>number</td><td>Código de error, ver abajo</td></tr><tr><td>statusText(*)</td><td>text</td><td>Descripción del error, ver abajo</td></tr></tbody></table><p>(*) Los siguientes valores pueden ser devueltos en laspropiedadese <em>status</em> y <em>statusText</em> del objeto<em>Result</em> en caso de error:</p><table><thead><tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr></thead><tbody><tr><td><code>dk status entity does not exist anymore</code></td><td>5</td><td>La entidad ya no existe en los datos. Este error puede ocurriren los siguientes casos:<br /><ul><li>la entidad ha sido abandonada (el sello ha cambiado y elespacio de memoria está ahora libre)</li><li>la entidad ha sido eliminada y sustituida por otra con otrallave primaria (el sello ha cambiado y una nueva entidad utilizaahora el espacio de memoria). la entidad ha sido eliminada ysustituida por otra con otra llave primaria (el sello ha cambiado yuna nueva entidad utiliza ahora el espacio de memoria). Cuando seutiliza <code>.lock( )</code>, este error puede ser devuelto cuandose utiliza la opción <code>dk reload if stamp changed</code></li><br /><strong><em>statusText asociado</em></strong>: "La entidad ya noexiste"</ul></td></tr><tr><td><code>dk status serious error</code></td><td>4</td><td>Un error grave es un error de base de datos de bajo nivel (porejemplo, una llave duplicada), un error de hardware, etc.<br /><strong><em>statusText asociado</em></strong>: "Otro error"</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-15"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-15"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$result </span>: Object <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName=:1"</span>;<span class="hljs-string">"Hollis"</span>) <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>[<span class="hljs-number">0</span>] <span class="hljs-variable">$employee</span>.firstName:=<span class="hljs-string">"Mary"</span> <span class="hljs-variable">$result</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">reload</span>()<span class="hljs-keyword"> Case of</span>    :(<span class="hljs-variable">$result</span>.success)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"Reload has been done"</span>)    :(<span class="hljs-variable">$result</span>.status=dk status entity does not exist anymore)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"The entity has been dropped"</span>)<span class="hljs-keyword"> End case</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_save"></a><a aria-hidden="true" class="hash-link"href="#EntityClass.html_save"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.save()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.save</strong>( { <em>mode</em> : Integer } ) :Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>mode</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>dk auto merge</code>: activa el modo de fusiónautomática</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Resultado de la operación guardar</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-18"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-18"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.save()</code> guarda los cambios realizados enla entidad en la tabla relacionada con su dataClass. Debe llamar aeste método después de crear o modificar una entidad si quiereguardar los cambios realizados en ella.</p><p>La operación de guardar se ejecuta sólo si se ha "tocado" almenos un atributo de la entidad (ver las funciones <a href="#EntityClass.html_touched"><code>.touched()</code></a> y <a href="#EntityClass.html_touchedattributes"><code>.touchedAttributes()</code></a>).En caso contrario, la función no hace nada (no se llama alactivador).</p><p>En una aplicación multiusuario o multiproceso, la función<code>.save()</code> se ejecuta bajo un mecanismo de <a href="#EntityClass.html_entity-locking">"bloqueo optimista"</a>, en elque un sello de bloqueo interno se incrementa automáticamente cadavez que se guarda el registro.</p><p>Por defecto, si se omite el parámetro <em>mode</em>, el métododevolverá un error (ver más abajo) siempre que la misma entidadhaya sido modificada por otro proceso o usuario mientras tanto, sinimportar el atributo o atributos modificados.</p><p>En caso contrario, se puede pasar la opción <code>dk automerge</code> en el parámetro <em>mode</em>: cuando el modo defusión automática está activado, una modificación realizadasimultáneamente por otro proceso/usuario en la misma entidad peroen un atributo diferente no dará lugar a un error. Los datosresultantes guardados en la entidad serán la combinación (la"fusión") de todas las modificaciones no concurrentes (si seaplicaron modificaciones al mismo atributo, el guardado falla y sedevuelve un error, incluso con el modo de fusión automática).</p><blockquote><p>El modo de fusión automática no está disponible para losatributos de tipo Imagen, Objeto y Texto cuando se almacenan fueradel registro. Los cambios concurrentes en estos atributos daránlugar a un error <code>dk status stamp has changed</code>.</p></blockquote><p><strong>Resultado</strong></p><p>El objeto devuelto por <code>.save()</code> contiene lassiguientes propiedades:</p><table><thead><tr><th>Propiedad</th><th></th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td></td><td>boolean</td><td>True si la acción guardar tiene éxito, false en casocontrario.</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible sólo si se utiliza la opción <code>dkauto merge</code></em></strong>:</td></tr><tr><td>autoMerged</td><td></td><td>boolean</td><td>True si se ha realizado una fusión automática, False en casocontrario.</td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible sólo en caso deerror</em></strong>:</td></tr><tr><td>status</td><td></td><td>number</td><td>Código de error, <a href="#EntityClass.html_status-and-statustext">ver abajo</a></td></tr><tr><td>statusText</td><td></td><td>text</td><td>Descripción del error, <a href="#EntityClass.html_status-and-statustext">ver más abajo</a></td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible sólo en caso de bloqueopesimista</em></strong>:</td></tr><tr><td>lockKindText</td><td></td><td>text</td><td>"Locked by record"</td></tr><tr><td>lockInfo</td><td></td><td>object</td><td>Información sobre el origen del bloqueo</td></tr><tr><td></td><td>task_id</td><td>number</td><td>Id del proceso</td></tr><tr><td></td><td>user_name</td><td>text</td><td>Nombre de usuario de la sesión en la máquina</td></tr><tr><td></td><td>user4d_alias</td><td>text</td><td>Alias de usuario si está definido por <code>SET USERALIAS</code>, si no, nombre de usuario en el directorio 4D</td></tr><tr><td></td><td>host_name</td><td>text</td><td>Nombre de la máquina</td></tr><tr><td></td><td>task_name</td><td>texto</td><td>Nombre del proceso</td></tr><tr><td></td><td>client_version</td><td>text</td><td></td></tr><tr><td></td><td></td><td></td><td><strong><em>Disponible sólo en caso de errorgrave</em></strong> (error grave - puede ser intentar duplicar unallave primaria, disco lleno...):</td></tr><tr><td>errors</td><td></td><td>collection of objects</td><td></td></tr><tr><td></td><td>message</td><td>text</td><td>Mensaje de error</td></tr><tr><td></td><td>componentSignature</td><td>text</td><td>Firma del componente interno (por ejemplo, "dmbg" significa elcomponente de la base)</td></tr><tr><td></td><td>errCode</td><td>number</td><td>Código de error</td></tr></tbody></table><h5><a aria-hidden="true" class="anchor" id="EntityClass.html_status-y-statustext"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_status-y-statustext"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>status y statusText</h5><p>Los siguientes valores pueden ser devueltos en las propiedades<code>status</code> y <code>statusText</code> del objeto Result encaso de error:</p><table><thead><tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr></thead><tbody><tr><td><code>dk status automerge failed</code></td><td>6</td><td>(Sólo si se utiliza la opción <code>dk auto merge</code>) Laopción de fusión automática falló al guardar la entidad.<p><strong>statusText asociado</strong>: "Fallo de la fusiónautomática"</p></td></tr><tr><td><code>dk status entity does not exist anymore</code></td><td>5</td><td>La entidad ya no existe en los datos. Este error puede ocurriren los siguientes casos:<br /><ul><li>la entidad ha sido abandonada (el sello ha cambiado y elespacio de memoria está ahora libre)</li><li>la entidad ha sido eliminada y sustituida por otra con otrallave primaria (el sello ha cambiado y una nueva entidad utilizaahora el espacio de memoria). la entidad ha sido eliminada ysustituida por otra con otra llave primaria (el sello ha cambiado yuna nueva entidad utiliza ahora el espacio de memoria). Cuando seutiliza <code>.lock( )</code>, este error puede ser devuelto cuandose utiliza la opción <code>dk reload if stamp changed</code></li><br /><strong>statusText asociado</strong>: "La entidad ya noexiste"</ul></td></tr><tr><td><code>dk status locked</code></td><td>3</td><td>La entidad está bloqueada por un bloqueo pesimista.<p><strong>statusText asociado</strong>: "Ya bloqueado"</p></td></tr><tr><td><code>dk status serious error</code></td><td>4</td><td>Un error grave es un error de base de datos de bajo nivel (porejemplo, una llave duplicada), un error de hardware, etc.<p><strong>statusText asociado</strong>: "Otro error"</p></td></tr><tr><td><code>dk status stamp has changed</code></td><td>2</td><td>El valor del sello interno de la entidad no coincide con el dela entidad almacenada en los datos (bloqueo optimista).<br /><ul><li>con <code>.save( )</code>: error sólo si no se utiliza laopción <code>dk auto merge</code></li><li>con <code>.drop( )</code>: error sólo si no se utiliza laopción <code>dk force drop if stamp changed</code></li><li>con <code>.lock( )</code>: error sólo si no se utiliza laopción <code>dk reload if stamp changed</code></li><br /><strong>statusText asociado</strong>: "El sello ha cambiado"</ul></td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-1-4"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-1-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 1</h4><p>Crear una nueva entidad:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity <span class="hljs-variable">$employee</span>:=ds.Employee.<span class="hljs-function">new</span>() <span class="hljs-variable">$employee</span>.firstName:=<span class="hljs-string">"Mary"</span> <span class="hljs-variable">$employee</span>.lastName:=<span class="hljs-string">"Smith"</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">save</span>()<span class="hljs-keyword"> If</span>(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Employee created"</span>)<span class="hljs-keyword"> End if</span></code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-2-4"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-2-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 2</h4><p>Actualización de una entidad sin la opción <code>dk automerge</code>:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName=:1"</span>;<span class="hljs-string">"Smith"</span>) <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>.<span class="hljs-function">first</span>() <span class="hljs-variable">$employee</span>.lastName:=<span class="hljs-string">"Mac Arthur"</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">save</span>()<span class="hljs-keyword"> Case of</span>    :(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"Employee updated"</span>)    :(<span class="hljs-variable">$status</span>.status=dk status stamp has changed)<span class="hljs-function">       ALERT</span>(<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End case</span></code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-3-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-3-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 3</h4><p>Actualización de una entidad con la opción <code>dk automerge</code>:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$employees </span>: cs.EmployeeSelection <span class="hljs-variable">$employees</span>:=ds.Employee.<span class="hljs-function">query</span>(<span class="hljs-string">"lastName=:1"</span>;<span class="hljs-string">"Smith"</span>) <span class="hljs-variable">$employee</span>:=<span class="hljs-variable">$employees</span>.<span class="hljs-function">first</span>() <span class="hljs-variable">$employee</span>.lastName:=<span class="hljs-string">"Mac Arthur"</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">save</span>(dk auto merge)<span class="hljs-keyword"> Case of</span>    :(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">       ALERT</span>(<span class="hljs-string">"Employee updated"</span>)    :(<span class="hljs-variable">$status</span>.status=dk status automerge failed)<span class="hljs-function">       ALERT</span>(<span class="hljs-variable">$status</span>.statusText)<span class="hljs-keyword"> End case</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_toobject"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_toobject"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.toObject()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.toObject</strong>() : Object<br /><strong>.toObject</strong>( <em>filterString</em> : Text { ;<em>options</em> : Integer} ) : Object<br /><strong>.toObject</strong>( <em>filterCol</em> : Collection { ;<em>options</em> : Integer } ) : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>filterString</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Atributo(s) a extraer (cadena separada por comas)</td></tr><tr><td>filterCol</td><td>Collection</td><td style="text-align:center">-&gt;</td><td>Colección de atributos a extraer</td></tr><tr><td>options</td><td>Integer</td><td style="text-align:center">-&gt;</td><td><code>dk with primary key</code>: añade la propiedad_KEY;<br /><code>dk with stamp</code>: añade la propiedad _STAMP</td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Objeto creado a partir de la entidad</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-19"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-19"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.toObject()</code> devuelve un objeto que hasido construido a partir de la entidad. Los nombres de laspropiedades en el objeto coinciden con los nombres de los atributosde la entidad.</p><p>Si no se especifica ningún filtro, o si el parámetro<em>filterString</em> contiene una cadena vacía o "*", el objetodevuelto contendrá:</p><ul><li>todos los atributos de la entidad de almacenamiento</li><li>atributos de la <code>relatedEntity</code> <a href="#EntityClass.html_kind">kind</a>: se obtiene una propiedad con elmismo nombre que la entidad relacionada (nombre del enlacemuchos-a-uno). El atributo se extrae con la forma simple.</li><li>atributos donde <a href="#EntityClass.html_kind">kind</a> es<code>relatedEntities</code>: no se devuelve el atributo.</li></ul><p>En el primer parámetro, se pasa el atributo o atributos de laentidad a extraer. Puede pasar:</p><ul><li><em>filterString</em>: una cadena con rutas de propiedadesseparadas por comas: "propertyPath1, propertyPath2, ...", o</li><li><em>filterCol</em>: una colección de cadenas:["propertyPath1","propertyPath2";...]</li></ul><p>Si se especifica un filtro para los atributos de larelatedEntity <a href="#EntityClass.html_kind">kind</a>:</p><ul><li>propertyPath = "relatedEntity" -&gt; se extrae de formasencilla: un objeto con la propiedad __KEY (llave primaria).</li><li>propertyPath = "relatedEntity.*" -&gt; se extraen todas laspropiedades</li><li>propertyPath = "relatedEntity.propertyName1;relatedEntity.propertyName2; ..." -&gt; sólo se extraen esaspropiedades</li></ul><p>Si se especifica un filtro para los atributos de lasrelatedEntities <a href="#EntityClass.html_kind">kind</a>:</p><ul><li>propertyPath = "relatedEntities.*" -&gt; se extraen todas laspropiedades</li><li>propertyPath = "relatedEntities.propertyName1;relatedEntities.propertyName2; ..." -&gt; sólo se extraen esaspropiedades</li></ul><p>En el parámetro <em>options</em> se puede pasar el selector<code>ddk with primary key</code> y/o<code>dk with stamp</code>para añadir las llaves primarias de la entidad y/o los sellos enlos objetos extraídos.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-1-5"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-1-5"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 1</h4><p>En todos los ejemplos de esta sección se utilizará la siguienteestructura:</p><p><img alt="" src="assets/en/API/dataclassAttribute4.png" /></p><p>Sin parámetro de filtro:</p><pre><code class="hljs css language-4d">employeeObject:=employeeSelected.<span class="hljs-function">toObject</span>()</code></pre><p>Devuelve:</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"ID"</span>: <span class="hljs-number">413</span>,    <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Greg"</span>,    <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Wahl"</span>,    <span class="hljs-string">"salary"</span>: <span class="hljs-number">0</span>,    <span class="hljs-string">"birthDate"</span>: <span class="hljs-string">"1963-02-01T00:00:00.000Z"</span>,    <span class="hljs-string">"woman"</span>: false,    <span class="hljs-string">"managerID"</span>: <span class="hljs-number">412</span>,    <span class="hljs-string">"employerID"</span>: <span class="hljs-number">20</span>,    <span class="hljs-string">"photo"</span>: <span class="hljs-string">"[object Picture]"</span>,    <span class="hljs-string">"extra"</span>: null,    <span class="hljs-string">"employer"</span>: { <span class="hljs-comment">// relatedEntity extracted with simple form</span>        <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">20</span>    },    <span class="hljs-string">"manager"</span>: {        <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">412</span>    }}</code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-2-5"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-2-5"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 2</h4><p>Extraer la llave primaria y el sello:</p><pre><code class="hljs css language-4d">employeeObject:=employeeSelected.<span class="hljs-function">toObject</span>(<span class="hljs-string">""</span>;dk with primary key+dk with stamp)</code></pre><p>Devuelve:</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">413</span>,   <span class="hljs-string">"__STAMP"</span>: <span class="hljs-number">1</span>,    <span class="hljs-string">"ID"</span>: <span class="hljs-number">413</span>,    <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Greg"</span>,    <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Wahl"</span>,    <span class="hljs-string">"salary"</span>: <span class="hljs-number">0</span>,    <span class="hljs-string">"birthDate"</span>: <span class="hljs-string">"1963-02-01T00:00:00.000Z"</span>,    <span class="hljs-string">"woman"</span>: false,    <span class="hljs-string">"managerID"</span>: <span class="hljs-number">412</span>,    <span class="hljs-string">"employerID"</span>: <span class="hljs-number">20</span>,    <span class="hljs-string">"photo"</span>: <span class="hljs-string">"[object Picture]"</span>,    <span class="hljs-string">"extra"</span>: null,    <span class="hljs-string">"employer"</span>: {        <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">20</span>    },    <span class="hljs-string">"manager"</span>: {        <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">412</span>    }}</code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-3-2"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-3-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 3</h4><p>Desplegando todas las propiedades de<code>relatedEntities</code>:</p><pre><code class="hljs css language-4d">employeeObject:=employeeSelected.<span class="hljs-function">toObject</span>(<span class="hljs-string">"directReports.*"</span>)</code></pre><pre><code class="hljs css language-4d">{    <span class="hljs-string">"directReports"</span>: [        {            <span class="hljs-string">"ID"</span>: <span class="hljs-number">418</span>,            <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Lorena"</span>,            <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Boothe"</span>,            <span class="hljs-string">"salary"</span>: <span class="hljs-number">44800</span>,            <span class="hljs-string">"birthDate"</span>: <span class="hljs-string">"1970-10-02T00:00:00.000Z"</span>,            <span class="hljs-string">"woman"</span>: true,            <span class="hljs-string">"managerID"</span>: <span class="hljs-number">413</span>,            <span class="hljs-string">"employerID"</span>: <span class="hljs-number">20</span>,            <span class="hljs-string">"photo"</span>: <span class="hljs-string">"[object Picture]"</span>,            <span class="hljs-string">"extra"</span>: null,            <span class="hljs-string">"employer"</span>: {                <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">20</span>            },            <span class="hljs-string">"manager"</span>: {                <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">413</span>            }        },        {            <span class="hljs-string">"ID"</span>: <span class="hljs-number">419</span>,            <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Drew"</span>,            <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Caudill"</span>,            <span class="hljs-string">"salary"</span>: <span class="hljs-number">41000</span>,            <span class="hljs-string">"birthDate"</span>: <span class="hljs-string">"2030-01-12T00:00:00.000Z"</span>,            <span class="hljs-string">"woman"</span>: false,            <span class="hljs-string">"managerID"</span>: <span class="hljs-number">413</span>,            <span class="hljs-string">"employerID"</span>: <span class="hljs-number">20</span>,            <span class="hljs-string">"photo"</span>: <span class="hljs-string">"[object Picture]"</span>,            <span class="hljs-string">"extra"</span>: null,            <span class="hljs-string">"employer"</span>: {                <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">20</span>            },            <span class="hljs-string">"manager"</span>: {                <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">413</span>            }        },        {            <span class="hljs-string">"ID"</span>: <span class="hljs-number">420</span>,            <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Nathan"</span>,            <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Gomes"</span>,            <span class="hljs-string">"salary"</span>: <span class="hljs-number">46300</span>,            <span class="hljs-string">"birthDate"</span>: <span class="hljs-string">"2010-05-29T00:00:00.000Z"</span>,            <span class="hljs-string">"woman"</span>: false,            <span class="hljs-string">"managerID"</span>: <span class="hljs-number">413</span>,            <span class="hljs-string">"employerID"</span>: <span class="hljs-number">20</span>,            <span class="hljs-string">"photo"</span>: <span class="hljs-string">"[object Picture]"</span>,            <span class="hljs-string">"extra"</span>: null,            <span class="hljs-string">"employer"</span>: {                <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">20</span>            },            <span class="hljs-string">"manager"</span>: {                <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">413</span>            }        }    ]}</code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-4-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-4-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 4</h4><p>Extracción de algunas propiedades de<code>relatedEntities</code>:</p><pre><code class="hljs css language-4d"> employeeObject:=employeeSelected.<span class="hljs-function">toObject</span>(<span class="hljs-string">"firstName, directReports.lastName"</span>)</code></pre><p>Devuelve:</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Greg"</span>,    <span class="hljs-string">"directReports"</span>: [        {            <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Boothe"</span>        },        {            <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Caudill"</span>        },        {            <span class="hljs-string">"lastName"</span>: <span class="hljs-string">"Gomes"</span>        }    ]}</code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-5-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-5-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 5</h4><p>Obtenga una <code>relatedEntity</code> en un formulariosimple:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$coll</span>:=<span class="hljs-function">New collection</span>(<span class="hljs-string">"firstName"</span>;<span class="hljs-string">"employer"</span>) employeeObject:=employeeSelected.<span class="hljs-function">toObject</span>(<span class="hljs-variable">$coll</span>)</code></pre><p>Devuelve:</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"firstName"</span>: <span class="hljs-string">"Greg"</span>,    <span class="hljs-string">"employer"</span>: {        <span class="hljs-string">"__KEY"</span>: <span class="hljs-number">20</span>    }}</code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-6-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-6-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 6</h4><p>Extracción de todas las propiedades de una <code>Entidadrelacionada</code>:</p><pre><code class="hljs css language-4d"> employeeObject:=employeeSelected.<span class="hljs-function">toObject</span>(<span class="hljs-string">"employer.*"</span>)</code></pre><p>Devuelve:</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"employer"</span>: {        <span class="hljs-string">"ID"</span>: <span class="hljs-number">20</span>,        <span class="hljs-string">"name"</span>: <span class="hljs-string">"India Astral Secretary"</span>,        <span class="hljs-string">"creationDate"</span>: <span class="hljs-string">"1984-08-25T00:00:00.000Z"</span>,        <span class="hljs-string">"revenues"</span>: <span class="hljs-number">12000000</span>,        <span class="hljs-string">"extra"</span>: null    }}</code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-7-1"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-7-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 7</h4><p>Extracción de algunas propiedades de una <code>Entidadrelacionada</code>:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$col</span>:=New collection <span class="hljs-variable">$col</span>.<span class="hljs-function">push</span>(<span class="hljs-string">"employer.name"</span>) <span class="hljs-variable">$col</span>.<span class="hljs-function">push</span>(<span class="hljs-string">"employer.revenues"</span>) employeeObject:=employeeSelected.<span class="hljs-function">toObject</span>(<span class="hljs-variable">$col</span>)</code></pre><p>Devuelve:</p><pre><code class="hljs css language-4d">{    <span class="hljs-string">"employer"</span>: {        <span class="hljs-string">"name"</span>: <span class="hljs-string">"India Astral Secretary"</span>,        <span class="hljs-string">"revenues"</span>: <span class="hljs-number">12000000</span>    }}</code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_touched-"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_touched-"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.touched( )</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.touched()</strong> : Boolean</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>Booleano</td><td style="text-align:center">&lt;-</td><td>True si se ha modificado al menos un atributo de la entidad yaún no se ha guardado, si no, False</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-20"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-20"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.touched()</code> comprueba si un atributo dela entidad ha sido modificado o no desde que la entidad fue cargadaen memoria o guardada.</p><p>Si un atributo ha sido modificado o calculado, la funcióndevuelve True, en caso contrario devuelve False. Puede utilizaresta función para determinar si necesita guardar la entidad.</p><p>Esta función devuelve False para una nueva entidad que acaba deser creada (con <a href="#EntityClass.html_new"><code>.new()</code></a>). Tenga en cuenta, sin embargo, que si utiliza unafunción que calcula un atributo de la entidad, la función<code>.touched()</code> devolverá entonces True. Por ejemplo, si sellama a <a href="#EntityClass.html_getkey"><code>.getKey()</code></a> para calcularla llave primaria, <code>.touched()</code> devuelve True.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-16"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-16"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><p>En este ejemplo, comprobamos si es necesario guardar laentidad:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$emp </span>: cs.EmployeeEntity <span class="hljs-variable">$emp</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">672</span>) <span class="hljs-variable">$emp</span>.firstName:=<span class="hljs-variable">$emp</span>.firstName <span class="hljs-comment">//Aunque se actualice con el mismo valor, el atributo se marca como tocado</span><span class="hljs-keyword"> If</span>(<span class="hljs-variable">$emp</span>.<span class="hljs-function">touched</span>()) <span class="hljs-comment">//si se ha modificado al menos uno de los atributos</span>    <span class="hljs-variable">$emp</span>.<span class="hljs-function">save</span>()<span class="hljs-keyword"> End if</span> <span class="hljs-comment">// de lo contrario, no es necesario guardar la entidad</span></code></pre><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_touchedattributes-"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_touchedattributes-"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.touchedAttributes( )</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.touchedAttributes()</strong> : Collection</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>Collection</td><td style="text-align:center">&lt;-</td><td>Nombres de atributos tocados, o colección vacía</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-21"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-21"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.touchedAttributes()</code> devuelve losnombres de los atributos que han sido modificados desde que laentidad fue cargada en memoria.</p><p>Esto se aplica a los atributos <a href="#EntityClass.html_kind">kind</a> <code>storage</code> o<code>relatedEntity</code>.</p><p>En el caso de que se haya tocado una entidad relacionada (esdecir, la llave externa), se devuelve el nombre de la entidadrelacionada y el nombre de su llave primaria.</p><p>Si no se ha tocado ningún atributo de entidad, el métododevuelve una colección vacía.</p><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-1-6"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-1-6"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 1</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$touchedAttributes </span>: Collection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$emp </span>: cs.EmployeeEntity <span class="hljs-variable">$touchedAttributes</span>:=New collection <span class="hljs-variable">$emp</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">725</span>) <span class="hljs-variable">$emp</span>.firstName:=<span class="hljs-variable">$emp</span>.firstName <span class="hljs-comment">//Aunque se actualice con el mismo valor, el atributo se marca como tocado</span> <span class="hljs-variable">$emp</span>.lastName:=<span class="hljs-string">"Martin"</span> <span class="hljs-variable">$touchedAttributes</span>:=<span class="hljs-variable">$emp</span>.<span class="hljs-function">touchedAttributes</span>()  <span class="hljs-comment">//$touchedAttributes: ["firstName","lastName"]</span></code></pre><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-2-6"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-2-6"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 2</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$touchedAttributes </span>: Collection<span class="hljs-keyword"> var</span> <span class="hljs-variable">$emp </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$company </span>: cs.CompanyEntity <span class="hljs-variable">$touchedAttributes</span>:=New collection <span class="hljs-variable">$emp</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">672</span>) <span class="hljs-variable">$emp</span>.firstName:=<span class="hljs-variable">$emp</span>.firstName <span class="hljs-variable">$emp</span>.lastName:=<span class="hljs-string">"Martin"</span> <span class="hljs-variable">$company</span>:=ds.Company.<span class="hljs-function">get</span>(<span class="hljs-number">121</span>) <span class="hljs-variable">$emp</span>.employer:=<span class="hljs-variable">$company</span> <span class="hljs-variable">$touchedAttributes</span>:=<span class="hljs-variable">$emp</span>.<span class="hljs-function">touchedAttributes</span>()  <span class="hljs-comment">//collection $touchedAttributes: ["firstName","lastName","employer","employerID"]</span></code></pre><p>En este caso:</p><ul><li>firstName y lastName tienen un tipo <code>storage</code></li><li>employer tiene un tipo <code>relatedEntity</code></li><li>employerID es la llave extranjera de la entidad relacionada conel empleador</li></ul><h2><a aria-hidden="true" class="anchor" id="EntityClass.html_unlock"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_unlock"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.unlock()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v17</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.unlock()</strong> : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Objeto de estado</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_descripci%C3%B3n-22"></a><a aria-hidden="true"class="hash-link" href="#EntityClass.html_descripci%25C3%25B3n-22"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.unlock()</code> elimina el bloqueo pesimistadel registro que coincide con la entidad en el datastore y la tablarelacionada con su dataclass.</p><blockquote><p>Para más información, consulte la sección <a href="#EntityClass.html_entity-locking">Entity locking</a>.</p></blockquote><p>Un registro se desbloquea automáticamente cuando ya no esreferenciado por ninguna entidad en el proceso de bloqueo (porejemplo: si el bloqueo se pone sólo en una referencia local de unaentidad, la entidad y, por tanto, el registro se desbloquea cuandoel proceso termina).</p><blockquote><p>Cuando un registro se bloquea, debe desbloquearse desde elproceso de bloqueo y en la referencia de la entidad que puso elbloqueo. Por ejemplo:</p></blockquote><pre><code class="hljs css language-4d"> <span class="hljs-variable">$e1</span>:=ds.Emp.<span class="hljs-function">all</span>()[<span class="hljs-number">0</span>] <span class="hljs-variable">$e2</span>:=ds.Emp.<span class="hljs-function">all</span>()[<span class="hljs-number">0</span>] <span class="hljs-variable">$res</span>:=<span class="hljs-variable">$e1</span>.<span class="hljs-function">lock</span>() <span class="hljs-comment">//$res.success=true</span> <span class="hljs-variable">$res</span>:=<span class="hljs-variable">$e2</span>.<span class="hljs-function">unlock</span>() <span class="hljs-comment">//$res.success=false</span> <span class="hljs-variable">$res</span>:=<span class="hljs-variable">$e1</span>.<span class="hljs-function">unlock</span>() <span class="hljs-comment">//$res.success=true</span></code></pre><p><strong>Resultado</strong></p><p>El objeto devuelto por &lt;<code>.unlock()&lt;</code> contienela siguiente propiedad:</p><table><thead><tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>success</td><td>Boolean</td><td>True si la acción de desbloquear tiene éxito, False en casocontrario. Si el desbloqueo se realiza en una entidad abandonada,en un registro no bloqueado o en un registro bloqueado por otroproceso o entidad, el éxito es False.</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="EntityClass.html_ejemplo-17"></a><a aria-hidden="true" class="hash-link" href="#EntityClass.html_ejemplo-17"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$employee </span>: cs.EmployeeEntity<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$employee</span>:=ds.Employee.<span class="hljs-function">get</span>(<span class="hljs-number">725</span>) <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">lock</span>() ... <span class="hljs-comment">//processing</span> <span class="hljs-variable">$status</span>:=<span class="hljs-variable">$employee</span>.<span class="hljs-function">unlock</span>()<span class="hljs-keyword"> If</span>(<span class="hljs-variable">$status</span>.success)<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"The entity is now unlocked"</span>)<span class="hljs-keyword"> End if</span></code></pre><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#EmailObjectClass.html"><span class="arrow-prev">←</span><span>Email</span></a><a class="docs-next button" href="#EntitySelectionClass.html"><span class="function-name-prevnext">EntitySelection</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#EntityClass.html_attributename">.<em>attributeName</em></a></li><li><a href="#EntityClass.html_clone">.clone()</a></li><li><a href="#EntityClass.html_diff">.diff()</a></li><li><a href="#EntityClass.html_drop">.drop()</a></li><li><a href="#EntityClass.html_first">.first()</a></li><li><a href="#EntityClass.html_fromobject">.fromObject()</a></li><li><a href="#EntityClass.html_getdataclass">.getDataClass()</a></li><li><a href="#EntityClass.html_getkey">.getKey()</a></li><li><a href="#EntityClass.html_getremotecontextattributes">.getRemoteContextAttributes()</a></li><li><a href="#EntityClass.html_getselection">.getSelection()</a></li><li><a href="#EntityClass.html_getstamp">.getStamp()</a></li><li><a href="#EntityClass.html_indexof">.indexOf()</a></li><li><a href="#EntityClass.html_isnew">.isNew()</a></li><li><a href="#EntityClass.html_last">.last()</a></li><li><a href="#EntityClass.html_lock">.lock()</a></li><li><a href="#EntityClass.html_next">.next()</a></li><li><a href="#EntityClass.html_previous">.previous()</a></li><li><a href="#EntityClass.html_reload-">.reload( )</a></li><li><a href="#EntityClass.html_save">.save()</a></li><li><a href="#EntityClass.html_toobject">.toObject()</a></li><li><a href="#EntityClass.html_touched-">.touched( )</a></li><li><a href="#EntityClass.html_touchedattributes-">.touchedAttributes()</a></li><li><a href="#EntityClass.html_unlock">.unlock()</a></li></ul></nav></div></div></body></html>