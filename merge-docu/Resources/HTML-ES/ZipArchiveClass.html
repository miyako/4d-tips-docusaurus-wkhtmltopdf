<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="es"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>ZIPArchive · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="Un archivo ZIP 4D es un objeto `File` o `Folder` que contiene uno o más archivos o carpetas, que se comprimen para ser más pequeños que su tamaño original. Estos archivos se crean con una extensión &quot;.zip&quot; y pueden utilizarse para ahorrar espacio en el disco o transferir archivos a través de medios que pueden tener limitaciones de tamaño (por ejemplo, el correo electrónico o la red)."name="description" /><meta content="es" name="docsearch:language" /><meta content="ZIPArchive · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="Un archivo ZIP 4D es un objeto `File` o `Folder` que contiene uno o más archivos o carpetas, que se comprimen para ser más pequeños que su tamaño original. Estos archivos se crean con una extensión &quot;.zip&quot; y pueden utilizarse para ahorrar espacio en el disco o transferir archivos a través de medios que pueden tener limitaciones de tamaño (por ejemplo, el correo electrónico o la red)."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#ZipArchiveClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">ZIPArchive<a aria-hidden="true" class="anchor" id="ZipArchiveClass.html"></a></h1></header><article><div><p><span>Un archivo ZIP 4D es un objeto <code>File</code> o<code>Folder</code> que contiene uno o más archivos o carpetas, quese comprimen para ser más pequeños que su tamaño original. Estosarchivos se crean con una extensión ".zip" y pueden utilizarse paraahorrar espacio en el disco o transferir archivos a través demedios que pueden tener limitaciones de tamaño (por ejemplo, elcorreo electrónico o la red).</span></p><ul><li><span>Cree un archivo ZIP 4D con el comando <a href="#ZipArchiveClass.html_zip-create-archive">ZIP Createarchive</a>.</span></li><li><span>Las instancias <a href="#ZipFileClass.html"><code>ZIPFile</code></a> y <a href="#ZipFolderClass.html"><code>ZIPFolder</code></a> de 4D estándisponibles vía la propriedad <a href="#ZipArchiveClass.html_root"><code>root</code></a>(<code>ZIPFolder</code>) del objeto devuelto por el comando<a href="#ZipArchiveClass.html_zip-read-archive">ZIP Readarchive</a>.</span></li></ul><h3><span><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_ejemplo"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_ejemplo"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</span></h3><p><span>Para recuperar y ver el contenido de un objeto ZIPfile:</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$path</span>; <span class="hljs-variable">$archive </span>: 4D.File<span class="hljs-keyword">var</span> <span class="hljs-variable">$zipFile </span>: 4D.ZipFile<span class="hljs-keyword">var</span> <span class="hljs-variable">$zipFolder </span>: 4D.ZipFolder<span class="hljs-keyword">var</span> <span class="hljs-variable">$txt </span>: Text<span class="hljs-variable">$path</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/Archive.zip"</span>)<span class="hljs-variable">$archive</span>:=<span class="hljs-function">ZIP Read archive</span>(<span class="hljs-variable">$path</span>)<span class="hljs-variable">$zipFolder</span>:=<span class="hljs-variable">$archive</span>.root <span class="hljs-comment">// guardar la carpeta principal del zip</span><span class="hljs-variable">$zipFile</span>:=<span class="hljs-variable">$zipFolder</span>.<span class="hljs-function">files</span>()[<span class="hljs-number">0</span>] <span class="hljs-comment">//leer la primera carpeta comprimida</span><span class="hljs-keyword">If</span>(<span class="hljs-variable">$zipFile</span>.extension=<span class="hljs-string">".txt"</span>)    <span class="hljs-variable">$txt</span>:=<span class="hljs-variable">$zipFile</span>.<span class="hljs-function">getText</span>()<span class="hljs-keyword">End if</span></code></span></pre><h3><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_resumen"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_resumen"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Resumen</h3><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#ZipArchiveClass.html_root"><strong>.root</strong> :4D.ZipFolder</a><p>&nbsp;&nbsp;&nbsp;&nbsp;una carpeta virtual que permite accederal contenido del archivo ZIP</p></td></tr></tbody></table><h2><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_zip-create-archive"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_zip-create-archive"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>ZIP Create archive</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v19 R3</td><td>Adición de las propiedades <code>ZIP Compression LZMA</code>,<code>ZIP Compression xy</code>, <code>.level</code></td></tr><tr><td>v18</td><td>Añadidos</td></tr></tbody></table></details><p><strong>ZIP Create archive</strong> ( <em>fileToZip</em> :4D.File ; <em>destinationFile</em> : 4D.File ) : Object<br /><strong>ZIP Create archive</strong> ( <em>folderToZip</em> :4D.Folder ; <em>destinationFile</em> : 4D.File { ; <em>options</em>: Integer }) : Object<br /><strong>ZIP Create archive</strong> ( <em>zipStructure</em> :Object ; <em>destinationFile</em> : 4D.File ) : Object</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>fileToZip</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>Objeto archivo o carpeta a comprimir</td></tr><tr><td>folderToZip</td><td>4D.Folder</td><td style="text-align:center">-&gt;</td><td>Objeto archivo o carpeta a comprimir</td></tr><tr><td>zipStructure</td><td>Objeto</td><td style="text-align:center">-&gt;</td><td>Objeto archivo o carpeta a comprimir</td></tr><tr><td>destinationFile</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>Archivo de destino del archivo</td></tr><tr><td>options</td><td>Integer</td><td style="text-align:center">-&gt;</td><td>Opción <em>folderToZip</em>: <code>ZIP Without enclosingfolder</code></td></tr><tr><td>Resultado</td><td>Objeto</td><td style="text-align:center">&lt;-</td><td>Objeto de estado</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_descripci%C3%B3n"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_descripci%25C3%25B3n"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>El comando <code>ZIP Create archive</code>crea un objeto archivoZIP comprimido y devuelve el estado de la operación.</p><p>Puede pasar un objeto 4D.File, 4D.Folder, o una estructura zipcomo primer parámetro:</p><ul><li><p><em>fileToZip</em>: simplemente pase un <code>4D.File</code> acomprimir.</p></li><li><p><em>folderToZip</em>: pase un <code>4D.Folder</code> acomprimir. En este caso, el parámetro <em>options</em> permitecomprimir sólo el contenido de la carpeta (es decir, excluir lacarpeta padre). Por defecto, <code>ZIP Create archive</code>comprimirá la carpeta y su contenido, de modo que la operación dedescompresión volverá a crear una carpeta. Si desea que laoperación de descompresión restaure sólo el contenido de lacarpeta, pase la constante <code>ZIP Without enclosingfolder</code> en el parámetro <em>options</em>.</p></li><li><p><em>zipStructure</em>: pase un objeto que describa el objeto ZIParchivo. Las siguientes propiedades están disponibles para definirla estructura:</p></li></ul><table><thead><tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>compression</td><td>Integer</td><td><ul><li><code>ZIP Compression standard</code>: Reducir la compresión(por defecto)</li><li><code>ZIP Compression LZMA</code>: compresión LZMA</li><li><code>ZIP Compression XZ</code>: compresión XZ</li><li><code>ZIP Compression none</code>: sin compresión</li></ul></td></tr><tr><td>level</td><td>Integer</td><td>Nivel de compresión. Valores posibles: 1 a 10. Un valor másbajo producirá un archivo más grande, mientras que un valor másalto producirá un archivo más pequeño. Sin embargo, el nivel decompresión influye en el rendimiento. Valores por defecto si seomiten:<ul><li><code>ZIP Compression standard</code>: 6</li><li><code>ZIP Compression LZMA</code>: 4</li><li><code>ZIP Compression XZ</code>: 4</li></ul></td></tr><tr><td>encryption</td><td>Integer</td><td>La encriptación a utilizar si se define una contraseña:<ul><li><code>ZIP Encryption AES128</code>: encriptación AES con unallave de 128 bits.</li><li><code>ZIP Encryption AES192</code>: encriptación AES con unallave de 192 bits.</li><li><code>ZIP Encryption AES256</code>: encriptación AES con unallave de 256 bits (por defecto si se define la contraseña).</li><li><code>ZIP Encryption none</code>: los datos no estánencriptados (por defecto si no se define una contraseña)</li></ul></td></tr><tr><td>contraseña</td><td>Texto</td><td>Una contraseña a utilizar si se requiere encriptación.</td></tr><tr><td>Histórico</td><td>Collection</td><td><ul><li>una colección de objetos <code>4D.File</code> o<code>4D.Folder</code> o</li><li>una colección de objetos con las siguientes propiedades:</li><table><tr><td>Propiedad</td><td>Tipo</td><td>Descripción</td></tr><tr><td>source</td><td>4D.File o 4D.Folder</td><td>File o Folder</td></tr><tr><td>destination</td><td>Texto</td><td>(opcional) - Especifica una ruta de archivo relativa paracambiar la organización del contenido del archivo</td></tr><tr><td>option</td><td>number</td><td>(opcional) - <code>ZIP Ignore invisible files</code> o 0 paracomprimir todo el archivo</td></tr></table></ul></td></tr><tr><td>retrollamada</td><td>4D.Function</td><td>Una fórmula de retrollamada que recibirá la progresión de lacompresión (0 - 100) en $1.</td></tr></tbody></table><p>En el parámetro <em>destinationFile</em>, pase un objeto<code>4D.File</code> describiendo el archivo ZIP a crear (nombre,ubicación, etc.). Se aconseja utilizar la extensión ".zip" siquiere que el archivo ZIP sea procesado automáticamente porcualquier software.</p><p>Una vez creado un archivo, puede utilizar el comando <a href="#ZipArchiveClass.html_zip-read-archive">ZIP Read archive</a> paraacceder a él.</p><p><strong>Objeto de estado</strong></p><p>El objeto status devuelto contiene las siguientespropiedades:</p><table><thead><tr><th>Propiedad</th><th>Tipo</th><th>Descripción</th></tr></thead><tbody><tr><td>statusText</td><td>Texto</td><td>Mensaje de error (si lo hay):<ul><li>No se puede abrir el archivo ZIP</li><li>No se puede crear un archivo ZIP</li><li>La contraseña es necesaria para la codificación</li></ul></td></tr><tr><td>status</td><td>Integer</td><td>Código de estado</td></tr><tr><td>success</td><td>Booleano</td><td>True si el archivo se ha creado con éxito, si no, false</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_ejemplo-1"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_ejemplo-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 1</h4><p>Para comprimir un <code>4D.File</code>:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$file</span>; <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/file.zip"</span>) <span class="hljs-variable">$file</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/text.txt"</span>) <span class="hljs-variable">$status</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$file</span>;<span class="hljs-variable">$destination</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_ejemplo-2"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_ejemplo-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 2</h4><p>Para comprimir un <code>4D.Folder</code> sin la carpetamisma:</p><pre><code class="hljs css language-4D"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$folder </span>: 4D.Folder<span class="hljs-keyword"> var</span> <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$status </span>: Object <span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/Images.zip"</span>) <span class="hljs-variable">$folder</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"MyDocs/Images"</span>) <span class="hljs-variable">$status</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$folder</span>;<span class="hljs-variable">$destination</span>;ZIP Without enclosing folder)</code></pre><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_ejemplo-3"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_ejemplo-3"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 3</h4><p>Para comprimir una estructura de archivo ZIP con una contraseñay una barra de progreso:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$zip</span>;<span class="hljs-variable">$status </span>: Object<span class="hljs-keyword"> var</span> progID : Integer <span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/Archive.zip"</span>) <span class="hljs-variable">$zip</span>:=New object <span class="hljs-variable">$zip</span>.files:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"MyDocs/Resources"</span>).<span class="hljs-function">folders</span>() <span class="hljs-variable">$zip</span>.password:=<span class="hljs-string">"password"</span> <span class="hljs-variable">$zip</span>.callback:=<span class="hljs-function">Formula</span>(<span class="hljs-function">myFormulaCompressingMethod</span>(<span class="hljs-variable">$1</span>)) progID:=Progress New <span class="hljs-comment">//utilizamos el componente 4D Progress</span> <span class="hljs-variable">$status</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$zip</span>;<span class="hljs-variable">$destination</span>)<span class="hljs-function"> Progress QUIT</span>(progID)</code></pre><p><code>myFormulaCompressingMethod</code>:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$1 </span>: Integer<span class="hljs-function"> Progress SET PROGRESS</span>(progID;<span class="hljs-function">Num</span>(<span class="hljs-variable">$1</span>/<span class="hljs-number">100</span>))</code></pre><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_ejemplo-4"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_ejemplo-4"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 4</h4><p>Quiere pasar una colección de carpetas y archivos para comprimiral objeto <em>zipStructure</em>:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword"> var</span> <span class="hljs-variable">$zip</span>;<span class="hljs-variable">$err </span>: Object <span class="hljs-variable">$zip</span>:=New object <span class="hljs-variable">$zip</span>.files:=New collection <span class="hljs-variable">$zip</span>.files.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"source"</span>;<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"Tests/text.txt"</span>))) <span class="hljs-variable">$zip</span>.files.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"source"</span>;<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"Tests/text2.txt"</span>))) <span class="hljs-variable">$zip</span>.files.<span class="hljs-function">push</span>(<span class="hljs-function">New object</span>(<span class="hljs-string">"source"</span>;<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"Images/image.png"</span>))) <span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"file.zip"</span>) <span class="hljs-variable">$err</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$zip</span>;<span class="hljs-variable">$destination</span>)</code></pre><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_ejemplo-5"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_ejemplo-5"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 5</h4><p>Desea utilizar un algoritmo de compresión alternativo con unalto nivel de compresión:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword">var</span> <span class="hljs-variable">$destination </span>: 4D.File<span class="hljs-keyword">var</span> <span class="hljs-variable">$zip</span>; <span class="hljs-variable">$err </span>: Object<span class="hljs-variable">$zip</span>:=New object<span class="hljs-variable">$zip</span>.files:=New collection<span class="hljs-variable">$zip</span>.files.<span class="hljs-function">push</span>(<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"images"</span>))<span class="hljs-variable">$zip</span>.compression:=ZIP Compression LZMA<span class="hljs-variable">$zip</span>.level:=<span class="hljs-number">7</span> <span class="hljs-comment">//por defecto es 4</span><span class="hljs-variable">$destination</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"images.zip"</span>)<span class="hljs-variable">$err</span>:=<span class="hljs-function">ZIP Create archive</span>(<span class="hljs-variable">$zip</span>; <span class="hljs-variable">$destination</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_zip-read-archive"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_zip-read-archive"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>ZIP Read archive</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v18</td><td>Añadidos</td></tr></tbody></table></details><p><strong>ZIP Read archive</strong> ( <em>zipFile</em> : 4D.File {; <em>password</em> : Text }) : 4D.ZipArchive</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>zIPFile</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>Archivos Zip</td></tr><tr><td>contraseña</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Contraseña del archivo ZIP, si la hay</td></tr><tr><td>Resultado</td><td>4D.ZipArchive</td><td style="text-align:center">&lt;-</td><td>Objeto archivo</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_descripci%C3%B3n-1"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_descripci%25C3%25B3n-1"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>El comando <code>ZIP Read archive</code>recupera el contenidodel <em>zipFile</em> y lo devuelve como un objeto<code>4D.ZipArchive</code>.</p><blockquote><p>Este comando no descomprime el archivo ZIP, sólo ofrece unavista de su contenido. Para extraer el contenido de un archivo, esnecesario utilizar métodos como <a href="#ZipArchiveClass.html_copyto">file.copyTo()</a> o <a href="#ZipArchiveClass.html_copyto">folder.copyTo()</a>.</p></blockquote><p>Pase un objeto <code>4D.File</code> haciendo referencia alarchivo ZIP comprimido en el parámetro <em>zipFile</em>. El archivode destino se abrirá hasta que el <code>ZIP Read archive</code>haya terminado de ejecutarse y todos los contenidos/referenciashayan sido extraídos/liberados, entonces se cerraráautomáticamente.</p><p>Si el <em>archivo_zip</em> está protegido por contraseña, esnecesario utilizar el parámetro opcional <em>password</em> parasuministrar una contraseña. Si se requiere una contraseña pero nose pasa al intentar leer el contenido del archivo, se genera unerror.</p><p><strong>Objeto archivo</strong></p><p>El objeto <code>4D.ZipArchive</code> revuelto contiene una solapropiedad, <a href="#ZipArchiveClass.html_root"><code>root</code></a>, cuyo valor esun objeto.<code>4D.ZipFolder</code>. Esta carpeta describe todo elcontenido del archivo ZIP.</p><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_ejemplo-6"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_ejemplo-6"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16"width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><p>Para recuperar y ver el contenido de un objeto ZIP file:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> var</span> <span class="hljs-variable">$archive </span>: 4D.ZipArchive<span class="hljs-keyword"> var</span> <span class="hljs-variable">$path </span>: 4D.File <span class="hljs-variable">$path</span>:=<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">file</span>(<span class="hljs-string">"MyDocs/Archive.zip"</span>) <span class="hljs-variable">$archive</span>:=<span class="hljs-function">ZIP Read archive</span>(<span class="hljs-variable">$path</span>)</code></pre><p>Para recuperar la lista de los archivos y carpetas delarchivo:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$folders</span>:=<span class="hljs-variable">$archive</span>.root.<span class="hljs-function">folders</span>() <span class="hljs-variable">$files</span>:=<span class="hljs-variable">$archive</span>.root.<span class="hljs-function">files</span>()</code></pre><p>Para leer el contenido de un archivo sin extraerlo de la carpetaroot:</p><pre><code class="hljs css language-4d"><span class="hljs-keyword"> If</span>(<span class="hljs-variable">$files</span>[<span class="hljs-variable">$i</span>].extension=<span class="hljs-string">".txt"</span>)    <span class="hljs-variable">$txt</span>:=<span class="hljs-variable">$files</span>[<span class="hljs-variable">$i</span>].<span class="hljs-function">getText</span>()<span class="hljs-keyword"> Else</span>    <span class="hljs-variable">$blob</span>:=<span class="hljs-variable">$files</span>[<span class="hljs-variable">$i</span>].<span class="hljs-function">getContent</span>()<span class="hljs-keyword"> End if</span></code></pre><p>Para extraer desde la carpeta root:</p><pre><code class="hljs css language-4d">  <span class="hljs-comment">//extraer un archivo</span> <span class="hljs-variable">$folderResult</span>:=<span class="hljs-variable">$files</span>[<span class="hljs-variable">$i</span>].<span class="hljs-function">copyTo</span>(<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"MyDocs"</span>))  <span class="hljs-comment">//extraer todos los archivos</span> <span class="hljs-variable">$folderResult</span>:=<span class="hljs-variable">$archive</span>.root.<span class="hljs-function">copyTo</span>(<span class="hljs-function">Folder</span>(fk desktop folder).<span class="hljs-function">folder</span>(<span class="hljs-string">"MyDocs"</span>))</code></pre><h2><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_root"></a><a aria-hidden="true" class="hash-link" href="#ZipArchiveClass.html_root"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.root</h2><p><strong>.root</strong> : 4D.ZipFolder</p><h4><a aria-hidden="true" class="anchor" id="ZipArchiveClass.html_descripci%C3%B3n-2"></a><a aria-hidden="true"class="hash-link" href="#ZipArchiveClass.html_descripci%25C3%25B3n-2"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La propiedad <code>.root</code> contiene una carpeta virtual quepermite acceder al contenido del archivo ZIP.</p><p>La carpeta <code>root</code> y su contenido pueden sermanipulados con las funciones y propiedades <a href="#ZipFileClass.html">ZipFile</a> y <a href="#ZipFolderClass.html">ZipFolder</a>.</p><p>Esta propiedad es <strong>de sólo lectura</strong>.</p><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#WebServerClass.html"><span class="arrow-prev">←</span><span class="function-name-prevnext">WebServer</span></a><a class="docs-next button" href="#ZipFileClass.html"><span>ZIPFile</span><span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#ZipArchiveClass.html_zip-create-archive">ZIP Createarchive</a></li><li><a href="#ZipArchiveClass.html_zip-read-archive">ZIP Readarchive</a></li><li><a href="#ZipArchiveClass.html_root">.root</a></li></ul></nav></div></div></body></html>