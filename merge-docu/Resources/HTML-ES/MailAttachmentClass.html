<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="es"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>MailAttachment · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="Los objetos adjuntos permiten referenciar archivos en un objeto [`Email`](/docs/Rx/es/API/EmailObjectClass.html). Los objetos Attachment (adjuntos) son creados utilizando el comando [`MAIL New attachment`](#mail-new-attachment)."name="description" /><meta content="es" name="docsearch:language" /><meta content="MailAttachment · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="Los objetos adjuntos permiten referenciar archivos en un objeto [`Email`](/docs/Rx/es/API/EmailObjectClass.html). Los objetos Attachment (adjuntos) son creados utilizando el comando [`MAIL New attachment`](#mail-new-attachment)."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#MailAttachmentClass.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">MailAttachment<a aria-hidden="true" class="anchor" id="MailAttachmentClass.html"></a></h1></header><article><div><p><span>Los objetos adjuntos permiten referenciar archivos en unobjeto <a href="#EmailObjectClass.html"><code>Email</code></a>. Losobjetos Attachment (adjuntos) son creados utilizando el comando<a href="#MailAttachmentClass.html_mail-new-attachment"><code>MAILNew attachment</code></a>.</span></p><h3><span><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_objetos-adjuntos"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_objetos-adjuntos"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Objetos adjuntos</span></h3><p><span>Los objetos Attachment ofrecen las siguientes propiedadesy funciones de sólo lectura:</span></p><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#MailAttachmentClass.html_cid"><strong>.cid</strong> :Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp; el ID del adjunto</p></td></tr><tr><td><a href="#MailAttachmentClass.html_disposition"><strong>.disposition</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;el valor del encabezado<code>Content-Disposition</code></p></td></tr><tr><td><a href="#MailAttachmentClass.html_getContent"><strong>.getContent()</strong>: 4D.Blob</a><p>&nbsp;&nbsp;&nbsp;&nbsp;devuelve el contenido del objeto adjuntoen un objeto <code>4D.Blob</code></p></td></tr><tr><td><a href="#MailAttachmentClass.html_name"><strong>.name</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;el nombre y la extensión deladjuntot</p></td></tr><tr><td><a href="#MailAttachmentClass.html_path"><strong>.path</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;la ruta POSIX del archivo adjunto, siexiste</p></td></tr><tr><td><a href="#MailAttachmentClass.html_platformpath"><strong>.platformPath</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;la ruta del archivo adjunto expresadacon la sintaxis de la plataforma actual</p></td></tr><tr><td><a href="#MailAttachmentClass.html_type"><strong>.type</strong>: Text</a><p>&nbsp;&nbsp;&nbsp;&nbsp;el <code>content-type</code> del archivoadjunto</p></td></tr></tbody></table><h2><span><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_mail-new-attachment"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_mail-new-attachment"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>MAIL New attachment</span></h2><details><summary><span>Histórico</span></summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v19 R2</td><td>Acepta 4D.File, 4D.ZipFile, 4D.Blob</td></tr></tbody></table></details><p><span><strong>MAIL New attachment</strong>( <em>file</em> :4D.File { ; <em>name</em> : Text {; <em>cid</em> : Text{ ;<em>type</em> : Text { ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment<br /><strong>MAIL New attachment</strong>( <em>zipFile</em> : 4D.ZipFile{ ; <em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> :Text { ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment<br /><strong>MAIL New attachment</strong>( <em>blob</em> : 4D.Blob { ;<em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> : Text{ ; <em>disposition</em> :Text } } } } ) : 4D.MailAttachment<br /><strong>MAIL New attachment</strong>( <em>path</em> : Text { ;<em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> : Text{ ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment</span></p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>file</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>Archivo adjunto</td></tr><tr><td>zIPFile</td><td>4D.ZipFile</td><td style="text-align:center">-&gt;</td><td>Archivo zip adjunto</td></tr><tr><td>blob</td><td>4D.Blob</td><td style="text-align:center">-&gt;</td><td>BLOB que contiene el archivo adjunto</td></tr><tr><td>path</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Ruta del archivo adjunto</td></tr><tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre + extensión utilizados por el cliente de correo paradesignar el archivo adjunto</td></tr><tr><td>cid</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>ID del archivo adjunto (sólo en mensajes HTML), o " " si no serequiere cid</td></tr><tr><td>type</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Valor del encabezado content-type</td></tr><tr><td>disposition</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Valor del encabezado content-disposition: "inline" o"attachment".</td></tr><tr><td>Resultado</td><td>4D.MailAttachment</td><td style="text-align:center">&lt;-</td><td>Objeto adjunto</td></tr></tbody></table><h4><span><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_descripci%C3%B3n"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_descripci%25C3%25B3n"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</span></h4><p><span>El comando <code>MAIL New attachment</code> le permitecrear un objeto adjunto que puede asociar a un objeto <a href="#MailAttachmentClass.html_email-object">Email</a>.</span></p><p><span>Para definir el adjunto, puede utilizar:</span></p><ul><li><span>un <em>file</em>, pase un objeto <code>4D.File</code> quecontenga el propio archivo adjunto.</span></li><li><span>un <em>zipfile</em>, pase un objeto<code>4D.ZipFile</code> que contenga el propio archivoadjunto.</span></li><li><span>un <em>blob</em>, pase un objeto <code>4D.Blob</code> quecontenga el propio archivo adjunto.</span></li><li><span>un <em>path</em>, pase un valor <strong>texto</strong>que contenga la ruta del archivo adjunto, expresada con la sintaxisdel sistema. Puede pasar un nombre de ruta completo o un simplenombre de archivo (en cuyo caso 4D buscará el archivo en el mismodirectorio que el archivo del proyecto).</span></li></ul><p><span>El parámetro opcional <em>name</em> permite pasar elnombre y la extensión que utilizará el cliente de correo paradesignar el archivo adjunto. Si se omite <em>name</em>y:</span></p><ul><li><span>pasó una ruta de archivo, se utiliza el nombre y laextensión del archivo,</span></li><li><span>pasó un BLOB, se genera automáticamente un nombrealeatorio sin extensión.</span></li></ul><p><span>El parámetro opcional <em>cid</em> permite pasar un IDinterno para el archivo adjunto. Este ID es el valor del encabezado<code>Content-Id</code>, se utilizará sólo en mensajes HTML. El cidasocia el archivo adjunto con una referencia definida en el cuerpodel mensaje mediante una etiqueta HTML como <code>\&lt;imgsrc="cid:ID"&gt;</code>. Esto significa que el contenido delarchivo adjunto (por ejemplo, una imagen) debe mostrarse dentro delmensaje en el cliente de correo. El resultado final puede variar enfunción del cliente de correo. Puede pasar una cadena vacía en<em>cid</em> si no quiere utilizar este parámetro.</span></p><p><span>Puede utilizar el parámetro opcional <em>type</em> paradefinir explícitamente el <code>content-type</code> del archivoadjunto. Por ejemplo, puede pasar una cadena que defina un tipoMIME ("video/mpeg"). Este valor de content-type se definirá para elarchivo adjunto, independientemente de su extensión. Para másinformación sobre los tipos MIME, consulte la página <a href="https://en.wikipedia.org/wiki/MIME">Tipo MIME enWikipedia</a>.</span></p><p><span>Por defecto, si el parámetro <em>type</em> se omite ocontiene una cadena vacía, el <code>content-type</code> del archivoadjunto se basa en su extensión. Se aplican las siguientes reglaspara los principales tipos MIME:</span></p><table><thead><tr><th>Extensión</th><th>Content-Type</th></tr></thead><tbody><tr><td>jpg, jpeg</td><td>image/jpeg</td></tr><tr><td>png</td><td>image/png</td></tr><tr><td>gif</td><td>image/gif</td></tr><tr><td>pdf</td><td>application/pdf</td></tr><tr><td>doc</td><td>application/msword</td></tr><tr><td>xls</td><td>application/vnd.ms-excel</td></tr><tr><td>ppt</td><td>application/vnd.ms-powerpoint</td></tr><tr><td>zip</td><td>application/zip</td></tr><tr><td>gz</td><td>application/gzip</td></tr><tr><td>json</td><td>application/json</td></tr><tr><td>js</td><td>application/javascript</td></tr><tr><td>ps</td><td>application/postscript</td></tr><tr><td>xml</td><td>application/xml</td></tr><tr><td>htm, html</td><td>text/html</td></tr><tr><td>mp3</td><td>audio/mpeg</td></tr><tr><td><em>otro</em></td><td>application/octet-stream</td></tr></tbody></table><p><span>El parámetro opcional <em>disposition</em> permite pasarel encabezado <code>content-disposition</code> del adjunto. Puedepasar una de las siguientes constantes del tema constante"Mail":</span></p><table><thead><tr><th>Constante</th><th>Valor</th><th>Comentario</th></tr></thead><tbody><tr><td>mail disposition attachment</td><td>"attachment"</td><td>Define el valor del encabezado Content-disposition como"attachment", lo que significa que el archivo adjunto debeproporcionarse como un enlace en el mensaje.</td></tr><tr><td>mail disposition inline</td><td>"inline"</td><td>Define el valor del encabezado Content-disposition como"inline", lo que significa que el archivo adjunto debe aparecerdentro del contenido del mensaje, en la ubicación "cid". Larenderización depende del cliente de correo.</td></tr></tbody></table><p><span>Por defecto, si se omite el parámetro<em>disposition</em>:</span></p><ul><li><span>si el parámetro <em>cid</em> se utiliza, el encabezado<code>Content-disposition</code> es definido como"inline",</span></li><li><span>si el parámetro <em>cid</em> no se pasa o está vacío, elencabezado <code>Content-disposition</code> es definido como"attachment".</span></li></ul><h4><span><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_ejemplo-1"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_ejemplo-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 1</span></h4><p><span>Desea enviar un correo electrónico con un archivoseleccionado por el usuario como adjunto y una imagen integrada enel cuerpo HTML:</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-variable">$doc</span>:=<span class="hljs-function">Select document</span>(<span class="hljs-string">""</span>;<span class="hljs-string">"*"</span>;<span class="hljs-string">"Please select a file to attach"</span>;<span class="hljs-number">0</span>)<span class="hljs-keyword">If</span> (OK=<span class="hljs-number">1</span>) <span class="hljs-comment">//Si se ha seleccionado un documento</span><span class="hljs-function">C_OBJECT</span>(<span class="hljs-variable">$email</span>;<span class="hljs-variable">$server</span>;<span class="hljs-variable">$transporter</span>)<span class="hljs-variable">$server</span>:=New object<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"smtp.mail.com"</span><span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"test_user@mail.com"</span><span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"p@ssw@rd"</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">SMTP New transporter</span>(<span class="hljs-variable">$server</span>)<span class="hljs-variable">$email</span>:=New object<span class="hljs-variable">$email</span>.from:=<span class="hljs-string">"test_user@mail.com"</span><span class="hljs-variable">$email</span>.to:=<span class="hljs-string">"test_user@mail.com"</span><span class="hljs-variable">$email</span>.subject:=<span class="hljs-string">"This is a test message with attachments"</span><span class="hljs-comment">//añadir un enlace para descargar el archivo</span><span class="hljs-variable">$email</span>.attachments:=<span class="hljs-function">New collection</span>(<span class="hljs-function">MAIL New attachment</span>(Document))<span class="hljs-comment">//insertar una imagen en línea (utilice un cid)</span><span class="hljs-variable">$email</span>.attachments[<span class="hljs-number">1</span>]:=<span class="hljs-function">MAIL New attachment</span>(<span class="hljs-string">"c:\\Pictures\\4D.jpg"</span>;<span class="hljs-string">""</span>;<span class="hljs-string">"4D"</span>)<span class="hljs-variable">$email</span>.htmlBody:=<span class="hljs-string">"&lt;html&gt;"</span>+\<span class="hljs-string">"&lt;body&gt;Hello World!"</span>+\<span class="hljs-string">"&lt;img src='cid:4D' &gt;"</span>+\<span class="hljs-string">"&lt;/body&gt;"</span>+\<span class="hljs-string">"&lt;/head&gt;"</span>+\<span class="hljs-string">"&lt;/html&gt;"</span><span class="hljs-variable">$transporter</span>.<span class="hljs-function">send</span>(<span class="hljs-variable">$email</span>) <span class="hljs-comment">//enviar mail</span><span class="hljs-keyword">End if</span></code></span></pre><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_ejemplo-2"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_ejemplo-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo 2</h4><p>Desea enviar un correo electrónico con un área 4D Write Pro comoarchivo adjunto:</p><pre><code class="hljs css language-4d"><span class="hljs-function">C_BLOB</span>(<span class="hljs-variable">$blob</span>)<span class="hljs-function">WP EXPORT VARIABLE</span>(WPArea;<span class="hljs-variable">$blob</span>;wk docx)<span class="hljs-function">C_OBJECT</span>(<span class="hljs-variable">$email</span>;<span class="hljs-variable">$server</span>;<span class="hljs-variable">$transporter</span>)<span class="hljs-variable">$server</span>:=New object<span class="hljs-variable">$server</span>.host:=<span class="hljs-string">"smtp.mail.com"</span><span class="hljs-variable">$server</span>.user:=<span class="hljs-string">"user@mail.com"</span><span class="hljs-variable">$server</span>.password:=<span class="hljs-string">"p@ssw@rd"</span><span class="hljs-variable">$transporter</span>:=<span class="hljs-function">SMTP New transporter</span>(<span class="hljs-variable">$server</span>)<span class="hljs-variable">$email</span>:=New object<span class="hljs-variable">$email</span>.from:=<span class="hljs-string">"user@mail.com"</span><span class="hljs-variable">$email</span>.to:=<span class="hljs-string">"customer@mail.com"</span><span class="hljs-variable">$email</span>.subject:=<span class="hljs-string">"New annual report"</span><span class="hljs-variable">$email</span>.textBody:=<span class="hljs-string">"Please find enclosed our latest annual report."</span><span class="hljs-variable">$email</span>.attachments:=<span class="hljs-function">New collection</span>(<span class="hljs-function">MAIL New attachment</span>(<span class="hljs-variable">$blob</span>;<span class="hljs-string">"Annual report.docx"</span>))<span class="hljs-variable">$transporter</span>.<span class="hljs-function">send</span>(<span class="hljs-variable">$email</span>)</code></pre><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_4dmailattachmentnew"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_4dmailattachmentnew"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>4D.MailAttachment.new()</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v19 R2</td><td>Acepta 4D.File, 4D.ZipFile, 4D.Blob</td></tr></tbody></table></details><p><strong>4D.MailAttachment.new</strong>( <em>file</em> : 4D.File{ ; <em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> :Text { ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment<br /><strong>4D.MailAttachment.new</strong>( <em>zipFile</em> :4D.ZipFile { ; <em>name</em> : Text {; <em>cid</em> : Text{ ;<em>type</em> : Text { ; <em>disposition</em> :Text } } } } ) :4D.MailAttachment<br /><strong>4D.MailAttachment.new</strong>( <em>blob</em> : 4D.Blob { ;<em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> : Text{ ; <em>disposition</em> :Text } } } } ) : 4D.MailAttachment<br /><strong>4D.MailAttachment.new</strong>( <em>path</em> : Text { ;<em>name</em> : Text {; <em>cid</em> : Text{ ; <em>type</em> : Text{ ; <em>disposition</em> :Text } } } } ) : 4D.MailAttachment</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>file</td><td>4D.File</td><td style="text-align:center">-&gt;</td><td>Archivo adjunto</td></tr><tr><td>zIPFile</td><td>4D.ZipFile</td><td style="text-align:center">-&gt;</td><td>Archivo zip adjunto</td></tr><tr><td>blob</td><td>4D.Blob</td><td style="text-align:center">-&gt;</td><td>BLOB que contiene el archivo adjunto</td></tr><tr><td>path</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Ruta del archivo adjunto</td></tr><tr><td>name</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Nombre + extensión utilizados por el cliente de correo paradesignar el archivo adjunto</td></tr><tr><td>cid</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>ID del archivo adjunto (sólo en mensajes HTML), o " " si no serequiere cid</td></tr><tr><td>type</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Valor del encabezado content-type</td></tr><tr><td>disposition</td><td>Texto</td><td style="text-align:center">-&gt;</td><td>Valor del encabezado content-disposition: "inline" o"attachment".</td></tr><tr><td>Resultado</td><td>4D.MailAttachment</td><td style="text-align:center">&lt;-</td><td>Objeto adjunto</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_descripci%C3%B3n-1"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_descripci%25C3%25B3n-1"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>4D.MailAttachment.new()</code> crea y devuelveun nuevo objeto de tipo <code>4D.MailAttachment</code>. Es idénticoal comando <a href="#MailAttachmentClass.html_mail-new-attachment"><code>MAIL Newattachment</code></a> (acceso directo).</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_cid"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_cid"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.cid</h2><p><strong>.cid</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_descripci%C3%B3n-2"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_descripci%25C3%25B3n-2"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La propiedad <code>.cid</code> contiene el ID del adjunto. Estapropiedad se utiliza sólo en los mensajes HTML. Si falta estapropiedad, el archivo se maneja como un simple adjunto(enlace).</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_disposition"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_disposition"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.disposition</h2><p><strong>.disposition</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_descripci%C3%B3n-3"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_descripci%25C3%25B3n-3"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La propiedad <code>.disposition</code> contiene el valor delencabezado <code>Content-Disposition</code>. Hay dos valoresdisponibles:</p><ul><li>"inline": el archivo adjunto se muestra dentro del contenidodel mensaje, en la ubicación "cid". La renderización depende delcliente de correo.</li><li>"attachment": el archivo adjunto se presenta como un enlace enel mensaje.</li></ul><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_getcontent"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_getcontent"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.getContent()</h2><p><strong>.getContent()</strong> : 4D.Blob</p><table><thead><tr><th>Parámetros</th><th>Tipo</th><th style="text-align:center"></th><th>Descripción</th></tr></thead><tbody><tr><td>Resultado</td><td>4D.Blob</td><td style="text-align:center">&lt;-</td><td>Contenido del anexo</td></tr></tbody></table><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_descripci%C3%B3n-4"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_descripci%25C3%25B3n-4"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La función <code>.getContent()</code> devuelve el contenido delobjeto adjunto en un objeto <code>4D.Blob</code>. Puede utilizaresta función con los objetos adjuntos recibidos por el comando<a href="#MailAttachmentClass.html_mail-convert-from-mime"><code>MAILConvert from MIME</code></a>.</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_name"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_name"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.name</h2><p><strong>.name</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_descripci%C3%B3n-5"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_descripci%25C3%25B3n-5"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La propiedad <code>.name</code> contiene el nombre y laextensión del adjuntot. Por defecto, es el nombre del archivo, amenos que se haya indicado otro nombre en el comando <a href="#MailAttachmentClass.html_mail-new-attachment"><code>MAIL Newattachment</code></a>.</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_path"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_path"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.path</h2><p><strong>.path</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_descripci%C3%B3n-6"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_descripci%25C3%25B3n-6"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La propiedad <code>.path</code> contiene la ruta POSIX delarchivo adjunto, si existe.</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_platformpath"></a><a aria-hidden="true"class="hash-link" href="#MailAttachmentClass.html_platformpath"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.platformPath</h2><details><summary>Histórico</summary><table><thead><tr><th>Versión</th><th>Modificaciones</th></tr></thead><tbody><tr><td>v19</td><td>Añadidos</td></tr></tbody></table></details><p><strong>.platformPath</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_descripci%C3%B3n-7"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_descripci%25C3%25B3n-7"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La propiedad <code>.platformPath</code> contiene la ruta delarchivo adjunto expresada con la sintaxis de la plataformaactual.</p><h2><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_type"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_type"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>.type</h2><p><strong>.type</strong> : Text</p><h4><a aria-hidden="true" class="anchor" id="MailAttachmentClass.html_descripci%C3%B3n-8"></a><a aria-hidden="true" class="hash-link" href="#MailAttachmentClass.html_descripci%25C3%25B3n-8"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Descripción</h4><p>La propiedad <code>.type</code> contiene el<code>content-type</code> del archivo adjunto. Si este tipo no sepasa explícitamente al comando <a href="#MailAttachmentClass.html_mail-new-attachment"><code>MAIL Newattachment</code></a>, el <code>content-type</code> se basa en suextensión de archivo.</p><style><![CDATA[ h2 { background: #d9ebff;}]]></style></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#IMAPTransporterClass.html"><span class="arrow-prev">←</span><span>IMAPTransporter</span></a><a class="docs-next button" href="#POP3TransporterClass.html"><span>POP3Transporter</span><span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#MailAttachmentClass.html_mail-new-attachment">MAILNew attachment</a></li><li><a href="#MailAttachmentClass.html_4dmailattachmentnew">4D.MailAttachment.new()</a></li><li><a href="#MailAttachmentClass.html_cid">.cid</a></li><li><a href="#MailAttachmentClass.html_disposition">.disposition</a></li><li><a href="#MailAttachmentClass.html_getcontent">.getContent()</a></li><li><a href="#MailAttachmentClass.html_name">.name</a></li><li><a href="#MailAttachmentClass.html_path">.path</a></li><li><a href="#MailAttachmentClass.html_platformpath">.platformPath</a></li><li><a href="#MailAttachmentClass.html_type">.type</a></li></ul></nav></div></div></body></html>