<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE html><html lang="es"><head><meta content="19 R5" name="docsearch:version" /><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><title>Gestión de errores · 4D Documentation</title><meta content="width=device-width" name="viewport" /><meta content="Docusaurus" name="generator" /><meta content="El manejo de errores es el proceso de anticipar y responder a los errores que puedan ocurrir en su aplicación. 4D soporta de forma completa la detección y notificación de errores en tiempo de ejecución, así como el análisis de sus condiciones."name="description" /><meta content="es" name="docsearch:language" /><meta content="Gestión de errores · 4D Documentation" property="og:title" /><meta content="website" property="og:type" /><meta content="https://4d.github.io/docs/Rx/index.html" property="og:url" /><meta content="El manejo de errores es el proceso de anticipar y responder a los errores que puedan ocurrir en su aplicación. 4D soporta de forma completa la detección y notificación de errores en tiempo de ejecución, así como el análisis de sus condiciones."property="og:description" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png"property="og:image" /><meta content="summary" name="twitter:card" /><meta content="https://4d.github.io/docs/Rx/img/logohome.png" name="twitter:image" /><link href="https://developer.4d.com/docs/Rx/img/4d.gif" rel="shortcut icon" /><link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/routeros.min.css"rel="stylesheet" /><link href="https://developer.4d.com/docs/Rx/css/main.css" rel="stylesheet" /></head><body class="sideNavVisible separateOnPageNav"><div class="navPusher" style="padding-top:0px!important;"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="#error-handling.md" rel="noreferrer noopener" target="_blank">Edit</a><h1 class="postHeaderTitle" id="__docusaurus">Gestión deerrores<a aria-hidden="true" class="anchor" id="error-handling.html"></a></h1></header><article><div><p><span>El manejo de errores es el proceso de anticipar yresponder a los errores que puedan ocurrir en su aplicación. 4Dsoporta de forma completa la detección y notificación de errores entiempo de ejecución, así como el análisis de suscondiciones.</span></p><p><span>La gestión de errores responde a dos necesidadesprincipales:</span></p><ul><li><span>descubrir y corregir posibles errores y fallos en elcódigo durante la fase de desarrollo,</span></li><li><span>detectar y recuperar errores inesperados en lasaplicaciones desplegadas; en particular, puede sustituir losdiálogos de error del sistema (disco lleno, archivo perdido, etc.)por su propia interfaz.</span></li></ul><blockquote><blockquote><blockquote><blockquote><p><span>Es muy recomendable instalar un método de gestión deerrores en 4D Server, para todo el código que se ejecute en elservidor. Este método evitaría la aparición de cajas de diálogoinesperadas en el servidor, y podría registrar los errores en unarchivo específico para su posterior análisis.</span></p></blockquote></blockquote></blockquote></blockquote><h2><span><a aria-hidden="true" class="anchor" id="error-handling.html_error-o-estado"></a><a aria-hidden="true"class="hash-link" href="#error-handling.html_error-o-estado"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Error o estado</span></h2><p><span>Muchas funciones de clase 4D, como<code>entity.save()</code> o <code>transporter.send()</code>,devuelven un objeto <em>status</em>. Este objeto se utiliza paraalmacenar errores "predecibles" en el contexto de ejecución, porejemplo, una contraseña no válida, una entidad bloqueada, etc., queno detienen la ejecución del programa. Esta categoría de errorespuede ser manejada por el código habitual.</span></p><p><span>Otros errores "imprevisibles" son el error de escritura enel disco, el fallo de la red o, en general, cualquier interrupcióninesperada. Esta categoría de errores genera excepciones y necesitaser manejada a través de un método de gestión deerrores.</span></p><h2><span><a aria-hidden="true" class="anchor" id="error-handling.html_instalaci%C3%B3n-de-un-m%C3%A9todo-de-gesti%C3%B3n-de-errores"></a><a aria-hidden="true" class="hash-link" href="#error-handling.html_instalaci%25C3%25B3n-de-un-m%25C3%25A9todo-de-gesti%25C3%25B3n-de-errores"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Instalación de un método de gestión deerrores</span></h2><p><span>En 4D, todos los errores pueden ser captados y manejadosen un método proyecto específico, el método <strong>gestión deerrores</strong> (o <strong>captura deerrores</strong>).</span></p><p><span>Este método proyecto se instala para el proceso actual yserá llamado automáticamente para cualquier error que se produzcaen el proceso, en modo interpretado o compilado. Para<em>instalar</em> este método proyecto, basta con llamar al comando<code>ON ERR CALL</code> con el nombre del método proyecto comoparámetro. Por ejemplo:</span></p><pre><span><code class="hljs css language-4d"><span class="hljs-function">ON ERR CALL</span>(<span class="hljs-string">"IO_ERRORS"</span>) <span class="hljs-comment">//Instala el método de gestión de errores</span></code></span></pre><p>Para dejar de detectar errores y devolver el control a 4D, llamea <code>ON ERR CALL</code> con una cadena vacía:</p><pre><code class="hljs css language-4d"><span class="hljs-function">ON ERR CALL</span>(<span class="hljs-string">""</span>) <span class="hljs-comment">//devuelve el control a 4D</span></code></pre><p>El comando <code>Method called on error</code> le permiteconocer el nombre del método instalado por <code>ON ERR CALL</code>para el proceso actual. Es particularmente útil en el contexto decódigo genérico porque permite cambiar temporalmente y luegorestaurar el método de captura de error:</p><pre><code class="hljs css language-4d"> <span class="hljs-variable">$methCurrent</span>:=Method called on error<span class="hljs-function"> ON ERR CALL</span>(<span class="hljs-string">"NewMethod"</span>)  <span class="hljs-comment">//Si no se puede abrir el documento, se genera un error</span> <span class="hljs-variable">$ref</span>:=<span class="hljs-function">Open document</span>(<span class="hljs-string">"MyDocument"</span>)  <span class="hljs-comment">//Reinstalación del método anterior</span><span class="hljs-function"> ON ERR CALL</span>(<span class="hljs-variable">$methCurrent</span>)</code></pre><h3><a aria-hidden="true" class="anchor" id="error-handling.html_alcance-y-componentes"></a><a aria-hidden="true" class="hash-link" href="#error-handling.html_alcance-y-componentes"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Alcance y componentes</h3><p>Se puede definir un único método de captura de errores para todala aplicación o diferentes métodos por módulo de aplicación. Sinembargo, sólo se puede instalar un método por proceso.</p><p>Un método de gestión de errores instalado por el comando<code>ON ERR CALL</code> sólo se aplica únicamente a la aplicaciónen ejecución. En el caso de un error generado por un<strong>componente</strong>, no se llama al método <code>ON ERRCALL</code> de gestión de errores de la aplicación local, yviceversa.</p><h3><a aria-hidden="true" class="anchor" id="error-handling.html_manejo-de-errores-dentro-del-m%C3%A9todo"></a><a aria-hidden="true"class="hash-link" href="#error-handling.html_manejo-de-errores-dentro-del-m%25C3%25A9todo"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Manejo de errores dentro del método</h3><p>Dentro del método de error personalizado, tiene acceso a variaspiezas de información que le ayudarán a identificar el error:</p><ul><li><p>variables sistema (*):</p><ul><li><code>Error</code> (entero largo): código de error</li><li><code>Error method</code>(texto): nombre del método que haprovocado el error</li><li><code>Error line</code> (entero largo): número de línea delmétodo que ha provocado el error</li><li><code>Error formula</code> (texto): fórmula del código 4D(texto bruto) que está en el origen del error.</li></ul></li></ul><p>(*) 4D mantiene automáticamente una serie de variables llamadas<strong>variables sistema</strong>, que responden a diferentesnecesidades. Consulte el <em>Manual del lenguaje de 4D</em>.</p><ul><li>el comando <code>GET LAST ERROR STACK</code> que devuelveinformación sobre la pila de errores actual de la aplicación4D.</li><li>el comando <code>Get call chain</code> que devuelve unacolección de objetos que describen cada paso de la cadena dellamadas a métodos dentro del proceso actual.</li></ul><h4><a aria-hidden="true" class="anchor" id="error-handling.html_ejemplo"></a><a aria-hidden="true" class="hash-link" href="#error-handling.html_ejemplo"><svg aria-hidden="true" class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Ejemplo</h4><p>He aquí un sistema de gestión de errores sencillo:</p><pre><code class="hljs css language-4d"><span class="hljs-comment">//instalar el método de gestión de errores</span><span class="hljs-function"> ON ERR CALL</span>(<span class="hljs-string">"errorMethod"</span>) <span class="hljs-comment">//... ejecutar el código</span><span class="hljs-function"> ON ERR CALL</span>(<span class="hljs-string">""</span>) <span class="hljs-comment">//giving control back to 4D</span></code></pre><pre><code class="hljs css language-4d"><span class="hljs-comment">// método proyecto errorMethod</span><span class="hljs-keyword"> If</span>(Error#<span class="hljs-number">1006</span>) <span class="hljs-comment">//esto no es una interrupción del usuario</span><span class="hljs-function">    ALERT</span>(<span class="hljs-string">"Se ha producido el error "</span>+<span class="hljs-function">String</span>(Error)+<span class="hljs-string">". El código en cuestión es: \""</span>+Error formula+<span class="hljs-string">"\""</span>)<span class="hljs-keyword"> End if</span></code></pre><h3><a aria-hidden="true" class="anchor" id="error-handling.html_utilizar-un-m%C3%A9todo-de-gesti%C3%B3n-de-errores-vac%C3%ADo"></a><a aria-hidden="true" class="hash-link" href="#error-handling.html_utilizar-un-m%25C3%25A9todo-de-gesti%25C3%25B3n-de-errores-vac%25C3%25ADo"><svg aria-hidden="true"class="hash-link-icon" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"fill-rule="evenodd"></path></svg></a>Utilizar un método de gestión de errores vacío</h3><p>Si desea principalmente que la caja de diálogo de error estándaresté oculta, puede instalar un método de gestión de errores vacío.La variable sistema <code>Error</code> puede ser probada encualquier método, es decir, fuera del método de gestión deerrores:</p><pre><code class="hljs css language-4d"><span class="hljs-function">ON ERR CALL</span>(<span class="hljs-string">"emptyMethod"</span>) <span class="hljs-comment">//emptyMethod existe pero está vacío</span><span class="hljs-variable">$doc</span>:=<span class="hljs-function">Open document</span>( <span class="hljs-string">"myFile.txt"</span>)<span class="hljs-keyword">If</span> (Error=<span class="hljs-number">-43</span>)<span class="hljs-function">    ALERT</span>(<span class="hljs-string">"File not found."</span>)<span class="hljs-keyword">End if</span><span class="hljs-function">ON ERR CALL</span>(<span class="hljs-string">""</span>)<span class="hljs-keyword">End if</span><span class="hljs-function">ON ERR CALL</span>(<span class="hljs-string">""</span>)<span class="hljs-keyword">End if</span><span class="hljs-function">ON ERR CALL</span>(<span class="hljs-string">""</span>)<span class="hljs-keyword">End if</span><span class="hljs-function">ON ERR CALL</span>(<span class="hljs-string">""</span>)</code></pre></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="#looping.html"><span class="arrow-prev">←</span> <span>Estructurasrepetitivas (bucles)</span></a><a class="docs-next button" href="#interpreted-compiled.html"><span>Modos interpretado ycompilado</span> <span class="arrow-next">→</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#error-handling.html_error-o-estado">Error oestado</a></li><li><a href="#error-handling.html_instalaci%25C3%25B3n-de-un-m%25C3%25A9todo-de-gesti%25C3%25B3n-de-errores">Instalación de un método de gestión de errores</a><ul class="toc-headings"><li><a href="#error-handling.html_alcance-y-componentes">Alcance ycomponentes</a></li><li><a href="#error-handling.html_manejo-de-errores-dentro-del-m%25C3%25A9todo">Manejo de errores dentro del método</a></li><li><a href="#error-handling.html_utilizar-un-m%25C3%25A9todo-de-gesti%25C3%25B3n-de-errores-vac%25C3%25ADo">Utilizar un método de gestión de errores vacío</a></li></ul></li></ul></nav></div></div></body></html>